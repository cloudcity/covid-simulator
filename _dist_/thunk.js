import k from"./compile.js";function l(a){var d=["'use strict'","var CACHED={}"],f=[],m=a.funcName+"_cwise_thunk";d.push(["return function ",m,"(",a.shimArgs.join(","),"){"].join(""));for(var g=[],h=[],e=[["array",a.arrayArgs[0],".shape.slice(",Math.max(0,a.arrayBlockIndices[0]),a.arrayBlockIndices[0]<0?","+a.arrayBlockIndices[0]+")":")"].join("")],i=[],j=[],c=0;c<a.arrayArgs.length;++c){var b=a.arrayArgs[c];f.push(["t",b,"=array",b,".dtype,","r",b,"=array",b,".order"].join("")),g.push("t"+b),g.push("r"+b),h.push("t"+b),h.push("r"+b+".join()"),e.push("array"+b+".data"),e.push("array"+b+".stride"),e.push("array"+b+".offset|0"),c>0&&(i.push("array"+a.arrayArgs[0]+".shape.length===array"+b+".shape.length+"+(Math.abs(a.arrayBlockIndices[0])-Math.abs(a.arrayBlockIndices[c]))),j.push("array"+a.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[0])+"]===array"+b+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[c])+"]"))}a.arrayArgs.length>1&&(d.push("if (!("+i.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),d.push("for(var shapeIndex=array"+a.arrayArgs[0]+".shape.length-"+Math.abs(a.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),d.push("if (!("+j.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),d.push("}"));for(var c=0;c<a.scalarArgs.length;++c)e.push("scalar"+a.scalarArgs[c]);f.push(["type=[",h.join(","),"].join()"].join("")),f.push("proc=CACHED[type]"),d.push("var "+f.join(",")),d.push(["if(!proc){","CACHED[type]=proc=compile([",g.join(","),"])}","return proc(",e.join(","),")}"].join("")),a.debug&&console.log(`-----Generated thunk:
`+d.join(`
`)+`
----------`);var n=new Function("compile",d.join(`
`));return n(k.bind(void 0,a))}export default l;
