import l from"./compile.js";function p(a){var n=["'use strict'","var CACHED={}"],t=[],u=a.funcName+"_cwise_thunk";n.push(["return function ",u,"(",a.shimArgs.join(","),"){"].join(""));for(var o=[],i=[],s=[["array",a.arrayArgs[0],".shape.slice(",Math.max(0,a.arrayBlockIndices[0]),a.arrayBlockIndices[0]<0?","+a.arrayBlockIndices[0]+")":")"].join("")],h=[],c=[],r=0;r<a.arrayArgs.length;++r){var e=a.arrayArgs[r];t.push(["t",e,"=array",e,".dtype,","r",e,"=array",e,".order"].join("")),o.push("t"+e),o.push("r"+e),i.push("t"+e),i.push("r"+e+".join()"),s.push("array"+e+".data"),s.push("array"+e+".stride"),s.push("array"+e+".offset|0"),r>0&&(h.push("array"+a.arrayArgs[0]+".shape.length===array"+e+".shape.length+"+(Math.abs(a.arrayBlockIndices[0])-Math.abs(a.arrayBlockIndices[r]))),c.push("array"+a.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[0])+"]===array"+e+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[r])+"]"))}a.arrayArgs.length>1&&(n.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),n.push("for(var shapeIndex=array"+a.arrayArgs[0]+".shape.length-"+Math.abs(a.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),n.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),n.push("}"));for(var r=0;r<a.scalarArgs.length;++r)s.push("scalar"+a.scalarArgs[r]);t.push(["type=[",i.join(","),"].join()"].join("")),t.push("proc=CACHED[type]"),n.push("var "+t.join(",")),n.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),a.debug&&console.log(`-----Generated thunk:
`+n.join(`
`)+`
----------`);var d=new Function("compile",n.join(`
`));return d(l.bind(void 0,a))}export default p;
