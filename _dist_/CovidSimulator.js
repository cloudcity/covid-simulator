import"./CovidSimulator.css.proxy.js";import{SvelteComponent as Fa,add_flush_callback as ma,add_render_callback as Ga,append as b,attr as e,bind as na,binding_callbacks as oa,check_outros as Ha,create_bidirectional_transition as xa,create_component as ia,destroy_component as ja,detach as W,element as f,get_binding_group_value as pa,group_outros as Ia,init as Ja,insert as X,listen as M,mount_component as ka,run_all as sa,safe_not_equal as Ka,set_data as La,space as w,text as ba,toggle_class as z,transition_in as Y,transition_out as _}from"../web_modules/svelte/internal.js";import{fade as ya}from"../web_modules/svelte/transition.js";import Ma from"../web_modules/wnumb.js";import qa from"./RangeSlider.js";import Na from"./CovidGraph.js";function za(a){let c,d,r=a[11].name+"",h,K,I=a[11].body+"",F,o,m,v,x,y;return{c(){c=f("section"),d=f("div"),h=w(),K=f("div"),F=w(),o=f("button"),o.textContent="Back",e(d,"class","control-name svelte-jt39wy"),e(K,"class","control-explanation svelte-jt39wy"),e(o,"class","explain-back svelte-jt39wy"),e(c,"class","explain svelte-jt39wy")},m(n,k){X(n,c,k),b(c,d),d.innerHTML=r,b(c,h),b(c,K),K.innerHTML=I,b(c,F),b(c,o),v=!0,x||(y=M(o,"click",a[14]),x=!0)},p(n,k){(!v||k[0]&2048)&&r!==(r=n[11].name+"")&&(d.innerHTML=r),(!v||k[0]&2048)&&I!==(I=n[11].body+"")&&(K.innerHTML=I)},i(n){if(v)return;Ga(()=>{m||(m=xa(c,ya,{},!0)),m.run(1)}),v=!0},o(n){m||(m=xa(c,ya,{},!1)),m.run(0),v=!1},d(n){n&&W(c),n&&m&&m.end(),x=!1,y()}}}function Oa(a){let c,d,r,h,K,I,F,o,m,v,x,y,n,k,P,p,A,u,q,s,Q,$,S,T,D,U,L,N,Z;function R(t){a[24].call(null,t)}let C={max:la,step:1,tooltip:a[12],disabled:!a[9].includes("Quarantine")};a[8]!==void 0&&(C.values=a[8]);const E=new qa({props:C});return oa.push(()=>na(E,"values",R)),{c(){c=f("section"),d=f("div"),r=f("label"),h=f("input"),I=ba(`
            Quarantine infected on days`),F=w(),o=f("div"),m=w(),v=f("div"),v.innerHTML=`
          Control of COVID-19 requires the effective testing and isolation and quarantine of contacts. Users should determine whether a household quarantine strategy will be adopted (lower resource intensity; we assume 37% reduction in transmission) or an extended contact tracing strategy and quarantine of all extended contacts will be used (higher resource intensity; we assume 52% reduction in transmission. (<a href="https://cmmid.github.io/topics/covid19/reports/bbc_contact_tracing.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,x=w(),y=f("div"),n=f("label"),k=f("input"),p=ba(`
            Quarantine household only`),A=w(),u=f("div"),q=f("label"),s=f("input"),$=ba(`
            Quarantine all contacts`),S=w(),T=f("div"),D=f("div"),ia(E.$$.fragment),e(h,"type","checkbox"),h.__value=K="Quarantine",h.value=h.__value,e(h,"class","svelte-jt39wy"),a[21][0].push(h),e(r,"class","control-label svelte-jt39wy"),e(d,"class","control-name svelte-jt39wy"),z(d,"enabled",a[9].includes("Quarantine")),e(o,"class","control-tooltip svelte-jt39wy"),e(v,"class","control-explanation svelte-jt39wy"),e(k,"type","radio"),k.__value=P=!1,k.value=k.__value,e(k,"class","svelte-jt39wy"),a[21][1].push(k),e(n,"class","control-label svelte-jt39wy"),z(n,"tracing",!a[2]),e(y,"class","control-group radio svelte-jt39wy"),e(s,"type","radio"),s.__value=Q=!0,s.value=s.__value,e(s,"class","svelte-jt39wy"),a[21][1].push(s),e(q,"class","control-label svelte-jt39wy"),z(q,"tracing",a[2]),e(u,"class","control-group radio svelte-jt39wy"),e(D,"class","slider-container svelte-jt39wy"),e(T,"class","control-group slider svelte-jt39wy"),e(c,"class","control control-radio svelte-jt39wy")},m(t,g){X(t,c,g),b(c,d),b(d,r),b(r,h),h.checked=~a[9].indexOf(h.__value),b(r,I),b(c,F),b(c,o),b(c,m),b(c,v),b(c,x),b(c,y),b(y,n),b(n,k),k.checked=k.__value===a[2],b(n,p),b(c,A),b(c,u),b(u,q),b(q,s),s.checked=s.__value===a[2],b(q,$),b(c,S),b(c,T),b(T,D),ka(E,D,null),L=!0,N||(Z=[M(h,"change",a[20]),M(o,"click",a[14]),M(k,"change",a[22]),M(s,"change",a[23])],N=!0)},p(t,g){g[0]&512&&(h.checked=~t[9].indexOf(h.__value)),g[0]&512&&z(d,"enabled",t[9].includes("Quarantine")),g[0]&4&&(k.checked=k.__value===t[2]),g[0]&4&&z(n,"tracing",!t[2]),g[0]&4&&(s.checked=s.__value===t[2]),g[0]&4&&z(q,"tracing",t[2]);const J={};g[0]&512&&(J.disabled=!t[9].includes("Quarantine")),!U&&g[0]&256&&(U=!0,J.values=t[8],ma(()=>U=!1)),E.$set(J)},i(t){if(L)return;Y(E.$$.fragment,t),L=!0},o(t){_(E.$$.fragment,t),L=!1},d(t){t&&W(c),a[21][0].splice(a[21][0].indexOf(h),1),a[21][1].splice(a[21][1].indexOf(k),1),a[21][1].splice(a[21][1].indexOf(s),1),ja(E),N=!1,sa(Z)}}}function Pa(a){let c;return{c(){c=ba("on days")},m(d,r){X(d,c,r)},d(d){d&&W(c)}}}function Qa(a){let c;return{c(){c=f("div"),c.textContent="Overrides interventions below",e(c,"class","control-note svelte-jt39wy")},m(d,r){X(d,c,r)},d(d){d&&W(c)}}}function Aa(a){let c;return{c(){c=f("span"),c.textContent="Day",e(c,"class","control-label svelte-jt39wy")},m(d,r){X(d,c,r)},d(d){d&&W(c)}}}function Ra(a){let c,d,r,h,K,I,F,o,m,v,x,y,n,k,P,p,A,u,q,s,Q,$,S,T,D,U,L,N,Z,R,C,E,t,g,J,l,V,G,ra,da,aa,O,i,B,ca,ea,Ba;function Va(j){a[28].call(null,j)}let Ca={max:la,step:1,tooltip:a[12],disabled:!a[9].includes("School closure")};a[6]!==void 0&&(Ca.values=a[6]);const fa=new qa({props:Ca});oa.push(()=>na(fa,"values",Va));function Wa(j){a[30].call(null,j)}let Da={max:la,step:1,tooltip:a[12],disabled:!a[9].includes("Cancel mass gatherings")};a[5]!==void 0&&(Da.values=a[5]);const ga=new qa({props:Da});oa.push(()=>na(ga,"values",Wa));function Xa(j){a[32].call(null,j)}let Ea={max:la,step:1,tooltip:a[12],disabled:!a[9].includes("Shielding the elderly")};a[7]!==void 0&&(Ea.values=a[7]);const ha=new qa({props:Ea});return oa.push(()=>na(ha,"values",Xa)),{c(){c=f("section"),d=f("div"),r=f("label"),h=f("input"),I=ba(`
            Schools closed on days`),F=w(),o=f("div"),m=w(),v=f("div"),v.innerHTML=`
          Community acceptance may be stronger if alternative services for childcare and student learning and provision of nutrition are established. We used reductions in contacts by age groups in our age-structured model to replicate the findings of Litinova et al. (2019) (<a href="https://www.thelancet.com/action/showPdf?pii=S2352-4642%2820%2930095-X" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,x=w(),y=f("div"),n=f("div"),ia(fa.$$.fragment),P=w(),p=f("section"),A=f("div"),u=f("label"),q=f("input"),Q=ba(`
            No mass gatherings on days`),$=w(),S=f("div"),T=w(),D=f("div"),D.innerHTML=`
          Engage with community and religious leaders to articulate value-based decisions and encourage local adoption. Adaptation of existing events, including outdoor services or services in shifts, may be helpful in localities where cancellation of gatherings is not practical. We assumed a reduction in transmission by 28%. (<a href="https://www.pnas.org/content/104/18/7588" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,U=w(),L=f("div"),N=f("div"),ia(ga.$$.fragment),R=w(),C=f("section"),E=f("div"),t=f("label"),g=f("input"),l=ba(`
            Shield the elderly on days`),V=w(),G=f("div"),ra=w(),da=f("div"),da.innerHTML=`
          While there is a limited evidence base for a “shielding” strategy, such an approach might be of benefit to certain at-risk groups for severe outcomes. We assumed a reduction in transmission among the elderly cohort and their contacts of 50%. (<a href="https://www.imperial.ac.uk/media/imperial-college/medicine/sph/ide/gida-fellowships/Imperial-College-COVID19-NPI-modelling-16-03-2020.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,aa=w(),O=f("div"),i=f("div"),ia(ha.$$.fragment),e(h,"type","checkbox"),h.__value=K="School closure",h.value=h.__value,e(h,"class","svelte-jt39wy"),a[21][0].push(h),e(r,"class","control-label svelte-jt39wy"),e(d,"class","control-name svelte-jt39wy"),z(d,"enabled",a[9].includes("School closure")),e(o,"class","control-tooltip svelte-jt39wy"),e(v,"class","control-explanation svelte-jt39wy"),e(n,"class","slider-container svelte-jt39wy"),e(y,"class","control-group slider svelte-jt39wy"),e(c,"class","control svelte-jt39wy"),e(q,"type","checkbox"),q.__value=s="Cancel mass gatherings",q.value=q.__value,e(q,"class","svelte-jt39wy"),a[21][0].push(q),e(u,"class","control-label svelte-jt39wy"),e(A,"class","control-name svelte-jt39wy"),z(A,"enabled",a[9].includes("Cancel mass gatherings")),e(S,"class","control-tooltip svelte-jt39wy"),e(D,"class","control-explanation svelte-jt39wy"),e(N,"class","slider-container svelte-jt39wy"),e(L,"class","control-group slider svelte-jt39wy"),e(p,"class","control svelte-jt39wy"),e(g,"type","checkbox"),g.__value=J="Shielding the elderly",g.value=g.__value,e(g,"class","svelte-jt39wy"),a[21][0].push(g),e(t,"class","control-label svelte-jt39wy"),e(E,"class","control-name svelte-jt39wy"),z(E,"enabled",a[9].includes("Shielding the elderly")),e(G,"class","control-tooltip svelte-jt39wy"),e(da,"class","control-explanation svelte-jt39wy"),e(i,"class","slider-container svelte-jt39wy"),e(O,"class","control-group slider svelte-jt39wy"),e(C,"class","control svelte-jt39wy")},m(j,H){X(j,c,H),b(c,d),b(d,r),b(r,h),h.checked=~a[9].indexOf(h.__value),b(r,I),b(c,F),b(c,o),b(c,m),b(c,v),b(c,x),b(c,y),b(y,n),ka(fa,n,null),X(j,P,H),X(j,p,H),b(p,A),b(A,u),b(u,q),q.checked=~a[9].indexOf(q.__value),b(u,Q),b(p,$),b(p,S),b(p,T),b(p,D),b(p,U),b(p,L),b(L,N),ka(ga,N,null),X(j,R,H),X(j,C,H),b(C,E),b(E,t),b(t,g),g.checked=~a[9].indexOf(g.__value),b(t,l),b(C,V),b(C,G),b(C,ra),b(C,da),b(C,aa),b(C,O),b(O,i),ka(ha,i,null),ca=!0,ea||(Ba=[M(h,"change",a[27]),M(o,"click",a[14]),M(q,"change",a[29]),M(S,"click",a[14]),M(g,"change",a[31]),M(G,"click",a[14])],ea=!0)},p(j,H){H[0]&512&&(h.checked=~j[9].indexOf(h.__value)),H[0]&512&&z(d,"enabled",j[9].includes("School closure"));const ta={};H[0]&512&&(ta.disabled=!j[9].includes("School closure")),!k&&H[0]&64&&(k=!0,ta.values=j[6],ma(()=>k=!1)),fa.$set(ta),H[0]&512&&(q.checked=~j[9].indexOf(q.__value)),H[0]&512&&z(A,"enabled",j[9].includes("Cancel mass gatherings"));const ua={};H[0]&512&&(ua.disabled=!j[9].includes("Cancel mass gatherings")),!Z&&H[0]&32&&(Z=!0,ua.values=j[5],ma(()=>Z=!1)),ga.$set(ua),H[0]&512&&(g.checked=~j[9].indexOf(g.__value)),H[0]&512&&z(E,"enabled",j[9].includes("Shielding the elderly"));const va={};H[0]&512&&(va.disabled=!j[9].includes("Shielding the elderly")),!B&&H[0]&128&&(B=!0,va.values=j[7],ma(()=>B=!1)),ha.$set(va)},i(j){if(ca)return;Y(fa.$$.fragment,j),Y(ga.$$.fragment,j),Y(ha.$$.fragment,j),ca=!0},o(j){_(fa.$$.fragment,j),_(ga.$$.fragment,j),_(ha.$$.fragment,j),ca=!1},d(j){j&&W(c),a[21][0].splice(a[21][0].indexOf(h),1),ja(fa),j&&W(P),j&&W(p),a[21][0].splice(a[21][0].indexOf(q),1),ja(ga),j&&W(R),j&&W(C),a[21][0].splice(a[21][0].indexOf(g),1),ja(ha),ea=!1,sa(Ba)}}}function Sa(a){let c,d,r,h,K,I,F,o,m,v,x,y,n,k,P,p,A,u,q,s,Q,$,S,T,D,U,L,N,Z,R,C,E;const t=new Na({props:{region:a[0],interventions:a[10],compartment:a[1],days:la}});let g=a[11]&&za(a),J=a[13]&&Oa(a),l=a[13]&&Pa(a),V=a[13]&&Qa(a),G=a[3]&&Aa(a);function ra(i){a[26].call(null,i)}let da={max:la,step:1,tooltip:a[12],disabled:!a[9].includes("Shelter in place")};a[4]!==void 0&&(da.values=a[4]);const aa=new qa({props:da});oa.push(()=>na(aa,"values",ra));let O=a[13]&&Ra(a);return{c(){c=f("section"),d=f("section"),r=f("h1"),h=ba(a[0]),K=w(),I=f("p"),I.textContent="per million population",F=w(),o=f("nav"),m=f("button"),m.textContent="Infections",v=w(),x=f("button"),x.textContent="Deaths",y=w(),ia(t.$$.fragment),n=w(),k=f("section"),g&&g.c(),P=w(),J&&J.c(),p=w(),A=f("section"),u=f("div"),q=f("label"),s=f("input"),$=ba(`
          Shelter in place `),l&&l.c(),S=w(),V&&V.c(),T=w(),D=f("div"),G&&G.c(),U=w(),L=f("div"),ia(aa.$$.fragment),Z=w(),O&&O.c(),e(r,"class","title svelte-jt39wy"),e(I,"class","subtitle svelte-jt39wy"),e(m,"class","svelte-jt39wy"),z(m,"active",a[1]==="Infected"),e(x,"class","svelte-jt39wy"),z(x,"active",a[1]==="Dead"),e(o,"class","compartment-tabs svelte-jt39wy"),e(d,"class","compartments svelte-jt39wy"),e(s,"type","checkbox"),s.__value=Q="Shelter in place",s.value=s.__value,e(s,"class","svelte-jt39wy"),a[21][0].push(s),e(q,"class","control-label svelte-jt39wy"),e(u,"class","control-name svelte-jt39wy"),z(u,"enabled",a[9].includes("Shelter in place")),e(L,"class","slider-container svelte-jt39wy"),e(D,"class","control-group slider svelte-jt39wy"),e(A,"class","control svelte-jt39wy"),e(k,"class","controls svelte-jt39wy"),e(c,"class","covid-simulator svelte-jt39wy"),z(c,"stacked",a[13]),z(c,"simple",a[3])},m(i,B){X(i,c,B),b(c,d),b(d,r),b(r,h),b(d,K),b(d,I),b(d,F),b(d,o),b(o,m),b(o,v),b(o,x),b(d,y),ka(t,d,null),b(c,n),b(c,k),g&&g.m(k,null),b(k,P),J&&J.m(k,null),b(k,p),b(k,A),b(A,u),b(u,q),b(q,s),s.checked=~a[9].indexOf(s.__value),b(q,$),l&&l.m(q,null),b(A,S),V&&V.m(A,null),b(A,T),b(A,D),G&&G.m(D,null),b(D,U),b(D,L),ka(aa,L,null),b(k,Z),O&&O.m(k,null),R=!0,C||(E=[M(m,"click",a[18]),M(x,"click",a[19]),M(s,"change",a[25])],C=!0)},p(i,B){(!R||B[0]&1)&&La(h,i[0]),B[0]&2&&z(m,"active",i[1]==="Infected"),B[0]&2&&z(x,"active",i[1]==="Dead");const ca={};B[0]&1&&(ca.region=i[0]),B[0]&1024&&(ca.interventions=i[10]),B[0]&2&&(ca.compartment=i[1]),t.$set(ca),i[11]?g?(g.p(i,B),B[0]&2048&&Y(g,1)):(g=za(i),g.c(),Y(g,1),g.m(k,P)):g&&(Ia(),_(g,1,1,()=>{g=null}),Ha()),i[13]&&J.p(i,B),B[0]&512&&(s.checked=~i[9].indexOf(s.__value)),B[0]&512&&z(u,"enabled",i[9].includes("Shelter in place")),i[3]?G||(G=Aa(i),G.c(),G.m(D,U)):G&&(G.d(1),G=null);const ea={};B[0]&512&&(ea.disabled=!i[9].includes("Shelter in place")),!N&&B[0]&16&&(N=!0,ea.values=i[4],ma(()=>N=!1)),aa.$set(ea),i[13]&&O.p(i,B),B[0]&8192&&z(c,"stacked",i[13]),B[0]&8&&z(c,"simple",i[3])},i(i){if(R)return;Y(t.$$.fragment,i),Y(g),Y(J),Y(aa.$$.fragment,i),Y(O),R=!0},o(i){_(t.$$.fragment,i),_(g),_(J),_(aa.$$.fragment,i),_(O),R=!1},d(i){i&&W(c),ja(t),g&&g.d(),J&&J.d(),a[21][0].splice(a[21][0].indexOf(s),1),l&&l.d(),V&&V.d(),G&&G.d(),ja(aa),O&&O.d(),C=!1,sa(E)}}}let la=180;function Ta(a,c,d){let{region:r}=c,{preset:h=null}=c,K="Infected",I=Ma({decimals:0,thousand:","}),F=!1,o,m,v,x,y,n;switch(h){case"shelter-only":o=!1,n=[0,0],m=[0,60],x=[0,0],v=[0,0],y=[0,0];break;case"shelter-plus":o=!1,n=[0,0],m=[0,60],x=[0,60],v=[0,60],y=[0,60];break;case"none":o=!1,n=[0,0],m=[0,0],x=[0,0],v=[0,0],y=[0,0];break;case"elderly":o=!1,n=[0,0],m=[0,0],x=[0,0],v=[0,0],y=[0,180];break;case"schools":o=!1,n=[0,0],m=[0,0],x=[0,180],v=[0,0],y=[0,0];break;case"1":o=!0,m=[21,90];break;case"3":o=!0,m=[21,60];break;case"2":case"4":case"5":default:o=!1,n=[90,180],m=[21,90],x=[21,120],v=[21,90],y=[21,120]}let k=!o,P=["Shelter in place","Cancel mass gatherings","School closure","Shielding the elderly","Quarantine"],p=P.slice(),A="Quarantine",u={},q=!1,s=l=>{if(q)return d(11,q=!1);let V=l.target.parentElement;d(11,q={name:V.querySelector(".control-name").innerText,body:V.querySelector(".control-explanation").innerHTML})};const Q=[[],[]],$=()=>d(1,K="Infected"),S=()=>d(1,K="Dead");function T(){p=pa(Q[0]),d(9,p)}function D(){F=this.__value,d(2,F)}function U(){F=this.__value,d(2,F)}function L(l){n=l,d(8,n)}function N(){p=pa(Q[0]),d(9,p)}function Z(l){m=l,d(4,m)}function R(){p=pa(Q[0]),d(9,p)}function C(l){x=l,d(6,x)}function E(){p=pa(Q[0]),d(9,p)}function t(l){v=l,d(5,v)}function g(){p=pa(Q[0]),d(9,p)}function J(l){y=l,d(7,y)}return a.$set=l=>{"region"in l&&d(0,r=l.region),"preset"in l&&d(15,h=l.preset)},a.$$.update=()=>{if(a.$$.dirty[0]&1){wa:d(0,r=r[0].toUpperCase()+r.slice(1))}if(a.$$.dirty[0]&4){wa:d(16,A=F?"Quarantine and tracing":"Quarantine")}if(a.$$.dirty[0]&66552){wa:if(o)d(10,u={"Shelter in place":m});else{d(10,u={});for(let l of P)switch(l){case"Cancel mass gatherings":d(10,u[l]=p.includes(l)?v:[0,0],u);break;case"School closure":d(10,u[l]=p.includes(l)?x:[0,0],u);break;case"Shelter in place":d(10,u[l]=p.includes(l)?m:[0,0],u);break;case"Shielding the elderly":d(10,u[l]=p.includes(l)?y:[0,0],u);break;case"Quarantine":d(10,u[A]=p.includes(l)?n:[0,0],u);break}}}},[r,K,F,o,m,v,x,y,n,p,u,q,I,k,s,h,A,P,$,S,T,Q,D,U,L,N,Z,R,C,E,t,g,J]}class Ua extends Fa{constructor(a){super();Ja(this,a,Ta,Sa,Ka,{region:0,preset:15},[-1,-1])}}export default Ua;
