import"./CovidSimulator.css.proxy.js";import{SvelteComponent as Ie,add_flush_callback as pe,add_render_callback as Me,append as l,attr as i,bind as ge,binding_callbacks as _e,check_outros as Ee,create_bidirectional_transition as Ce,create_component as oe,destroy_component as de,detach as J,element as a,get_binding_group_value as fe,group_outros as De,init as Re,insert as K,listen as G,mount_component as ce,run_all as ke,safe_not_equal as We,set_data as Ne,space as y,text as ne,toggle_class as O,transition_in as Y,transition_out as ee}from"../web_modules/svelte/internal.js";import{fade as Oe}from"../web_modules/svelte/transition.js";import Ge from"../web_modules/wnumb.js";import ve from"./RangeSlider.js";import Pe from"./CovidGraph.js";function qe(e){let n,t,b=e[11].name+"",r,D,M=e[11].body+"",T,_,p,k,j,S;return{c(){n=a("section"),t=a("div"),r=y(),D=a("div"),T=y(),_=a("button"),_.textContent="Back",i(t,"class","control-name svelte-jt39wy"),i(D,"class","control-explanation svelte-jt39wy"),i(_,"class","explain-back svelte-jt39wy"),i(n,"class","explain svelte-jt39wy")},m(g,c){K(g,n,c),l(n,t),t.innerHTML=b,l(n,r),l(n,D),D.innerHTML=M,l(n,T),l(n,_),k=!0,j||(S=G(_,"click",e[14]),j=!0)},p(g,c){(!k||c[0]&2048)&&b!==(b=g[11].name+"")&&(t.innerHTML=b),(!k||c[0]&2048)&&M!==(M=g[11].body+"")&&(D.innerHTML=M)},i(g){if(k)return;Me(()=>{p||(p=Ce(n,Oe,{},!0)),p.run(1)}),k=!0},o(g){p||(p=Ce(n,Oe,{},!1)),p.run(0),k=!1},d(g){g&&J(n),g&&p&&p.end(),j=!1,S()}}}function Ue(e){let n,t,b,r,D,M,T,_,p,k,j,S,g,c,P,f,$,w,v,h,U,Z,A,B,Q,X,R,W,F;function V(m){e[24].call(null,m)}let q={max:ue,step:1,tooltip:e[12],disabled:!e[9].includes("Quarantine")};e[8]!==void 0&&(q.values=e[8]);const L=new ve({props:q});return _e.push(()=>ge(L,"values",V)),{c(){n=a("section"),t=a("div"),b=a("label"),r=a("input"),M=ne(`
            Quarantine infected on days`),T=y(),_=a("div"),p=y(),k=a("div"),k.innerHTML=`
          Control of COVID-19 requires the effective testing and isolation and quarantine of contacts. Users should determine whether a household quarantine strategy will be adopted (lower resource intensity; we assume 37% reduction in transmission) or an extended contact tracing strategy and quarantine of all extended contacts will be used (higher resource intensity; we assume 52% reduction in transmission. (<a href="https://cmmid.github.io/topics/covid19/reports/bbc_contact_tracing.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,j=y(),S=a("div"),g=a("label"),c=a("input"),f=ne(`
            Quarantine household only`),$=y(),w=a("div"),v=a("label"),h=a("input"),Z=ne(`
            Quarantine all contacts`),A=y(),B=a("div"),Q=a("div"),oe(L.$$.fragment),i(r,"type","checkbox"),r.__value=D="Quarantine",r.value=r.__value,i(r,"class","svelte-jt39wy"),e[21][0].push(r),i(b,"class","control-label svelte-jt39wy"),i(t,"class","control-name svelte-jt39wy"),O(t,"enabled",e[9].includes("Quarantine")),i(_,"class","control-tooltip svelte-jt39wy"),i(k,"class","control-explanation svelte-jt39wy"),i(c,"type","radio"),c.__value=P=!1,c.value=c.__value,i(c,"class","svelte-jt39wy"),e[21][1].push(c),i(g,"class","control-label svelte-jt39wy"),O(g,"tracing",!e[2]),i(S,"class","control-group radio svelte-jt39wy"),i(h,"type","radio"),h.__value=U=!0,h.value=h.__value,i(h,"class","svelte-jt39wy"),e[21][1].push(h),i(v,"class","control-label svelte-jt39wy"),O(v,"tracing",e[2]),i(w,"class","control-group radio svelte-jt39wy"),i(Q,"class","slider-container svelte-jt39wy"),i(B,"class","control-group slider svelte-jt39wy"),i(n,"class","control control-radio svelte-jt39wy")},m(m,s){K(m,n,s),l(n,t),l(t,b),l(b,r),r.checked=~e[9].indexOf(r.__value),l(b,M),l(n,T),l(n,_),l(n,p),l(n,k),l(n,j),l(n,S),l(S,g),l(g,c),c.checked=c.__value===e[2],l(g,f),l(n,$),l(n,w),l(w,v),l(v,h),h.checked=h.__value===e[2],l(v,Z),l(n,A),l(n,B),l(B,Q),ce(L,Q,null),R=!0,W||(F=[G(r,"change",e[20]),G(_,"click",e[14]),G(c,"change",e[22]),G(h,"change",e[23])],W=!0)},p(m,s){s[0]&512&&(r.checked=~m[9].indexOf(r.__value)),s[0]&512&&O(t,"enabled",m[9].includes("Quarantine")),s[0]&4&&(c.checked=c.__value===m[2]),s[0]&4&&O(g,"tracing",!m[2]),s[0]&4&&(h.checked=h.__value===m[2]),s[0]&4&&O(v,"tracing",m[2]);const E={};s[0]&512&&(E.disabled=!m[9].includes("Quarantine")),!X&&s[0]&256&&(X=!0,E.values=m[8],pe(()=>X=!1)),L.$set(E)},i(m){if(R)return;Y(L.$$.fragment,m),R=!0},o(m){ee(L.$$.fragment,m),R=!1},d(m){m&&J(n),e[21][0].splice(e[21][0].indexOf(r),1),e[21][1].splice(e[21][1].indexOf(c),1),e[21][1].splice(e[21][1].indexOf(h),1),de(L),W=!1,ke(F)}}}function Ve(e){let n;return{c(){n=ne("on days")},m(t,b){K(t,n,b)},d(t){t&&J(n)}}}function Ae(e){let n;return{c(){n=a("div"),n.textContent="Overrides interventions below",i(n,"class","control-note svelte-jt39wy")},m(t,b){K(t,n,b)},d(t){t&&J(n)}}}function Qe(e){let n;return{c(){n=a("span"),n.textContent="Day",i(n,"class","control-label svelte-jt39wy")},m(t,b){K(t,n,b)},d(t){t&&J(n)}}}function Be(e){let n,t,b,r,D,M,T,_,p,k,j,S,g,c,P,f,$,w,v,h,U,Z,A,B,Q,X,R,W,F,V,q,L,m,s,E,u,z,H,be,te,x,N,o,C,le,ie,ye;function Le(d){e[28].call(null,d)}let je={max:ue,step:1,tooltip:e[12],disabled:!e[9].includes("School closure")};e[6]!==void 0&&(je.values=e[6]);const ae=new ve({props:je});_e.push(()=>ge(ae,"values",Le));function Te(d){e[30].call(null,d)}let Se={max:ue,step:1,tooltip:e[12],disabled:!e[9].includes("Cancel mass gatherings")};e[5]!==void 0&&(Se.values=e[5]);const se=new ve({props:Se});_e.push(()=>ge(se,"values",Te));function He(d){e[32].call(null,d)}let $e={max:ue,step:1,tooltip:e[12],disabled:!e[9].includes("Shielding the elderly")};e[7]!==void 0&&($e.values=e[7]);const re=new ve({props:$e});return _e.push(()=>ge(re,"values",He)),{c(){n=a("section"),t=a("div"),b=a("label"),r=a("input"),M=ne(`
            Schools closed on days`),T=y(),_=a("div"),p=y(),k=a("div"),k.innerHTML=`
          Community acceptance may be stronger if alternative services for childcare and student learning and provision of nutrition are established. We used reductions in contacts by age groups in our age-structured model to replicate the findings of Litinova et al. (2019) (<a href="https://www.thelancet.com/action/showPdf?pii=S2352-4642%2820%2930095-X" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,j=y(),S=a("div"),g=a("div"),oe(ae.$$.fragment),P=y(),f=a("section"),$=a("div"),w=a("label"),v=a("input"),U=ne(`
            No mass gatherings on days`),Z=y(),A=a("div"),B=y(),Q=a("div"),Q.innerHTML=`
          Engage with community and religious leaders to articulate value-based decisions and encourage local adoption. Adaptation of existing events, including outdoor services or services in shifts, may be helpful in localities where cancellation of gatherings is not practical. We assumed a reduction in transmission by 28%. (<a href="https://www.pnas.org/content/104/18/7588" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,X=y(),R=a("div"),W=a("div"),oe(se.$$.fragment),V=y(),q=a("section"),L=a("div"),m=a("label"),s=a("input"),u=ne(`
            Shield the elderly on days`),z=y(),H=a("div"),be=y(),te=a("div"),te.innerHTML=`
          While there is a limited evidence base for a “shielding” strategy, such an approach might be of benefit to certain at-risk groups for severe outcomes. We assumed a reduction in transmission among the elderly cohort and their contacts of 50%. (<a href="https://www.imperial.ac.uk/media/imperial-college/medicine/sph/ide/gida-fellowships/Imperial-College-COVID19-NPI-modelling-16-03-2020.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,x=y(),N=a("div"),o=a("div"),oe(re.$$.fragment),i(r,"type","checkbox"),r.__value=D="School closure",r.value=r.__value,i(r,"class","svelte-jt39wy"),e[21][0].push(r),i(b,"class","control-label svelte-jt39wy"),i(t,"class","control-name svelte-jt39wy"),O(t,"enabled",e[9].includes("School closure")),i(_,"class","control-tooltip svelte-jt39wy"),i(k,"class","control-explanation svelte-jt39wy"),i(g,"class","slider-container svelte-jt39wy"),i(S,"class","control-group slider svelte-jt39wy"),i(n,"class","control svelte-jt39wy"),i(v,"type","checkbox"),v.__value=h="Cancel mass gatherings",v.value=v.__value,i(v,"class","svelte-jt39wy"),e[21][0].push(v),i(w,"class","control-label svelte-jt39wy"),i($,"class","control-name svelte-jt39wy"),O($,"enabled",e[9].includes("Cancel mass gatherings")),i(A,"class","control-tooltip svelte-jt39wy"),i(Q,"class","control-explanation svelte-jt39wy"),i(W,"class","slider-container svelte-jt39wy"),i(R,"class","control-group slider svelte-jt39wy"),i(f,"class","control svelte-jt39wy"),i(s,"type","checkbox"),s.__value=E="Shielding the elderly",s.value=s.__value,i(s,"class","svelte-jt39wy"),e[21][0].push(s),i(m,"class","control-label svelte-jt39wy"),i(L,"class","control-name svelte-jt39wy"),O(L,"enabled",e[9].includes("Shielding the elderly")),i(H,"class","control-tooltip svelte-jt39wy"),i(te,"class","control-explanation svelte-jt39wy"),i(o,"class","slider-container svelte-jt39wy"),i(N,"class","control-group slider svelte-jt39wy"),i(q,"class","control svelte-jt39wy")},m(d,I){K(d,n,I),l(n,t),l(t,b),l(b,r),r.checked=~e[9].indexOf(r.__value),l(b,M),l(n,T),l(n,_),l(n,p),l(n,k),l(n,j),l(n,S),l(S,g),ce(ae,g,null),K(d,P,I),K(d,f,I),l(f,$),l($,w),l(w,v),v.checked=~e[9].indexOf(v.__value),l(w,U),l(f,Z),l(f,A),l(f,B),l(f,Q),l(f,X),l(f,R),l(R,W),ce(se,W,null),K(d,V,I),K(d,q,I),l(q,L),l(L,m),l(m,s),s.checked=~e[9].indexOf(s.__value),l(m,u),l(q,z),l(q,H),l(q,be),l(q,te),l(q,x),l(q,N),l(N,o),ce(re,o,null),le=!0,ie||(ye=[G(r,"change",e[27]),G(_,"click",e[14]),G(v,"change",e[29]),G(A,"click",e[14]),G(s,"change",e[31]),G(H,"click",e[14])],ie=!0)},p(d,I){I[0]&512&&(r.checked=~d[9].indexOf(r.__value)),I[0]&512&&O(t,"enabled",d[9].includes("School closure"));const he={};I[0]&512&&(he.disabled=!d[9].includes("School closure")),!c&&I[0]&64&&(c=!0,he.values=d[6],pe(()=>c=!1)),ae.$set(he),I[0]&512&&(v.checked=~d[9].indexOf(v.__value)),I[0]&512&&O($,"enabled",d[9].includes("Cancel mass gatherings"));const me={};I[0]&512&&(me.disabled=!d[9].includes("Cancel mass gatherings")),!F&&I[0]&32&&(F=!0,me.values=d[5],pe(()=>F=!1)),se.$set(me),I[0]&512&&(s.checked=~d[9].indexOf(s.__value)),I[0]&512&&O(L,"enabled",d[9].includes("Shielding the elderly"));const we={};I[0]&512&&(we.disabled=!d[9].includes("Shielding the elderly")),!C&&I[0]&128&&(C=!0,we.values=d[7],pe(()=>C=!1)),re.$set(we)},i(d){if(le)return;Y(ae.$$.fragment,d),Y(se.$$.fragment,d),Y(re.$$.fragment,d),le=!0},o(d){ee(ae.$$.fragment,d),ee(se.$$.fragment,d),ee(re.$$.fragment,d),le=!1},d(d){d&&J(n),e[21][0].splice(e[21][0].indexOf(r),1),de(ae),d&&J(P),d&&J(f),e[21][0].splice(e[21][0].indexOf(v),1),de(se),d&&J(V),d&&J(q),e[21][0].splice(e[21][0].indexOf(s),1),de(re),ie=!1,ke(ye)}}}function Xe(e){let n,t,b,r,D,M,T,_,p,k,j,S,g,c,P,f,$,w,v,h,U,Z,A,B,Q,X,R,W,F,V,q,L;const m=new Pe({props:{region:e[0],interventions:e[10],compartment:e[1],days:ue}});let s=e[11]&&qe(e),E=e[13]&&Ue(e),u=e[13]&&Ve(e),z=e[13]&&Ae(e),H=e[3]&&Qe(e);function be(o){e[26].call(null,o)}let te={max:ue,step:1,tooltip:e[12],disabled:!e[9].includes("Shelter in place")};e[4]!==void 0&&(te.values=e[4]);const x=new ve({props:te});_e.push(()=>ge(x,"values",be));let N=e[13]&&Be(e);return{c(){n=a("section"),t=a("section"),b=a("h1"),r=ne(e[0]),D=y(),M=a("p"),M.textContent="per million population",T=y(),_=a("nav"),p=a("button"),p.textContent="Infections",k=y(),j=a("button"),j.textContent="Deaths",S=y(),oe(m.$$.fragment),g=y(),c=a("section"),s&&s.c(),P=y(),E&&E.c(),f=y(),$=a("section"),w=a("div"),v=a("label"),h=a("input"),Z=ne(`
          Shelter in place `),u&&u.c(),A=y(),z&&z.c(),B=y(),Q=a("div"),H&&H.c(),X=y(),R=a("div"),oe(x.$$.fragment),F=y(),N&&N.c(),i(b,"class","title svelte-jt39wy"),i(M,"class","subtitle svelte-jt39wy"),i(p,"class","svelte-jt39wy"),O(p,"active",e[1]==="Infected"),i(j,"class","svelte-jt39wy"),O(j,"active",e[1]==="Dead"),i(_,"class","compartment-tabs svelte-jt39wy"),i(t,"class","compartments svelte-jt39wy"),i(h,"type","checkbox"),h.__value=U="Shelter in place",h.value=h.__value,i(h,"class","svelte-jt39wy"),e[21][0].push(h),i(v,"class","control-label svelte-jt39wy"),i(w,"class","control-name svelte-jt39wy"),O(w,"enabled",e[9].includes("Shelter in place")),i(R,"class","slider-container svelte-jt39wy"),i(Q,"class","control-group slider svelte-jt39wy"),i($,"class","control svelte-jt39wy"),i(c,"class","controls svelte-jt39wy"),i(n,"class","covid-simulator svelte-jt39wy"),O(n,"stacked",e[13]),O(n,"simple",e[3])},m(o,C){K(o,n,C),l(n,t),l(t,b),l(b,r),l(t,D),l(t,M),l(t,T),l(t,_),l(_,p),l(_,k),l(_,j),l(t,S),ce(m,t,null),l(n,g),l(n,c),s&&s.m(c,null),l(c,P),E&&E.m(c,null),l(c,f),l(c,$),l($,w),l(w,v),l(v,h),h.checked=~e[9].indexOf(h.__value),l(v,Z),u&&u.m(v,null),l($,A),z&&z.m($,null),l($,B),l($,Q),H&&H.m(Q,null),l(Q,X),l(Q,R),ce(x,R,null),l(c,F),N&&N.m(c,null),V=!0,q||(L=[G(p,"click",e[18]),G(j,"click",e[19]),G(h,"change",e[25])],q=!0)},p(o,C){(!V||C[0]&1)&&Ne(r,o[0]),C[0]&2&&O(p,"active",o[1]==="Infected"),C[0]&2&&O(j,"active",o[1]==="Dead");const le={};C[0]&1&&(le.region=o[0]),C[0]&1024&&(le.interventions=o[10]),C[0]&2&&(le.compartment=o[1]),m.$set(le),o[11]?s?(s.p(o,C),C[0]&2048&&Y(s,1)):(s=qe(o),s.c(),Y(s,1),s.m(c,P)):s&&(De(),ee(s,1,1,()=>{s=null}),Ee()),o[13]&&E.p(o,C),C[0]&512&&(h.checked=~o[9].indexOf(h.__value)),C[0]&512&&O(w,"enabled",o[9].includes("Shelter in place")),o[3]?H||(H=Qe(o),H.c(),H.m(Q,X)):H&&(H.d(1),H=null);const ie={};C[0]&512&&(ie.disabled=!o[9].includes("Shelter in place")),!W&&C[0]&16&&(W=!0,ie.values=o[4],pe(()=>W=!1)),x.$set(ie),o[13]&&N.p(o,C),C[0]&8192&&O(n,"stacked",o[13]),C[0]&8&&O(n,"simple",o[3])},i(o){if(V)return;Y(m.$$.fragment,o),Y(s),Y(E),Y(x.$$.fragment,o),Y(N),V=!0},o(o){ee(m.$$.fragment,o),ee(s),ee(E),ee(x.$$.fragment,o),ee(N),V=!1},d(o){o&&J(n),de(m),s&&s.d(),E&&E.d(),e[21][0].splice(e[21][0].indexOf(h),1),u&&u.d(),z&&z.d(),H&&H.d(),de(x),N&&N.d(),q=!1,ke(L)}}}let ue=180;function ze(e,n,t){let{region:b}=n,{preset:r=null}=n,D="Infected",M=Ge({decimals:0,thousand:","}),T=!1,_,p,k,j,S,g;switch(r){case"shelter-only":_=!1,g=[0,0],p=[0,60],j=[0,0],k=[0,0],S=[0,0];break;case"shelter-plus":_=!1,g=[0,0],p=[0,60],j=[0,60],k=[0,60],S=[0,60];break;case"none":_=!1,g=[0,0],p=[0,0],j=[0,0],k=[0,0],S=[0,0];break;case"elderly":_=!1,g=[0,0],p=[0,0],j=[0,0],k=[0,0],S=[0,180];break;case"schools":_=!1,g=[0,0],p=[0,0],j=[0,180],k=[0,0],S=[0,0];break;case"1":_=!0,p=[21,90];break;case"3":_=!0,p=[21,60];break;case"2":case"4":case"5":default:_=!1,g=[90,180],p=[21,90],j=[21,120],k=[21,90],S=[21,120]}let c=!_,P=["Shelter in place","Cancel mass gatherings","School closure","Shielding the elderly","Quarantine"],f=P.slice(),$="Quarantine",w={},v=!1,h=u=>{if(v)return t(11,v=!1);let z=u.target.parentElement;t(11,v={name:z.querySelector(".control-name").innerText,body:z.querySelector(".control-explanation").innerHTML})};const U=[[],[]],Z=()=>t(1,D="Infected"),A=()=>t(1,D="Dead");function B(){f=fe(U[0]),t(9,f)}function Q(){T=this.__value,t(2,T)}function X(){T=this.__value,t(2,T)}function R(u){g=u,t(8,g)}function W(){f=fe(U[0]),t(9,f)}function F(u){p=u,t(4,p)}function V(){f=fe(U[0]),t(9,f)}function q(u){j=u,t(6,j)}function L(){f=fe(U[0]),t(9,f)}function m(u){k=u,t(5,k)}function s(){f=fe(U[0]),t(9,f)}function E(u){S=u,t(7,S)}return e.$set=u=>{"region"in u&&t(0,b=u.region),"preset"in u&&t(15,r=u.preset)},e.$$.update=()=>{if(e.$$.dirty[0]&1){e:t(0,b=b[0].toUpperCase()+b.slice(1))}if(e.$$.dirty[0]&4){e:t(16,$=T?"Quarantine and tracing":"Quarantine")}if(e.$$.dirty[0]&66552){e:if(_)t(10,w={"Shelter in place":p});else{t(10,w={});for(let u of P)switch(u){case"Cancel mass gatherings":t(10,w[u]=f.includes(u)?k:[0,0],w);break;case"School closure":t(10,w[u]=f.includes(u)?j:[0,0],w);break;case"Shelter in place":t(10,w[u]=f.includes(u)?p:[0,0],w);break;case"Shielding the elderly":t(10,w[u]=f.includes(u)?S:[0,0],w);break;case"Quarantine":t(10,w[$]=f.includes(u)?g:[0,0],w);break}}}},[b,D,T,_,p,k,j,S,g,f,w,v,M,c,h,r,$,P,Z,A,B,U,Q,X,R,W,F,V,q,L,m,s,E]}class Fe extends Ie{constructor(e){super();Re(this,e,ze,Xe,We,{region:0,preset:15},[-1,-1])}}export default Fe;
