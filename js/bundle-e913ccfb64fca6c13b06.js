/*! For license information please see bundle-e913ccfb64fca6c13b06.js.LICENSE.txt */!function(le){var _a={};function ya(Ca){if(_a[Ca])return _a[Ca].exports;var v=_a[Ca]={i:Ca,l:!1,exports:{}};return le[Ca].call(v.exports,v,v.exports,ya),v.l=!0,v.exports}ya.m=le,ya.c=_a,ya.d=function(Ca,v,Fa){ya.o(Ca,v)||Object.defineProperty(Ca,v,{enumerable:!0,get:Fa})},ya.r=function(Ca){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Ca,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ca,"__esModule",{value:!0})},ya.t=function(Ca,v){if(1&v&&(Ca=ya(Ca)),8&v)return Ca;if(4&v&&"object"==typeof Ca&&Ca&&Ca.__esModule)return Ca;var Fa=Object.create(null);if(ya.r(Fa),Object.defineProperty(Fa,"default",{enumerable:!0,value:Ca}),2&v&&"string"!=typeof Ca)for(var bc in Ca)ya.d(Fa,bc,function(cc){return Ca[cc]}.bind(null,bc));return Fa},ya.n=function(Ca){var v=Ca&&Ca.__esModule?function(){return Ca.default}:function(){return Ca};return ya.d(v,"a",v),v},ya.o=function(Ca,v){return Object.prototype.hasOwnProperty.call(Ca,v)},ya.p="",ya(ya.s=11)}([function(le,_a,ya){"use strict";(function(Ca){function v(){}ya.d(_a,"a",function(){return Rk}),ya.d(_a,"b",function(){return H}),ya.d(_a,"c",function(){return C}),ya.d(_a,"d",function(){return jc}),ya.d(_a,"e",function(){return Zf}),ya.d(_a,"f",function(){return Qk}),ya.d(_a,"g",function(){return be}),ya.d(_a,"h",function(){return Cc}),ya.d(_a,"i",function(){return Ok}),ya.d(_a,"j",function(){return Bj}),ya.d(_a,"k",function(){return ch}),ya.d(_a,"l",function(){return Yf}),ya.d(_a,"m",function(){return Xe}),ya.d(_a,"n",function(){return wg}),ya.d(_a,"o",function(){return _e}),ya.d(_a,"p",function(){return Fa}),ya.d(_a,"q",function(){return Ag}),ya.d(_a,"r",function(){return kc}),ya.d(_a,"s",function(){return me}),ya.d(_a,"t",function(){return zi}),ya.d(_a,"u",function(){return v}),ya.d(_a,"v",function(){return Cf}),ya.d(_a,"w",function(){return uc}),ya.d(_a,"x",function(){return qb}),ya.d(_a,"y",function(){return td}),ya.d(_a,"z",function(){return bh}),ya.d(_a,"A",function(){return ae}),ya.d(_a,"B",function(){return vg}),ya.d(_a,"C",function(){return Ye}),ya.d(_a,"D",function(){return De}),ya.d(_a,"E",function(){return zg});const Fa=ca=>ca;function bc(ca){return ca()}function cc(){return Object.create(null)}function qb(ca){ca.forEach(bc)}function ha(ca){return"function"==typeof ca}function td(ca,Ja){return ca!=ca?Ja==Ja:ca!==Ja||ca&&"object"==typeof ca||"function"==typeof ca}const zb="undefined"!=typeof window;let Ua=zb?()=>window.performance.now():()=>Date.now(),eb=zb?ca=>requestAnimationFrame(ca):v;const Wb=new Set();function ic(ca){Wb.forEach(Ja=>{Ja.c(ca)||(Wb.delete(Ja),Ja.f())}),0!==Wb.size&&eb(ic)}function $c(ca){let Ja;return 0===Wb.size&&eb(ic),{promise:new Promise(Va=>{Wb.add(Ja={c:ca,f:Va})}),abort(){Wb.delete(Ja)}}}function jc(ca,Ja){ca.appendChild(Ja)}function kc(ca,Ja,Va){ca.insertBefore(Ja,Va||null)}function Yf(ca){ca.parentNode.removeChild(ca)}function Xe(ca){return document.createElement(ca)}function vg(ca){return document.createTextNode(ca)}function ae(){return vg(" ")}function me(ca,Ja,Va,dc){return ca.addEventListener(Ja,Va,dc),()=>ca.removeEventListener(Ja,Va,dc)}function Zf(ca,Ja,Va){null==Va?ca.removeAttribute(Ja):ca.getAttribute(Ja)!==Va&&ca.setAttribute(Ja,Va)}function wg(ca){const Ja=[];for(let Va=0;Va<ca.length;Va+=1)ca[Va].checked&&Ja.push(ca[Va].__value);return Ja}function bh(ca,Ja){Ja=""+Ja,ca.data!==Ja&&(ca.data=Ja)}function Ye(ca,Ja,Va){ca.classList[Va?"add":"remove"](Ja)}function yi(ca,Ja){const Va=document.createEvent("CustomEvent");return Va.initCustomEvent(ca,!1,!1,Ja),Va}const _f=new Set();let xg,yg=0;function Gb(ca,Ja,Va,dc,Cd,yc,E,F=0){const N=16.666/dc;let L=`{
`;for(let aa=0;aa<=1;aa+=N){const ma=Ja+(Va-Ja)*yc(aa);L+=100*aa+`%{${E(ma,1-ma)}}
`}const P=L+`100% {${E(Va,1-Va)}}
}`,R=`__svelte_${function(aa){let ma=5381,Y=aa.length;for(;Y--;)ma=(ma<<5)-ma^aa.charCodeAt(Y);return ma>>>0}(P)}_${F}`,S=ca.ownerDocument;_f.add(S);const ga=S.__svelte_stylesheet||(S.__svelte_stylesheet=S.head.appendChild(Xe("style")).sheet),_=S.__svelte_rules||(S.__svelte_rules={});_[R]||(_[R]=!0,ga.insertRule(`@keyframes ${R} ${P}`,ga.cssRules.length));const la=ca.style.animation||"";return ca.style.animation=`${la?la+", ":""}${R} ${dc}ms linear ${Cd}ms 1 both`,yg+=1,R}function cb(ca,Ja){const Va=(ca.style.animation||"").split(", "),dc=Va.filter(Ja?yc=>yc.indexOf(Ja)<0:yc=>-1===yc.indexOf("__svelte")),Cd=Va.length-dc.length;Cd&&(ca.style.animation=dc.join(", "),yg-=Cd,yg||eb(()=>{yg||(_f.forEach(yc=>{const E=yc.__svelte_stylesheet;let F=E.cssRules.length;for(;F--;)E.deleteRule(F);yc.__svelte_rules={}}),_f.clear())}))}function Be(ca){xg=ca}function rf(){if(!xg)throw new Error("Function called outside component initialization");return xg}function uc(ca){rf().$$.on_mount.push(ca)}function Cf(ca){rf().$$.on_destroy.push(ca)}const ne=[],be=[],Df=[],Ze=[],$f=Promise.resolve();let Ce=!1;function y(){Ce||(Ce=!0,$f.then(T))}function C(ca){Df.push(ca)}function H(ca){Ze.push(ca)}let X=!1;const W=new Set();function T(){if(!X){X=!0;do{for(let ca=0;ca<ne.length;ca+=1){const Ja=ne[ca];Be(Ja),Sa(Ja.$$)}for(ne.length=0;be.length;)be.pop()();for(let ca=0;ca<Df.length;ca+=1){const Ja=Df[ca];W.has(Ja)||(W.add(Ja),Ja())}Df.length=0}while(ne.length);for(;Ze.length;)Ze.pop()();Ce=!1,X=!1,W.clear()}}function Sa(ca){if(null!==ca.fragment){ca.update(),qb(ca.before_update);const Ja=ca.dirty;ca.dirty=[-1],ca.fragment&&ca.fragment.p(ca.ctx,Ja),ca.after_update.forEach(C)}}let rb;function xc(){return rb||(rb=Promise.resolve(),rb.then(()=>{rb=null})),rb}function Yb(ca,Ja,Va){ca.dispatchEvent(yi(`${Ja?"intro":"outro"}${Va}`))}const Hb=new Set();let ud;function _e(){ud={r:0,c:[],p:ud}}function Cc(){ud.r||qb(ud.c),ud=ud.p}function De(ca,Ja){ca&&ca.i&&(Hb.delete(ca),ca.i(Ja))}function zg(ca,Ja,Va,dc){if(ca&&ca.o){if(Hb.has(ca))return;Hb.add(ca),ud.c.push(()=>{Hb.delete(ca),dc&&(Va&&ca.d(1),dc())}),ca.o(Ja)}}const Nk={duration:0};function Ok(ca,Ja,Va,dc){let Cd=Ja(ca,Va),yc=dc?0:1,E=null,F=null,N=null;function L(){N&&cb(ca,N)}function P(S,ga){const _=S.b-yc;return ga*=Math.abs(_),{a:yc,b:S.b,d:_,duration:ga,start:S.start,end:S.start+ga,group:S.group}}function R(S){const{delay:ga=0,duration:_=300,easing:la=Fa,tick:aa=v,css:ma}=Cd||Nk,Y={start:Ua()+ga,b:S};S||(Y.group=ud,ud.r+=1),E?F=Y:(ma&&(L(),N=Gb(ca,yc,S,_,ga,la,ma)),S&&aa(0,1),E=P(Y,_),C(()=>Yb(ca,S,"start")),$c(qa=>{if(F&&qa>F.start&&(E=P(F,_),F=null,Yb(ca,E.b,"start"),ma&&(L(),N=Gb(ca,yc,E.b,E.duration,0,la,Cd.css))),E){if(qa>=E.end)aa(yc=E.b,1-yc),Yb(ca,E.b,"end"),F||(E.b?L():--E.group.r||qb(E.group.c)),E=null;else if(qa>=E.start){const ba=qa-E.start;yc=E.a+E.d*la(ba/E.duration),aa(yc,1-yc)}}return!(!E&&!F)}))}return{run(S){ha(Cd)?xc().then(()=>{Cd=Cd(),R(S)}):R(S)},end(){L(),E=F=null}}}"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let Pk;function Qk(ca,Ja,Va){const dc=ca.$$.props[Ja];void 0!==dc&&(ca.$$.bound[dc]=Va,Va(ca.$$.ctx[dc]))}function Bj(ca){ca&&ca.c()}function zi(ca,Ja,Va){const{fragment:dc,on_mount:Cd,on_destroy:yc,after_update:E}=ca.$$;dc&&dc.m(Ja,Va),C(()=>{const F=Cd.map(bc).filter(ha);yc?yc.push(...F):qb(F),ca.$$.on_mount=[]}),E.forEach(C)}function ch(ca,Ja){const Va=ca.$$;null!==Va.fragment&&(qb(Va.on_destroy),Va.fragment&&Va.fragment.d(Ja),Va.on_destroy=Va.fragment=null,Va.ctx=[])}function Ag(ca,Ja,Va,dc,Cd,yc,E=[-1]){const F=xg;Be(ca);const N=Ja.props||{},L=ca.$$={fragment:null,ctx:null,props:yc,update:v,not_equal:Cd,bound:cc(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(F?F.$$.context:[]),callbacks:cc(),dirty:E};let P=!1;if(L.ctx=Va?Va(ca,N,(R,S,...ga)=>{const _=ga.length?ga[0]:S;return L.ctx&&Cd(L.ctx[R],L.ctx[R]=_)&&(L.bound[R]&&L.bound[R](_),P&&function(la,aa){-1===la.$$.dirty[0]&&(ne.push(la),y(),la.$$.dirty.fill(0)),la.$$.dirty[aa/31|0]|=1<<aa%31}(ca,R)),S}):[],L.update(),P=!0,qb(L.before_update),L.fragment=!!dc&&dc(L.ctx),Ja.target){if(Ja.hydrate){const R=function(S){return Array.from(S.childNodes)}(Ja.target);L.fragment&&L.fragment.l(R),R.forEach(Yf)}else L.fragment&&L.fragment.c();Ja.intro&&De(ca.$$.fragment),zi(ca,Ja.target,Ja.anchor),T()}Be(F)}"function"==typeof HTMLElement&&(Pk=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const ca in this.$$.slotted)this.appendChild(this.$$.slotted[ca])}attributeChangedCallback(ca,Ja,Va){this[ca]=Va}$destroy(){ch(this,1),this.$destroy=v}$on(ca,Ja){const Va=this.$$.callbacks[ca]||(this.$$.callbacks[ca]=[]);return Va.push(Ja),()=>{const dc=Va.indexOf(Ja);-1!==dc&&Va.splice(dc,1)}}$set(){}});class Rk{$destroy(){ch(this,1),this.$destroy=v}$on(ca,Ja){const Va=this.$$.callbacks[ca]||(this.$$.callbacks[ca]=[]);return Va.push(Ja),()=>{const dc=Va.indexOf(Ja);-1!==dc&&Va.splice(dc,1)}}$set(){}}}).call(this,ya(2))},function(le,_a,ya){"use strict";function Ca(v,Fa,bc){return v(bc={path:Fa,exports:{},require:function(cc,qb){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==qb&&bc.path)}},bc.exports),bc.exports}ya.d(_a,"a",function(){return Ca})},function(le,_a){var ya;ya=function(){return this}();try{ya=ya||new Function("return this")()}catch(Ca){"object"==typeof window&&(ya=window)}le.exports=ya},function(le,_a,ya){"use strict";(function(Ca){var v=ya(1);function Fa(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]])}return c}function bc(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(j){try{i(d.next(j))}catch(k){f(k)}}function h(j){try{i(d.throw(j))}catch(k){f(k)}}function i(j){j.done?e(j.value):function(k){return k instanceof c?k:new c(function(l){l(k)})}(j.value).then(g,h)}i((d=d.apply(a,b||[])).next())})}var cc,qb=(cc=function(a,b){return(cc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var e in d)d.hasOwnProperty(e)&&(c[e]=d[e])})(a,b)},function(a,b){function c(){this.constructor=a}cc(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c())}),ha=Object.prototype.hasOwnProperty;function td(a,b){return ha.call(a,b)}function zb(a){if(Array.isArray(a)){for(var b=new Array(a.length),c=0;c<b.length;c++)b[c]=""+c;return b}if(Object.keys)return Object.keys(a);b=[];for(var d in a)td(a,d)&&b.push(d);return b}function Ua(a){switch(typeof a){case"object":return JSON.parse(JSON.stringify(a));case"undefined":return null;default:return a}}function eb(a){for(var b,c=0,d=a.length;c<d;){if(!((b=a.charCodeAt(c))>=48&&b<=57))return!1;c++}return!0}function Wb(a){return-1===a.indexOf("/")&&-1===a.indexOf("~")?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function ic(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}function $c(a,b){var c=[a];for(var d in b){var e="object"==typeof b[d]?JSON.stringify(b[d],null,2):b[d];void 0!==e&&c.push(d+": "+e)}return c.join(`
`)}var jc=function(a){function b(c,d,e,f,g){var h=this.constructor,i=a.call(this,$c(c,{name:d,index:e,operation:f,tree:g}))||this;return i.name=d,i.index=e,i.operation=f,i.tree=g,Object.setPrototypeOf(i,h.prototype),i.message=$c(c,{name:d,index:e,operation:f,tree:g}),i}return qb(b,a),b}(Error),kc=jc,Yf=Ua,Xe={add:function(a,b,c){return a[b]=this.value,{newDocument:c}},remove:function(a,b,c){var d=a[b];return delete a[b],{newDocument:c,removed:d}},replace:function(a,b,c){var d=a[b];return a[b]=this.value,{newDocument:c,removed:d}},move:function(a,b,c){var d=ae(c,this.path);d&&(d=Ua(d));var e=me(c,{op:"remove",path:this.from}).removed;return me(c,{op:"add",path:this.path,value:e}),{newDocument:c,removed:d}},copy:function(a,b,c){var d=ae(c,this.from);return me(c,{op:"add",path:this.path,value:Ua(d)}),{newDocument:c}},test:function(a,b,c){return{newDocument:c,test:Ye(a[b],this.value)}},_get:function(a,b,c){return this.value=a[b],{newDocument:c}}},vg={add:function(a,b,c){return eb(b)?a.splice(b,0,this.value):a[b]=this.value,{newDocument:c,index:b}},remove:function(a,b,c){return{newDocument:c,removed:a.splice(b,1)[0]}},replace:function(a,b,c){var d=a[b];return a[b]=this.value,{newDocument:c,removed:d}},move:Xe.move,copy:Xe.copy,test:Xe.test,_get:Xe._get};function ae(a,b){if(""==b)return a;var c={op:"_get",path:b};return me(a,c),c.value}function me(a,b,c,d,e,f){if(void 0===c&&(c=!1),void 0===d&&(d=!0),void 0===e&&(e=!0),void 0===f&&(f=0),c&&("function"==typeof c?c(b,0,a,b.path):wg(b,0)),""===b.path){var g={newDocument:a};if("add"===b.op)return g.newDocument=b.value,g;if("replace"===b.op)return g.newDocument=b.value,g.removed=a,g;if("move"===b.op||"copy"===b.op)return g.newDocument=ae(a,b.from),"move"===b.op&&(g.removed=a),g;if("test"===b.op){if(g.test=Ye(a,b.value),!1===g.test)throw new kc("Test operation failed","TEST_OPERATION_FAILED",f,b,a);return g.newDocument=a,g}if("remove"===b.op)return g.removed=a,g.newDocument=null,g;if("_get"===b.op)return b.value=a,g;if(c)throw new kc("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",f,b,a);return g}d||(a=Ua(a));var h=(b.path||"").split("/"),i=a,j=1,k=h.length,l=void 0,m=void 0,n=void 0;for(n="function"==typeof c?c:wg;;){if(m=h[j],e&&"__proto__"==m)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(c&&void 0===l&&(void 0===i[m]?l=h.slice(0,j).join("/"):j==k-1&&(l=b.path),void 0!==l&&n(b,0,a,l)),j++,Array.isArray(i)){if("-"===m)m=i.length;else{if(c&&!eb(m))throw new kc("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",f,b,a);eb(m)&&(m=~~m)}if(j>=k){if(c&&"add"===b.op&&m>i.length)throw new kc("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",f,b,a);if(!1===(g=vg[b.op].call(b,i,m,a)).test)throw new kc("Test operation failed","TEST_OPERATION_FAILED",f,b,a);return g}}else if(m&&-1!=m.indexOf("~")&&(m=ic(m)),j>=k){if(!1===(g=Xe[b.op].call(b,i,m,a)).test)throw new kc("Test operation failed","TEST_OPERATION_FAILED",f,b,a);return g}i=i[m]}}function Zf(a,b,c,d,e){if(void 0===d&&(d=!0),void 0===e&&(e=!0),c&&!Array.isArray(b))throw new kc("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");d||(a=Ua(a));for(var f=new Array(b.length),g=0,h=b.length;g<h;g++)f[g]=me(a,b[g],c,!0,e,g),a=f[g].newDocument;return f.newDocument=a,f}function wg(a,b,c,d){if("object"!=typeof a||null===a||Array.isArray(a))throw new kc("Operation is not an object","OPERATION_NOT_AN_OBJECT",b,a,c);if(!Xe[a.op])throw new kc("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",b,a,c);if("string"!=typeof a.path)throw new kc("Operation `path` property is not a string","OPERATION_PATH_INVALID",b,a,c);if(0!==a.path.indexOf("/")&&a.path.length>0)throw new kc('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",b,a,c);if(("move"===a.op||"copy"===a.op)&&"string"!=typeof a.from)throw new kc("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",b,a,c);if(("add"===a.op||"replace"===a.op||"test"===a.op)&&void 0===a.value)throw new kc("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",b,a,c);if(("add"===a.op||"replace"===a.op||"test"===a.op)&&function h(i){if(void 0===i)return!0;if(i){if(Array.isArray(i)){for(var j=0,k=i.length;j<k;j++)if(h(i[j]))return!0}else if("object"==typeof i){var l=zb(i),m=l.length;for(j=0;j<m;j++)if(h(i[l[j]]))return!0}}return!1}(a.value))throw new kc("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",b,a,c);if(c){if("add"==a.op){var e=a.path.split("/").length,f=d.split("/").length;if(e!==f+1&&e!==f)throw new kc("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",b,a,c)}else if("replace"===a.op||"remove"===a.op||"_get"===a.op){if(a.path!==d)throw new kc("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",b,a,c)}else if("move"===a.op||"copy"===a.op){var g=bh([{op:"_get",path:a.from,value:void 0}],c);if(g&&"OPERATION_PATH_UNRESOLVABLE"===g.name)throw new kc("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",b,a,c)}}}function bh(a,b,c){try{if(!Array.isArray(a))throw new kc("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(b)Zf(Ua(b),Ua(a),c||!0);else{c=c||wg;for(var d=0;d<a.length;d++)c(a[d],d,b,void 0)}}catch(e){if(e instanceof kc)return e;throw e}}function Ye(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){var c,d,e,f=Array.isArray(a),g=Array.isArray(b);if(f&&g){if((d=a.length)!=b.length)return!1;for(c=d;0!=c--;)if(!Ye(a[c],b[c]))return!1;return!0}if(f!=g)return!1;var h=Object.keys(a);if((d=h.length)!==Object.keys(b).length)return!1;for(c=d;0!=c--;)if(!b.hasOwnProperty(h[c]))return!1;for(c=d;0!=c--;)if(!Ye(a[e=h[c]],b[e]))return!1;return!0}return a!=a&&b!=b}var yi=Object.freeze({__proto__:null,JsonPatchError:kc,deepClone:Yf,getValueByPointer:ae,applyOperation:me,applyPatch:Zf,applyReducer:function(a,b,c){var d=me(a,b);if(!1===d.test)throw new kc("Test operation failed","TEST_OPERATION_FAILED",c,b,a);return d.newDocument},validator:wg,validate:bh,_areEquals:Ye}),_f=new WeakMap(),xg=function(a){this.observers=new Map(),this.obj=a},yg=function(a,b){this.callback=a,this.observer=b};function Gb(a,b){void 0===b&&(b=!1);var c=_f.get(a.object);cb(c.value,a.object,a.patches,"",b),a.patches.length&&Zf(c.value,a.patches);var d=a.patches;return d.length>0&&(a.patches=[],a.callback&&a.callback(d)),d}function cb(a,b,c,d,e){if(b!==a){"function"==typeof b.toJSON&&(b=b.toJSON());for(var f=zb(b),g=zb(a),h=!1,i=g.length-1;i>=0;i--){var j=a[l=g[i]];if(!td(b,l)||void 0===b[l]&&void 0!==j&&!1===Array.isArray(b))Array.isArray(a)===Array.isArray(b)?(e&&c.push({op:"test",path:d+"/"+Wb(l),value:Ua(j)}),c.push({op:"remove",path:d+"/"+Wb(l)}),h=!0):(e&&c.push({op:"test",path:d,value:a}),c.push({op:"replace",path:d,value:b}));else{var k=b[l];"object"==typeof j&&null!=j&&"object"==typeof k&&null!=k?cb(j,k,c,d+"/"+Wb(l),e):j!==k&&(e&&c.push({op:"test",path:d+"/"+Wb(l),value:Ua(j)}),c.push({op:"replace",path:d+"/"+Wb(l),value:Ua(k)}))}}if(h||f.length!=g.length)for(i=0;i<f.length;i++){var l;td(a,l=f[i])||void 0===b[l]||c.push({op:"add",path:d+"/"+Wb(l),value:Ua(b[l])})}}}var Be=Object.freeze({__proto__:null,unobserve:function(a,b){b.unobserve()},observe:function(a,b){var c,d=function(h){return _f.get(h)}(a);if(d){var e=function(h,i){return h.observers.get(i)}(d,b);c=e&&e.observer}else d=new xg(a),_f.set(a,d);if(c)return c;if(c={},d.value=Ua(a),b){c.callback=b,c.next=null;var f=function(){Gb(c)},g=function(){clearTimeout(c.next),c.next=setTimeout(f)};"undefined"!=typeof window&&(window.addEventListener("mouseup",g),window.addEventListener("keyup",g),window.addEventListener("mousedown",g),window.addEventListener("keydown",g),window.addEventListener("change",g))}return c.patches=[],c.object=a,c.unobserve=function(){Gb(c),clearTimeout(c.next),function(h,i){h.observers.delete(i.callback)}(d,c),"undefined"!=typeof window&&(window.removeEventListener("mouseup",g),window.removeEventListener("keyup",g),window.removeEventListener("mousedown",g),window.removeEventListener("keydown",g),window.removeEventListener("change",g))},d.observers.set(b,new yg(b,c)),c},generate:Gb,compare:function(a,b,c){void 0===c&&(c=!1);var d=[];return cb(a,b,d,"",c),d}});Object.assign({},yi,Be,{JsonPatchError:jc,deepClone:Ua,escapePathComponent:Wb,unescapePathComponent:ic});var rf=/("(?:[^\\"]|\\.)*")|[:,]/g,uc=function(a,b){var c,d,e;return b=b||{},c=JSON.stringify([1],void 0,void 0===b.indent?2:b.indent).slice(2,-3),d=""===c?1/0:void 0===b.maxLength?80:b.maxLength,e=b.replacer,function f(g,h,i){var j,k,l,m,n,o,p,q,s,r,u,t;if(g&&"function"==typeof g.toJSON&&(g=g.toJSON()),void 0===(u=JSON.stringify(g,e)))return u;if(p=d-h.length-i,u.length<=p&&(s=u.replace(rf,function(w,x){return x||w+" "})).length<=p)return s;if(null!=e&&(g=JSON.parse(u),e=void 0),"object"==typeof g&&null!==g){if(q=h+c,l=[],k=0,Array.isArray(g))for(r="[",j="]",p=g.length;k<p;k++)l.push(f(g[k],q,k===p-1?0:1)||"null");else for(r="{",j="}",p=(o=Object.keys(g)).length;k<p;k++)m=o[k],n=JSON.stringify(m)+": ",void 0!==(t=f(g[m],q,n.length+(k===p-1?0:1)))&&l.push(n+t);if(l.length>0)return[r,c+l.join(`,
`+q),j].join(`
`+h)}return u}(a,"",0)},Cf={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},ne=()=>{},be=Object(v.a)(function(a,b){const{MAX_SAFE_COMPONENT_LENGTH:c}=Cf,d=(b=a.exports={}).re=[],e=b.src=[],f=b.t={};let g=0;const h=(i,j,k)=>{const l=g++;f[i]=l,e[l]=j,d[l]=new RegExp(j,k?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","[0-9]+"),h("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),h("MAINVERSION",`(${e[f.NUMERICIDENTIFIER]})\\.(${e[f.NUMERICIDENTIFIER]})\\.(${e[f.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${e[f.NUMERICIDENTIFIERLOOSE]})\\.(${e[f.NUMERICIDENTIFIERLOOSE]})\\.(${e[f.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${e[f.NUMERICIDENTIFIER]}|${e[f.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${e[f.NUMERICIDENTIFIERLOOSE]}|${e[f.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${e[f.PRERELEASEIDENTIFIER]}(?:\\.${e[f.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${e[f.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${e[f.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER","[0-9A-Za-z-]+"),h("BUILD",`(?:\\+(${e[f.BUILDIDENTIFIER]}(?:\\.${e[f.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${e[f.MAINVERSION]}${e[f.PRERELEASE]}?${e[f.BUILD]}?`),h("FULL",`^${e[f.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${e[f.MAINVERSIONLOOSE]}${e[f.PRERELEASELOOSE]}?${e[f.BUILD]}?`),h("LOOSE",`^${e[f.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",e[f.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),h("XRANGEIDENTIFIER",e[f.NUMERICIDENTIFIER]+"|x|X|\\*"),h("XRANGEPLAIN",`[v=\\s]*(${e[f.XRANGEIDENTIFIER]})(?:\\.(${e[f.XRANGEIDENTIFIER]})(?:\\.(${e[f.XRANGEIDENTIFIER]})(?:${e[f.PRERELEASE]})?${e[f.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${e[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${e[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${e[f.XRANGEIDENTIFIERLOOSE]})(?:${e[f.PRERELEASELOOSE]})?${e[f.BUILD]}?)?)?`),h("XRANGE",`^${e[f.GTLT]}\\s*${e[f.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${e[f.GTLT]}\\s*${e[f.XRANGEPLAINLOOSE]}$`),h("COERCE",`(^|[^\\d])(\\d{1,${c}})(?:\\.(\\d{1,${c}}))?(?:\\.(\\d{1,${c}}))?(?:$|[^\\d])`),h("COERCERTL",e[f.COERCE],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${e[f.LONETILDE]}\\s+`,!0),b.tildeTrimReplace="$1~",h("TILDE",`^${e[f.LONETILDE]}${e[f.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${e[f.LONETILDE]}${e[f.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${e[f.LONECARET]}\\s+`,!0),b.caretTrimReplace="$1^",h("CARET",`^${e[f.LONECARET]}${e[f.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${e[f.LONECARET]}${e[f.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${e[f.GTLT]}\\s*(${e[f.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${e[f.GTLT]}\\s*(${e[f.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${e[f.GTLT]}\\s*(${e[f.LOOSEPLAIN]}|${e[f.XRANGEPLAIN]})`,!0),b.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${e[f.XRANGEPLAIN]})\\s+-\\s+(${e[f.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${e[f.XRANGEPLAINLOOSE]})\\s+-\\s+(${e[f.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0.0.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});const Df=/^[0-9]+$/,Ze=(a,b)=>{const c=Df.test(a),d=Df.test(b);return c&&d&&(a=+a,b=+b),a===b?0:c&&!d?-1:d&&!c?1:a<b?-1:1};var $f={compareIdentifiers:Ze,rcompareIdentifiers:(a,b)=>Ze(b,a)};const{MAX_LENGTH:Ce,MAX_SAFE_INTEGER:y}=Cf,{re:C,t:H}=be,{compareIdentifiers:X}=$f;class W{constructor(a,b){if(b&&"object"==typeof b||(b={loose:!!b,includePrerelease:!1}),a instanceof W){if(a.loose===!!b.loose&&a.includePrerelease===!!b.includePrerelease)return a;a=a.version}else if("string"!=typeof a)throw new TypeError("Invalid Version: "+a);if(a.length>Ce)throw new TypeError(`version is longer than ${Ce} characters`);this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease;const c=a.trim().match(b.loose?C[H.LOOSE]:C[H.FULL]);if(!c)throw new TypeError("Invalid Version: "+a);if(this.raw=a,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>y||this.major<0)throw new TypeError("Invalid major version");if(this.minor>y||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>y||this.patch<0)throw new TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){const e=+d;if(e>=0&&e<y)return e}return d}):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(a){if(ne("SemVer.compare",this.version,this.options),!(a instanceof W)){if("string"==typeof a&&a===this.version)return 0;a=new W(a,this.options)}return a.version===this.version?0:this.compareMain(a)||this.comparePre(a)}compareMain(a){return a instanceof W||(a=new W(a,this.options)),X(this.major,a.major)||X(this.minor,a.minor)||X(this.patch,a.patch)}comparePre(a){if(a instanceof W||(a=new W(a,this.options)),this.prerelease.length&&!a.prerelease.length)return-1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;let b=0;do{const c=this.prerelease[b],d=a.prerelease[b];if(void 0===c&&void 0===d)return 0;if(void 0===d)return 1;if(void 0===c)return-1;if(c!==d)return X(c,d)}while(++b)}compareBuild(a){a instanceof W||(a=new W(a,this.options));let b=0;do{const c=this.build[b],d=a.build[b];if(void 0===c&&void 0===d)return 0;if(void 0===d)return 1;if(void 0===c)return-1;if(c!==d)return X(c,d)}while(++b)}inc(a,b){switch(a){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",b);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",b);break;case"prepatch":this.prerelease.length=0,this.inc("patch",b),this.inc("pre",b);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",b),this.inc("pre",b);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let c=this.prerelease.length;for(;--c>=0;)"number"==typeof this.prerelease[c]&&(this.prerelease[c]++,c=-2);-1===c&&this.prerelease.push(0)}b&&(this.prerelease[0]===b?isNaN(this.prerelease[1])&&(this.prerelease=[b,0]):this.prerelease=[b,0]);break;default:throw new Error("invalid increment argument: "+a)}return this.format(),this.raw=this.version,this}}var T=W;const{MAX_LENGTH:Sa}=Cf,{re:rb,t:xc}=be;var Yb=(a,b)=>{if(b&&"object"==typeof b||(b={loose:!!b,includePrerelease:!1}),a instanceof T)return a;if("string"!=typeof a)return null;if(a.length>Sa)return null;if(!(b.loose?rb[xc.LOOSE]:rb[xc.FULL]).test(a))return null;try{return new T(a,b)}catch(c){return null}},Hb=(a,b)=>{const c=Yb(a,b);return c?c.version:null},ud=(a,b)=>{const c=Yb(a.trim().replace(/^[=v]+/,""),b);return c?c.version:null},_e=(a,b,c,d)=>{"string"==typeof c&&(d=c,c=void 0);try{return new T(a,c).inc(b,d).version}catch(e){return null}},Cc=(a,b,c)=>new T(a,c).compare(new T(b,c)),De=(a,b,c)=>0===Cc(a,b,c),zg=(a,b)=>{if(De(a,b))return null;{const c=Yb(a),d=Yb(b),e=c.prerelease.length||d.prerelease.length,f=e?"pre":"",g=e?"prerelease":"";for(const h in c)if(("major"===h||"minor"===h||"patch"===h)&&c[h]!==d[h])return f+h;return g}},Nk=(a,b)=>new T(a,b).major,Ok=(a,b)=>new T(a,b).minor,Pk=(a,b)=>new T(a,b).patch,Qk=(a,b)=>{const c=Yb(a,b);return c&&c.prerelease.length?c.prerelease:null},Bj=(a,b,c)=>Cc(b,a,c),zi=(a,b)=>Cc(a,b,!0),ch=(a,b,c)=>{const d=new T(a,c),e=new T(b,c);return d.compare(e)||d.compareBuild(e)},Ag=(a,b)=>a.sort((c,d)=>ch(c,d,b)),Rk=(a,b)=>a.sort((c,d)=>ch(d,c,b)),ca=(a,b,c)=>Cc(a,b,c)>0,Ja=(a,b,c)=>Cc(a,b,c)<0,Va=(a,b,c)=>0!==Cc(a,b,c),dc=(a,b,c)=>Cc(a,b,c)>=0,Cd=(a,b,c)=>Cc(a,b,c)<=0,yc=(a,b,c,d)=>{switch(b){case"===":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a===c;case"!==":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a!==c;case"":case"=":case"==":return De(a,c,d);case"!=":return Va(a,c,d);case">":return ca(a,c,d);case">=":return dc(a,c,d);case"<":return Ja(a,c,d);case"<=":return Cd(a,c,d);default:throw new TypeError("Invalid operator: "+b)}};const{re:E,t:F}=be;var N=(a,b)=>{if(a instanceof T)return a;if("number"==typeof a&&(a=String(a)),"string"!=typeof a)return null;let c=null;if((b=b||{}).rtl){let d;for(;(d=E[F.COERCERTL].exec(a))&&(!c||c.index+c[0].length!==a.length);)c&&d.index+d[0].length===c.index+c[0].length||(c=d),E[F.COERCERTL].lastIndex=d.index+d[1].length+d[2].length;E[F.COERCERTL].lastIndex=-1}else c=a.match(E[F.COERCE]);return null===c?null:Yb(`${c[2]}.${c[3]||"0"}.${c[4]||"0"}`,b)};class L{constructor(a,b){if(b&&"object"==typeof b||(b={loose:!!b,includePrerelease:!1}),a instanceof L)return a.loose===!!b.loose&&a.includePrerelease===!!b.includePrerelease?a:new L(a.raw,b);if(a instanceof Db)return this.raw=a.value,this.set=[[a]],this.format(),this;if(this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease,this.raw=a,this.set=a.split(/\s*\|\|\s*/).map(c=>this.parseRange(c.trim())).filter(c=>c.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+a);this.format()}format(){return this.range=this.set.map(a=>a.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(a){const b=this.options.loose;a=a.trim();const c=b?R[S.HYPHENRANGELOOSE]:R[S.HYPHENRANGE];a=(a=a.replace(c,Aa(this.options.includePrerelease))).replace(R[S.COMPARATORTRIM],ga),ne("comparator trim",a,R[S.COMPARATORTRIM]),a=(a=(a=a.replace(R[S.TILDETRIM],_)).replace(R[S.CARETTRIM],la)).split(/\s+/).join(" ");const d=b?R[S.COMPARATORLOOSE]:R[S.COMPARATOR];return a.split(" ").map(e=>ma(e,this.options)).join(" ").split(/\s+/).map(e=>Ib(e,this.options)).filter(this.options.loose?e=>!!e.match(d):()=>!0).map(e=>new Db(e,this.options))}intersects(a,b){if(!(a instanceof L))throw new TypeError("a Range is required");return this.set.some(c=>aa(c,b)&&a.set.some(d=>aa(d,b)&&c.every(e=>d.every(f=>e.intersects(f,b)))))}test(a){if(!a)return!1;if("string"==typeof a)try{a=new T(a,this.options)}catch(b){return!1}for(let b=0;b<this.set.length;b++)if(Ic(this.set[b],a,this.options))return!0;return!1}}var P=L;const{re:R,t:S,comparatorTrimReplace:ga,tildeTrimReplace:_,caretTrimReplace:la}=be,aa=(a,b)=>{let c=!0;const d=a.slice();let e=d.pop();for(;c&&d.length;)c=d.every(f=>e.intersects(f,b)),e=d.pop();return c},ma=(a,b)=>(a=ea(a,b),a=qa(a,b),a=Ta(a,b),a=Nb(a)),Y=a=>!a||"x"===a.toLowerCase()||"*"===a,qa=(a,b)=>a.trim().split(/\s+/).map(c=>ba(c,b)).join(" "),ba=(a,b)=>{const c=b.loose?R[S.TILDELOOSE]:R[S.TILDE];return a.replace(c,(d,e,f,g,h)=>{let i;return i=Y(e)?"":Y(f)?`>=${e}.0.0 <${+e+1}.0.0-0`:Y(g)?`>=${e}.${f}.0 <${e}.${+f+1}.0-0`:h?`>=${e}.${f}.${g}-${h} <${e}.${+f+1}.0-0`:`>=${e}.${f}.${g} <${e}.${+f+1}.0-0`,i})},ea=(a,b)=>a.trim().split(/\s+/).map(c=>ta(c,b)).join(" "),ta=(a,b)=>{const c=b.loose?R[S.CARETLOOSE]:R[S.CARET],d=b.includePrerelease?"-0":"";return a.replace(c,(e,f,g,h,i)=>{let j;return j=Y(f)?"":Y(g)?`>=${f}.0.0${d} <${+f+1}.0.0-0`:Y(h)?"0"===f?`>=${f}.${g}.0${d} <${f}.${+g+1}.0-0`:`>=${f}.${g}.0${d} <${+f+1}.0.0-0`:i?"0"===f?"0"===g?`>=${f}.${g}.${h}-${i} <${f}.${g}.${+h+1}-0`:`>=${f}.${g}.${h}-${i} <${f}.${+g+1}.0-0`:`>=${f}.${g}.${h}-${i} <${+f+1}.0.0-0`:"0"===f?"0"===g?`>=${f}.${g}.${h}${d} <${f}.${g}.${+h+1}-0`:`>=${f}.${g}.${h}${d} <${f}.${+g+1}.0-0`:`>=${f}.${g}.${h} <${+f+1}.0.0-0`,j})},Ta=(a,b)=>a.split(/\s+/).map(c=>fb(c,b)).join(" "),fb=(a,b)=>{a=a.trim();const c=b.loose?R[S.XRANGELOOSE]:R[S.XRANGE];return a.replace(c,(d,e,f,g,h,i)=>{const j=Y(f),k=j||Y(g),l=k||Y(h),m=l;return"="===e&&m&&(e=""),i=b.includePrerelease?"-0":"",j?d=">"===e||"<"===e?"<0.0.0-0":"*":e&&m?(k&&(g=0),h=0,">"===e?(e=">=",k?(f=+f+1,g=0,h=0):(g=+g+1,h=0)):"<="===e&&(e="<",k?f=+f+1:g=+g+1),"<"===e&&(i="-0"),d=`${e+f}.${g}.${h}${i}`):k?d=`>=${f}.0.0${i} <${+f+1}.0.0-0`:l&&(d=`>=${f}.${g}.0${i} <${f}.${+g+1}.0-0`),d})},Nb=(a,b)=>a.trim().replace(R[S.STAR],""),Ib=(a,b)=>a.trim().replace(R[b.includePrerelease?S.GTE0PRE:S.GTE0],""),Aa=a=>(b,c,d,e,f,g,h,i,j,k,l,m,n)=>`${c=Y(d)?"":Y(e)?`>=${d}.0.0${a?"-0":""}`:Y(f)?`>=${d}.${e}.0${a?"-0":""}`:g?">="+c:`>=${c}${a?"-0":""}`} ${i=Y(j)?"":Y(k)?`<${+j+1}.0.0-0`:Y(l)?`<${j}.${+k+1}.0-0`:m?`<=${j}.${k}.${l}-${m}`:a?`<${j}.${k}.${+l+1}-0`:"<="+i}`.trim(),Ic=(a,b,c)=>{for(let d=0;d<a.length;d++)if(!a[d].test(b))return!1;if(b.prerelease.length&&!c.includePrerelease){for(let d=0;d<a.length;d++)if(ne(a[d].semver),a[d].semver!==Db.ANY&&a[d].semver.prerelease.length>0){const e=a[d].semver;if(e.major===b.major&&e.minor===b.minor&&e.patch===b.patch)return!0}return!1}return!0},Ob=Symbol("SemVer ANY");class Jb{static get ANY(){return Ob}constructor(a,b){if(b&&"object"==typeof b||(b={loose:!!b,includePrerelease:!1}),a instanceof Jb){if(a.loose===!!b.loose)return a;a=a.value}this.options=b,this.loose=!!b.loose,this.parse(a),this.semver===Ob?this.value="":this.value=this.operator+this.semver.version}parse(a){const b=this.options.loose?Jc[md.COMPARATORLOOSE]:Jc[md.COMPARATOR],c=a.match(b);if(!c)throw new TypeError("Invalid comparator: "+a);this.operator=void 0!==c[1]?c[1]:"","="===this.operator&&(this.operator=""),c[2]?this.semver=new T(c[2],this.options.loose):this.semver=Ob}toString(){return this.value}test(a){if(ne("Comparator.test",a,this.options.loose),this.semver===Ob||a===Ob)return!0;if("string"==typeof a)try{a=new T(a,this.options)}catch(b){return!1}return yc(a,this.operator,this.semver,this.options)}intersects(a,b){if(!(a instanceof Jb))throw new TypeError("a Comparator is required");if(b&&"object"==typeof b||(b={loose:!!b,includePrerelease:!1}),""===this.operator)return""===this.value||new P(a.value,b).test(this.value);if(""===a.operator)return""===a.value||new P(this.value,b).test(a.semver);const c=!(">="!==this.operator&&">"!==this.operator||">="!==a.operator&&">"!==a.operator),d=!("<="!==this.operator&&"<"!==this.operator||"<="!==a.operator&&"<"!==a.operator),e=this.semver.version===a.semver.version,f=!(">="!==this.operator&&"<="!==this.operator||">="!==a.operator&&"<="!==a.operator),g=yc(this.semver,"<",a.semver,b)&&(">="===this.operator||">"===this.operator)&&("<="===a.operator||"<"===a.operator),h=yc(this.semver,">",a.semver,b)&&("<="===this.operator||"<"===this.operator)&&(">="===a.operator||">"===a.operator);return c||d||e&&f||g||h}}var Db=Jb;const{re:Jc,t:md}=be;var Dc=(a,b,c)=>{try{b=new P(b,c)}catch(d){return!1}return b.test(a)},Ec=(a,b)=>new P(a,b).set.map(c=>c.map(d=>d.value).join(" ").trim().split(" ")),nd=(a,b,c)=>{let d=null,e=null,f=null;try{f=new P(b,c)}catch(g){return null}return a.forEach(g=>{f.test(g)&&(d&&-1!==e.compare(g)||(d=g,e=new T(d,c)))}),d},lc=(a,b,c)=>{let d=null,e=null,f=null;try{f=new P(b,c)}catch(g){return null}return a.forEach(g=>{f.test(g)&&(d&&1!==e.compare(g)||(d=g,e=new T(d,c)))}),d},Ab=(a,b)=>{a=new P(a,b);let c=new T("0.0.0");if(a.test(c))return c;if(c=new T("0.0.0-0"),a.test(c))return c;c=null;for(let d=0;d<a.set.length;++d)a.set[d].forEach(e=>{const f=new T(e.semver.version);switch(e.operator){case">":0===f.prerelease.length?f.patch++:f.prerelease.push(0),f.raw=f.format();case"":case">=":c&&!ca(c,f)||(c=f);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}});return c&&a.test(c)?c:null},ub=(a,b)=>{try{return new P(a,b).range||"*"}catch(c){return null}};const{ANY:Kc}=Db;var cd=(a,b,c,d)=>{let e,f,g,h,i;switch(a=new T(a,d),b=new P(b,d),c){case">":e=ca,f=Cd,g=Ja,h=">",i=">=";break;case"<":e=Ja,f=dc,g=ca,h="<",i="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Dc(a,b,d))return!1;for(let j=0;j<b.set.length;++j){const k=b.set[j];let l=null,m=null;if(k.forEach(n=>{n.semver===Kc&&(n=new Db(">=0.0.0")),l=l||n,m=m||n,e(n.semver,l.semver,d)?l=n:g(n.semver,m.semver,d)&&(m=n)}),l.operator===h||l.operator===i)return!1;if((!m.operator||m.operator===h)&&f(a,m.semver))return!1;if(m.operator===i&&g(a,m.semver))return!1}return!0},Ld=(a,b,c)=>cd(a,b,">",c),Ee=(a,b,c)=>cd(a,b,"<",c),Md=(a,b,c)=>(a=new P(a,c),b=new P(b,c),a.intersects(b));const{ANY:Fe}=Db,sf=(a,b,c)=>{if(1===a.length&&a[0].semver===Fe)return 1===b.length&&b[0].semver===Fe;const d=new Set();let e,f,g,h,i,j,k;for(const l of a)">"===l.operator||">="===l.operator?e=Pc(e,l,c):"<"===l.operator||"<="===l.operator?f=vd(f,l,c):d.add(l.semver);if(d.size>1)return null;if(e&&f){if(g=Cc(e.semver,f.semver,c),g>0)return null;if(0===g&&(">="!==e.operator||"<="!==f.operator))return null}for(const l of d){if(e&&!Dc(l,String(e),c))return null;if(f&&!Dc(l,String(f),c))return null;for(const m of b)if(!Dc(l,String(m),c))return!1;return!0}for(const l of b){if(k=k||">"===l.operator||">="===l.operator,j=j||"<"===l.operator||"<="===l.operator,e){if(">"===l.operator||">="===l.operator){if(h=Pc(e,l,c),h===l)return!1}else if(">="===e.operator&&!Dc(e.semver,String(l),c))return!1}if(f){if("<"===l.operator||"<="===l.operator){if(i=vd(f,l,c),i===l)return!1}else if("<="===f.operator&&!Dc(f.semver,String(l),c))return!1}if(!l.operator&&(f||e)&&0!==g)return!1}return!(e&&j&&!f&&0!==g)&&!(f&&k&&!e&&0!==g)},Pc=(a,b,c)=>{if(!a)return b;const d=Cc(a.semver,b.semver,c);return d>0?a:d<0||">"===b.operator&&">="===a.operator?b:a},vd=(a,b,c)=>{if(!a)return b;const d=Cc(a.semver,b.semver,c);return d<0?a:d>0||"<"===b.operator&&"<="===a.operator?b:a};var ra=(a,b,c)=>{a=new P(a,c),b=new P(b,c);let d=!1;qf:for(const e of a.set){for(const f of b.set){const g=sf(e,f,c);if(d=d||null!==g,g)continue qf}if(d)return!1}return!0},Ya={re:be.re,src:be.src,tokens:be.t,SEMVER_SPEC_VERSION:Cf.SEMVER_SPEC_VERSION,SemVer:T,compareIdentifiers:$f.compareIdentifiers,rcompareIdentifiers:$f.rcompareIdentifiers,parse:Yb,valid:Hb,clean:ud,inc:_e,diff:zg,major:Nk,minor:Ok,patch:Pk,prerelease:Qk,compare:Cc,rcompare:Bj,compareLoose:zi,compareBuild:ch,sort:Ag,rsort:Rk,gt:ca,lt:Ja,eq:De,neq:Va,gte:dc,lte:Cd,cmp:yc,coerce:N,Comparator:Db,Range:P,satisfies:Dc,toComparators:Ec,maxSatisfying:nd,minSatisfying:lc,minVersion:Ab,validRange:ub,outside:cd,gtr:Ld,ltr:Ee,intersects:Md,simplifyRange:(a,b,c)=>{const d=[];let e=null,f=null;const g=a.sort((k,l)=>Cc(k,l,c));for(const k of g)Dc(k,b,c)?(f=k,e||(e=k)):(f&&d.push([e,f]),f=null,e=null);e&&d.push([e,null]);const h=[];for(const[k,l]of d)k===l?h.push(k):l||k!==g[0]?l?k===g[0]?h.push("<="+l):h.push(`${k} - ${l}`):h.push(">="+k):h.push("*");const i=h.join(" || "),j="string"==typeof b.raw?b.raw:String(b);return i.length<j.length?i:b},subset:ra};function Pb(a,b,c){return a.fields=b||[],a.fname=c,a}function ec(a){return null==a?null:a.fields}function M(a){return 1===a.length?G(a[0]):pa(a)}const G=a=>function(b){return b[a]},pa=a=>{const b=a.length;return function(c){for(let d=0;d<b;++d)c=c[a[d]];return c}};function za(a){throw Error(a)}function va(a){var b,c,d,e=[],f=null,g=0,h=a.length,i="";function j(){e.push(i+a.substring(b,c)),i="",b=c+1}for(a+="",b=c=0;c<h;++c)if("\\"===(d=a[c]))i+=a.substring(b,c),i+=a.substring(++c,++c),b=c;else if(d===f)j(),f=null,g=-1;else{if(f)continue;b===g&&'"'===d||b===g&&"'"===d?(b=c+1,f=d):"."!==d||g?"["===d?(c>b&&j(),g=b=c+1):"]"===d&&(g||za("Access path missing open bracket: "+a),g>0&&j(),g=0,b=c+1):c>b?j():b=c+1}return g&&za("Access path missing closing bracket: "+a),f&&za("Access path missing closing quote: "+a),c>b&&(c++,j()),e}function pb(a,b,c){const d=va(a);return a=1===d.length?d[0]:a,Pb((c&&c.get||M)(d),[a],b||a)}var sb=[],bb=pb("id"),$a=Pb(function(a){return a},sb,"identity"),Qb=Pb(function(){return 0},sb,"zero"),Xb=Pb(function(){return 1},sb,"one"),wd=Pb(function(){return!0},sb,"true"),Lc=Pb(function(){return!1},sb,"false");function qc(a,b,c){var d=[b].concat([].slice.call(c));console[a].apply(console,d)}var kb=Array.isArray;function gc(a){return a===Object(a)}const Rb=a=>"__proto__"!==a;function mc(a,b,c,d){var e,f;if(Rb(b))if(gc(c)&&!kb(c))for(e in(f=gc(a[b])?a[b]:a[b]={},c))d&&(!0===d||d[e])?mc(f,e,c[e]):Rb(e)&&(f[e]=c[e]);else a[b]=c}function dd(a,b){if(null==a)return b;const c={},d=[];function e(f){c[f.name]||(c[f.name]=1,d.push(f))}return b.forEach(e),a.forEach(e),d}function Uc(a){return a[a.length-1]}function od(a){return null==a||""===a?null:+a}function vc(a){return function(b){return a*Math.exp(b)}}function xd(a){return function(b){return Math.log(a*b)}}function Kb(a){return function(b){return Math.sign(b)*Math.log1p(Math.abs(b/a))}}function Fc(a){return function(b){return Math.sign(b)*Math.expm1(Math.abs(b))*a}}function oe(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function ob(a,b,c,d){var e=c(a[0]),f=c(Uc(a)),g=(f-e)*b;return[d(e-g),d(f-g)]}function hc(a,b,c,d,e){var f=d(a[0]),g=d(Uc(a)),h=null!=b?d(b):(f+g)/2;return[e(h+(f-h)*c),e(h+(g-h)*c)]}function Oa(a){return null!=a?kb(a)?a:[a]:[]}function da(a){return"function"==typeof a}const lb=(a,b)=>(a<b||null==a)&&null!=b?-1:(a>b||null==b)&&null!=a?1:(b=b instanceof Date?+b:b,(a=a instanceof Date?+a:a)!==a&&b==b?-1:b!=b&&a==a?1:0),ua=(a,b)=>1===a.length?zc(a[0],b[0]):vb(a,b,a.length),zc=(a,b)=>function(c,d){return lb(a(c),a(d))*b},vb=(a,b,c)=>(b.push(0),function(d,e){let f,g=0,h=-1;for(;0===g&&++h<c;)f=a[h],g=lb(f(d),f(e));return g*b[h]});function Vc(a){for(var b,c,d=1,e=arguments.length;d<e;++d)for(c in b=arguments[d])a[c]=b[c];return a}const Wc=Object.prototype.hasOwnProperty;function Bb(a,b){return Wc.call(a,b)}var Mc={};function Sb(a){return"[object Date]"===Object.prototype.toString.call(a)}function Dd(a){return"number"==typeof a}function ad(a){return"string"==typeof a}function Qc(a,b){for(var c="";--b>=0;)c+=a;return c}function pd(a){return Dd(a)||Sb(a)?a:Date.parse(a)}function Zb(a,b,c){return a.fields=b||[],a.fname=c,a}function gb(a){return null==a?null:a.fname}function ed(a){return null==a?null:a.fields}function nc(a){return 1===a.length?Ih(a[0]):Jh(a)}const Ih=a=>function(b){return b[a]},Jh=a=>{const b=a.length;return function(c){for(let d=0;d<b;++d)c=c[a[d]];return c}};function ja(a){throw Error(a)}function $e(a){var b,c,d,e=[],f=null,g=0,h=a.length,i="";function j(){e.push(i+a.substring(b,c)),i="",b=c+1}for(a+="",b=c=0;c<h;++c)if("\\"===(d=a[c]))i+=a.substring(b,c),i+=a.substring(++c,++c),b=c;else if(d===f)j(),f=null,g=-1;else{if(f)continue;b===g&&'"'===d||b===g&&"'"===d?(b=c+1,f=d):"."!==d||g?"["===d?(c>b&&j(),g=b=c+1):"]"===d&&(g||ja("Access path missing open bracket: "+a),g>0&&j(),g=0,b=c+1):c>b?j():b=c+1}return g&&ja("Access path missing closing bracket: "+a),f&&ja("Access path missing closing quote: "+a),c>b&&(c++,j()),e}function ce(a,b,c){const d=$e(a);return a=1===d.length?d[0]:a,Zb((c&&c.get||nc)(d),[a],b||a)}var Hd=[],yb=ce("id"),fc=Zb(function(a){return a},Hd,"identity"),pe=Zb(function(){return 0},Hd,"zero"),Ef=Zb(function(){return 1},Hd,"one"),de=Zb(function(){return!0},Hd,"true"),Z=Zb(function(){return!1},Hd,"false");function fa(a,b,c){var d=[b].concat([].slice.call(c));console[a].apply(console,d)}function sa(a,b){var c=a||0;return{level:function(d){return arguments.length?(c=+d,this):c},error:function(){return c>=1&&fa(b||"error","ERROR",arguments),this},warn:function(){return c>=2&&fa(b||"warn","WARN",arguments),this},info:function(){return c>=3&&fa(b||"log","INFO",arguments),this},debug:function(){return c>=4&&fa(b||"log","DEBUG",arguments),this}}}var U=Array.isArray;function ka(a){return a===Object(a)}const Na=a=>"__proto__"!==a;function Wa(...a){return a.reduce((b,c)=>{for(var d in c)if("signals"===d)b.signals=Tb(b.signals,c.signals);else{var e="legend"===d?{layout:1}:"style"===d||null;Lb(b,d,c[d],e)}return b},{})}function Lb(a,b,c,d){var e,f;if(Na(b))if(ka(c)&&!U(c))for(e in(f=ka(a[b])?a[b]:a[b]={},c))d&&(!0===d||d[e])?Lb(f,e,c[e]):Na(e)&&(f[e]=c[e]);else a[b]=c}function Tb(a,b){if(null==a)return b;const c={},d=[];function e(f){c[f.name]||(c[f.name]=1,d.push(f))}return b.forEach(e),a.forEach(e),d}function Ha(a){return a[a.length-1]}function Eb(a){return null==a||""===a?null:+a}function qd(a){return function(b){return a*Math.exp(b)}}function rc(a){return function(b){return Math.log(a*b)}}function Id(a){return function(b){return Math.sign(b)*Math.log1p(Math.abs(b/a))}}function Bg(a){return function(b){return Math.sign(b)*Math.expm1(Math.abs(b))*a}}function qe(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function Ge(a,b,c,d){var e=c(a[0]),f=c(Ha(a)),g=(f-e)*b;return[d(e-g),d(f-g)]}function re(a,b,c,d,e){var f=d(a[0]),g=d(Ha(a)),h=null!=b?d(b):(f+g)/2;return[e(h+(f-h)*c),e(h+(g-h)*c)]}function He(a,b,c){return re(a,b,c,Eb,fc)}function Ie(a,b,c){var d=Math.sign(a[0]);return re(a,b,c,rc(d),qd(d))}function Xc(a,b,c,d){return re(a,b,c,qe(d),qe(1/d))}function Ai(a,b,c,d){return re(a,b,c,Id(d),Bg(d))}function Ra(a){return null!=a?U(a)?a:[a]:[]}function Ub(a){return"function"==typeof a}function Sk(a,b,c){c=c||{},b=Ra(b)||[];const d=[],e=[],f={},g=c.comparator||Xm;return Ra(a).forEach((h,i)=>{null!=h&&(d.push("descending"===b[i]?-1:1),e.push(h=Ub(h)?h:ce(h,null,c)),(ed(h)||[]).forEach(j=>f[j]=1))}),0===e.length?null:Zb(g(e,d),Object.keys(f))}const Cj=(a,b)=>(a<b||null==a)&&null!=b?-1:(a>b||null==b)&&null!=a?1:(b=b instanceof Date?+b:b,(a=a instanceof Date?+a:a)!==a&&b==b?-1:b!=b&&a==a?1:0),Xm=(a,b)=>1===a.length?Ym(a[0],b[0]):Zm(a,b,a.length),Ym=(a,b)=>function(c,d){return Cj(a(c),a(d))*b},Zm=(a,b,c)=>(b.push(0),function(d,e){let f,g=0,h=-1;for(;0===g&&++h<c;)f=a[h],g=Cj(f(d),f(e));return g*b[h]});function Nd(a){return Ub(a)?a:function(){return a}}function Kh(a,b){var c,d;function e(){b(d),c=d=null}return function(f){d=f,c&&clearTimeout(c),c=setTimeout(e,a)}}function Mb(a){for(var b,c,d=1,e=arguments.length;d<e;++d)for(c in b=arguments[d])a[c]=b[c];return a}function dh(a,b){var c,d,e,f,g=0;if(a&&(c=a.length))if(null==b){for(d=a[g];g<c&&(null==d||d!=d);d=a[++g]);for(e=f=d;g<c;++g)null!=(d=a[g])&&(d<e&&(e=d),d>f&&(f=d))}else{for(d=b(a[g]);g<c&&(null==d||d!=d);d=b(a[++g]));for(e=f=d;g<c;++g)null!=(d=b(a[g]))&&(d<e&&(e=d),d>f&&(f=d))}return[e,f]}const gM=Object.prototype.hasOwnProperty;function db(a,b){return gM.call(a,b)}var _m={};function Tk(a){var b,c,d={};function e(f){return db(d,f)&&d[f]!==_m}return b={size:0,empty:0,object:d,has:e,get:function(f){return e(f)?d[f]:void 0},set:function(f,g){return e(f)||(++b.size,d[f]===_m&&--b.empty),d[f]=g,this},delete:function(f){return e(f)&&(--b.size,++b.empty,d[f]=_m),this},clear:function(){b.size=b.empty=0,b.object=d={}},test:function(f){return arguments.length?(c=f,b):c},clean:function(){var f,g,h={},i=0;for(f in d)(g=d[f])===_m||c&&c(g)||(h[f]=g,++i);b.size=i,b.empty=0,b.object=d=h}},a&&Object.keys(a).forEach(function(f){b.set(f,a[f])}),b}function Da(a,b){var c=a.prototype=Object.create(b.prototype);return c.constructor=a,c}function Uk(a,b,c,d){var e,f=b[0],g=b[b.length-1];return f>g&&(e=f,f=g,g=e),d=void 0===d||d,((c=void 0===c||c)?f<=a:f<a)&&(d?a<=g:a<g)}function Bi(a){return"boolean"==typeof a}function Ci(a){return"[object Date]"===Object.prototype.toString.call(a)}function Yc(a){return"number"==typeof a}function Xa(a){return"string"==typeof a}function zy(a,b,c){a&&(a=b?Ra(a).map(h=>h.replace(/\\(.)/g,"$1")):Ra(a));const d=a&&a.length,e=c&&c.get||nc,f=h=>e(b?[h]:$e(h));let g;if(d)if(1===d){const h=f(a[0]);g=function(i){return""+h(i)}}else{const h=a.map(f);g=function(i){let j=""+h[0](i),k=0;for(;++k<d;)j+="|"+h[k](i);return j}}else g=function(){return""};return Zb(g,a,"key")}function $m(a,b){for(var c="";--b>=0;)c+=a;return c}function an(a){return a&&Ha(a)-a[0]||0}function Ga(a){return U(a)?"["+a.map(Ga)+"]":ka(a)||Xa(a)?JSON.stringify(a).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):a}function Ay(a){return null==a||""===a?null:!(!a||"false"===a||"0"===a)&&!!a}function hM(a){return Yc(a)||Ci(a)?a:Date.parse(a)}function By(a,b){return b=b||hM,null==a||""===a?null:b(a)}function Cy(a){return null==a||""===a?null:a+""}function ee(a){for(var b={},c=0,d=a.length;c<d;++c)b[a[c]]=!0;return b}function Dj(a,b,c){if(a){var d,e=0,f=a.length;if(b)for(;e<f;++e)(d=b(a[e]))&&c(d,e,a);else a.forEach(c)}}function bn(a){var b=a||fc,c=[],d={};return c.add=function(e){var f=b(e);return d[f]||(d[f]=1,c.push(e)),c},c.remove=function(e){var f,g=b(e);return d[g]&&(d[g]=0,(f=c.indexOf(e))>=0&&c.splice(f,1)),c},c}async function cn(a,b){try{await b(a)}catch(c){a.error(c)}}var Dy=Symbol("vega_id"),iM=1;function dn(a){return!(!a||!hb(a))}function hb(a){return a[Dy]}function Ey(a,b){return a[Dy]=b,a}function Ac(a){var b=a===Object(a)?a:{data:a};return hb(b)?b:Ey(b,iM++)}function Xq(a){return Yq(a,Ac({}))}function Yq(a,b){for(var c in a)b[c]=a[c];return b}function Fy(a,b){return Ey(b,hb(a))}function Di(a,b){return a?b?(c,d)=>a(c,d)||hb(b(c))-hb(b(d)):(c,d)=>a(c,d)||hb(c)-hb(d):null}function Gy(a){return a&&a.constructor===Ei}function Ei(){var a=[],b=[],c=[],d=[],e=[],f=null,g=!1;return{constructor:Ei,insert:function(h){for(var i=Ra(h),j=0,k=i.length;j<k;++j)a.push(i[j]);return this},remove:function(h){for(var i=Ub(h)?d:b,j=Ra(h),k=0,l=j.length;k<l;++k)i.push(j[k]);return this},modify:function(h,i,j){var k={field:i,value:Nd(j)};return Ub(h)?(k.filter=h,e.push(k)):(k.tuple=h,c.push(k)),this},encode:function(h,i){return Ub(h)?e.push({filter:h,field:i}):c.push({tuple:h,field:i}),this},clean:function(h){return f=h,this},reflow:function(){return g=!0,this},pulse:function(h,i){var j,k,l,m,n,o,p={},q={};for(j=0,k=i.length;j<k;++j)p[hb(i[j])]=1;for(j=0,k=b.length;j<k;++j)p[hb(n=b[j])]=-1;for(j=0,k=d.length;j<k;++j)m=d[j],i.forEach(function(r){m(r)&&(p[hb(r)]=-1)});for(j=0,k=a.length;j<k;++j)o=hb(n=a[j]),p[o]?p[o]=1:h.add.push(Ac(a[j]));for(j=0,k=i.length;j<k;++j)n=i[j],p[hb(n)]<0&&h.rem.push(n);function s(r,u,t){t?r[u]=t(r):h.encode=u,g||(q[hb(r)]=r)}for(j=0,k=c.length;j<k;++j)n=(l=c[j]).tuple,m=l.field,(o=p[hb(n)])>0&&(s(n,m,l.value),h.modifies(m));for(j=0,k=e.length;j<k;++j)l=e[j],m=l.filter,i.forEach(function(r){m(r)&&p[hb(r)]>0&&s(r,l.field,l.value)}),h.modifies(l.field);if(g)h.mod=b.length||d.length?i.filter(function(r){return p[hb(r)]>0}):i.slice();else for(o in q)h.mod.push(q[o]);return(f||null==f&&(b.length||d.length))&&h.clean(!0),h}}}var en="_:mod:_";function fn(){Object.defineProperty(this,en,{writable:!0,value:{}})}var Zq=fn.prototype;Zq.set=function(a,b,c,d){var e=this,f=e[a],g=e[en];return null!=b&&b>=0?(f[b]!==c||d)&&(f[b]=c,g[b+":"+a]=-1,g[a]=-1):(f!==c||d)&&(e[a]=c,g[a]=U(c)?1+c.length:-1),e},Zq.modified=function(a,b){var c,d=this[en];if(!arguments.length){for(c in d)if(d[c])return!0;return!1}if(U(a)){for(c=0;c<a.length;++c)if(d[a[c]])return!0;return!1}return null!=b&&b>=0?b+1<d[a]||!!d[b+":"+a]:!!d[a]},Zq.clear=function(){return this[en]={},this};var jM=0,kM=new fn();function Zc(a,b,c,d){this.id=++jM,this.value=a,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,b&&(this._update=b),c&&this.parameters(c,d)}var eh=Zc.prototype;function Hy(a){return function(b){var c=this.flags;return 0===arguments.length?!!(c&a):(this.flags=b?c|a:c&~a,this)}}eh.targets=function(){return this._targets||(this._targets=bn(yb))},eh.set=function(a){return this.value!==a?(this.value=a,1):0},eh.skip=Hy(1),eh.modified=Hy(2),eh.parameters=function(a,b,c){b=!1!==b;var d,e,f,g,h=this,i=h._argval=h._argval||new fn(),j=h._argops=h._argops||[],k=[];function l(m,n,o){o instanceof Zc?(o!==h&&(b&&o.targets().add(h),k.push(o)),j.push({op:o,name:m,index:n})):i.set(m,n,o)}for(d in a)if(e=a[d],"pulse"===d)Ra(e).forEach(function(m){m instanceof Zc?m!==h&&(m.targets().add(h),k.push(m)):ja("Pulse parameters must be operator instances.")}),h.source=e;else if(U(e))for(i.set(d,-1,Array(f=e.length)),g=0;g<f;++g)l(d,g,e[g]);else l(d,-1,e);return this.marshall().clear(),c&&(j.initonly=!0),k},eh.marshall=function(a){var b,c,d,e,f,g=this._argval||kM,h=this._argops;if(h){for(c=0,d=h.length;c<d;++c)f=(e=(b=h[c]).op).modified()&&e.stamp===a,g.set(b.name,b.index,e.value,f);if(h.initonly){for(c=0;c<d;++c)(b=h[c]).op.targets().remove(this);this._argops=null,this._update=null}}return g},eh.detach=function(){var a,b,c,d=this._argops;if(d)for(a=0,b=d.length;a<b;++a)(c=d[a].op)._targets&&c._targets.remove(this)},eh.evaluate=function(a){var b=this._update;if(b){var c=this.marshall(a.stamp),d=b.call(this,c,a);if(c.clear(),d!==this.value)this.value=d;else if(!this.modified())return a.StopPropagation}},eh.run=function(a){return a.stamp<this.stamp?a.StopPropagation:(this.skip()?(this.skip(!1),b=0):b=this.evaluate(a),this.pulse=b||a);var b};var lM=0;function gn(a,b,c){this.id=++lM,this.value=null,c&&(this.receive=c),a&&(this._filter=a),b&&(this._apply=b)}function Lh(a,b,c){return new gn(a,b,c)}var ag=gn.prototype;ag._filter=de,ag._apply=fc,ag.targets=function(){return this._targets||(this._targets=bn(yb))},ag.consume=function(a){return arguments.length?(this._consume=!!a,this):!!this._consume},ag.receive=function(a){if(this._filter(a)){for(var b=this.value=this._apply(a),c=this._targets,d=c?c.length:0,e=0;e<d;++e)c[e].receive(b);this._consume&&(a.preventDefault(),a.stopPropagation())}},ag.filter=function(a){var b=Lh(a);return this.targets().add(b),b},ag.apply=function(a){var b=Lh(null,a);return this.targets().add(b),b},ag.merge=function(){var a=Lh();this.targets().add(a);for(var b=0,c=arguments.length;b<c;++b)arguments[b].targets().add(a);return a},ag.throttle=function(a){var b=-1;return this.filter(function(){var c=Date.now();return c-b>a?(b=c,1):0})},ag.debounce=function(a){var b=Lh();return this.targets().add(Lh(null,null,Kh(a,function(c){var d=c.dataflow;b.receive(c),d&&d.run&&d.run()}))),b},ag.between=function(a,b){var c=!1;return a.targets().add(Lh(null,null,function(){c=!0})),b.targets().add(Lh(null,null,function(){c=!1})),this.filter(function(){return c})};const mM=/^([A-Za-z]+:)?\/\//,nM=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,oM=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function pM(a,b){const c=await this.sanitize(a,b),d=c.href;return c.localFile?this.file(d):this.http(d,b)}async function qM(a,b){b=Mb({},this.options,b);const c=this.fileAccess,d={href:null};let e,f,g;const h=nM.test(a.replace(oM,""));null!=a&&"string"==typeof a&&h||ja("Sanitize failure, invalid URI: "+Ga(a));const i=mM.test(a);return(g=b.baseURL)&&!i&&(a.startsWith("/")||"/"===g[g.length-1]||(a="/"+a),a=g+a),f=(e=a.startsWith("file://"))||"file"===b.mode||"http"!==b.mode&&!i&&c,e?a=a.slice("file://".length):a.startsWith("//")&&("file"===b.defaultProtocol?(a=a.slice(2),f=!0):a=(b.defaultProtocol||"http")+":"+a),Object.defineProperty(d,"localFile",{value:!!f}),d.href=a,b.target&&(d.target=b.target+""),b.rel&&(d.rel=b.rel+""),"image"===b.context&&b.crossOrigin&&(d.crossOrigin=b.crossOrigin+""),d}function rM(a){return a?function(b){return new Promise(function(c,d){a.readFile(b,function(e,f){e?d(e):c(f)})})}:sM}async function sM(){ja("No file system access.")}function tM(a){return a?async function(b,c){const d=Mb({},this.options.http,c),e=c&&c.response,f=await a(b,d);return f.ok?Ub(f[e])?f[e]():f.text():ja(f.status+""+f.statusText)}:uM}async function uM(){ja("No HTTP fetch method available.")}var _q={boolean:Ay,integer:Eb,number:Eb,date:By,string:Cy,unknown:fc},hn=[function(a){return"true"===a||"false"===a||!0===a||!1===a},function(a){return Ky(a)&&Number.isInteger(+a)},Ky,function(a){return!Number.isNaN(Date.parse(a))}],vM=["boolean","integer","number","date"];function Iy(a,b){if(!a||!a.length)return"unknown";const c=a.length,d=hn.length,e=hn.map((g,h)=>h+1);for(let g,h,i=0,j=0;i<c;++i)for(h=b?a[i][b]:a[i],g=0;g<d;++g)if(e[g]&&(null!=(f=h)&&f==f)&&!hn[g](h)&&(e[g]=0,++j,j===hn.length))return"string";var f;return vM[e.reduce((g,h)=>0===g?h:g,0)-1]}function Jy(a,b){return b.reduce(function(c,d){return c[d]=Iy(a,d),c},{})}function Ky(a){return!(Number.isNaN(+a)||a instanceof Date)}var Ly={},$q={};function My(a){return new Function("d","return {"+a.map(function(b,c){return JSON.stringify(b)+": d["+c+'] || ""'}).join(",")+"}")}function Ny(a){var b=Object.create(null),c=[];return a.forEach(function(d){for(var e in d)e in b||c.push(b[e]=e)}),c}function af(a,b){var c=a+"",d=c.length;return d<b?new Array(b-d+1).join(0)+c:c}function wM(a){var b=a.getUTCHours(),c=a.getUTCMinutes(),d=a.getUTCSeconds(),e=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":function(f){return f<0?"-"+af(-f,6):f>9999?"+"+af(f,6):af(f,4)}(a.getUTCFullYear())+"-"+af(a.getUTCMonth()+1,2)+"-"+af(a.getUTCDate(),2)+(e?"T"+af(b,2)+":"+af(c,2)+":"+af(d,2)+"."+af(e,3)+"Z":d?"T"+af(b,2)+":"+af(c,2)+":"+af(d,2)+"Z":c||b?"T"+af(b,2)+":"+af(c,2)+"Z":"")}function xM(a){var b=new RegExp('["'+a+`
\r]`),c=a.charCodeAt(0);function d(h,i){var j,k=[],l=h.length,m=0,n=0,o=l<=0,p=!1;function q(){if(o)return $q;if(p)return p=!1,Ly;var r,u,t=m;if(34===h.charCodeAt(t)){for(;m++<l&&34!==h.charCodeAt(m)||34===h.charCodeAt(++m););return(r=m)>=l?o=!0:10===(u=h.charCodeAt(m++))?p=!0:13===u&&(p=!0,10===h.charCodeAt(m)&&++m),h.slice(t+1,r-1).replace(/""/g,'"')}for(;m<l;){if(10===(u=h.charCodeAt(r=m++)))p=!0;else if(13===u)p=!0,10===h.charCodeAt(m)&&++m;else if(u!==c)continue;return h.slice(t,r)}return o=!0,h.slice(t,l)}for(10===h.charCodeAt(l-1)&&--l,13===h.charCodeAt(l-1)&&--l;(j=q())!==$q;){for(var s=[];j!==Ly&&j!==$q;)s.push(j),j=q();i&&null==(s=i(s,n++))||k.push(s)}return k}function e(h,i){return h.map(function(j){return i.map(function(k){return g(j[k])}).join(a)})}function f(h){return h.map(g).join(a)}function g(h){return null==h?"":h instanceof Date?wM(h):b.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:function(h,i){var j,k,l=d(h,function(m,n){if(j)return j(m,n-1);k=m,j=i?function(o,p){var q=My(o);return function(s,r){return p(q(s),r,o)}}(m,i):My(m)});return l.columns=k||[],l},parseRows:d,format:function(h,i){return null==i&&(i=Ny(h)),[i.map(g).join(a)].concat(e(h,i)).join(`
`)},formatBody:function(h,i){return null==i&&(i=Ny(h)),e(h,i).join(`
`)},formatRows:function(h){return h.map(f).join(`
`)},formatRow:f,formatValue:g}}function Oy(a){const b=function(c,d){const e={delimiter:a};return ar(c,d?Mb(d,e):e)};return b.responseType="text",b}function ar(a,b){return b.header&&(a=b.header.map(Ga).join(b.delimiter)+`
`+a),xM(b.delimiter).parse(a+"")}function br(a,b){const c=b&&b.property?ce(b.property):fc;return!ka(a)||(d=a,"function"==typeof Ca&&Ub(Ca.isBuffer)&&Ca.isBuffer(d))?c(JSON.parse(a)):function(e,f){return f&&f.copy?JSON.parse(JSON.stringify(e)):e}(c(a));var d}function yM(a){return a}function zM(a,b){return"string"==typeof b&&(b=a.objects[b]),"GeometryCollection"===b.type?{type:"FeatureCollection",features:b.geometries.map(function(c){return Py(a,c)})}:Py(a,b)}function Py(a,b){var c=b.id,d=b.bbox,e=null==b.properties?{}:b.properties,f=Qy(a,b);return null==c&&null==d?{type:"Feature",properties:e,geometry:f}:null==d?{type:"Feature",id:c,properties:e,geometry:f}:{type:"Feature",id:c,bbox:d,properties:e,geometry:f}}function Qy(a,b){var c=function(j){if(null==j)return yM;var k,l,m=j.scale[0],n=j.scale[1],o=j.translate[0],p=j.translate[1];return function(q,s){s||(k=l=0);var r=2,u=q.length,t=new Array(u);for(t[0]=(k+=q[0])*m+o,t[1]=(l+=q[1])*n+p;r<u;)t[r]=q[r],++r;return t}}(a.transform),d=a.arcs;function e(j,k){k.length&&k.pop();for(var l=d[j<0?~j:j],m=0,n=l.length;m<n;++m)k.push(c(l[m],m));j<0&&function(o,p){for(var q,s=o.length,r=s-p;r<--s;)q=o[r],o[r++]=o[s],o[s]=q}(k,n)}function f(j){return c(j)}function g(j){for(var k=[],l=0,m=j.length;l<m;++l)e(j[l],k);return k.length<2&&k.push(k[0]),k}function h(j){for(var k=g(j);k.length<4;)k.push(k[0]);return k}function i(j){return j.map(h)}return function j(k){var l,m=k.type;switch(m){case"GeometryCollection":return{type:m,geometries:k.geometries.map(j)};case"Point":l=f(k.coordinates);break;case"MultiPoint":l=k.coordinates.map(f);break;case"LineString":l=g(k.arcs);break;case"MultiLineString":l=k.arcs.map(g);break;case"Polygon":l=i(k.arcs);break;case"MultiPolygon":l=k.arcs.map(i);break;default:return null}return{type:m,coordinates:l}}(b)}function AM(a,b){var c={},d={},e={},f=[],g=-1;function h(i,j){for(var k in i){var l=i[k];delete j[l.start],delete l.start,delete l.end,l.forEach(function(m){c[m<0?~m:m]=1}),f.push(l)}}return b.forEach(function(i,j){var k,l=a.arcs[i<0?~i:i];l.length<3&&!l[1][0]&&!l[1][1]&&(k=b[++g],b[g]=i,b[j]=k)}),b.forEach(function(i){var j,k,l=function(q){var s,r=a.arcs[q<0?~q:q],u=r[0];return a.transform?(s=[0,0],r.forEach(function(t){s[0]+=t[0],s[1]+=t[1]})):s=r[r.length-1],q<0?[s,u]:[u,s]}(i),m=l[0],n=l[1];if(j=e[m])if(delete e[j.end],j.push(i),j.end=n,k=d[n]){delete d[k.start];var o=k===j?j:j.concat(k);d[o.start=j.start]=e[o.end=k.end]=o}else d[j.start]=e[j.end]=j;else if(j=d[n])if(delete d[j.start],j.unshift(i),j.start=m,k=e[m]){delete e[k.end];var p=k===j?j:k.concat(j);d[p.start=k.start]=e[p.end=j.end]=p}else d[j.start]=e[j.end]=j;else d[(j=[i]).start=m]=e[j.end=n]=j}),h(e,d),h(d,e),b.forEach(function(i){c[i<0?~i:i]||f.push([i])}),f}function BM(a){return Qy(a,CM.apply(this,arguments))}function CM(a,b,c){var d,e,f;if(arguments.length>1)d=DM(a,b,c);else for(e=0,d=new Array(f=a.arcs.length);e<f;++e)d[e]=e;return{type:"MultiLineString",arcs:AM(a,d)}}function DM(a,b,c){var d,e=[],f=[];function g(j){var k=j<0?~j:j;(f[k]||(f[k]=[])).push({i:j,g:d})}function h(j){j.forEach(g)}function i(j){j.forEach(h)}return function j(k){switch(d=k,k.type){case"GeometryCollection":k.geometries.forEach(j);break;case"LineString":h(k.arcs);break;case"MultiLineString":case"Polygon":i(k.arcs);break;case"MultiPolygon":!function(l){l.forEach(i)}(k.arcs)}}(b),f.forEach(null==c?function(j){e.push(j[0].i)}:function(j){c(j[0].g,j[j.length-1].g)&&e.push(j[0].i)}),e}ar.responseType="text",br.responseType="json";const EM={interior:(a,b)=>a!==b,exterior:(a,b)=>a===b};function Ry(a,b){let c,d,e,f;return a=br(a,b),b&&b.feature?(c=zM,e=b.feature):b&&b.mesh?(c=BM,e=b.mesh,f=EM[b.filter]):ja("Missing TopoJSON feature or mesh parameter."),d=(d=a.objects[e])?c(a,d,f):ja("Invalid TopoJSON object: "+e),d&&d.features||[d]}Ry.responseType="json";const jn={dsv:ar,csv:Oy(","),tsv:Oy("	"),json:br,topojson:Ry};function cr(a,b){return arguments.length>1?(jn[a]=b,this):db(jn,a)?jn[a]:null}function Sy(a){const b=cr(a);return b&&b.responseType||"text"}function Vk(a){const b={};return c=>b[c]||(b[c]=a(c))}function Ej(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function kn(a){var b;return 1===a.length&&(b=a,a=function(c,d){return Ej(b(c),d)}),{left:function(c,d,e,f){for(null==e&&(e=0),null==f&&(f=c.length);e<f;){var g=e+f>>>1;a(c[g],d)<0?e=g+1:f=g}return e},right:function(c,d,e,f){for(null==e&&(e=0),null==f&&(f=c.length);e<f;){var g=e+f>>>1;a(c[g],d)>0?f=g:e=g+1}return e}}}var Ty=kn(Ej),Mh=Ty.right,FM=Ty.left;function Fi(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):e<3?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f}var dr=Math.sqrt(50),er=Math.sqrt(10),fr=Math.sqrt(2);function gr(a,b,c){var d,e,f,g,h=-1;if(c=+c,(a=+a)===(b=+b)&&c>0)return[a];if((d=b<a)&&(e=a,a=b,b=e),0===(g=ln(a,b,c))||!isFinite(g))return[];if(g>0)for(a=Math.ceil(a/g),b=Math.floor(b/g),f=new Array(e=Math.ceil(b-a+1));++h<e;)f[h]=(a+h)*g;else for(a=Math.floor(a*g),b=Math.ceil(b*g),f=new Array(e=Math.ceil(a-b+1));++h<e;)f[h]=(a-h)/g;return d&&f.reverse(),f}function ln(a,b,c){var d=(b-a)/Math.max(0,c),e=Math.floor(Math.log(d)/Math.LN10),f=d/Math.pow(10,e);return e>=0?(f>=dr?10:f>=er?5:f>=fr?2:1)*Math.pow(10,e):-Math.pow(10,-e)/(f>=dr?10:f>=er?5:f>=fr?2:1)}function Nh(a,b,c){var d=Math.abs(b-a)/Math.max(0,c),e=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),f=d/e;return f>=dr?e*=10:f>=er?e*=5:f>=fr&&(e*=2),b<a?-e:e}function Gi(a,b){let c;if(void 0===b)for(const d of a)null!=d&&(c<d||void 0===c&&d>=d)&&(c=d);else{let d=-1;for(let e of a)null!=(e=b(e,++d,a))&&(c<e||void 0===c&&e>=e)&&(c=e)}return c}function hr(a,b){let c;if(void 0===b)for(const d of a)null!=d&&(c>d||void 0===c&&d>=d)&&(c=d);else{let d=-1;for(let e of a)null!=(e=b(e,++d,a))&&(c>e||void 0===c&&e>=e)&&(c=e)}return c}function Wk(a,b,c){const d=a[b];a[b]=a[c],a[c]=d}function GM(a){return null===a?NaN:+a}function mn(a,b,c){if(d=(a=Float64Array.from(function*(h,i){if(void 0===i)for(let j of h)null!=j&&(j=+j)>=j&&(yield j);else{let j=-1;for(let k of h)null!=(k=i(k,++j,h))&&(k=+k)>=k&&(yield k)}}(a,c))).length){if((b=+b)<=0||d<2)return hr(a);if(b>=1)return Gi(a);var d,e=(d-1)*b,f=Math.floor(e),g=Gi(function h(i,j,k=0,l=i.length-1,m=Ej){for(;l>k;){if(l-k>600){const q=l-k+1,s=j-k+1,r=Math.log(q),u=.5*Math.exp(2*r/3),t=.5*Math.sqrt(r*u*(q-u)/q)*(s-q/2<0?-1:1);h(i,j,Math.max(k,Math.floor(j-s*u/q+t)),Math.min(l,Math.floor(j+(q-s)*u/q+t)),m)}const n=i[j];let o=k,p=l;for(Wk(i,k,j),m(i[l],n)>0&&Wk(i,k,l);o<p;){for(Wk(i,o,p),++o,--p;m(i[o],n)<0;)++o;for(;m(i[p],n)>0;)--p}0===m(i[k],n)?Wk(i,k,p):(++p,Wk(i,p,l)),p<=j&&(k=p+1),j<=p&&(l=p-1)}return i}(a,f).subarray(0,f+1));return g+(hr(a.subarray(f+1))-g)*(e-f)}}function Uy(a,b){return mn(a,.5,b)}function Vy(a,b){let c=0;if(void 0===b)for(let d of a)(d=+d)&&(c+=d);else{let d=-1;for(let e of a)(e=+b(e,++d,a))&&(c+=e)}return c}function nn(a,b){if((c=(a=b?a.toExponential(b-1):a.toExponential()).indexOf("e"))<0)return null;var c,d=a.slice(0,c);return[d.length>1?d[0]+d.slice(2):d,+a.slice(c+1)]}function Fj(a){return(a=nn(Math.abs(a)))?a[1]:NaN}var Wy,HM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gj(a){if(!(b=HM.exec(a)))throw new Error("invalid format: "+a);var b;return new ir({fill:b[1],align:b[2],sign:b[3],symbol:b[4],zero:b[5],width:b[6],comma:b[7],precision:b[8]&&b[8].slice(1),trim:b[9],type:b[10]})}function ir(a){this.fill=void 0===a.fill?" ":a.fill+"",this.align=void 0===a.align?">":a.align+"",this.sign=void 0===a.sign?"-":a.sign+"",this.symbol=void 0===a.symbol?"":a.symbol+"",this.zero=!!a.zero,this.width=void 0===a.width?void 0:+a.width,this.comma=!!a.comma,this.precision=void 0===a.precision?void 0:+a.precision,this.trim=!!a.trim,this.type=void 0===a.type?"":a.type+""}function Xy(a,b){var c=nn(a,b);if(!c)return a+"";var d=c[0],e=c[1];return e<0?"0."+new Array(-e).join("0")+d:d.length>e+1?d.slice(0,e+1)+"."+d.slice(e+1):d+new Array(e-d.length+2).join("0")}Gj.prototype=ir.prototype,ir.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Yy={"%":function(a,b){return(100*a).toFixed(b)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:function(a){return Math.round(a).toString(10)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},g:function(a,b){return a.toPrecision(b)},o:function(a){return Math.round(a).toString(8)},p:function(a,b){return Xy(100*a,b)},r:Xy,s:function(a,b){var c=nn(a,b);if(!c)return a+"";var d=c[0],e=c[1],f=e-(Wy=3*Math.max(-8,Math.min(8,Math.floor(e/3))))+1,g=d.length;return f===g?d:f>g?d+new Array(f-g+1).join("0"):f>0?d.slice(0,f)+"."+d.slice(f):"0."+new Array(1-f).join("0")+nn(a,Math.max(0,b+f-1))[0]},X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function Zy(a){return a}var jr,on,kr,_y=Array.prototype.map,$y=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function az(a){var b,c,d=void 0===a.grouping||void 0===a.thousands?Zy:(b=_y.call(a.grouping,Number),c=a.thousands+"",function(m,n){for(var o=m.length,p=[],q=0,s=b[0],r=0;o>0&&s>0&&(r+s+1>n&&(s=Math.max(1,n-r)),p.push(m.substring(o-=s,o+s)),!((r+=s+1)>n));)s=b[q=(q+1)%b.length];return p.reverse().join(c)}),e=void 0===a.currency?"":a.currency[0]+"",f=void 0===a.currency?"":a.currency[1]+"",g=void 0===a.decimal?".":a.decimal+"",h=void 0===a.numerals?Zy:function(m){return function(n){return n.replace(/[0-9]/g,function(o){return m[+o]})}}(_y.call(a.numerals,String)),i=void 0===a.percent?"%":a.percent+"",j=void 0===a.minus?"-":a.minus+"",k=void 0===a.nan?"NaN":a.nan+"";function l(m){var n=(m=Gj(m)).fill,o=m.align,p=m.sign,q=m.symbol,s=m.zero,r=m.width,u=m.comma,t=m.precision,w=m.trim,x=m.type;"n"===x?(u=!0,x="g"):Yy[x]||(void 0===t&&(t=12),w=!0,x="g"),(s||"0"===n&&"="===o)&&(s=!0,n="0",o="=");var z="$"===q?e:"#"===q&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",A="$"===q?f:/[%p]/.test(x)?i:"",B=Yy[x],I=/[defgprs%]/.test(x);function J(D){var O,K,Q,V=z,$=A;if("c"===x)$=B(D)+$,D="";else{var Ia=(D=+D)<0||1/D<0;if(D=isNaN(D)?k:B(Math.abs(D),t),w&&(D=function(oa){qf:for(var Ma,Za=oa.length,Pa=1,La=-1;Pa<Za;++Pa)switch(oa[Pa]){case".":La=Ma=Pa;break;case"0":0===La&&(La=Pa),Ma=Pa;break;default:if(!+oa[Pa])break qf;La>0&&(La=0)}return La>0?oa.slice(0,La)+oa.slice(Ma+1):oa}(D)),Ia&&0==+D&&"+"!==p&&(Ia=!1),V=(Ia?"("===p?p:j:"-"===p||"("===p?"":p)+V,$=("s"===x?$y[8+Wy/3]:"")+$+(Ia&&"("===p?")":""),I){for(O=-1,K=D.length;++O<K;)if(48>(Q=D.charCodeAt(O))||Q>57){$=(46===Q?g+D.slice(O+1):D.slice(O))+$,D=D.slice(0,O);break}}}u&&!s&&(D=d(D,1/0));var wa=V.length+D.length+$.length,xa=wa<r?new Array(r-wa+1).join(n):"";switch(u&&s&&(D=d(xa+D,xa.length?r-$.length:1/0),xa=""),o){case"<":D=V+D+$+xa;break;case"=":D=V+xa+D+$;break;case"^":D=xa.slice(0,wa=xa.length>>1)+V+D+$+xa.slice(wa);break;default:D=xa+V+D+$}return h(D)}return t=void 0===t?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,t)):Math.max(0,Math.min(20,t)),J.toString=function(){return m+""},J}return{format:l,formatPrefix:function(m,n){var o=l(((m=Gj(m)).type="f",m)),p=3*Math.max(-8,Math.min(8,Math.floor(Fj(n)/3))),q=Math.pow(10,-p),s=$y[8+p/3];return function(r){return o(q*r)+s}}}}function bz(a){return Math.max(0,-Fj(Math.abs(a)))}function cz(a,b){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Fj(b)/3)))-Fj(Math.abs(a)))}function dz(a,b){return a=Math.abs(a),b=Math.abs(b)-a,Math.max(0,Fj(b)-Fj(a))+1}function ez(a){const b=Vk(a.format),c=a.formatPrefix;return{format:b,formatPrefix:c,formatFloat(d){var e=Gj(d||",");if(null==e.precision){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1}return function(f,g){return h=>{var i,j,k=f(h),l=k.indexOf(g);if(l<0)return k;for(j=(i=function(m,n){var o,p=m.lastIndexOf("e");if(p>0)return p;for(p=m.length;--p>n;)if((o=m.charCodeAt(p))>=48&&o<=57)return p+1}(k,l))<k.length?k.slice(i):"";--i>l;)if("0"!==k[i]){++i;break}return k.slice(0,i)+j}}(b(e),b(".1f")(1)[1])}return b(e)},formatSpan(d,e,f,g){g=Gj(null==g?",f":g);const h=Nh(d,e,f),i=Math.max(Math.abs(d),Math.abs(e));let j;if(null==g.precision)switch(g.type){case"s":return isNaN(j=cz(h,i))||(g.precision=j),c(g,i);case"":case"e":case"g":case"p":case"r":isNaN(j=dz(h,i))||(g.precision=j-("e"===g.type));break;case"f":case"%":isNaN(j=bz(h))||(g.precision=j-2*("%"===g.type))}return b(g)}}}let lr;function fz(){return lr=ez({format:on,formatPrefix:kr})}function gz(a){return ez(az(a))}function pn(a){return arguments.length?lr=gz(a):lr}!function(a){jr=az(a),on=jr.format,kr=jr.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),fz();const Je="year",bf="quarter",cf="month",Od="week",tf="date",Ff="day",Gf="hours",uf="minutes",Hf="seconds",mr=[Je,bf,cf,Od,tf,Ff,"dayofyear",Gf,uf,Hf,"milliseconds"],nr=mr.reduce((a,b,c)=>(a[b]=1+c,a),{});function or(a){const b=Ra(a).slice(),c={};return b.length||ja("Missing time unit."),b.forEach(d=>{db(nr,d)?c[d]=1:ja(`Invalid time unit: ${d}.`)}),(c[Od]||c.day?1:0)+(c[bf]||c[cf]||c[tf]?1:0)+(c.dayofyear?1:0)>1&&ja("Incompatible time units: "+a),b.sort((d,e)=>nr[d]-nr[e]),b}const IM={[Je]:"%Y ",[bf]:"Q%q ",[cf]:"%b ",[tf]:"%d ",[Od]:"W%U ",[Ff]:"%a ",dayofyear:"%j ",[Gf]:"%H:00",[uf]:"00:%M",[Hf]:":%S",milliseconds:".%L","year-month":"%Y-%m ","year-month-date":"%Y-%m-%d ",["hours-"+uf]:"%H:%M"};function hz(a,b){const c=Mb({},IM,b),d=or(a),e=d.length;let f,g,h="",i=0;for(i=0;i<e;)for(f=d.length;f>i;--f)if(g=d.slice(i,f).join("-"),null!=c[g]){h+=c[g],i=f;break}return h.trim()}var pr=new Date(),qr=new Date();function Ud(a,b,c,d){function e(f){return a(f=0===arguments.length?new Date():new Date(+f)),f}return e.floor=function(f){return a(f=new Date(+f)),f},e.ceil=function(f){return a(f=new Date(f-1)),b(f,1),a(f),f},e.round=function(f){var g=e(f),h=e.ceil(f);return f-g<h-f?g:h},e.offset=function(f,g){return b(f=new Date(+f),null==g?1:Math.floor(g)),f},e.range=function(f,g,h){var i,j=[];if(f=e.ceil(f),h=null==h?1:Math.floor(h),!(f<g&&h>0))return j;do j.push(i=new Date(+f)),b(f,h),a(f);while(i<f&&f<g);return j},e.filter=function(f){return Ud(function(g){if(g>=g)for(;a(g),!f(g);)g.setTime(g-1)},function(g,h){if(g>=g)if(h<0)for(;++h<=0;)for(;b(g,-1),!f(g););else for(;--h>=0;)for(;b(g,1),!f(g););})},c&&(e.count=function(f,g){return pr.setTime(+f),qr.setTime(+g),a(pr),a(qr),Math.floor(c(pr,qr))},e.every=function(f){return f=Math.floor(f),isFinite(f)&&f>0?f>1?e.filter(d?function(g){return d(g)%f==0}:function(g){return e.count(0,g)%f==0}):e:null}),e}var Hj=Ud(function(){},function(a,b){a.setTime(+a+b)},function(a,b){return b-a});Hj.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?Ud(function(b){b.setTime(Math.floor(b/a)*a)},function(b,c){b.setTime(+b+c*a)},function(b,c){return(c-b)/a}):Hj:null};var qn=Ud(function(a){a.setTime(a-a.getMilliseconds())},function(a,b){a.setTime(+a+1e3*b)},function(a,b){return(b-a)/1e3},function(a){return a.getUTCSeconds()}),iz=Ud(function(a){a.setTime(a-a.getMilliseconds()-1e3*a.getSeconds())},function(a,b){a.setTime(+a+6e4*b)},function(a,b){return(b-a)/6e4},function(a){return a.getMinutes()}),jz=Ud(function(a){a.setTime(a-a.getMilliseconds()-1e3*a.getSeconds()-6e4*a.getMinutes())},function(a,b){a.setTime(+a+36e5*b)},function(a,b){return(b-a)/36e5},function(a){return a.getHours()}),Hi=Ud(function(a){a.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+b)},function(a,b){return(b-a-6e4*(b.getTimezoneOffset()-a.getTimezoneOffset()))/864e5},function(a){return a.getDate()-1});function Ii(a){return Ud(function(b){b.setDate(b.getDate()-(b.getDay()+7-a)%7),b.setHours(0,0,0,0)},function(b,c){b.setDate(b.getDate()+7*c)},function(b,c){return(c-b-6e4*(c.getTimezoneOffset()-b.getTimezoneOffset()))/6048e5})}var rn=Ii(0),rr=Ii(1),sr=(Ii(2),Ii(3),Ii(4)),tr=(Ii(5),Ii(6),Ud(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,b){a.setMonth(a.getMonth()+b)},function(a,b){return b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear())},function(a){return a.getMonth()})),Oh=Ud(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a,b){return b.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});Oh.every=function(a){return isFinite(a=Math.floor(a))&&a>0?Ud(function(b){b.setFullYear(Math.floor(b.getFullYear()/a)*a),b.setMonth(0,1),b.setHours(0,0,0,0)},function(b,c){b.setFullYear(b.getFullYear()+c*a)}):null};var kz=Ud(function(a){a.setUTCSeconds(0,0)},function(a,b){a.setTime(+a+6e4*b)},function(a,b){return(b-a)/6e4},function(a){return a.getUTCMinutes()}),lz=Ud(function(a){a.setUTCMinutes(0,0,0)},function(a,b){a.setTime(+a+36e5*b)},function(a,b){return(b-a)/36e5},function(a){return a.getUTCHours()}),Ji=Ud(function(a){a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+b)},function(a,b){return(b-a)/864e5},function(a){return a.getUTCDate()-1});function Ki(a){return Ud(function(b){b.setUTCDate(b.getUTCDate()-(b.getUTCDay()+7-a)%7),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCDate(b.getUTCDate()+7*c)},function(b,c){return(c-b)/6048e5})}var sn=Ki(0),ur=Ki(1),vr=(Ki(2),Ki(3),Ki(4)),wr=(Ki(5),Ki(6),Ud(function(a){a.setUTCDate(1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCMonth(a.getUTCMonth()+b)},function(a,b){return b.getUTCMonth()-a.getUTCMonth()+12*(b.getUTCFullYear()-a.getUTCFullYear())},function(a){return a.getUTCMonth()})),Ph=Ud(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCFullYear(a.getUTCFullYear()+b)},function(a,b){return b.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});Ph.every=function(a){return isFinite(a=Math.floor(a))&&a>0?Ud(function(b){b.setUTCFullYear(Math.floor(b.getUTCFullYear()/a)*a),b.setUTCMonth(0,1),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCFullYear(b.getUTCFullYear()+c*a)}):null};const Li=new Date();function xr(a){return Li.setFullYear(a),Li.setMonth(0),Li.setDate(1),Li.setHours(0,0,0,0),Li}function mz(a){return oz(new Date(a))}function nz(a){return yr(new Date(a))}function oz(a){return Hi.count(xr(a.getFullYear())-1,a)}function yr(a){return rn.count(xr(a.getFullYear())-1,a)}function zr(a){return xr(a).getDay()}function JM(a,b,c,d,e,f,g){if(0<=a&&a<100){var h=new Date(-1,b,c,d,e,f,g);return h.setFullYear(a),h}return new Date(a,b,c,d,e,f,g)}function pz(a){return rz(new Date(a))}function qz(a){return Ar(new Date(a))}function rz(a){const b=Date.UTC(a.getUTCFullYear(),0,1);return Ji.count(b-1,a)}function Ar(a){const b=Date.UTC(a.getUTCFullYear(),0,1);return sn.count(b-1,a)}function Br(a){return Li.setTime(Date.UTC(a,0,1)),Li.getUTCDay()}function KM(a,b,c,d,e,f,g){if(0<=a&&a<100){var h=new Date(Date.UTC(-1,b,c,d,e,f,g));return h.setUTCFullYear(c.y),h}return new Date(Date.UTC(a,b,c,d,e,f,g))}function sz(a,b,c,d,e){const f=b||1,g=Ha(a),h=(s,r,u)=>function(t,w,x,z){const A=x<=1?t:z?(B,I)=>z+x*Math.floor((t(B,I)-z)/x):(B,I)=>x*Math.floor(t(B,I)/x);return w?(B,I)=>w(A(B,I),I):A}(c[u=u||s],d[u],s===g&&f,r),i=new Date(),j=ee(a),k=j[Je]?h(Je):Nd(2012),l=j[cf]?h(cf):j[bf]?h(bf):pe,m=j[Od]&&j.day?h(Ff,1,Od+Ff):j[Od]?h(Od,1):j.day?h(Ff,1):j[tf]?h(tf,1):j.dayofyear?h("dayofyear",1):Ef,n=j[Gf]?h(Gf):pe,o=j[uf]?h(uf):pe,p=j[Hf]?h(Hf):pe,q=j.milliseconds?h("milliseconds"):pe;return function(s){i.setTime(+s);const r=k(i);return e(r,l(i),m(i,r),n(i),o(i),p(i),q(i))}}function Ij(a,b,c){return b+7*a-(c+6)%7}const LM={[Je]:a=>a.getFullYear(),[bf]:a=>Math.floor(a.getMonth()/3),[cf]:a=>a.getMonth(),[tf]:a=>a.getDate(),[Gf]:a=>a.getHours(),[uf]:a=>a.getMinutes(),[Hf]:a=>a.getSeconds(),milliseconds:a=>a.getMilliseconds(),dayofyear:a=>oz(a),[Od]:a=>yr(a),[Od+Ff]:(a,b)=>Ij(yr(a),a.getDay(),zr(b)),[Ff]:(a,b)=>Ij(1,a.getDay(),zr(b))},MM={[bf]:a=>3*a,[Od]:(a,b)=>Ij(a,0,zr(b))};function tz(a,b){return sz(a,b||1,LM,MM,JM)}const NM={[Je]:a=>a.getUTCFullYear(),[bf]:a=>Math.floor(a.getUTCMonth()/3),[cf]:a=>a.getUTCMonth(),[tf]:a=>a.getUTCDate(),[Gf]:a=>a.getUTCHours(),[uf]:a=>a.getUTCMinutes(),[Hf]:a=>a.getUTCSeconds(),milliseconds:a=>a.getUTCMilliseconds(),dayofyear:a=>rz(a),[Od]:a=>Ar(a),[Ff]:(a,b)=>Ij(1,a.getUTCDay(),Br(b)),[Od+Ff]:(a,b)=>Ij(Ar(a),a.getUTCDay(),Br(b))},OM={[bf]:a=>3*a,[Od]:(a,b)=>Ij(a,0,Br(b))};function uz(a,b){return sz(a,b||1,NM,OM,KM)}const PM={[Je]:Oh,[bf]:tr.every(3),[cf]:tr,[Od]:rn,[tf]:Hi,[Ff]:Hi,dayofyear:Hi,[Gf]:jz,[uf]:iz,[Hf]:qn,milliseconds:Hj},QM={[Je]:Ph,[bf]:wr.every(3),[cf]:wr,[Od]:sn,[tf]:Ji,[Ff]:Ji,dayofyear:Ji,[Gf]:lz,[uf]:kz,[Hf]:qn,milliseconds:Hj};function Jj(a){return PM[a]}function Kj(a){return QM[a]}function vz(a,b,c){return a?a.offset(b,c):void 0}function wz(a,b,c){return vz(Jj(a),b,c)}function xz(a,b,c){return vz(Kj(a),b,c)}function yz(a,b,c,d){return a?a.range(b,c,d):void 0}function zz(a,b,c,d){return yz(Jj(a),b,c,d)}function Az(a,b,c,d){return yz(Kj(a),b,c,d)}const Bz=[Je,cf,tf,Gf,uf,Hf,"milliseconds"],Xk=Bz.slice(0,-1),Yk=Xk.slice(0,-1),Zk=Yk.slice(0,-1),RM=Zk.slice(0,-1),Cz=[Je,cf],Dz=[Je],_k=[[Xk,1,1e3],[Xk,5,5e3],[Xk,15,15e3],[Xk,30,3e4],[Yk,1,6e4],[Yk,5,3e5],[Yk,15,9e5],[Yk,30,18e5],[Zk,1,36e5],[Zk,3,108e5],[Zk,6,216e5],[Zk,12,432e5],[RM,1,864e5],[[Je,Od],1,6048e5],[Cz,1,2592e6],[Cz,3,7776e6],[Dz,1,31536e6]];function Ez(a){const b=a.extent,c=a.maxbins||40,d=Math.abs(an(b))/c;let e,f,g=kn(h=>h[2]).right(_k,d);return g===_k.length?(e=Dz,f=Nh(b[0]/31536e6,b[1]/31536e6,c)):g?(g=_k[d/_k[g-1][2]<_k[g][2]/d?g-1:g],e=g[0],f=g[1]):(e=Bz,f=Math.max(Nh(b[0],b[1],c),1)),{units:e,step:f}}function Cr(a){if(0<=a.y&&a.y<100){var b=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return b.setFullYear(a.y),b}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function Dr(a){if(0<=a.y&&a.y<100){var b=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return b.setUTCFullYear(a.y),b}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function $k(a,b,c){return{y:a,m:b,d:c,H:0,M:0,S:0,L:0}}function Fz(a){var b=a.dateTime,c=a.date,d=a.time,e=a.periods,f=a.days,g=a.shortDays,h=a.months,i=a.shortMonths,j=bl(e),k=cl(e),l=bl(f),m=cl(f),n=bl(g),o=cl(g),p=bl(h),q=cl(h),s=bl(i),r=cl(i),u={a:function(B){return g[B.getDay()]},A:function(B){return f[B.getDay()]},b:function(B){return i[B.getMonth()]},B:function(B){return h[B.getMonth()]},c:null,d:Lz,e:Lz,f:oN,H:lN,I:mN,j:nN,L:Mz,m:pN,M:qN,p:function(B){return e[+(B.getHours()>=12)]},q:function(B){return 1+~~(B.getMonth()/3)},Q:Qz,s:Rz,S:rN,u:sN,U:tN,V:uN,w:vN,W:wN,x:null,X:null,y:xN,Y:yN,Z:zN,"%":Pz},t={a:function(B){return g[B.getUTCDay()]},A:function(B){return f[B.getUTCDay()]},b:function(B){return i[B.getUTCMonth()]},B:function(B){return h[B.getUTCMonth()]},c:null,d:Nz,e:Nz,f:DN,H:AN,I:BN,j:CN,L:Oz,m:EN,M:FN,p:function(B){return e[+(B.getUTCHours()>=12)]},q:function(B){return 1+~~(B.getUTCMonth()/3)},Q:Qz,s:Rz,S:GN,u:HN,U:IN,V:JN,w:KN,W:LN,x:null,X:null,y:MN,Y:NN,Z:ON,"%":Pz},w={a:function(B,I,J){var D=n.exec(I.slice(J));return D?(B.w=o[D[0].toLowerCase()],J+D[0].length):-1},A:function(B,I,J){var D=l.exec(I.slice(J));return D?(B.w=m[D[0].toLowerCase()],J+D[0].length):-1},b:function(B,I,J){var D=s.exec(I.slice(J));return D?(B.m=r[D[0].toLowerCase()],J+D[0].length):-1},B:function(B,I,J){var D=p.exec(I.slice(J));return D?(B.m=q[D[0].toLowerCase()],J+D[0].length):-1},c:function(B,I,J){return A(B,b,I,J)},d:Jz,e:Jz,f:hN,H:Kz,I:Kz,j:dN,L:gN,m:cN,M:eN,p:function(B,I,J){var D=j.exec(I.slice(J));return D?(B.p=k[D[0].toLowerCase()],J+D[0].length):-1},q:bN,Q:jN,s:kN,S:fN,u:WM,U:XM,V:YM,w:VM,W:ZM,x:function(B,I,J){return A(B,c,I,J)},X:function(B,I,J){return A(B,d,I,J)},y:$M,Y:_M,Z:aN,"%":iN};function x(B,I){return function(J){var D,O,K,Q=[],V=-1,$=0,Ia=B.length;for(J instanceof Date||(J=new Date(+J));++V<Ia;)37===B.charCodeAt(V)&&(Q.push(B.slice($,V)),null!=(O=Iz[D=B.charAt(++V)])?D=B.charAt(++V):O="e"===D?" ":"0",(K=I[D])&&(D=K(J,O)),Q.push(D),$=V+1);return Q.push(B.slice($,V)),Q.join("")}}function z(B,I){return function(J){var D,O,K=$k(1900,void 0,1);if(A(K,B,J+="",0)!=J.length)return null;if("Q"in K)return new Date(K.Q);if("s"in K)return new Date(1e3*K.s+("L"in K?K.L:0));if(I&&!("Z"in K)&&(K.Z=0),"p"in K&&(K.H=K.H%12+12*K.p),void 0===K.m&&(K.m="q"in K?K.q:0),"V"in K){if(K.V<1||K.V>53)return null;"w"in K||(K.w=1),"Z"in K?(O=(D=Dr($k(K.y,0,1))).getUTCDay(),D=O>4||0===O?ur.ceil(D):ur(D),D=Ji.offset(D,7*(K.V-1)),K.y=D.getUTCFullYear(),K.m=D.getUTCMonth(),K.d=D.getUTCDate()+(K.w+6)%7):(O=(D=Cr($k(K.y,0,1))).getDay(),D=O>4||0===O?rr.ceil(D):rr(D),D=Hi.offset(D,7*(K.V-1)),K.y=D.getFullYear(),K.m=D.getMonth(),K.d=D.getDate()+(K.w+6)%7)}else("W"in K||"U"in K)&&("w"in K||(K.w="u"in K?K.u%7:"W"in K?1:0),O="Z"in K?Dr($k(K.y,0,1)).getUTCDay():Cr($k(K.y,0,1)).getDay(),K.m=0,K.d="W"in K?(K.w+6)%7+7*K.W-(O+5)%7:K.w+7*K.U-(O+6)%7);return"Z"in K?(K.H+=K.Z/100|0,K.M+=K.Z%100,Dr(K)):Cr(K)}}function A(B,I,J,D){for(var O,K,Q=0,V=I.length,$=J.length;Q<V;){if(D>=$)return-1;if(37===(O=I.charCodeAt(Q++))){if(O=I.charAt(Q++),!(K=w[O in Iz?I.charAt(Q++):O])||(D=K(B,J,D))<0)return-1}else if(O!=J.charCodeAt(D++))return-1}return D}return u.x=x(c,u),u.X=x(d,u),u.c=x(b,u),t.x=x(c,t),t.X=x(d,t),t.c=x(b,t),{format:function(B){var I=x(B+="",u);return I.toString=function(){return B},I},parse:function(B){var I=z(B+="",!1);return I.toString=function(){return B},I},utcFormat:function(B){var I=x(B+="",t);return I.toString=function(){return B},I},utcParse:function(B){var I=z(B+="",!0);return I.toString=function(){return B},I}}}var al,Er,Gz,Fr,Hz,Iz={"-":"",_:" ",0:"0"},Vd=/^\s*\d+/,SM=/^%/,TM=/[\\^$*+?|[\]().{}]/g;function Rc(a,b,c){var d=a<0?"-":"",e=(d?-a:a)+"",f=e.length;return d+(f<c?new Array(c-f+1).join(b)+e:e)}function UM(a){return a.replace(TM,"\\$&")}function bl(a){return new RegExp("^(?:"+a.map(UM).join("|")+")","i")}function cl(a){for(var b={},c=-1,d=a.length;++c<d;)b[a[c].toLowerCase()]=c;return b}function VM(a,b,c){var d=Vd.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function WM(a,b,c){var d=Vd.exec(b.slice(c,c+1));return d?(a.u=+d[0],c+d[0].length):-1}function XM(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.U=+d[0],c+d[0].length):-1}function YM(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.V=+d[0],c+d[0].length):-1}function ZM(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.W=+d[0],c+d[0].length):-1}function _M(a,b,c){var d=Vd.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function $M(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.y=+d[0]+(+d[0]>68?1900:2e3),c+d[0].length):-1}function aN(a,b,c){var d=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(b.slice(c,c+6));return d?(a.Z=d[1]?0:-(d[2]+(d[3]||"00")),c+d[0].length):-1}function bN(a,b,c){var d=Vd.exec(b.slice(c,c+1));return d?(a.q=3*d[0]-3,c+d[0].length):-1}function cN(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function Jz(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function dN(a,b,c){var d=Vd.exec(b.slice(c,c+3));return d?(a.m=0,a.d=+d[0],c+d[0].length):-1}function Kz(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function eN(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function fN(a,b,c){var d=Vd.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function gN(a,b,c){var d=Vd.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function hN(a,b,c){var d=Vd.exec(b.slice(c,c+6));return d?(a.L=Math.floor(d[0]/1e3),c+d[0].length):-1}function iN(a,b,c){var d=SM.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function jN(a,b,c){var d=Vd.exec(b.slice(c));return d?(a.Q=+d[0],c+d[0].length):-1}function kN(a,b,c){var d=Vd.exec(b.slice(c));return d?(a.s=+d[0],c+d[0].length):-1}function Lz(a,b){return Rc(a.getDate(),b,2)}function lN(a,b){return Rc(a.getHours(),b,2)}function mN(a,b){return Rc(a.getHours()%12||12,b,2)}function nN(a,b){return Rc(1+Hi.count(Oh(a),a),b,3)}function Mz(a,b){return Rc(a.getMilliseconds(),b,3)}function oN(a,b){return Mz(a,b)+"000"}function pN(a,b){return Rc(a.getMonth()+1,b,2)}function qN(a,b){return Rc(a.getMinutes(),b,2)}function rN(a,b){return Rc(a.getSeconds(),b,2)}function sN(a){var b=a.getDay();return 0===b?7:b}function tN(a,b){return Rc(rn.count(Oh(a)-1,a),b,2)}function uN(a,b){var c=a.getDay();return a=c>=4||0===c?sr(a):sr.ceil(a),Rc(sr.count(Oh(a),a)+(4===Oh(a).getDay()),b,2)}function vN(a){return a.getDay()}function wN(a,b){return Rc(rr.count(Oh(a)-1,a),b,2)}function xN(a,b){return Rc(a.getFullYear()%100,b,2)}function yN(a,b){return Rc(a.getFullYear()%1e4,b,4)}function zN(a){var b=a.getTimezoneOffset();return(b>0?"-":(b*=-1,"+"))+Rc(b/60|0,"0",2)+Rc(b%60,"0",2)}function Nz(a,b){return Rc(a.getUTCDate(),b,2)}function AN(a,b){return Rc(a.getUTCHours(),b,2)}function BN(a,b){return Rc(a.getUTCHours()%12||12,b,2)}function CN(a,b){return Rc(1+Ji.count(Ph(a),a),b,3)}function Oz(a,b){return Rc(a.getUTCMilliseconds(),b,3)}function DN(a,b){return Oz(a,b)+"000"}function EN(a,b){return Rc(a.getUTCMonth()+1,b,2)}function FN(a,b){return Rc(a.getUTCMinutes(),b,2)}function GN(a,b){return Rc(a.getUTCSeconds(),b,2)}function HN(a){var b=a.getUTCDay();return 0===b?7:b}function IN(a,b){return Rc(sn.count(Ph(a)-1,a),b,2)}function JN(a,b){var c=a.getUTCDay();return a=c>=4||0===c?vr(a):vr.ceil(a),Rc(vr.count(Ph(a),a)+(4===Ph(a).getUTCDay()),b,2)}function KN(a){return a.getUTCDay()}function LN(a,b){return Rc(ur.count(Ph(a)-1,a),b,2)}function MN(a,b){return Rc(a.getUTCFullYear()%100,b,2)}function NN(a,b){return Rc(a.getUTCFullYear()%1e4,b,4)}function ON(){return"+0000"}function Pz(){return"%"}function Qz(a){return+a}function Rz(a){return Math.floor(+a/1e3)}function Sz(a,b,c){ka(c=c||{})||ja("Invalid time multi-format specifier: "+c);const d=b(Hf),e=b(uf),f=b(Gf),g=b(tf),h=b(Od),i=b(cf),j=b(bf),k=b(Je),l=a(c.milliseconds||".%L"),m=a(c[Hf]||":%S"),n=a(c[uf]||"%I:%M"),o=a(c[Gf]||"%I %p"),p=a(c[tf]||c.day||"%a %d"),q=a(c[Od]||"%b %d"),s=a(c[cf]||"%B"),r=a(c[bf]||"%B"),u=a(c[Je]||"%Y");return t=>(d(t)<t?l:e(t)<t?m:f(t)<t?n:g(t)<t?o:i(t)<t?h(t)<t?p:q:k(t)<t?j(t)<t?s:r:u)(t)}function Tz(a){const b=Vk(a.format),c=Vk(a.utcFormat);return{timeFormat:d=>Xa(d)?b(d):Sz(b,Jj,d),utcFormat:d=>Xa(d)?c(d):Sz(c,Kj,d),timeParse:Vk(a.parse),utcParse:Vk(a.utcParse)}}let Gr;function Uz(){return Gr=Tz({format:Er,parse:Gz,utcFormat:Fr,utcParse:Hz})}function Vz(a){return Tz(Fz(a))}function dl(a){return arguments.length?Gr=Vz(a):Gr}!function(a){al=Fz(a),Er=al.format,Gz=al.parse,Fr=al.utcFormat,Hz=al.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Uz();const Hr=(a,b)=>Mb({},a,b);function Wz(a,b){const c=a?gz(a):pn(),d=b?Vz(b):dl();return Hr(c,d)}function Ir(a,b){const c=arguments.length;return c&&2!==c&&ja("defaultLocale expects either zero or two arguments."),c?Hr(pn(a),dl(b)):Hr(pn(),dl())}function Xz(a,b,c,d){const e=cr((b=b||{}).type||"json");return e||ja("Unknown data format type: "+b.type),a=e(a,b),b.parse&&function(f,g,h,i){if(!f.length)return;const j=dl();h=h||j.timeParse,i=i||j.utcParse;var k,l,m,n,o,p,q,s=f.columns||Object.keys(f[0]);for("auto"===g&&(g=Jy(f,s)),s=Object.keys(g),k=s.map(function(r){var u,t,w=g[r];if(w&&(w.startsWith("date:")||w.startsWith("utc:")))return("'"===(t=(u=w.split(/:(.+)?/,2))[1])[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1])&&(t=t.slice(1,-1)),("utc"===u[0]?i:h)(t);if(!_q[w])throw Error("Illegal format pattern: "+r+":"+w);return _q[w]}),n=0,p=f.length,q=s.length;n<p;++n)for(l=f[n],o=0;o<q;++o)m=s[o],l[m]=k[o](l[m])}(a,b.parse,c,d),db(a,"columns")&&delete a.columns,a}var tn=function(a,b){return function(c){return{options:c||{},sanitize:qM,load:pM,fileAccess:!!b,file:rM(b),http:tM(a)}}}("undefined"!=typeof fetch&&fetch,null),PN={skip:!0};function QN(a,b,c,d,e,f){var g,h,i=Mb({},f,PN);Ub(c)||(c=Nd(c)),void 0===d?g=j=>a.touch(c(j)):Ub(d)?(h=new Zc(null,d,e,!1),g=j=>{h.evaluate(j);const k=c(j),l=h.value;Gy(l)?a.pulse(k,l,f):a.update(k,l,i)}):g=j=>a.update(c(j),d,i),b.apply(g)}function RN(a,b,c,d,e,f){if(void 0===d)b.targets().add(c);else{const g=f||{},h=new Zc(null,function(i,j){return j=Ub(j)?j:Nd(j),i?function(k,l){const m=j(k,l);return i.skip()||(i.skip(m!==this.value).value=m),m}:j}(c,d),e,!1);h.modified(g.force),h.rank=b.rank,b.targets().add(h),c&&(h.skip(!0),h.value=c.value,h.targets().add(c),a.connect(c,[h]))}}const un={};function Qh(a,b,c){this.dataflow=a,this.stamp=null==b?-1:b,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=c||null}const id=Qh.prototype;function vn(a,b){return a?(c,d)=>a(c,d)&&b(c,d):b}function Jr(a,b){var c=[];return Dj(a,b,d=>c.push(d)),c}function Yz(a,b){var c={};return a.visit(b,function(d){c[hb(d)]=1}),d=>c[hb(d)]?null:d}function Kr(a,b,c,d){var e,f,g,h,i,j=this,k=0;for(this.dataflow=a,this.stamp=b,this.fields=null,this.encode=d||null,this.pulses=c,g=0,h=c.length;g<h;++g)if((e=c[g]).stamp===b){if(e.fields)for(i in(f=j.fields||(j.fields={}),e.fields))f[i]=1;e.changed(j.ADD)&&(k|=j.ADD),e.changed(j.REM)&&(k|=j.REM),e.changed(j.MOD)&&(k|=j.MOD)}this.changes=k}id.StopPropagation=un,id.ADD=1,id.REM=2,id.MOD=4,id.ADD_REM=3,id.ADD_MOD=5,id.ALL=7,id.REFLOW=8,id.SOURCE=16,id.NO_SOURCE=32,id.NO_FIELDS=64,id.fork=function(a){return new Qh(this.dataflow).init(this,a)},id.clone=function(){const a=this.fork(7);return a.add=a.add.slice(),a.rem=a.rem.slice(),a.mod=a.mod.slice(),a.source&&(a.source=a.source.slice()),a.materialize(23)},id.addAll=function(){let a=this;return a.source&&a.source.length!==a.add.length?(a=new Qh(this.dataflow).init(this),a.add=a.source,a):a},id.init=function(a,b){const c=this;return c.stamp=a.stamp,c.encode=a.encode,!a.fields||64&b||(c.fields=a.fields),1&b?(c.addF=a.addF,c.add=a.add):(c.addF=null,c.add=[]),2&b?(c.remF=a.remF,c.rem=a.rem):(c.remF=null,c.rem=[]),4&b?(c.modF=a.modF,c.mod=a.mod):(c.modF=null,c.mod=[]),32&b?(c.srcF=null,c.source=null):(c.srcF=a.srcF,c.source=a.source,a.cleans&&(c.cleans=a.cleans)),c},id.runAfter=function(a){this.dataflow.runAfter(a)},id.changed=function(a){var b=a||7;return 1&b&&this.add.length||2&b&&this.rem.length||4&b&&this.mod.length},id.reflow=function(a){if(a)return this.fork(7).reflow();var b=this.add.length,c=this.source&&this.source.length;return c&&c!==b&&(this.mod=this.source,b&&this.filter(4,Yz(this,1))),this},id.clean=function(a){return arguments.length?(this.cleans=!!a,this):this.cleans},id.modifies=function(a){var b=this.fields||(this.fields={});return U(a)?a.forEach(c=>b[c]=!0):b[a]=!0,this},id.modified=function(a,b){var c=this.fields;return!(!b&&!this.mod.length||!c)&&(arguments.length?U(a)?a.some(d=>c[d]):c[a]:!!c)},id.filter=function(a,b){var c=this;return 1&a&&(c.addF=vn(c.addF,b)),2&a&&(c.remF=vn(c.remF,b)),4&a&&(c.modF=vn(c.modF,b)),16&a&&(c.srcF=vn(c.srcF,b)),c},id.materialize=function(a){var b=this;return 1&(a=a||7)&&b.addF&&(b.add=Jr(b.add,b.addF),b.addF=null),2&a&&b.remF&&(b.rem=Jr(b.rem,b.remF),b.remF=null),4&a&&b.modF&&(b.mod=Jr(b.mod,b.modF),b.modF=null),16&a&&b.srcF&&(b.source=b.source.filter(b.srcF),b.srcF=null),b},id.visit=function(a,b){var c,d,e=this,f=b;return 16&a?(Dj(e.source,e.srcF,f),e):(1&a&&Dj(e.add,e.addF,f),2&a&&Dj(e.rem,e.remF,f),4&a&&Dj(e.mod,e.modF,f),8&a&&(c=e.source)&&((d=e.add.length+e.mod.length)===c.length||Dj(c,d?Yz(e,5):e.srcF,f)),e)};var Lj=Da(Kr,Qh);function Zz(a){return a.error("Dataflow already running. Use runAsync() to chain invocations."),a}Lj.fork=function(a){var b=new Qh(this.dataflow).init(this,a&this.NO_FIELDS);return void 0!==a&&(a&b.ADD&&this.visit(b.ADD,function(c){return b.add.push(c)}),a&b.REM&&this.visit(b.REM,function(c){return b.rem.push(c)}),a&b.MOD&&this.visit(b.MOD,function(c){return b.mod.push(c)})),b},Lj.changed=function(a){return this.changes&a},Lj.modified=function(a){var b=this,c=b.fields;return c&&b.changes&b.MOD?U(a)?a.some(function(d){return c[d]}):c[a]:0},Lj.filter=function(){ja("MultiPulse does not support filtering.")},Lj.materialize=function(){ja("MultiPulse does not support materialization.")},Lj.visit=function(a,b){var c=this,d=c.pulses,e=d.length,f=0;if(a&c.SOURCE)for(;f<e;++f)d[f].visit(a,b);else for(;f<e;++f)d[f].stamp===c.stamp&&d[f].visit(a,b);return c};var Lr={skip:!1,force:!1};function SN(a){var b=[];return{clear:()=>b=[],size:()=>b.length,peek:()=>b[0],push:c=>(b.push(c),_z(b,0,b.length-1,a)),pop:()=>{var c,d=b.pop();return b.length?(c=b[0],b[0]=d,function(e,f,g){for(var h,i=f,j=e.length,k=e[f],l=1+(f<<1);l<j;)(h=l+1)<j&&g(e[l],e[h])>=0&&(l=h),e[f]=e[l],l=1+((f=l)<<1);e[f]=k,_z(e,i,f,g)}(b,0,a)):c=d,c}}}function _z(a,b,c,d){var e,f,g;for(e=a[c];c>b&&d(e,f=a[g=c-1>>1])<0;)a[c]=f,c=g;return a[c]=e}function Mj(){this.logger(sa()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=Ir();try{this._loader=tn()}catch(a){}this._touched=bn(yb),this._input={},this._pulse=null,this._heap=SN((a,b)=>a.qrank-b.qrank),this._postrun=[]}var Gc=Mj.prototype;function el(a){return function(){return this._log[a].apply(this,arguments)}}function ia(a,b){Zc.call(this,a,null,b)}Gc.stamp=function(){return this._clock},Gc.loader=function(a){return arguments.length?(this._loader=a,this):this._loader},Gc.locale=function(a){return arguments.length?(this._locale=a,this):this._locale},Gc.cleanThreshold=1e4,Gc.add=function(a,b,c,d){var e,f=1;return a instanceof Zc?e=a:a&&a.prototype instanceof Zc?e=new a():Ub(a)?e=new Zc(null,a):(f=0,e=new Zc(a,b)),this.rank(e),f&&(d=c,c=b),c&&this.connect(e,e.parameters(c,d)),this.touch(e),e},Gc.connect=function(a,b){var c,d,e=a.rank;for(c=0,d=b.length;c<d;++c)if(e<b[c].rank)return void this.rerank(a)},Gc.rank=function(a){a.rank=++this._rank},Gc.rerank=function(a){for(var b,c,d,e=[a];e.length;)if(this.rank(b=e.pop()),c=b._targets)for(d=c.length;--d>=0;)e.push(b=c[d]),b===a&&ja("Cycle detected in dataflow graph.")},Gc.pulse=function(a,b,c){this.touch(a,c||Lr);var d=new Qh(this,this._clock+(this._pulse?0:1)),e=a.pulse&&a.pulse.source||[];return d.target=a,this._input[a.id]=b.pulse(d,e),this},Gc.touch=function(a,b){var c=b||Lr;return this._pulse?this._enqueue(a):this._touched.add(a),c.skip&&a.skip(!0),this},Gc.update=function(a,b,c){var d=c||Lr;return(a.set(b)||d.force)&&this.touch(a,d),this},Gc.changeset=Ei,Gc.ingest=function(a,b,c){return b=this.parse(b,c),this.pulse(a,this.changeset().insert(b))},Gc.parse=function(a,b){const c=this.locale();return Xz(a,b,c.timeParse,c.utcParse)},Gc.preload=async function(a,b,c){const d=this,e=d._pending||function(g){var h,i=new Promise(function(j){h=j});return i.requests=0,i.done=function(){0==--i.requests&&(g._pending=null,h(g))},g._pending=i}(d);e.requests+=1;const f=await d.request(b,c);return d.pulse(a,d.changeset().remove(de).insert(f.data||[])),e.done(),f},Gc.request=async function(a,b){const c=this;let d,e=0;try{d=await c.loader().load(a,{context:"dataflow",response:Sy(b&&b.type)});try{d=c.parse(d,b)}catch(f){e=-2,c.warn("Data ingestion failed",a,f)}}catch(f){e=-1,c.warn("Loading failed",a,f)}return{data:d,status:e}},Gc.events=function(a,b,c,d){for(var e,f=this,g=Lh(c,d),h=function(k){k.dataflow=f;try{g.receive(k)}catch(l){f.error(l)}finally{f.run()}},i=0,j=(e="string"==typeof a&&"undefined"!=typeof document?document.querySelectorAll(a):Ra(a)).length;i<j;++i)e[i].addEventListener(b,h);return g},Gc.on=function(a,b,c,d,e){return(a instanceof Zc?RN:QN)(this,a,b,c,d,e),this},Gc.evaluate=async function(a,b,c){const d=this,e=[];if(d._pulse)return Zz(d);if(d._pending&&await d._pending,b&&await cn(d,b),!d._touched.length)return d.debug("Dataflow invoked, but nothing to do."),d;const f=++d._clock;d._pulse=new Qh(d,f,a),d._touched.forEach(k=>d._enqueue(k,!0)),d._touched=bn(yb);let g,h,i,j=0;try{for(;d._heap.size()>0;)g=d._heap.pop(),g.rank===g.qrank?(h=g.run(d._getPulse(g,a)),h.then?h=await h:h.async&&(e.push(h.async),h=un),h!==un&&g._targets&&g._targets.forEach(k=>d._enqueue(k)),++j):d._enqueue(g,!0)}catch(k){d._heap.clear(),i=k}if(d._input={},d._pulse=null,d.debug(`Pulse ${f}: ${j} operators`),i&&(d._postrun=[],d.error(i)),d._postrun.length){const k=d._postrun.sort((l,m)=>m.priority-l.priority);d._postrun=[];for(let l=0;l<k.length;++l)await cn(d,k[l].callback)}return c&&await cn(d,c),e.length&&Promise.all(e).then(k=>d.runAsync(null,()=>{k.forEach(l=>{try{l(d)}catch(m){d.error(m)}})})),d},Gc.run=function(a,b,c){return this._pulse?Zz(this):(this.evaluate(a,b,c),this)},Gc.runAsync=async function(a,b,c){for(;this._running;)await this._running;const d=()=>this._running=null;return(this._running=this.evaluate(a,b,c)).then(d,d),this._running},Gc.runAfter=function(a,b,c){if(this._pulse||b)this._postrun.push({priority:c||0,callback:a});else try{a(this)}catch(d){this.error(d)}},Gc._enqueue=function(a,b){var c=a.stamp<this._clock;c&&(a.stamp=this._clock),(c||b)&&(a.qrank=a.rank,this._heap.push(a))},Gc._getPulse=function(a,b){var c=a.source,d=this._clock;return c&&U(c)?new Kr(this,d,c.map(e=>e.pulse),b):this._input[a.id]||function(e,f){return f&&f.stamp===e.stamp?f:(e=e.fork(),f&&f!==un&&(e.source=f.source),e)}(this._pulse,c&&c.pulse)},Gc.logger=function(a){return arguments.length?(this._log=a,this):this._log},Gc.error=el("error"),Gc.warn=el("warn"),Gc.info=el("info"),Gc.debug=el("debug"),Gc.logLevel=el("level");var Mr=Da(ia,Zc);Mr.run=function(a){return a.stamp<this.stamp?a.StopPropagation:(this.skip()?this.skip(!1):b=this.evaluate(a),(b=b||a).then?b=b.then(c=>this.pulse=c):b!==a.StopPropagation&&(this.pulse=b),b);var b},Mr.evaluate=function(a){var b=this.marshall(a.stamp),c=this.transform(b,a);return b.clear(),c},Mr.transform=function(){};var Nj={};function $z(a){var b=aA(a);return b&&b.Definition||null}function aA(a){return a=a&&a.toLowerCase(),db(Nj,a)?Nj[a]:null}function Nr(a){return a&&a.length?1===a.length?a[0]:(b=a,function(c){for(var d=b.length,e=1,f=String(b[0](c));e<d;++e)f+="|"+b[e](c);return f}):function(){return""};var b}function bA(a,b,c){return c||a+(b?"_"+b:"")}const Or=()=>{},TN={init:Or,add:Or,rem:Or,idx:0},fl={values:{init:a=>a.cell.store=!0,value:a=>a.cell.data.values(),idx:-1},count:{value:a=>a.cell.num},__count__:{value:a=>a.missing+a.valid},missing:{value:a=>a.missing},valid:{value:a=>a.valid},sum:{init:a=>a.sum=0,value:a=>a.sum,add:(a,b)=>a.sum+=+b,rem:(a,b)=>a.sum-=b},product:{init:a=>a.product=1,value:a=>a.valid?a.product:void 0,add:(a,b)=>a.product*=b,rem:(a,b)=>a.product/=b},mean:{init:a=>a.mean=0,value:a=>a.valid?a.mean:void 0,add:(a,b)=>(a.mean_d=b-a.mean,a.mean+=a.mean_d/a.valid),rem:(a,b)=>(a.mean_d=b-a.mean,a.mean-=a.valid?a.mean_d/a.valid:a.mean)},average:{value:a=>a.valid?a.mean:void 0,req:["mean"],idx:1},variance:{init:a=>a.dev=0,value:a=>a.valid>1?a.dev/(a.valid-1):void 0,add:(a,b)=>a.dev+=a.mean_d*(b-a.mean),rem:(a,b)=>a.dev-=a.mean_d*(b-a.mean),req:["mean"],idx:1},variancep:{value:a=>a.valid>1?a.dev/a.valid:void 0,req:["variance"],idx:2},stdev:{value:a=>a.valid>1?Math.sqrt(a.dev/(a.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:a=>a.valid>1?Math.sqrt(a.dev/a.valid):void 0,req:["variance"],idx:2},stderr:{value:a=>a.valid>1?Math.sqrt(a.dev/(a.valid*(a.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:a=>a.cell.data.distinct(a.get),req:["values"],idx:3},ci0:{value:a=>a.cell.data.ci0(a.get),req:["values"],idx:3},ci1:{value:a=>a.cell.data.ci1(a.get),req:["values"],idx:3},median:{value:a=>a.cell.data.q2(a.get),req:["values"],idx:3},q1:{value:a=>a.cell.data.q1(a.get),req:["values"],idx:3},q3:{value:a=>a.cell.data.q3(a.get),req:["values"],idx:3},min:{init:a=>a.min=void 0,value:a=>a.min=Number.isNaN(a.min)?a.cell.data.min(a.get):a.min,add:(a,b)=>{(b<a.min||void 0===a.min)&&(a.min=b)},rem:(a,b)=>{b<=a.min&&(a.min=NaN)},req:["values"],idx:4},max:{init:a=>a.max=void 0,value:a=>a.max=Number.isNaN(a.max)?a.cell.data.max(a.get):a.max,add:(a,b)=>{(b>a.max||void 0===a.max)&&(a.max=b)},rem:(a,b)=>{b>=a.max&&(a.max=NaN)},req:["values"],idx:4},argmin:{init:a=>a.argmin=void 0,value:a=>a.argmin||a.cell.data.argmin(a.get),add:(a,b,c)=>{b<a.min&&(a.argmin=c)},rem:(a,b)=>{b<=a.min&&(a.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:a=>a.argmax=void 0,value:a=>a.argmax||a.cell.data.argmax(a.get),add:(a,b,c)=>{b>a.max&&(a.argmax=c)},rem:(a,b)=>{b>=a.max&&(a.argmax=void 0)},req:["max","values"],idx:3}},gl=Object.keys(fl);function cA(a,b){return fl[a](b)}function dA(a,b){return a.idx-b.idx}function UN(){this.valid=0,this.missing=0,this._ops.forEach(a=>a.init(this))}function VN(a,b){null!=a&&""!==a?a==a&&(++this.valid,this._ops.forEach(c=>c.add(this,a,b))):++this.missing}function WN(a,b){null!=a&&""!==a?a==a&&(--this.valid,this._ops.forEach(c=>c.rem(this,a,b))):--this.missing}function XN(a){return this._out.forEach(b=>a[b.out]=b.value(this)),a}function eA(a,b){var c=b||fc,d=function(g){const h={};g.forEach(j=>h[j.name]=j);const i=j=>{j.req&&j.req.forEach(k=>{h[k]||i(h[k]=fl[k]())})};return g.forEach(i),Object.values(h).sort(dA)}(a),e=a.slice().sort(dA);function f(g){this._ops=d,this._out=e,this.cell=g,this.init()}return f.prototype.init=UN,f.prototype.add=VN,f.prototype.rem=WN,f.prototype.set=XN,f.prototype.get=c,f.fields=a.map(g=>g.out),f}function*fA(a,b){if(null==b)for(let c of a)null!=c&&""!==c&&(c=+c)>=c&&(yield c);else{let c=-1;for(let d of a)d=b(d,++c,a),null!=d&&""!==d&&(d=+d)>=d&&(yield d)}}function Pr(a,b,c){var d=Float64Array.from(fA(a,c));return d.sort(Ej),b.map(e=>function(f,g,h=GM){if(i=f.length){if((g=+g)<=0||i<2)return+h(f[0],0,f);if(g>=1)return+h(f[i-1],i-1,f);var i,j=(i-1)*g,k=Math.floor(j),l=+h(f[k],k,f);return l+(+h(f[k+1],k+1,f)-l)*(j-k)}}(d,e))}function Qr(a,b){return Pr(a,[.25,.5,.75],b)}function Rr(a,b){var c=a.length,d=function(g,h){const i=function(j,k){let l,m=0,n=0,o=0;if(void 0===k)for(let p of j)null!=p&&(p=+p)>=p&&(l=p-n,n+=l/++m,o+=l*(p-n));else{let p=-1;for(let q of j)null!=(q=k(q,++p,j))&&(q=+q)>=q&&(l=q-n,n+=l/++m,o+=l*(q-n))}if(m>1)return o/(m-1)}(g,h);return i?Math.sqrt(i):i}(a,b),e=Qr(a,b),f=(e[2]-e[0])/1.34;return 1.06*(d=Math.min(d,f)||d||Math.abs(e[0])||1)*Math.pow(c,-.2)}function gA(a){var b,c,d,e,f,g,h,i,j=a.maxbins||20,k=a.base||10,l=Math.log(k),m=a.divide||[5,2],n=a.extent[0],o=a.extent[1],p=a.span||o-n||Math.abs(n)||1;if(a.step)b=a.step;else if(a.steps){for(f=p/j,g=0,h=a.steps.length;g<h&&a.steps[g]<f;++g);b=a.steps[Math.max(0,g-1)]}else{for(c=Math.ceil(Math.log(j)/l),d=a.minstep||0,b=Math.max(d,Math.pow(k,Math.round(Math.log(p)/l)-c));Math.ceil(p/b)>j;)b*=k;for(g=0,h=m.length;g<h;++g)(f=b/m[g])>=d&&p/f<=j&&(b=f)}return e=(f=Math.log(b))>=0?0:1+~~(-f/l),i=Math.pow(k,-e-1),(a.nice||void 0===a.nice)&&(n=n<(f=Math.floor(n/b+i)*b)?f-b:f,o=Math.ceil(o/b)*b),{start:n,stop:o===n?n+b:o,step:b}}gl.forEach(a=>{fl[a]=function(b,c){return d=>Mb({name:b,out:d||b},TN,c)}(a,fl[a])});var If=Math.random;function hA(a,b,c,d){if(!a.length)return[void 0,void 0];var e,f,g,h,i=Float64Array.from(fA(a,d)),j=i.length,k=b;for(g=0,h=Array(k);g<k;++g){for(e=0,f=0;f<j;++f)e+=i[~~(If()*j)];h[g]=e/j}return h.sort(Ej),[mn(h,c/2),mn(h,1-c/2)]}function iA(a,b,c,d){d=d||(m=>m);let e,f=0,g=1,h=a.length,i=new Float64Array(h),j=d(a[0]),k=j,l=j+b;for(;g<h;++g){if(e=d(a[g]),e>=l){for(k=(j+k)/2;f<g;++f)i[f]=k;l=e+b,j=e}k=e}for(k=(j+k)/2;f<g;++f)i[f]=k;return c?function(m,n){let o,p,q=m.length,s=0,r=1;for(;m[s]===m[r];)++r;for(;r<q;){for(o=r+1;m[r]===m[o];)++o;if(m[r]-m[r-1]<n){for(p=r+(s+o-r-r>>1);p<r;)m[p++]=m[r];for(;p>r;)m[p--]=m[s]}s=r,r=o}return m}(i,b+b/4):i}const jA=Math.sqrt(2*Math.PI),YN=Math.SQRT2;let hl=NaN;function wn(a,b){a=a||0,b=null==b?1:b;let c,d,e=0,f=0;if(hl==hl)e=hl,hl=NaN;else{do e=2*If()-1,f=2*If()-1,c=e*e+f*f;while(0===c||c>1);d=Math.sqrt(-2*Math.log(c)/c),e*=d,hl=f*d}return a+e*b}function Sr(a,b,c){const d=(a-(b||0))/(c=null==c?1:c);return Math.exp(-.5*d*d)/(c*jA)}function xn(a,b,c){let d,e=(a-(b=b||0))/(c=null==c?1:c),f=Math.abs(e);if(f>37)d=0;else{let g,h=Math.exp(-f*f/2);f<7.07106781186547?(g=.0352624965998911*f+.700383064443688,g=g*f+6.37396220353165,g=g*f+33.912866078383,g=g*f+112.079291497871,g=g*f+221.213596169931,g=g*f+220.206867912376,d=h*g,g=.0883883476483184*f+1.75566716318264,g=g*f+16.064177579207,g=g*f+86.7807322029461,g=g*f+296.564248779674,g=g*f+637.333633378831,g=g*f+793.826512519948,g=g*f+440.413735824752,d/=g):(g=f+.65,g=f+4/g,g=f+3/g,g=f+2/g,g=f+1/g,d=h/g/2.506628274631)}return e>0?1-d:d}function yn(a,b,c){return a<0||a>1?NaN:(b||0)+(null==c?1:c)*YN*function(d){let e,f=-Math.log((1-d)*(1+d));return f<6.25?(f-=3.125,e=-364441206401782e-35,e=e*f-16850591381820166e-35,e=128584807152564e-32+e*f,e=11157877678025181e-33+e*f,e=e*f-1333171662854621e-31,e=20972767875968562e-33+e*f,e=6637638134358324e-30+e*f,e=e*f-4054566272975207e-29,e=e*f-8151934197605472e-29,e=26335093153082323e-28+e*f,e=e*f-12975133253453532e-27,e=e*f-5415412054294628e-26,e=10512122733215323e-25+e*f,e=e*f-4112633980346984e-24,e=e*f-29070369957882005e-24,e=42347877827932404e-23+e*f,e=e*f-13654692000834679e-22,e=e*f-13882523362786469e-21,e=.00018673420803405714+e*f,e=e*f-.000740702534166267,e=e*f-.006033670871430149,e=.24015818242558962+e*f,e=1.6536545626831027+e*f):f<16?(f=Math.sqrt(f)-3.25,e=22137376921775787e-25,e=9075656193888539e-23+e*f,e=e*f-27517406297064545e-23,e=18239629214389228e-24+e*f,e=15027403968909828e-22+e*f,e=e*f-4013867526981546e-21,e=29234449089955446e-22+e*f,e=12475304481671779e-21+e*f,e=e*f-47318229009055734e-21,e=6828485145957318e-20+e*f,e=24031110387097894e-21+e*f,e=e*f-.0003550375203628475,e=.0009532893797373805+e*f,e=e*f-.0016882755560235047,e=.002491442096107851+e*f,e=e*f-.003751208507569241,e=.005370914553590064+e*f,e=1.0052589676941592+e*f,e=3.0838856104922208+e*f):Number.isFinite(f)?(f=Math.sqrt(f)-5,e=-27109920616438573e-27,e=e*f-2555641816996525e-25,e=15076572693500548e-25+e*f,e=e*f-3789465440126737e-24,e=761570120807834e-23+e*f,e=e*f-1496002662714924e-23,e=2914795345090108e-23+e*f,e=e*f-6771199775845234e-23,e=22900482228026655e-23+e*f,e=e*f-99298272942317e-20,e=4526062597223154e-21+e*f,e=e*f-1968177810553167e-20,e=7599527703001776e-20+e*f,e=e*f-.00021503011930044477,e=e*f-.00013871931833623122,e=1.0103004648645344+e*f,e=4.849906401408584+e*f):e=1/0,e*d}(2*a-1)}function Tr(a,b){var c,d,e={mean:function(f){return arguments.length?(c=f||0,e):c},stdev:function(f){return arguments.length?(d=null==f?1:f,e):d},sample:()=>wn(c,d),pdf:f=>Sr(f,c,d),cdf:f=>xn(f,c,d),icdf:f=>yn(f,c,d)};return e.mean(a).stdev(b)}function Ur(a,b){var c=Tr(),d={},e=0;return d.data=function(f){return arguments.length?(a=f,e=f?f.length:0,d.bandwidth(b)):a},d.bandwidth=function(f){return arguments.length?(!(b=f)&&a&&(b=Rr(a)),d):b},d.sample=function(){return a[~~(If()*e)]+b*c.sample()},d.pdf=function(f){for(var g=0,h=0;h<e;++h)g+=c.pdf((f-a[h])/b);return g/b/e},d.cdf=function(f){for(var g=0,h=0;h<e;++h)g+=c.cdf((f-a[h])/b);return g/e},d.icdf=function(){throw Error("KDE icdf not supported.")},d.data(a)}function Vr(a,b){return a=a||0,b=null==b?1:b,Math.exp(a+wn()*b)}function Wr(a,b,c){if(a<=0)return 0;b=b||0,c=null==c?1:c;const d=(Math.log(a)-b)/c;return Math.exp(-.5*d*d)/(c*jA*a)}function Xr(a,b,c){return xn(Math.log(a),b,c)}function Yr(a,b,c){return Math.exp(yn(a,b,c))}function kA(a,b){var c,d,e={mean:function(f){return arguments.length?(c=f||0,e):c},stdev:function(f){return arguments.length?(d=null==f?1:f,e):d},sample:()=>Vr(c,d),pdf:f=>Wr(f,c,d),cdf:f=>Xr(f,c,d),icdf:f=>Yr(f,c,d)};return e.mean(a).stdev(b)}function lA(a,b){var c,d={},e=0;function f(g){var h,i=[],j=0;for(h=0;h<e;++h)j+=i[h]=null==g[h]?1:+g[h];for(h=0;h<e;++h)i[h]/=j;return i}return d.weights=function(g){return arguments.length?(c=f(b=g||[]),d):b},d.distributions=function(g){return arguments.length?(g?(e=g.length,a=g):(e=0,a=[]),d.weights(b)):a},d.sample=function(){for(var g=If(),h=a[e-1],i=c[0],j=0;j<e-1;i+=c[++j])if(g<i){h=a[j];break}return h.sample()},d.pdf=function(g){for(var h=0,i=0;i<e;++i)h+=c[i]*a[i].pdf(g);return h},d.cdf=function(g){for(var h=0,i=0;i<e;++i)h+=c[i]*a[i].cdf(g);return h},d.icdf=function(){throw Error("Mixture icdf not supported.")},d.distributions(a).weights(b)}function Zr(a,b){return null==b&&(b=null==a?1:a,a=0),a+(b-a)*If()}function _r(a,b,c){return null==c&&(c=null==b?1:b,b=0),a>=b&&a<=c?1/(c-b):0}function $r(a,b,c){return null==c&&(c=null==b?1:b,b=0),a<b?0:a>c?1:(a-b)/(c-b)}function as(a,b,c){return null==c&&(c=null==b?1:b,b=0),a>=0&&a<=1?b+a*(c-b):NaN}function mA(a,b){var c,d,e={min:function(f){return arguments.length?(c=f||0,e):c},max:function(f){return arguments.length?(d=null==f?1:f,e):d},sample:()=>Zr(c,d),pdf:f=>_r(f,c,d),cdf:f=>$r(f,c,d),icdf:f=>as(f,c,d)};return null==b&&(b=null==a?1:a,a=0),e.min(a).max(b)}function il(a,b,c,d){const e=d-a*a,f=Math.abs(e)<1e-24?0:(c-a*b)/e;return[b-f*a,f]}function zn(a,b,c,d){a=a.filter(n=>{let o=b(n),p=c(n);return null!=o&&(o=+o)>=o&&null!=p&&(p=+p)>=p}),d&&a.sort((n,o)=>b(n)-b(o));const e=a.length,f=new Float64Array(e),g=new Float64Array(e);let h,i,j,k=0,l=0,m=0;for(j of a)f[k]=h=+b(j),g[k]=i=+c(j),++k,l+=(h-l)/k,m+=(i-m)/k;for(k=0;k<e;++k)f[k]-=l,g[k]-=m;return[f,g,l,m]}function jl(a,b,c,d){let e,f,g=-1;for(let h of a)e=b(h),f=c(h),null!=e&&(e=+e)>=e&&null!=f&&(f=+f)>=f&&d(e,f,++g)}function Oj(a,b,c,d,e){let f=0,g=0;return jl(a,b,c,(h,i)=>{const j=i-e(h),k=i-d;f+=j*j,g+=k*k}),1-f/g}function bs(a,b,c){let d=0,e=0,f=0,g=0,h=0;jl(a,b,c,(k,l)=>{++h,d+=(k-d)/h,e+=(l-e)/h,f+=(k*l-f)/h,g+=(k*k-g)/h});const i=il(d,e,f,g),j=k=>i[0]+i[1]*k;return{coef:i,predict:j,rSquared:Oj(a,b,c,e,j)}}function nA(a,b,c){let d=0,e=0,f=0,g=0,h=0;jl(a,b,c,(k,l)=>{++h,k=Math.log(k),d+=(k-d)/h,e+=(l-e)/h,f+=(k*l-f)/h,g+=(k*k-g)/h});const i=il(d,e,f,g),j=k=>i[0]+i[1]*Math.log(k);return{coef:i,predict:j,rSquared:Oj(a,b,c,e,j)}}function oA(a,b,c){const[d,e,f,g]=zn(a,b,c);let h,i,j,k=0,l=0,m=0,n=0,o=0;jl(a,b,c,(r,u)=>{h=d[o++],i=Math.log(u),j=h*u,k+=(u*i-k)/o,l+=(j-l)/o,m+=(j*i-m)/o,n+=(h*j-n)/o});const[p,q]=il(l/g,k/g,m/g,n/g),s=r=>Math.exp(p+q*(r-f));return{coef:[Math.exp(p-q*f),q],predict:s,rSquared:Oj(a,b,c,g,s)}}function pA(a,b,c){let d=0,e=0,f=0,g=0,h=0,i=0;jl(a,b,c,(l,m)=>{const n=Math.log(l),o=Math.log(m);++i,d+=(n-d)/i,e+=(o-e)/i,f+=(n*o-f)/i,g+=(n*n-g)/i,h+=(m-h)/i});const j=il(d,e,f,g),k=l=>j[0]*Math.pow(l,j[1]);return j[0]=Math.exp(j[0]),{coef:j,predict:k,rSquared:Oj(a,b,c,h,k)}}function cs(a,b,c){const[d,e,f,g]=zn(a,b,c),h=d.length;let i,j,k,l,m=0,n=0,o=0,p=0,q=0;for(i=0;i<h;)j=d[i],k=e[i++],l=j*j,m+=(l-m)/i,n+=(l*j-n)/i,o+=(l*l-o)/i,p+=(j*k-p)/i,q+=(l*k-q)/i;const s=o-m*m,r=m*s-n*n,u=(q*m-p*n)/r,t=(p*s-q*n)/r,w=-u*m,x=z=>u*(z-=f)*z+t*z+w+g;return{coef:[w-t*f+u*f*f+g,t-2*u*f,u],predict:x,rSquared:Oj(a,b,c,g,x)}}function qA(a,b,c,d){if(1===d)return bs(a,b,c);if(2===d)return cs(a,b,c);const[e,f,g,h]=zn(a,b,c),i=e.length,j=[],k=[],l=d+1;let m,n,o,p,q;for(m=0;m<l;++m){for(o=0,p=0;o<i;++o)p+=Math.pow(e[o],m)*f[o];for(j.push(p),q=new Float64Array(l),n=0;n<l;++n){for(o=0,p=0;o<i;++o)p+=Math.pow(e[o],m+n);q[n]=p}k.push(q)}k.push(j);const s=function(u){const t=u.length-1,w=[];let x,z,A,B,I;for(x=0;x<t;++x){for(B=x,z=x+1;z<t;++z)Math.abs(u[x][z])>Math.abs(u[x][B])&&(B=z);for(A=x;A<t+1;++A)I=u[A][x],u[A][x]=u[A][B],u[A][B]=I;for(z=x+1;z<t;++z)for(A=t;A>=x;A--)u[A][z]-=u[A][x]*u[x][z]/u[x][x]}for(z=t-1;z>=0;--z){for(I=0,A=z+1;A<t;++A)I+=u[A][z]*w[A];w[z]=(u[t][z]-I)/u[z][z]}return w}(k),r=u=>{u-=g;let t=h+s[0]+s[1]*u+s[2]*u*u;for(m=3;m<l;++m)t+=s[m]*Math.pow(u,m);return t};return{coef:ZN(l,s,-g,h),predict:r,rSquared:Oj(a,b,c,h,r)}}function ZN(a,b,c,d){const e=Array(a);let f,g,h,i;for(f=0;f<a;++f)e[f]=0;for(f=a-1;f>=0;--f)for(h=b[f],i=1,e[f]+=h,g=1;g<=f;++g)i*=(f+1-g)/g,e[f-g]+=h*Math.pow(c,g)*i;return e[0]+=d,e}function rA(a,b,c,d){const[e,f,g,h]=zn(a,b,c,!0),i=e.length,j=Math.max(2,~~(d*i)),k=new Float64Array(i),l=new Float64Array(i),m=new Float64Array(i).fill(1);for(let n=-1;++n<=2;){const o=[0,j-1];for(let q=0;q<i;++q){const s=e[q],r=o[0],u=o[1],t=s-e[r]>e[u]-s?r:u;let w=0,x=0,z=0,A=0,B=0,I=1/Math.abs(e[t]-s||1);for(let O=r;O<=u;++O){const K=e[O],Q=f[O],V=_N(Math.abs(s-K)*I)*m[O],$=K*V;w+=V,x+=$,z+=Q*V,A+=Q*$,B+=K*$}const[J,D]=il(x/w,z/w,A/w,B/w);k[q]=J+D*s,l[q]=Math.abs(f[q]-k[q]),$N(e,q+1,o)}if(2===n)break;const p=Uy(l);if(Math.abs(p)<1e-12)break;for(let q,s,r=0;r<i;++r)q=l[r]/(6*p),m[r]=q>=1?1e-12:(s=1-q*q)*s}return function(n,o,p,q){const s=n.length,r=[];let u,t=0,w=0,x=[];for(;t<s;++t)u=n[t]+p,x[0]===u?x[1]+=(o[t]-x[1])/++w:(w=0,x[1]+=q,x=[u,o[t]],r.push(x));return x[1]+=q,r}(e,k,g,h)}function _N(a){return(a=1-a*a*a)*a*a}function $N(a,b,c){let d=a[b],e=c[0],f=c[1]+1;if(!(f>=a.length))for(;b>e&&a[f]-d<=d-a[e];)c[0]=++e,c[1]=f,++f}const aO=.1*Math.PI/180;function An(a,b,c,d){c=c||25,d=Math.max(c,d||200);const e=n=>[n,a(n)],f=b[0],g=b[1],h=g-f,i=h/d,j=[e(f)],k=[];if(c===d){for(let n=1;n<d;++n)j.push(e(f+n/c*h));return j.push(e(g)),j}k.push(e(g));for(let n=c;--n>0;)k.push(e(f+n/c*h));let l=j[0],m=k[k.length-1];for(;m;){const n=e((l[0]+m[0])/2);n[0]-l[0]>=i&&bO(l,n,m)>aO?k.push(n):(l=m,j.push(m),k.pop()),m=k[k.length-1]}return j}function bO(a,b,c){const d=Math.atan2(c[1]-a[1],c[0]-a[0]),e=Math.atan2(b[1]-a[1],b[0]-a[0]);return Math.abs(d-e)}function ds(a){this._key=a?ce(a):hb,this.reset()}var fe=ds.prototype;function Mi(a){ia.call(this,null,a),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}fe.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},fe.add=function(a){this._add.push(a)},fe.rem=function(a){this._rem.push(a)},fe.values=function(){if(this._get=null,0===this._rem.length)return this._add;var a,b,c,d=this._add,e=this._rem,f=this._key,g=d.length,h=e.length,i=Array(g-h),j={};for(a=0;a<h;++a)j[f(e[a])]=1;for(a=0,b=0;a<g;++a)j[f(c=d[a])]?j[f(c)]=0:i[b++]=c;return this._rem=[],this._add=i},fe.distinct=function(a){for(var b,c=this.values(),d=c.length,e={},f=0;--d>=0;)db(e,b=a(c[d])+"")||(e[b]=1,++f);return f},fe.extent=function(a){if(this._get!==a||!this._ext){var b=this.values(),c=function(d,e){var f,g,h,i,j,k=-1,l=d.length;if(null==e){for(;++k<l;)if(null!=(g=d[k])&&g>=g){f=h=g;break}if(k===l)return[-1,-1];for(i=j=k;++k<l;)null!=(g=d[k])&&(f>g&&(f=g,i=k),h<g&&(h=g,j=k))}else{for(;++k<l;)if(null!=(g=e(d[k],k,d))&&g>=g){f=h=g;break}if(k===l)return[-1,-1];for(i=j=k;++k<l;)null!=(g=e(d[k],k,d))&&(f>g&&(f=g,i=k),h<g&&(h=g,j=k))}return[i,j]}(b,a);this._ext=[b[c[0]],b[c[1]]],this._get=a}return this._ext},fe.argmin=function(a){return this.extent(a)[0]||{}},fe.argmax=function(a){return this.extent(a)[1]||{}},fe.min=function(a){var b=this.extent(a)[0];return null!=b?a(b):void 0},fe.max=function(a){var b=this.extent(a)[1];return null!=b?a(b):void 0},fe.quartile=function(a){return this._get===a&&this._q||(this._q=Qr(this.values(),a),this._get=a),this._q},fe.q1=function(a){return this.quartile(a)[0]},fe.q2=function(a){return this.quartile(a)[1]},fe.q3=function(a){return this.quartile(a)[2]},fe.ci=function(a){return this._get===a&&this._ci||(this._ci=hA(this.values(),1e3,.05,a),this._get=a),this._ci},fe.ci0=function(a){return this.ci(a)[0]},fe.ci1=function(a){return this.ci(a)[1]},Mi.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:gl},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var Jf=Da(Mi,ia);Jf.transform=function(a,b){var c=this,d=b.fork(b.NO_SOURCE|b.NO_FIELDS),e=a.modified();return c.stamp=d.stamp,c.value&&(e||b.modified(c._inputs,!0))?(c._prev=c.value,c.value=e?c.init(a):{},b.visit(b.SOURCE,f=>c.add(f))):(c.value=c.value||c.init(a),b.visit(b.REM,f=>c.rem(f)),b.visit(b.ADD,f=>c.add(f))),d.modifies(c._outputs),c._drop=!1!==a.drop,a.cross&&c._dims.length>1&&(c._drop=!1,c.cross()),b.clean()&&c._drop&&d.clean(!0).runAfter(()=>this.clean()),c.changes(d)},Jf.cross=function(){var a=this,b=a.value,c=a._dnames,d=c.map(function(){return{}}),e=c.length;function f(g){var h,i,j,k;for(h in g)for(j=g[h].tuple,i=0;i<e;++i)d[i][k=j[c[i]]]=k}f(a._prev),f(b),function g(h,i,j){var k,l,m=c[j],n=d[j++];for(k in n)i[m]=n[k],l=h?h+"|"+k:k,j<e?g(l,i,j):b[l]||a.cell(l,i)}("",{},0)},Jf.init=function(a){var b=this._inputs=[],c=this._outputs=[],d={};function e(q){for(var s,r=Ra(ed(q)),u=0,t=r.length;u<t;++u)d[s=r[u]]||(d[s]=1,b.push(s))}this._dims=Ra(a.groupby),this._dnames=this._dims.map(function(q){var s=gb(q);return e(q),c.push(s),s}),this.cellkey=a.key?a.key:Nr(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var f,g,h,i,j,k,l=a.fields||[null],m=a.ops||["count"],n=a.as||[],o=l.length,p={};for(o!==m.length&&ja("Unmatched number of fields and aggregate ops."),k=0;k<o;++k)f=l[k],g=m[k],null==f&&"count"!==g&&ja("Null aggregate field specified."),j=bA(g,i=gb(f),n[k]),c.push(j),"count"!==g?((h=p[i])||(e(f),(h=p[i]=[]).field=f,this._measures.push(h)),"count"!==g&&(this._countOnly=!1),h.push(cA(g,j))):this._counts.push(j);return this._measures=this._measures.map(function(q){return eA(q,q.field)}),{}},Jf.cellkey=Nr(),Jf.cell=function(a,b){var c=this.value[a];return c?0===c.num&&this._drop&&c.stamp<this.stamp?(c.stamp=this.stamp,this._adds[this._alen++]=c):c.stamp<this.stamp&&(c.stamp=this.stamp,this._mods[this._mlen++]=c):(c=this.value[a]=this.newcell(a,b),this._adds[this._alen++]=c),c},Jf.newcell=function(a,b){var c={key:a,num:0,agg:null,tuple:this.newtuple(b,this._prev&&this._prev[a]),stamp:this.stamp,store:!1};if(!this._countOnly){var d,e=this._measures,f=e.length;for(c.agg=Array(f),d=0;d<f;++d)c.agg[d]=new e[d](c)}return c.store&&(c.data=new ds()),c},Jf.newtuple=function(a,b){var c,d,e=this._dnames,f=this._dims,g={};for(c=0,d=f.length;c<d;++c)g[e[c]]=f[c](a);return b?Fy(b.tuple,g):Ac(g)},Jf.clean=function(){const a=this.value;for(const b in a)0===a[b].num&&delete a[b]},Jf.add=function(a){var b,c,d,e=this.cellkey(a),f=this.cell(e,a);if(f.num+=1,!this._countOnly)for(f.store&&f.data.add(a),c=0,d=(b=f.agg).length;c<d;++c)b[c].add(b[c].get(a),a)},Jf.rem=function(a){var b,c,d,e=this.cellkey(a),f=this.cell(e,a);if(f.num-=1,!this._countOnly)for(f.store&&f.data.rem(a),c=0,d=(b=f.agg).length;c<d;++c)b[c].rem(b[c].get(a),a)},Jf.celltuple=function(a){var b,c,d,e=a.tuple,f=this._counts;for(a.store&&a.data.values(),c=0,d=f.length;c<d;++c)e[f[c]]=a.num;if(!this._countOnly)for(c=0,d=(b=a.agg).length;c<d;++c)b[c].set(e);return e},Jf.changes=function(a){var b,c,d,e,f=this._adds,g=this._mods,h=this._prev,i=this._drop,j=a.add,k=a.rem,l=a.mod;if(h)for(c in h)b=h[c],i&&!b.num||k.push(b.tuple);for(d=0,e=this._alen;d<e;++d)j.push(this.celltuple(f[d])),f[d]=null;for(d=0,e=this._mlen;d<e;++d)(0===(b=g[d]).num&&i?k:l).push(this.celltuple(b)),g[d]=null;return this._alen=this._mlen=0,this._prev=null,a};function es(a){ia.call(this,null,a)}es.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var sA=Da(es,ia);function tA(a,b,c){var d=a,e=b||[],f=c||[],g={},h=0;return{add:function(i){f.push(i)},remove:function(i){g[d(i)]=++h},size:function(){return e.length},data:function(i,j){return h&&(e=e.filter(function(k){return!g[d(k)]}),g={},h=0),j&&i&&e.sort(i),f.length&&(e=i?function(k,l,m,n){var o=l.length,p=m.length;if(!p)return l;if(!o)return m;for(var q=n||new l.constructor(o+p),s=0,r=0,u=0;s<o&&r<p;++u)q[u]=k(l[s],m[r])>0?m[r++]:l[s++];for(;s<o;++s,++u)q[u]=l[s];for(;r<p;++r,++u)q[u]=m[r];return q}(i,e,f.sort(i)):e.concat(f),f=[]),e}}}function fs(a){ia.call(this,[],a)}function uA(a){Zc.call(this,null,cO,a)}function cO(a){return this.value&&!a.modified()?this.value:Sk(a.fields,a.orders)}function gs(a){ia.call(this,null,a)}sA.transform=function(a,b){var c,d=!1!==a.interval,e=this._bins(a),f=e.start,g=e.step,h=a.as||["bin0","bin1"],i=h[0],j=h[1];return c=a.modified()?(b=b.reflow(!0)).SOURCE:b.modified(ed(a.field))?b.ADD_MOD:b.ADD,b.visit(c,d?function(k){var l=e(k);k[i]=l,k[j]=null==l?null:f+g*(1+(l-f)/g)}:function(k){k[i]=e(k)}),b.modifies(d?h:i)},sA._bins=function(a){if(this.value&&!a.modified())return this.value;var b,c,d=a.field,e=gA(a),f=e.step,g=e.start,h=g+Math.ceil((e.stop-g)/f)*f;null!=(b=a.anchor)&&(c=b-(g+f*Math.floor((b-g)/f)),g+=c,h+=c);var i=function(j){var k=Eb(d(j));return null==k?null:k<g?-1/0:k>h?1/0:(k=Math.max(g,Math.min(k,h-f)),g+f*Math.floor(1e-14+(k-g)/f))};return i.start=g,i.stop=e.stop,i.step=f,this.value=Zb(i,ed(d),a.name||"bin_"+gb(d))},fs.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Da(fs,ia).transform=function(a,b){var c=b.fork(b.ALL),d=tA(hb,this.value,c.materialize(c.ADD).add),e=a.sort,f=b.changed()||e&&(a.modified("sort")||b.modified(e.fields));return c.visit(c.REM,d.remove),this.modified(f),this.value=c.source=d.data(Di(e),f),b.source&&b.source.root&&(this.value.root=b.source.root),c},Da(uA,Zc),gs.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var hs=Da(gs,ia);function is(a){ia.call(this,null,a)}hs.transform=function(a,b){function c(l){return function(m){for(var n,o=function(s,r,u){switch(r){case"upper":s=s.toUpperCase();break;case"lower":s=s.toLowerCase()}return s.match(u)}(h(m),a.case,f)||[],p=0,q=o.length;p<q;++p)g.test(n=o[p])||l(n)}}var d=this._parameterCheck(a,b),e=this._counts,f=this._match,g=this._stop,h=a.field,i=a.as||["text","count"],j=c(function(l){e[l]=1+(e[l]||0)}),k=c(function(l){e[l]-=1});return d?b.visit(b.SOURCE,j):(b.visit(b.ADD,j),b.visit(b.REM,k)),this._finish(b,i)},hs._parameterCheck=function(a,b){var c=!1;return!a.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(a.stopwords||"")+"$","i"),c=!0),!a.modified("pattern")&&this._match||(this._match=new RegExp(a.pattern||"[\\w']+","g"),c=!0),(a.modified("field")||b.modified(a.field.fields))&&(c=!0),c&&(this._counts={}),c},hs._finish=function(a,b){var c,d,e,f=this._counts,g=this._tuples||(this._tuples={}),h=b[0],i=b[1],j=a.fork(a.NO_SOURCE|a.NO_FIELDS);for(c in f)d=g[c],e=f[c]||0,!d&&e?(g[c]=d=Ac({}),d[h]=c,d[i]=e,j.add.push(d)):0===e?(d&&j.rem.push(d),f[c]=null,g[c]=null):d[i]!==e&&(d[i]=e,j.mod.push(d));return j.modifies(b)},is.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Da(is,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE),d=this.value,e=a.as||["a","b"],f=e[0],g=e[1];return!d||b.changed(b.ADD_REM)||a.modified("as")||a.modified("filter")?(d&&(c.rem=d),d=b.materialize(b.SOURCE).source,c.add=this.value=function(h,i,j,k){for(var l,m,n=[],o={},p=h.length,q=0;q<p;++q)for(o[i]=m=h[q],l=0;l<p;++l)o[j]=h[l],k(o)&&(n.push(Ac(o)),(o={})[i]=m);return n}(d,f,g,a.filter||de)):c.mod=d,c.source=this.value,c.modifies(e)};var vA={kde:Ur,mixture:lA,normal:Tr,lognormal:kA,uniform:mA};function js(a){ia.call(this,null,a)}var wA=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],dO={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:wA},{name:"weights",type:"number",array:!0}]};function xA(a,b){return a?a.map(function(c,d){return b[d]||gb(c)}):null}function ks(a,b,c){var d,e,f,g,h,i,j=[],k=function(l){return l(g)};if(null==b)j.push(a.map(c));else for(d={},e=0,f=a.length;e<f;++e)g=a[e],(i=d[h=b.map(k)])||(d[h]=i=[],i.dims=h,j.push(i)),i.push(c(g));return j}js.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:wA.concat(dO)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Da(js,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE|b.NO_FIELDS);if(!this.value||b.changed()||a.modified()){var d=function j(k,l){var m=k.function;db(vA,m)||ja("Unknown distribution function: "+m);var n=vA[m]();for(var o in k)"field"===o?n.data((k.from||l()).map(k[o])):"distributions"===o?n[o](k[o].map(function(p){return j(p,l)})):"function"==typeof n[o]&&n[o](k[o]);return n}(a.distribution,function(j){return function(){return j.materialize(j.SOURCE).source}}(b)),e=a.steps||a.minsteps||25,f=a.steps||a.maxsteps||200,g=a.method||"pdf";"pdf"!==g&&"cdf"!==g&&ja("Invalid density method: "+g),a.extent||d.data||ja("Missing density extent parameter."),g=d[g];var h=a.as||["value","density"],i=An(g,a.extent||dh(d.data()),e,f).map(j=>{var k={};return k[h[0]]=j[0],k[h[1]]=j[1],Ac(k)});this.value&&(c.rem=this.value),this.value=c.add=c.source=i}return c};function ls(a){ia.call(this,null,a)}ls.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function yA(a){Zc.call(this,null,eO,a),this.modified(!0)}function eO(a){var b=a.expr;return this.value&&!a.modified("expr")?this.value:Zb(c=>b(c,a),ed(b),gb(b))}function ms(a){ia.call(this,[void 0,void 0],a)}function ns(a,b){Zc.call(this,a),this.parent=b,this.count=0}Da(ls,ia).transform=function(a,b){if(this.value&&!a.modified()&&!b.changed())return b;const c=b.materialize(b.SOURCE).source,d=ks(b.source,a.groupby,fc),e=a.smooth||!1,f=a.field,g=a.step||function(o,p){return an(dh(o,p))/30}(c,f),h=Di((o,p)=>f(o)-f(p)),i=a.as||"bin",j=d.length;let k,l=1/0,m=-1/0,n=0;for(;n<j;++n){const o=d[n].sort(h);k=-1;for(const p of iA(o,g,e,f))p<l&&(l=p),p>m&&(m=p),o[++k][i]=p}return this.value={start:l,stop:m,step:g},b.reflow(!0).modifies(i)},Da(yA,Zc),ms.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Da(ms,ia).transform=function(a,b){var c,d=this.value,e=a.field,f=d[0],g=d[1];if(((c=b.changed()||b.modified(e.fields)||a.modified("field"))||null==f)&&(f=1/0,g=-1/0),b.visit(c?b.SOURCE:b.ADD,function(h){var i=Eb(e(h));null!=i&&(i<f&&(f=i),i>g&&(g=i))}),!Number.isFinite(f)||!Number.isFinite(g)){let h=gb(e);h&&(h=` for field "${h}"`),b.dataflow.warn(`Infinite extent${h}: [${f}, ${g}]`),f=g=void 0}this.value=[f,g]};var Pj=Da(ns,Zc);function Bn(a){ia.call(this,{},a),this._keys=Tk();const b=this._targets=[];b.active=0,b.forEach=c=>{for(let d=0,e=b.active;d<e;++d)c(b[d],d,b)}}Pj.connect=function(a){return this.detachSubflow=a.detachSubflow,this.targets().add(a),a.source=this},Pj.add=function(a){this.count+=1,this.value.add.push(a)},Pj.rem=function(a){this.count-=1,this.value.rem.push(a)},Pj.mod=function(a){this.value.mod.push(a)},Pj.init=function(a){this.value.init(a,a.NO_SOURCE)},Pj.evaluate=function(){return this.value};const kl=Da(Bn,ia);function zA(a){Zc.call(this,null,fO,a)}function fO(a){return this.value&&!a.modified()?this.value:U(a.name)?Ra(a.name).map(function(b){return ce(b)}):ce(a.name,a.as)}function os(a){ia.call(this,Tk(),a)}function ps(a){ia.call(this,[],a)}function qs(a){ia.call(this,[],a)}function rs(a){ia.call(this,null,a)}function AA(a){ia.call(this,[],a)}kl.activate=function(a){this._targets[this._targets.active++]=a},kl.subflow=function(a,b,c,d){let e,f,g=this.value,h=db(g,a)&&g[a];return h?h.value.stamp<c.stamp&&(h.init(c),this.activate(h)):(f=d||(f=this._group[a])&&f.tuple,e=c.dataflow,h=new ns(c.fork(c.NO_SOURCE),this),e.add(h).connect(b(e,a,f)),g[a]=h,this.activate(h)),h},kl.clean=function(){const a=this.value;for(const b in a)if(0===a[b].count){const c=a[b].detachSubflow;c&&c(),delete a[b]}},kl.initTargets=function(){const a=this._targets,b=a.length;for(let c=0;c<b&&null!=a[c];++c)a[c]=null;a.active=0},kl.transform=function(a,b){const c=b.dataflow,d=a.key,e=a.subflow,f=this._keys,g=a.modified("key"),h=i=>this.subflow(i,e,b);return this._group=a.group||{},this.initTargets(),b.visit(b.REM,i=>{const j=hb(i),k=f.get(j);void 0!==k&&(f.delete(j),h(k).rem(i))}),b.visit(b.ADD,i=>{const j=d(i);f.set(hb(i),j),h(j).add(i)}),g||b.modified(d.fields)?b.visit(b.MOD,i=>{const j=hb(i),k=f.get(j),l=d(i);k===l?h(l).mod(i):(f.set(j,l),h(k).rem(i),h(l).add(i))}):b.changed(b.MOD)&&b.visit(b.MOD,i=>{h(f.get(hb(i))).mod(i)}),g&&b.visit(b.REFLOW,i=>{const j=hb(i),k=f.get(j),l=d(i);k!==l&&(f.set(j,l),h(k).rem(i),h(l).add(i))}),b.clean()?c.runAfter(()=>{this.clean(),f.clean()}):f.empty>c.cleanThreshold&&c.runAfter(f.clean),b},Da(zA,Zc),os.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Da(os,ia).transform=function(a,b){var c=b.dataflow,d=this.value,e=b.fork(),f=e.add,g=e.rem,h=e.mod,i=a.expr,j=!0;function k(l){var m=hb(l),n=i(l,a),o=d.get(m);n&&o?(d.delete(m),f.push(l)):n||o?j&&n&&!o&&h.push(l):(d.set(m,1),g.push(l))}return b.visit(b.REM,function(l){var m=hb(l);d.has(m)?d.delete(m):g.push(l)}),b.visit(b.ADD,function(l){i(l,a)?f.push(l):d.set(hb(l),1)}),b.visit(b.MOD,k),a.modified()&&(j=!1,b.visit(b.REFLOW,k)),d.empty>c.cleanThreshold&&c.runAfter(d.clean),e},ps.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Da(ps,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE),d=a.fields,e=xA(d,a.as||[]),f=a.index||null,g=e.length;return c.rem=this.value,b.visit(b.SOURCE,function(h){for(var i,j,k,l=d.map(o=>o(h)),m=l.reduce((o,p)=>Math.max(o,p.length),0),n=0;n<m;++n){for(j=Xq(h),i=0;i<g;++i)j[e[i]]=null==(k=l[i][n])?null:k;f&&(j[f]=n),c.add.push(j)}}),this.value=c.source=c.add,f&&c.modifies(f),c.modifies(e)},qs.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Da(qs,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE),d=a.fields,e=d.map(gb),f=a.as||["key","value"],g=f[0],h=f[1],i=d.length;return c.rem=this.value,b.visit(b.SOURCE,function(j){for(var k,l=0;l<i;++l)(k=Xq(j))[g]=e[l],k[h]=d[l](j),c.add.push(k)}),this.value=c.source=c.add,c.modifies(f)},rs.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Da(rs,ia).transform=function(a,b){var c=a.expr,d=a.as,e=a.modified(),f=a.initonly?b.ADD:e?b.SOURCE:b.modified(c.fields)||b.modified(d)?b.ADD_MOD:b.ADD;return e&&(b=b.materialize().reflow(!0)),a.initonly||b.modifies(d),b.visit(f,g=>g[d]=c(g,a))},Da(AA,ia).transform=function(a,b){var c,d,e,f=this.value,g=b.fork(b.ALL),h=a.size-f.length,i=a.generator;if(h>0){for(c=[];--h>=0;)c.push(e=Ac(i(a))),f.push(e);g.add=g.add.length?g.materialize(g.ADD).add.concat(c):c}else d=f.slice(0,-h),g.rem=g.rem.length?g.materialize(g.REM).rem.concat(d):d,f=f.slice(-h);return g.source=this.value=f,g};var Cn={value:"value",median:Uy,mean:function(a,b){let c=0,d=0;if(void 0===b)for(let e of a)null!=e&&(e=+e)>=e&&(++c,d+=e);else{let e=-1;for(let f of a)null!=(f=b(f,++e,a))&&(f=+f)>=f&&(++c,d+=f)}if(c)return d/c},min:hr,max:Gi},gO=[];function ss(a){ia.call(this,[],a)}function ts(a){Mi.call(this,a)}ss.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Da(ss,ia).transform=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=b.fork(b.ALL),n=function(x){var z,A=x.method||Cn.value;if(null!=Cn[A])return A===Cn.value?(z=void 0!==x.value?x.value:0,function(){return z}):Cn[A];ja("Unrecognized imputation method: "+A)}(a),o=function(x){var z=x.field;return function(A){return A?z(A):NaN}}(a),p=gb(a.field),q=gb(a.key),s=(a.groupby||[]).map(gb),r=function(x,z,A,B){var I,J,D,O,K,Q,V,$,Ia=function(Za){return Za($)},wa=[],xa=B?B.slice():[],oa={},Ma={};for(xa.forEach(function(Za,Pa){oa[Za]=Pa+1}),O=0,V=x.length;O<V;++O)$=x[O],Q=A($),K=oa[Q]||(oa[Q]=xa.push(Q)),J=(I=z?z.map(Ia):gO)+"",(D=Ma[J])||(D=Ma[J]=[],wa.push(D),D.values=I),D[K-1]=$;return wa.domain=xa,wa}(b.source,a.groupby,a.key,a.keyvals),u=[],t=this.value,w=r.domain.length;for(g=0,j=r.length;g<j;++g)for(e=(c=r[g]).values,d=NaN,i=0;i<w;++i)if(null==c[i]){for(f=r.domain[i],l={_impute:!0},h=0,k=e.length;h<k;++h)l[s[h]]=e[h];l[q]=f,l[p]=Number.isNaN(d)?d=n(c,o):d,u.push(Ac(l))}return u.length&&(m.add=m.materialize(m.ADD).add.concat(u)),t.length&&(m.rem=m.materialize(m.REM).rem.concat(t)),this.value=u,m},ts.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:gl},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var BA=Da(ts,Mi);function us(a){ia.call(this,null,a)}function CA(a){Zc.call(this,null,hO,a)}function hO(a){return this.value&&!a.modified()?this.value:zy(a.fields,a.flat)}function DA(a){ia.call(this,[],a),this._pending=null}function vs(a,b,c){c.forEach(Ac);const d=b.fork(b.NO_FIELDS&b.NO_SOURCE);return d.rem=a.value,a.value=d.source=d.add=c,a._pending=null,d.rem.length&&d.clean(!0),d}function ws(a){ia.call(this,{},a)}function EA(a){Zc.call(this,null,iO,a)}function iO(a){if(this.value&&!a.modified())return this.value;var b,c,d,e=1/0,f=-1/0,g=a.extents;for(b=0,c=g.length;b<c;++b)(d=g[b])[0]<e&&(e=d[0]),d[1]>f&&(f=d[1]);return[e,f]}function FA(a){Zc.call(this,null,jO,a)}function jO(a){return this.value&&!a.modified()?this.value:a.values.reduce(function(b,c){return b.concat(c)},[])}function xs(a){ia.call(this,null,a)}function ys(a){Mi.call(this,a)}BA.transform=function(a,b){var c,d=this,e=a.modified();return d.value&&(e||b.modified(d._inputs,!0))?(c=d.value=e?d.init(a):{},b.visit(b.SOURCE,function(f){d.add(f)})):(c=d.value=d.value||this.init(a),b.visit(b.REM,function(f){d.rem(f)}),b.visit(b.ADD,function(f){d.add(f)})),d.changes(),b.visit(b.SOURCE,function(f){Mb(f,c[d.cellkey(f)].tuple)}),b.reflow(e).modifies(this._outputs)},BA.changes=function(){var a,b,c=this._adds,d=this._mods;for(a=0,b=this._alen;a<b;++a)this.celltuple(c[a]),c[a]=null;for(a=0,b=this._mlen;a<b;++a)this.celltuple(d[a]),d[a]=null;this._alen=this._mlen=0},us.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Da(us,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE|b.NO_FIELDS);if(!this.value||b.changed()||a.modified()){const d=b.materialize(b.SOURCE).source,e=ks(d,a.groupby,a.field),f=(a.groupby||[]).map(gb),g=a.bandwidth,h=a.cumulative?"cdf":"pdf",i=a.as||["value","density"],j=[];let k=a.extent,l=a.steps||a.minsteps||25,m=a.steps||a.maxsteps||200;"pdf"!==h&&"cdf"!==h&&ja("Invalid density method: "+h),"shared"===a.resolve&&(k||(k=dh(d,a.field)),l=m=a.steps||m),e.forEach(n=>{const o=Ur(n,g)[h],p=a.counts?n.length:1;An(o,k||dh(n),l,m).forEach(q=>{const s={};for(let r=0;r<f.length;++r)s[f[r]]=n.dims[r];s[i[0]]=q[0],s[i[1]]=q[1]*p,j.push(Ac(s))})}),this.value&&(c.rem=this.value),this.value=c.add=c.source=j}return c},Da(CA,Zc),Da(DA,ia).transform=function(a,b){const c=b.dataflow;return this._pending?vs(this,b,this._pending):function(d){return d.modified("async")&&!(d.modified("values")||d.modified("url")||d.modified("format"))}(a)?b.StopPropagation:a.values?vs(this,b,c.parse(a.values,a.format)):a.async?{async:c.request(a.url,a.format).then(d=>(this._pending=Ra(d.data),e=>e.touch(this)))}:c.request(a.url,a.format).then(d=>vs(this,b,Ra(d.data)))},ws.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Da(ws,ia).transform=function(a,b){var c,d,e=b,f=a.as,g=a.fields,h=a.index,i=a.values,j=null==a.default?null:a.default,k=a.modified(),l=k?b.SOURCE:b.ADD,m=g.length;return i?(d=i.length,m>1&&!f&&ja('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==m*d&&ja('The "as" parameter has too few output field names.'),f=f||i.map(gb),c=function(n){for(var o,p,q=0,s=0;q<m;++q)if(null==(p=h.get(g[q](n))))for(o=0;o<d;++o,++s)n[f[s]]=j;else for(o=0;o<d;++o,++s)n[f[s]]=i[o](p)}):(f||ja("Missing output field names."),c=function(n){for(var o,p=0;p<m;++p)o=h.get(g[p](n)),n[f[p]]=null==o?j:o}),k?e=b.reflow(!0):l|=g.some(function(n){return b.modified(n.fields)})?b.MOD:0,b.visit(l,c),e.modifies(f)},Da(EA,Zc),Da(FA,Zc),Da(xs,ia),xs.prototype.transform=function(a,b){return this.modified(a.modified()),this.value=a,b.fork(b.NO_SOURCE|b.NO_FIELDS)},ys.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:gl,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var zs=Da(ys,Mi);function GA(a){Bn.call(this,a)}zs._transform=zs.transform,zs.transform=function(a,b){return this._transform(function(c,d){var e=c.field,f=c.value,g=("count"===c.op?"__count__":c.op)||"sum",h=ed(e).concat(ed(f)),i=function(j,k,l){var m={},n=[];return l.visit(l.SOURCE,function(o){var p=j(o);m[p]||(m[p]=1,n.push(p))}),n.sort(function(o,p){return(o<p||null==o)&&null!=p?-1:(o>p||null==p)&&null!=o?1:(p=p instanceof Date?+p:p,(o=o instanceof Date?+o:o)!==o&&p==p?-1:p!=p&&o==o?1:0)}),k?n.slice(0,k):n}(e,c.limit||0,d);return d.changed()&&c.set("__pivot__",null,null,!0),{key:c.key,groupby:c.groupby,ops:i.map(function(){return g}),fields:i.map(function(j){return function(k,l,m,n){return Zb(function(o){return l(o)===k?m(o):NaN},n,k+"")}(j,e,f,h)}),as:i.map(function(j){return j+""}),modified:c.modified.bind(c)}}(a,b),b)};function As(a){ia.call(this,null,a)}function HA(a){ia.call(this,null,a)}function Bs(a){ia.call(this,null,a)}Da(GA,Bn).transform=function(a,b){const c=a.subflow,d=a.field,e=f=>this.subflow(hb(f),c,b,f);return(a.modified("field")||d&&b.modified(ed(d)))&&ja("PreFacet does not support field modification."),this.initTargets(),d?(b.visit(b.MOD,f=>{const g=e(f);d(f).forEach(h=>g.mod(h))}),b.visit(b.ADD,f=>{const g=e(f);d(f).forEach(h=>g.add(Ac(h)))}),b.visit(b.REM,f=>{const g=e(f);d(f).forEach(h=>g.rem(h))})):(b.visit(b.MOD,f=>e(f).mod(f)),b.visit(b.ADD,f=>e(f).add(f)),b.visit(b.REM,f=>e(f).rem(f))),b.clean()&&b.runAfter(()=>this.clean()),b},As.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Da(As,ia).transform=function(a,b){var c,d,e=a.fields,f=xA(a.fields,a.as||[]),g=e?function(h,i){return function(j,k,l,m){for(var n=0,o=l.length;n<o;++n)k[m[n]]=l[n](j);return k}(h,i,e,f)}:Yq;return this.value?d=this.value:(b=b.addAll(),d=this.value={}),c=b.fork(b.NO_SOURCE),b.visit(b.REM,function(h){var i=hb(h);c.rem.push(d[i]),d[i]=null}),b.visit(b.ADD,function(h){var i=g(h,Ac({}));d[hb(h)]=i,c.add.push(i)}),b.visit(b.MOD,function(h){c.mod.push(g(h,d[hb(h)]))}),c},Da(HA,ia).transform=function(a,b){return this.value=a.value,a.modified("value")?b.fork(b.NO_SOURCE|b.NO_FIELDS):b.StopPropagation},Bs.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};var kO=Da(Bs,ia);function IA(a){ia.call(this,null,a)}function Cs(a){ia.call(this,[],a),this.count=0}function Ds(a){ia.call(this,null,a)}function JA(a){ia.call(this,null,a),this.modified(!0)}function Es(a){ia.call(this,null,a)}kO.transform=function(a,b){var c=b.fork(b.NO_SOURCE|b.NO_FIELDS),d=a.as||["prob","value"];if(this.value&&!a.modified()&&!b.changed())return c.source=this.value,c;const e=ks(b.materialize(b.SOURCE).source,a.groupby,a.field),f=(a.groupby||[]).map(gb),g=[],h=a.step||.01,i=a.probs||Fi(h/2,1-1e-14,h),j=i.length;return e.forEach(k=>{const l=Pr(k,i);for(let m=0;m<j;++m){const n={};for(let o=0;o<f.length;++o)n[f[o]]=k.dims[o];n[d[0]]=i[m],n[d[1]]=l[m],g.push(Ac(n))}}),this.value&&(c.rem=this.value),this.value=c.add=c.source=g,c},Da(IA,ia).transform=function(a,b){var c,d;return this.value?d=this.value:(c=b=b.addAll(),d=this.value={}),a.derive&&(c=b.fork(b.NO_SOURCE),b.visit(b.REM,e=>{var f=hb(e);c.rem.push(d[f]),d[f]=null}),b.visit(b.ADD,e=>{var f=Xq(e);d[hb(e)]=f,c.add.push(f)}),b.visit(b.MOD,e=>{var f,g=d[hb(e)];for(f in e)g[f]=e[f],c.modifies(f);c.mod.push(g)})),c},Cs.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Da(Cs,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE),d=a.modified("size"),e=a.size,f=this.value,g=this.count,h=0,i=f.reduce(function(m,n){return m[hb(n)]=1,m},{});function j(m){var n,o;f.length<e?f.push(m):(o=~~((g+1)*If()))<f.length&&o>=h&&(n=f[o],i[hb(n)]&&c.rem.push(n),f[o]=m),++g}if(b.rem.length&&(b.visit(b.REM,function(m){var n=hb(m);i[n]&&(i[n]=-1,c.rem.push(m)),--g}),f=f.filter(function(m){return-1!==i[hb(m)]})),(b.rem.length||d)&&f.length<e&&b.source&&(h=g=f.length,b.visit(b.SOURCE,function(m){i[hb(m)]||j(m)}),h=-1),d&&f.length>e){for(var k=0,l=f.length-e;k<l;++k)i[hb(f[k])]=-1,c.rem.push(f[k]);f=f.slice(l)}return b.mod.length&&b.visit(b.MOD,function(m){i[hb(m)]&&c.mod.push(m)}),b.add.length&&b.visit(b.ADD,j),(b.add.length||h<0)&&(c.add=f.filter(function(m){return!i[hb(m)]})),this.count=g,this.value=c.source=f,c},Ds.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Da(Ds,ia).transform=function(a,b){if(!this.value||a.modified()){var c=b.materialize().fork(b.MOD),d=a.as||"data";return c.rem=this.value?b.rem.concat(this.value):b.rem,this.value=Fi(a.start,a.stop,a.step||1).map(function(e){var f={};return f[d]=e,Ac(f)}),c.add=b.add.concat(this.value),c}},Da(JA,ia).transform=function(a,b){return this.value=b.source,b.changed()?b.fork(b.NO_SOURCE|b.NO_FIELDS):b.StopPropagation};const KA=["unit0","unit1"];Es.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:mr,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:KA}]};var LA=Da(Es,ia);function MA(a){ia.call(this,Tk(),a)}function NA(a){ia.call(this,null,a)}LA.transform=function(a,b){var c=a.field,d=!1!==a.interval,e="utc"===a.timezone,f=this._floor(a,b),g=(e?Kj:Jj)(f.unit).offset,h=a.as||KA,i=h[0],j=h[1],k=f.start||1/0,l=f.stop||-1/0,m=f.step,n=b.ADD;return(a.modified()||b.modified(ed(c)))&&(n=(b=b.reflow(!0)).SOURCE,k=1/0,l=-1/0),b.visit(n,function(o){var p,q,s=c(o);null==s?(o[i]=null,d&&(o[j]=null)):(o[i]=p=q=f(s),d&&(o[j]=q=g(p,m)),p<k&&(k=p),q>l&&(l=q))}),f.start=k,f.stop=l,b.modifies(d?h:i)},LA._floor=function(a,b){const c="utc"===a.timezone;let{units:d,step:e}=a.units?{units:a.units,step:a.step||1}:Ez({extent:a.extent||dh(b.materialize(b.SOURCE).source,a.field),maxbins:a.maxbins});d=or(d);const f=this.value||{},g=(c?uz:tz)(d,e);return g.unit=Ha(d),g.units=d,g.step=e,g.start=f.start,g.stop=f.stop,this.value=g},Da(MA,ia).transform=function(a,b){var c=b.dataflow,d=a.field,e=this.value,f=!0;function g(h){e.set(d(h),h)}return a.modified("field")||b.modified(d.fields)?(e.clear(),b.visit(b.SOURCE,g)):b.changed()?(b.visit(b.REM,function(h){e.delete(d(h))}),b.visit(b.ADD,g)):f=!1,this.modified(f),e.empty>c.cleanThreshold&&c.runAfter(e.clean),b.fork()},Da(NA,ia).transform=function(a,b){(!this.value||a.modified("field")||a.modified("sort")||b.changed()||a.sort&&b.modified(a.sort.fields))&&(this.value=(a.sort?b.source.slice().sort(Di(a.sort)):b.source).map(a.field))};const ll={row_number:function(){return{next:a=>a.index+1}},rank:function(){let a;return{init:()=>a=1,next:b=>{let c=b.index,d=b.data;return c&&b.compare(d[c-1],d[c])?a=c+1:a}}},dense_rank:function(){let a;return{init:()=>a=1,next:b=>{let c=b.index,d=b.data;return c&&b.compare(d[c-1],d[c])?++a:a}}},percent_rank:function(){let a=ll.rank(),b=a.next;return{init:a.init,next:c=>(b(c)-1)/(c.data.length-1)}},cume_dist:function(){let a;return{init:()=>a=0,next:b=>{let c=b.index,d=b.data,e=b.compare;if(a<c){for(;c+1<d.length&&!e(d[c],d[c+1]);)++c;a=c}return(1+a)/d.length}}},ntile:function(a,b){(b=+b)>0||ja("ntile num must be greater than zero.");let c=ll.cume_dist(),d=c.next;return{init:c.init,next:e=>Math.ceil(b*d(e))}},lag:function(a,b){return b=+b||1,{next:c=>{let d=c.index-b;return d>=0?a(c.data[d]):null}}},lead:function(a,b){return b=+b||1,{next:c=>{let d=c.index+b,e=c.data;return d<e.length?a(e[d]):null}}},first_value:function(a){return{next:b=>a(b.data[b.i0])}},last_value:function(a){return{next:b=>a(b.data[b.i1-1])}},nth_value:function(a,b){return(b=+b)>0||ja("nth_value nth must be greater than zero."),{next:c=>{let d=c.i0+(b-1);return d<c.i1?a(c.data[d]):null}}},prev_value:function(a){let b;return{init:()=>b=null,next:c=>{let d=a(c.data[c.index]);return null!=d?b=d:b}}},next_value:function(a){let b,c;return{init:()=>(b=null,c=-1),next:d=>{let e=d.data;return d.index<=c?b:(c=function(f,g,h){for(let i=g.length;h<i;++h)if(null!=f(g[h]))return h;return-1}(a,e,d.index))<0?(c=e.length,b=null):b=a(e[c])}}}};var lO=Object.keys(ll);function OA(a){let b=this,c=Ra(a.ops),d=Ra(a.fields),e=Ra(a.params),f=Ra(a.as),g=b.outputs=[],h=b.windows=[],i={},j={},k=!0,l=[],m=[];function n(o){Ra(ed(o)).forEach(p=>i[p]=1)}n(a.sort),c.forEach(function(o,p){let q=d[p],s=gb(q),r=bA(o,s,f[p]);if(n(q),g.push(r),db(ll,o))h.push(function(u,t,w,x){let z=ll[u](t,w);return{init:z.init||pe,update:function(A,B){B[x]=z.next(A)}}}(o,d[p],e[p],r));else{if(null==q&&"count"!==o&&ja("Null aggregate field specified."),"count"===o)return void l.push(r);k=!1;let u=j[s];u||(u=j[s]=[],u.field=q,m.push(u)),u.push(cA(o,r))}}),(l.length||m.length)&&(b.cell=function(o,p,q){o=o.map(x=>eA(x,x.field));let s={num:0,agg:null,store:!1,count:p};if(!q)for(var r=o.length,u=s.agg=Array(r),t=0;t<r;++t)u[t]=new o[t](s);if(s.store)var w=s.data=new ds();return s.add=function(x){if(s.num+=1,!q){w&&w.add(x);for(let z=0;z<r;++z)u[z].add(u[z].get(x),x)}},s.rem=function(x){if(s.num-=1,!q){w&&w.rem(x);for(let z=0;z<r;++z)u[z].rem(u[z].get(x),x)}},s.set=function(x){let z,A;for(w&&w.values(),z=0,A=p.length;z<A;++z)x[p[z]]=s.num;if(!q)for(z=0,A=u.length;z<A;++z)u[z].set(x)},s.init=function(){s.num=0,w&&w.reset();for(let x=0;x<r;++x)u[x].init()},s}(m,l,k)),b.inputs=Object.keys(i)}const PA=OA.prototype;function Fs(a){ia.call(this,{},a),this._mlen=0,this._mods=[]}PA.init=function(){this.windows.forEach(a=>a.init()),this.cell&&this.cell.init()},PA.update=function(a,b){let c,d=this.cell,e=this.windows,f=a.data,g=e&&e.length;if(d){for(c=a.p0;c<a.i0;++c)d.rem(f[c]);for(c=a.p1;c<a.i1;++c)d.add(f[c]);d.set(b)}for(c=0;c<g;++c)e[c].update(a,b)},Fs.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:lO.concat(gl)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var QA=Da(Fs,ia);function mO(a,b,c,d){var e=d.sort,f=e&&!d.ignorePeers,g=d.frame||[null,0],h=a.data(c),i=h.length,j=0,k=f?kn(e):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:h,compare:e||Nd(-1)};for(b.init();j<i;++j)nO(l,g,j,i),f&&oO(l,k),b.update(l,h[j])}function nO(a,b,c,d){a.p0=a.i0,a.p1=a.i1,a.i0=null==b[0]?0:Math.max(0,c-Math.abs(b[0])),a.i1=null==b[1]?d:Math.min(d,c+Math.abs(b[1])+1),a.index=c}function oO(a,b){var c=a.i0,d=a.i1-1,e=a.compare,f=a.data,g=f.length-1;c>0&&!e(f[c],f[c-1])&&(a.i0=b.left(f,f[c])),d<g&&!e(f[d],f[d+1])&&(a.i1=b.right(f,f[d]))}QA.transform=function(a,b){var c,d,e=this,f=e.state,g=a.modified(),h=Di(a.sort);this.stamp=b.stamp,f&&!g||(f=e.state=new OA(a));var i=Nr(a.groupby);function j(k){return e.group(i(k))}for(g||b.modified(f.inputs)?(e.value={},b.visit(b.SOURCE,function(k){j(k).add(k)})):(b.visit(b.REM,function(k){j(k).remove(k)}),b.visit(b.ADD,function(k){j(k).add(k)})),c=0,d=e._mlen;c<d;++c)mO(e._mods[c],f,h,a);return e._mlen=0,e._mods=[],b.reflow(g).modifies(f.outputs)},QA.group=function(a){var b=this.value[a];return b||((b=this.value[a]=tA(hb)).stamp=-1),b.stamp<this.stamp&&(b.stamp=this.stamp,this._mods[this._mlen++]=b),b};var pO=Object.freeze({__proto__:null,aggregate:Mi,bin:es,collect:fs,compare:uA,countpattern:gs,cross:is,density:js,dotbin:ls,expression:yA,extent:ms,facet:Bn,field:zA,filter:os,flatten:ps,fold:qs,formula:rs,generate:AA,impute:ss,joinaggregate:ts,kde:us,key:CA,load:DA,lookup:ws,multiextent:EA,multivalues:FA,params:xs,pivot:ys,prefacet:GA,project:As,proxy:HA,quantile:Bs,relay:IA,sample:Cs,sequence:Ds,sieve:JA,subflow:ns,timeunit:Es,tupleindex:MA,values:NA,window:Fs});const Qj="top",bg="left",cg="right",Ke="end",Rh="row";var RA=0;function Gs(a){return a&&a.gradient}function SA(a,b,c){let d=a.id,e=a.gradient,f="radial"===e?"p_":"";return d||(d=a.id="gradient_"+RA++,"radial"===e?(a.x1=Cg(a.x1,.5),a.y1=Cg(a.y1,.5),a.r1=Cg(a.r1,0),a.x2=Cg(a.x2,.5),a.y2=Cg(a.y2,.5),a.r2=Cg(a.r2,.5),f="p_"):(a.x1=Cg(a.x1,0),a.y1=Cg(a.y1,0),a.x2=Cg(a.x2,1),a.y2=Cg(a.y2,0))),b[d]=a,"url("+(c||"")+"#"+f+d+")"}function Cg(a,b){return null!=a?a:b}function TA(a,b){var c,d=[];return c={gradient:"linear",x1:a?a[0]:0,y1:a?a[1]:0,x2:b?b[0]:1,y2:b?b[1]:0,stops:d,stop:function(e,f){return d.push({offset:e,color:f}),c}}}var Hs=Math.PI,Is=2*Hs,qO=Is-1e-6;function Js(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ni(){return new Js()}function fd(a){return function(){return a}}Js.prototype=Ni.prototype={constructor:Js,moveTo:function(a,b){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,b){this._+="L"+(this._x1=+a)+","+(this._y1=+b)},quadraticCurveTo:function(a,b,c,d){this._+="Q"+ +a+","+ +b+","+(this._x1=+c)+","+(this._y1=+d)},bezierCurveTo:function(a,b,c,d,e,f){this._+="C"+ +a+","+ +b+","+ +c+","+ +d+","+(this._x1=+e)+","+(this._y1=+f)},arcTo:function(a,b,c,d,e){a=+a,b=+b,c=+c,d=+d,e=+e;var f=this._x1,g=this._y1,h=c-a,i=d-b,j=f-a,k=g-b,l=j*j+k*k;if(e<0)throw new Error("negative radius: "+e);if(null===this._x1)this._+="M"+(this._x1=a)+","+(this._y1=b);else if(l>1e-6)if(Math.abs(k*h-i*j)>1e-6&&e){var m=c-f,n=d-g,o=h*h+i*i,p=m*m+n*n,q=Math.sqrt(o),s=Math.sqrt(l),r=e*Math.tan((Hs-Math.acos((o+l-p)/(2*q*s)))/2),u=r/s,t=r/q;Math.abs(u-1)>1e-6&&(this._+="L"+(a+u*j)+","+(b+u*k)),this._+="A"+e+","+e+",0,0,"+ +(k*m>j*n)+","+(this._x1=a+t*h)+","+(this._y1=b+t*i)}else this._+="L"+(this._x1=a)+","+(this._y1=b)},arc:function(a,b,c,d,e,f){a=+a,b=+b,f=!!f;var g=(c=+c)*Math.cos(d),h=c*Math.sin(d),i=a+g,j=b+h,k=1^f,l=f?d-e:e-d;if(c<0)throw new Error("negative radius: "+c);null===this._x1?this._+="M"+i+","+j:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-j)>1e-6)&&(this._+="L"+i+","+j),c&&(l<0&&(l=l%Is+Is),l>qO?this._+="A"+c+","+c+",0,1,"+k+","+(a-g)+","+(b-h)+"A"+c+","+c+",0,1,"+k+","+(this._x1=i)+","+(this._y1=j):l>1e-6&&(this._+="A"+c+","+c+",0,"+ +(l>=Hs)+","+k+","+(this._x1=a+c*Math.cos(e))+","+(this._y1=b+c*Math.sin(e))))},rect:function(a,b,c,d){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)+"h"+ +c+"v"+ +d+"h"+-c+"Z"},toString:function(){return this._}};var UA=Math.abs,se=Math.atan2,Oi=Math.cos,rO=Math.max,Ks=Math.min,Dg=Math.sin,Rj=Math.sqrt,Sj=Math.PI,Dn=Sj/2,VA=2*Sj;function sO(a){return a>1?0:a<-1?Sj:Math.acos(a)}function WA(a){return a>=1?Dn:a<=-1?-Dn:Math.asin(a)}function tO(a){return a.innerRadius}function uO(a){return a.outerRadius}function vO(a){return a.startAngle}function wO(a){return a.endAngle}function xO(a){return a&&a.padAngle}function yO(a,b,c,d,e,f,g,h){var i=c-a,j=d-b,k=g-e,l=h-f,m=l*i-k*j;if(!(m*m<1e-12))return[a+(m=(k*(b-f)-l*(a-e))/m)*i,b+m*j]}function En(a,b,c,d,e,f,g){var h=a-c,i=b-d,j=(g?f:-f)/Rj(h*h+i*i),k=j*i,l=-j*h,m=a+k,n=b+l,o=c+k,p=d+l,q=(m+o)/2,s=(n+p)/2,r=o-m,u=p-n,t=r*r+u*u,w=e-f,x=m*p-o*n,z=(u<0?-1:1)*Rj(rO(0,w*w*t-x*x)),A=(x*u-r*z)/t,B=(-x*r-u*z)/t,I=(x*u+r*z)/t,J=(-x*r+u*z)/t,D=A-q,O=B-s,K=I-q,Q=J-s;return D*D+O*O>K*K+Q*Q&&(A=I,B=J),{cx:A,cy:B,x01:-k,y01:-l,x11:A*(e/w-1),y11:B*(e/w-1)}}function XA(a){this._context=a}function Ls(a){return new XA(a)}function YA(a){return a[0]}function ZA(a){return a[1]}function _A(){var a=YA,b=ZA,c=fd(!0),d=null,e=Ls,f=null;function g(h){var i,j,k,l=h.length,m=!1;for(null==d&&(f=e(k=Ni())),i=0;i<=l;++i)!(i<l&&c(j=h[i],i,h))===m&&((m=!m)?f.lineStart():f.lineEnd()),m&&f.point(+a(j,i,h),+b(j,i,h));if(k)return f=null,k+""||null}return g.x=function(h){return arguments.length?(a="function"==typeof h?h:fd(+h),g):a},g.y=function(h){return arguments.length?(b="function"==typeof h?h:fd(+h),g):b},g.defined=function(h){return arguments.length?(c="function"==typeof h?h:fd(!!h),g):c},g.curve=function(h){return arguments.length?(e=h,null!=d&&(f=e(d)),g):e},g.context=function(h){return arguments.length?(null==h?d=f=null:f=e(d=h),g):d},g}function $A(){var a=YA,b=null,c=fd(0),d=ZA,e=fd(!0),f=null,g=Ls,h=null;function i(k){var l,m,n,o,p,q=k.length,s=!1,r=new Array(q),u=new Array(q);for(null==f&&(h=g(p=Ni())),l=0;l<=q;++l){if(!(l<q&&e(o=k[l],l,k))===s)if(s=!s)m=l,h.areaStart(),h.lineStart();else{for(h.lineEnd(),h.lineStart(),n=l-1;n>=m;--n)h.point(r[n],u[n]);h.lineEnd(),h.areaEnd()}s&&(r[l]=+a(o,l,k),u[l]=+c(o,l,k),h.point(b?+b(o,l,k):r[l],d?+d(o,l,k):u[l]))}if(p)return h=null,p+""||null}function j(){return _A().defined(e).curve(g).context(f)}return i.x=function(k){return arguments.length?(a="function"==typeof k?k:fd(+k),b=null,i):a},i.x0=function(k){return arguments.length?(a="function"==typeof k?k:fd(+k),i):a},i.x1=function(k){return arguments.length?(b=null==k?null:"function"==typeof k?k:fd(+k),i):b},i.y=function(k){return arguments.length?(c="function"==typeof k?k:fd(+k),d=null,i):c},i.y0=function(k){return arguments.length?(c="function"==typeof k?k:fd(+k),i):c},i.y1=function(k){return arguments.length?(d=null==k?null:"function"==typeof k?k:fd(+k),i):d},i.lineX0=i.lineY0=function(){return j().x(a).y(c)},i.lineY1=function(){return j().x(a).y(d)},i.lineX1=function(){return j().x(b).y(c)},i.defined=function(k){return arguments.length?(e="function"==typeof k?k:fd(!!k),i):e},i.curve=function(k){return arguments.length?(g=k,null!=f&&(h=g(f)),i):g},i.context=function(k){return arguments.length?(null==k?f=h=null:h=g(f=k),i):f},i}XA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;default:this._context.lineTo(a,b)}}};var zO={draw:function(a,b){var c=Math.sqrt(b/Sj);a.moveTo(c,0),a.arc(0,0,c,0,VA)}};function Sh(){}function Fn(a,b,c){a._context.bezierCurveTo((2*a._x0+a._x1)/3,(2*a._y0+a._y1)/3,(a._x0+2*a._x1)/3,(a._y0+2*a._y1)/3,(a._x0+4*a._x1+b)/6,(a._y0+4*a._y1+c)/6)}function Gn(a){this._context=a}function aB(a){this._context=a}function bB(a){this._context=a}function cB(a,b){this._basis=new Gn(a),this._beta=b}Gn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fn(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},aB.prototype={areaStart:Sh,areaEnd:Sh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x2=a,this._y2=b;break;case 1:this._point=2,this._x3=a,this._y3=b;break;case 2:this._point=3,this._x4=a,this._y4=b,this._context.moveTo((this._x0+4*this._x1+a)/6,(this._y0+4*this._y1+b)/6);break;default:Fn(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},bB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var c=(this._x0+4*this._x1+a)/6,d=(this._y0+4*this._y1+b)/6;this._line?this._context.lineTo(c,d):this._context.moveTo(c,d);break;case 3:this._point=4;default:Fn(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},cB.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var a=this._x,b=this._y,c=a.length-1;if(c>0)for(var d,e=a[0],f=b[0],g=a[c]-e,h=b[c]-f,i=-1;++i<=c;)d=i/c,this._basis.point(this._beta*a[i]+(1-this._beta)*(e+d*g),this._beta*b[i]+(1-this._beta)*(f+d*h));this._x=this._y=null,this._basis.lineEnd()},point:function(a,b){this._x.push(+a),this._y.push(+b)}};var AO=function a(b){function c(d){return 1===b?new Gn(d):new cB(d,b)}return c.beta=function(d){return a(+d)},c}(.85);function Hn(a,b,c){a._context.bezierCurveTo(a._x1+a._k*(a._x2-a._x0),a._y1+a._k*(a._y2-a._y0),a._x2+a._k*(a._x1-b),a._y2+a._k*(a._y1-c),a._x2,a._y2)}function Ms(a,b){this._context=a,this._k=(1-b)/6}Ms.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Hn(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2,this._x1=a,this._y1=b;break;case 2:this._point=3;default:Hn(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var BO=function a(b){function c(d){return new Ms(d,b)}return c.tension=function(d){return a(+d)},c}(0);function Ns(a,b){this._context=a,this._k=(1-b)/6}Ns.prototype={areaStart:Sh,areaEnd:Sh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:Hn(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var CO=function a(b){function c(d){return new Ns(d,b)}return c.tension=function(d){return a(+d)},c}(0);function Os(a,b){this._context=a,this._k=(1-b)/6}Os.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Hn(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var DO=function a(b){function c(d){return new Os(d,b)}return c.tension=function(d){return a(+d)},c}(0);function Ps(a,b,c){var d=a._x1,e=a._y1,f=a._x2,g=a._y2;if(a._l01_a>1e-12){var h=2*a._l01_2a+3*a._l01_a*a._l12_a+a._l12_2a,i=3*a._l01_a*(a._l01_a+a._l12_a);d=(d*h-a._x0*a._l12_2a+a._x2*a._l01_2a)/i,e=(e*h-a._y0*a._l12_2a+a._y2*a._l01_2a)/i}if(a._l23_a>1e-12){var j=2*a._l23_2a+3*a._l23_a*a._l12_a+a._l12_2a,k=3*a._l23_a*(a._l23_a+a._l12_a);f=(f*j+a._x1*a._l23_2a-b*a._l12_2a)/k,g=(g*j+a._y1*a._l23_2a-c*a._l12_2a)/k}a._context.bezierCurveTo(d,e,f,g,a._x2,a._y2)}function dB(a,b){this._context=a,this._alpha=b}dB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3;default:Ps(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var EO=function a(b){function c(d){return b?new dB(d,b):new Ms(d,0)}return c.alpha=function(d){return a(+d)},c}(.5);function eB(a,b){this._context=a,this._alpha=b}eB.prototype={areaStart:Sh,areaEnd:Sh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:Ps(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var FO=function a(b){function c(d){return b?new eB(d,b):new Ns(d,0)}return c.alpha=function(d){return a(+d)},c}(.5);function fB(a,b){this._context=a,this._alpha=b}fB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ps(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var GO=function a(b){function c(d){return b?new fB(d,b):new Os(d,0)}return c.alpha=function(d){return a(+d)},c}(.5);function gB(a){this._context=a}function hB(a){return a<0?-1:1}function iB(a,b,c){var d=a._x1-a._x0,e=b-a._x1,f=(a._y1-a._y0)/(d||e<0&&-0),g=(c-a._y1)/(e||d<0&&-0),h=(f*e+g*d)/(d+e);return(hB(f)+hB(g))*Math.min(Math.abs(f),Math.abs(g),.5*Math.abs(h))||0}function jB(a,b){var c=a._x1-a._x0;return c?(3*(a._y1-a._y0)/c-b)/2:b}function Qs(a,b,c){var d=a._x0,e=a._y0,f=a._x1,g=a._y1,h=(f-d)/3;a._context.bezierCurveTo(d+h,e+h*b,f-h,g-h*c,f,g)}function In(a){this._context=a}function kB(a){this._context=new lB(a)}function lB(a){this._context=a}function mB(a){this._context=a}function nB(a){var b,c,d=a.length-1,e=new Array(d),f=new Array(d),g=new Array(d);for(e[0]=0,f[0]=2,g[0]=a[0]+2*a[1],b=1;b<d-1;++b)e[b]=1,f[b]=4,g[b]=4*a[b]+2*a[b+1];for(e[d-1]=2,f[d-1]=7,g[d-1]=8*a[d-1]+a[d],b=1;b<d;++b)c=e[b]/f[b-1],f[b]-=c,g[b]-=c*g[b-1];for(e[d-1]=g[d-1]/f[d-1],b=d-2;b>=0;--b)e[b]=(g[b]-e[b+1])/f[b];for(f[d-1]=(a[d]+e[d-1])/2,b=0;b<d-1;++b)f[b]=2*a[b+1]-e[b+1];return[e,f]}function Jn(a,b){this._context=a,this._t=b}gB.prototype={areaStart:Sh,areaEnd:Sh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(a,b){a=+a,b=+b,this._point?this._context.lineTo(a,b):(this._point=1,this._context.moveTo(a,b))}},In.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Qs(this,this._t0,jB(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){var c=NaN;if(b=+b,(a=+a)!==this._x1||b!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3,Qs(this,jB(this,c=iB(this,a,b)),c);break;default:Qs(this,this._t0,c=iB(this,a,b))}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b,this._t0=c}}},(kB.prototype=Object.create(In.prototype)).point=function(a,b){In.prototype.point.call(this,b,a)},lB.prototype={moveTo:function(a,b){this._context.moveTo(b,a)},closePath:function(){this._context.closePath()},lineTo:function(a,b){this._context.lineTo(b,a)},bezierCurveTo:function(a,b,c,d,e,f){this._context.bezierCurveTo(b,a,d,c,f,e)}},mB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var a=this._x,b=this._y,c=a.length;if(c)if(this._line?this._context.lineTo(a[0],b[0]):this._context.moveTo(a[0],b[0]),2===c)this._context.lineTo(a[1],b[1]);else for(var d=nB(a),e=nB(b),f=0,g=1;g<c;++f,++g)this._context.bezierCurveTo(d[0][f],e[0][f],d[1][f],e[1][f],a[g],b[g]);(this._line||0!==this._line&&1===c)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(a,b){this._x.push(+a),this._y.push(+b)}},Jn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,b),this._context.lineTo(a,b);else{var c=this._x*(1-this._t)+a*this._t;this._context.lineTo(c,this._y),this._context.lineTo(c,b)}}this._x=a,this._y=b}};var oB={basis:{curve:function(a){return new Gn(a)}},"basis-closed":{curve:function(a){return new aB(a)}},"basis-open":{curve:function(a){return new bB(a)}},bundle:{curve:AO,tension:"beta",value:.85},cardinal:{curve:BO,tension:"tension",value:0},"cardinal-open":{curve:DO,tension:"tension",value:0},"cardinal-closed":{curve:CO,tension:"tension",value:0},"catmull-rom":{curve:EO,tension:"alpha",value:.5},"catmull-rom-closed":{curve:FO,tension:"alpha",value:.5},"catmull-rom-open":{curve:GO,tension:"alpha",value:.5},linear:{curve:Ls},"linear-closed":{curve:function(a){return new gB(a)}},monotone:{horizontal:function(a){return new kB(a)},vertical:function(a){return new In(a)}},natural:{curve:function(a){return new mB(a)}},step:{curve:function(a){return new Jn(a,.5)}},"step-after":{curve:function(a){return new Jn(a,1)}},"step-before":{curve:function(a){return new Jn(a,0)}}};function Rs(a,b,c){var d=db(oB,a)&&oB[a],e=null;return d&&(e=d.curve||d[b||"vertical"],d.tension&&null!=c&&(e=e[d.tension](c))),e}var HO={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Kn=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function Tj(a){var b,c,d,e,f,g,h,i,j,k,l,m=[];for(i=0,k=(b=a.slice().replace(Kn[0],"###$1").split(Kn[1]).slice(1)).length;i<k;++i){for(d=(c=b[i]).slice(1).trim().replace(Kn[2],"$1###$2").split(Kn[3]),e=[g=c.charAt(0)],j=0,l=d.length;j<l;++j)(f=+d[j])===f&&e.push(f);if(h=HO[g.toLowerCase()],e.length-1>h)for(j=1,l=e.length;j<l;j+=h)m.push([g].concat(e.slice(j,j+h)));else m.push(e)}return m}const fh=Math.PI/180,Pi=Math.PI/2,Eg=2*Math.PI,Uj=Math.sqrt(3)/2;var Ss={},Ts={},pB=[].join;function IO(a){var b=pB.call(a);if(Ts[b])return Ts[b];var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=j*g,l=-i*h,m=i*g,n=j*h,o=Math.cos(e),p=Math.sin(e),q=Math.cos(f),s=Math.sin(f),r=.5*(f-e),u=Math.sin(.5*r),t=8/3*u*u/Math.sin(r),w=c+o-t*p,x=d+p+t*o,z=c+q,A=d+s,B=z+t*s,I=A-t*q;return Ts[b]=[k*w+l*x,m*w+n*x,k*B+l*I,m*B+n*I,k*z+l*A,m*z+n*A]}var Kf=["l",0,0,0,0,0,0,0];function JO(a,b,c){var d=Kf[0]=a[0];if("a"===d||"A"===d)Kf[1]=b*a[1],Kf[2]=c*a[2],Kf[3]=a[3],Kf[4]=a[4],Kf[5]=a[5],Kf[6]=b*a[6],Kf[7]=c*a[7];else if("h"===d||"H"===d)Kf[1]=b*a[1];else if("v"===d||"V"===d)Kf[1]=c*a[1];else for(var e=1,f=a.length;e<f;++e)Kf[e]=(e%2==1?b:c)*a[e];return Kf}function ml(a,b,c,d,e,f){var g,h,i,j,k,l=null,m=0,n=0,o=0,p=0;null==c&&(c=0),null==d&&(d=0),null==e&&(e=1),null==f&&(f=e),a.beginPath&&a.beginPath();for(var q=0,s=b.length;q<s;++q){switch(g=b[q],1===e&&1===f||(g=JO(g,e,f)),g[0]){case"l":m+=g[1],n+=g[2],a.lineTo(m+c,n+d);break;case"L":m=g[1],n=g[2],a.lineTo(m+c,n+d);break;case"h":m+=g[1],a.lineTo(m+c,n+d);break;case"H":m=g[1],a.lineTo(m+c,n+d);break;case"v":n+=g[1],a.lineTo(m+c,n+d);break;case"V":n=g[1],a.lineTo(m+c,n+d);break;case"m":m+=g[1],n+=g[2],a.moveTo(m+c,n+d);break;case"M":m=g[1],n=g[2],a.moveTo(m+c,n+d);break;case"c":h=m+g[5],i=n+g[6],o=m+g[3],p=n+g[4],a.bezierCurveTo(m+g[1]+c,n+g[2]+d,o+c,p+d,h+c,i+d),m=h,n=i;break;case"C":m=g[5],n=g[6],o=g[3],p=g[4],a.bezierCurveTo(g[1]+c,g[2]+d,o+c,p+d,m+c,n+d);break;case"s":h=m+g[3],i=n+g[4],o=2*m-o,p=2*n-p,a.bezierCurveTo(o+c,p+d,m+g[1]+c,n+g[2]+d,h+c,i+d),o=m+g[1],p=n+g[2],m=h,n=i;break;case"S":h=g[3],i=g[4],o=2*m-o,p=2*n-p,a.bezierCurveTo(o+c,p+d,g[1]+c,g[2]+d,h+c,i+d),m=h,n=i,o=g[1],p=g[2];break;case"q":h=m+g[3],i=n+g[4],o=m+g[1],p=n+g[2],a.quadraticCurveTo(o+c,p+d,h+c,i+d),m=h,n=i;break;case"Q":h=g[3],i=g[4],a.quadraticCurveTo(g[1]+c,g[2]+d,h+c,i+d),m=h,n=i,o=g[1],p=g[2];break;case"t":h=m+g[1],i=n+g[2],null===l[0].match(/[QqTt]/)?(o=m,p=n):"t"===l[0]?(o=2*m-j,p=2*n-k):"q"===l[0]&&(o=2*m-o,p=2*n-p),j=o,k=p,a.quadraticCurveTo(o+c,p+d,h+c,i+d),n=i,o=(m=h)+g[1],p=n+g[2];break;case"T":h=g[1],i=g[2],o=2*m-o,p=2*n-p,a.quadraticCurveTo(o+c,p+d,h+c,i+d),m=h,n=i;break;case"a":qB(a,m+c,n+d,[g[1],g[2],g[3],g[4],g[5],g[6]+m+c,g[7]+n+d]),m+=g[6],n+=g[7];break;case"A":qB(a,m+c,n+d,[g[1],g[2],g[3],g[4],g[5],g[6]+c,g[7]+d]),m=g[6],n=g[7];break;case"z":case"Z":a.closePath()}l=g}}function qB(a,b,c,d){for(var e=function(h,i,j,k,l,m,n,o,p){var q=pB.call(arguments);if(Ss[q])return Ss[q];var s=n*fh,r=Math.sin(s),u=Math.cos(s),t=u*(o-h)*.5+r*(p-i)*.5,w=u*(p-i)*.5-r*(o-h)*.5,x=t*t/((j=Math.abs(j))*j)+w*w/((k=Math.abs(k))*k);x>1&&(j*=x=Math.sqrt(x),k*=x);var z=u/j,A=r/j,B=-r/k,I=u/k,J=z*o+A*p,D=B*o+I*p,O=z*h+A*i,K=B*h+I*i,Q=(O-J)*(O-J)+(K-D)*(K-D),V=1/Q-.25;V<0&&(V=0);var $=Math.sqrt(V);m==l&&($=-$);var Ia=.5*(J+O)-$*(K-D),wa=.5*(D+K)+$*(O-J),xa=Math.atan2(D-wa,J-Ia),oa=Math.atan2(K-wa,O-Ia),Ma=oa-xa;Ma<0&&1===m?Ma+=Eg:Ma>0&&0===m&&(Ma-=Eg);for(var Za=Math.ceil(Math.abs(Ma/(Pi+.001))),Pa=[],La=0;La<Za;++La){var wb=xa+La*Ma/Za,tc=xa+(La+1)*Ma/Za;Pa[La]=[Ia,wa,wb,tc,j,k,r,u]}return Ss[q]=Pa}(d[5],d[6],d[0],d[1],d[3],d[4],d[2],b,c),f=0;f<e.length;++f){var g=IO(e[f]);a.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5])}}var rB=.5773502691896257,sB={circle:{draw:function(a,b){var c=Math.sqrt(b)/2;a.moveTo(c,0),a.arc(0,0,c,0,Eg)}},cross:{draw:function(a,b){var c=Math.sqrt(b)/2,d=c/2.5;a.moveTo(-c,-d),a.lineTo(-c,d),a.lineTo(-d,d),a.lineTo(-d,c),a.lineTo(d,c),a.lineTo(d,d),a.lineTo(c,d),a.lineTo(c,-d),a.lineTo(d,-d),a.lineTo(d,-c),a.lineTo(-d,-c),a.lineTo(-d,-d),a.closePath()}},diamond:{draw:function(a,b){var c=Math.sqrt(b)/2;a.moveTo(-c,0),a.lineTo(0,-c),a.lineTo(c,0),a.lineTo(0,c),a.closePath()}},square:{draw:function(a,b){var c=Math.sqrt(b),d=-c/2;a.rect(d,d,c,c)}},arrow:{draw:function(a,b){var c=Math.sqrt(b)/2,d=c/7,e=c/2.5,f=c/8;a.moveTo(-d,c),a.lineTo(d,c),a.lineTo(d,-f),a.lineTo(e,-f),a.lineTo(0,-c),a.lineTo(-e,-f),a.lineTo(-d,-f),a.closePath()}},wedge:{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c,e=d-c*rB,f=c/4;a.moveTo(0,-d-e),a.lineTo(-f,d-e),a.lineTo(f,d-e),a.closePath()}},triangle:{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c,e=d-c*rB;a.moveTo(0,-d-e),a.lineTo(-c,d-e),a.lineTo(c,d-e),a.closePath()}},"triangle-up":{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c;a.moveTo(0,-d),a.lineTo(-c,d),a.lineTo(c,d),a.closePath()}},"triangle-down":{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c;a.moveTo(0,d),a.lineTo(-c,-d),a.lineTo(c,-d),a.closePath()}},"triangle-right":{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c;a.moveTo(d,0),a.lineTo(-d,-c),a.lineTo(-d,c),a.closePath()}},"triangle-left":{draw:function(a,b){var c=Math.sqrt(b)/2,d=Uj*c;a.moveTo(-d,0),a.lineTo(d,-c),a.lineTo(d,c),a.closePath()}},stroke:{draw:function(a,b){var c=Math.sqrt(b)/2;a.moveTo(-c,0),a.lineTo(c,0)}}};function tB(a){return db(sB,a)?sB[a]:function(b){if(!db(Us,b)){var c=Tj(b);Us[b]={draw:function(d,e){ml(d,c,0,0,Math.sqrt(e)/2)}}}return Us[b]}(a)}var Us={};const Th=.448084975506;function KO(a){return a.x}function LO(a){return a.y}function MO(a){return a.width}function NO(a){return a.height}function gh(a){return"function"==typeof a?a:()=>+a}function Ln(a,b,c){return Math.max(b,Math.min(a,c))}function uB(){var a=KO,b=LO,c=MO,d=NO,e=gh(0),f=e,g=e,h=e,i=null;function j(k,l,m){var n,o=null!=l?l:+a.call(this,k),p=null!=m?m:+b.call(this,k),q=+c.call(this,k),s=+d.call(this,k),r=Math.min(q,s)/2,u=Ln(+e.call(this,k),0,r),t=Ln(+f.call(this,k),0,r),w=Ln(+g.call(this,k),0,r),x=Ln(+h.call(this,k),0,r);if(i||(i=n=Ni()),u<=0&&t<=0&&w<=0&&x<=0)i.rect(o,p,q,s);else{var z=o+q,A=p+s;i.moveTo(o+u,p),i.lineTo(z-t,p),i.bezierCurveTo(z-Th*t,p,z,p+Th*t,z,p+t),i.lineTo(z,A-x),i.bezierCurveTo(z,A-Th*x,z-Th*x,A,z-x,A),i.lineTo(o+w,A),i.bezierCurveTo(o+Th*w,A,o,A-Th*w,o,A-w),i.lineTo(o,p+u),i.bezierCurveTo(o,p+Th*u,o+Th*u,p,o+u,p),i.closePath()}if(n)return i=null,n+""||null}return j.x=function(k){return arguments.length?(a=gh(k),j):a},j.y=function(k){return arguments.length?(b=gh(k),j):b},j.width=function(k){return arguments.length?(c=gh(k),j):c},j.height=function(k){return arguments.length?(d=gh(k),j):d},j.cornerRadius=function(k,l,m,n){return arguments.length?(e=gh(k),f=null!=l?gh(l):e,h=null!=m?gh(m):e,g=null!=n?gh(n):f,j):e},j.context=function(k){return arguments.length?(i=null==k?null:k,j):i},j}function vB(){var a,b,c,d,e,f,g,h,i=null;function j(l,m,n){var o=n/2;if(e){var p=g-m,q=l-f;if(p||q){var s=Math.sqrt(p*p+q*q),r=(p/=s)*h,u=(q/=s)*h,t=Math.atan2(q,p);i.moveTo(f-r,g-u),i.lineTo(l-p*o,m-q*o),i.arc(l,m,o,t-Math.PI,t),i.lineTo(f+r,g+u),i.arc(f,g,h,t,t+Math.PI)}else i.arc(l,m,o,0,Eg);i.closePath()}else e=1;f=l,g=m,h=o}function k(l){var m,n,o,p=l.length,q=!1;for(null==i&&(i=o=Ni()),m=0;m<=p;++m)!(m<p&&d(n=l[m],m,l))===q&&(q=!q)&&(e=0),q&&j(+a(n,m,l),+b(n,m,l),+c(n,m,l));if(o)return i=null,o+""||null}return k.x=function(l){return arguments.length?(a=l,k):a},k.y=function(l){return arguments.length?(b=l,k):b},k.size=function(l){return arguments.length?(c=l,k):c},k.defined=function(l){return arguments.length?(d=l,k):d},k.context=function(l){return arguments.length?(i=null==l?null:l,k):i},k}function nl(a,b){return null!=a?a:b}const ol=a=>a.x||0,pl=a=>a.y||0,Mn=a=>!(!1===a.defined),OO=function(){var a=tO,b=uO,c=fd(0),d=null,e=vO,f=wO,g=xO,h=null;function i(){var j,k,l=+a.apply(this,arguments),m=+b.apply(this,arguments),n=e.apply(this,arguments)-Dn,o=f.apply(this,arguments)-Dn,p=UA(o-n),q=o>n;if(h||(h=j=Ni()),m<l&&(k=m,m=l,l=k),m>1e-12)if(p>VA-1e-12)h.moveTo(m*Oi(n),m*Dg(n)),h.arc(0,0,m,n,o,!q),l>1e-12&&(h.moveTo(l*Oi(o),l*Dg(o)),h.arc(0,0,l,o,n,q));else{var s,r,u=n,t=o,w=n,x=o,z=p,A=p,B=g.apply(this,arguments)/2,I=B>1e-12&&(d?+d.apply(this,arguments):Rj(l*l+m*m)),J=Ks(UA(m-l)/2,+c.apply(this,arguments)),D=J,O=J;if(I>1e-12){var K=WA(I/l*Dg(B)),Q=WA(I/m*Dg(B));(z-=2*K)>1e-12?(w+=K*=q?1:-1,x-=K):(z=0,w=x=(n+o)/2),(A-=2*Q)>1e-12?(u+=Q*=q?1:-1,t-=Q):(A=0,u=t=(n+o)/2)}var V=m*Oi(u),$=m*Dg(u),Ia=l*Oi(x),wa=l*Dg(x);if(J>1e-12){var xa,oa=m*Oi(t),Ma=m*Dg(t),Za=l*Oi(w),Pa=l*Dg(w);if(p<Sj&&(xa=yO(V,$,Za,Pa,oa,Ma,Ia,wa))){var La=V-xa[0],wb=$-xa[1],tc=oa-xa[0],Oc=Ma-xa[1],xb=1/Dg(sO((La*tc+wb*Oc)/(Rj(La*La+wb*wb)*Rj(tc*tc+Oc*Oc)))/2),hd=Rj(xa[0]*xa[0]+xa[1]*xa[1]);D=Ks(J,(l-hd)/(xb-1)),O=Ks(J,(m-hd)/(xb+1))}}A>1e-12?O>1e-12?(s=En(Za,Pa,V,$,m,O,q),r=En(oa,Ma,Ia,wa,m,O,q),h.moveTo(s.cx+s.x01,s.cy+s.y01),O<J?h.arc(s.cx,s.cy,O,se(s.y01,s.x01),se(r.y01,r.x01),!q):(h.arc(s.cx,s.cy,O,se(s.y01,s.x01),se(s.y11,s.x11),!q),h.arc(0,0,m,se(s.cy+s.y11,s.cx+s.x11),se(r.cy+r.y11,r.cx+r.x11),!q),h.arc(r.cx,r.cy,O,se(r.y11,r.x11),se(r.y01,r.x01),!q))):(h.moveTo(V,$),h.arc(0,0,m,u,t,!q)):h.moveTo(V,$),l>1e-12&&z>1e-12?D>1e-12?(s=En(Ia,wa,oa,Ma,l,-D,q),r=En(V,$,Za,Pa,l,-D,q),h.lineTo(s.cx+s.x01,s.cy+s.y01),D<J?h.arc(s.cx,s.cy,D,se(s.y01,s.x01),se(r.y01,r.x01),!q):(h.arc(s.cx,s.cy,D,se(s.y01,s.x01),se(s.y11,s.x11),!q),h.arc(0,0,l,se(s.cy+s.y11,s.cx+s.x11),se(r.cy+r.y11,r.cx+r.x11),q),h.arc(r.cx,r.cy,D,se(r.y11,r.x11),se(r.y01,r.x01),!q))):h.arc(0,0,l,x,w,q):h.lineTo(Ia,wa)}else h.moveTo(0,0);if(h.closePath(),j)return h=null,j+""||null}return i.centroid=function(){var j=(+a.apply(this,arguments)+ +b.apply(this,arguments))/2,k=(+e.apply(this,arguments)+ +f.apply(this,arguments))/2-Sj/2;return[Oi(k)*j,Dg(k)*j]},i.innerRadius=function(j){return arguments.length?(a="function"==typeof j?j:fd(+j),i):a},i.outerRadius=function(j){return arguments.length?(b="function"==typeof j?j:fd(+j),i):b},i.cornerRadius=function(j){return arguments.length?(c="function"==typeof j?j:fd(+j),i):c},i.padRadius=function(j){return arguments.length?(d=null==j?null:"function"==typeof j?j:fd(+j),i):d},i.startAngle=function(j){return arguments.length?(e="function"==typeof j?j:fd(+j),i):e},i.endAngle=function(j){return arguments.length?(f="function"==typeof j?j:fd(+j),i):f},i.padAngle=function(j){return arguments.length?(g="function"==typeof j?j:fd(+j),i):g},i.context=function(j){return arguments.length?(h=null==j?null:j,i):h},i}().startAngle(a=>a.startAngle||0).endAngle(a=>a.endAngle||0).padAngle(a=>a.padAngle||0).innerRadius(a=>a.innerRadius||0).outerRadius(a=>a.outerRadius||0).cornerRadius(a=>a.cornerRadius||0),PO=$A().x(ol).y1(pl).y0(a=>(a.y||0)+(a.height||0)).defined(Mn),QO=$A().y(pl).x1(ol).x0(a=>(a.x||0)+(a.width||0)).defined(Mn),RO=_A().x(ol).y(pl).defined(Mn),SO=uB().x(ol).y(pl).width(a=>a.width||0).height(a=>a.height||0).cornerRadius(a=>nl(a.cornerRadiusTopLeft,a.cornerRadius)||0,a=>nl(a.cornerRadiusTopRight,a.cornerRadius)||0,a=>nl(a.cornerRadiusBottomRight,a.cornerRadius)||0,a=>nl(a.cornerRadiusBottomLeft,a.cornerRadius)||0),TO=function(){var a=fd(zO),b=fd(64),c=null;function d(){var e;if(c||(c=e=Ni()),a.apply(this,arguments).draw(c,+b.apply(this,arguments)),e)return c=null,e+""||null}return d.type=function(e){return arguments.length?(a="function"==typeof e?e:fd(e),d):a},d.size=function(e){return arguments.length?(b="function"==typeof e?e:fd(+e),d):b},d.context=function(e){return arguments.length?(c=null==e?null:e,d):c},d}().type(a=>tB(a.shape||"circle")).size(a=>nl(a.size,64)),UO=vB().x(ol).y(pl).defined(Mn).size(a=>a.size||1);function Vs(a){return a.cornerRadius||a.cornerRadiusTopLeft||a.cornerRadiusTopRight||a.cornerRadiusBottomRight||a.cornerRadiusBottomLeft}function Vj(a,b,c,d){return SO.context(a)(b,c,d)}var wB=1;function xB(){wB=1}function Ws(a,b,c){var d=b.clip,e=a._defs,f=b.clip_id||(b.clip_id="clip"+wB++),g=e.clipping[f]||(e.clipping[f]={id:f});return Ub(d)?g.path=d(null):Vs(c)?g.path=Vj(null,c,0,0):(g.width=c.width||0,g.height=c.height||0),"url(#"+f+")"}function Pd(a){this.clear(),a&&this.union(a)}var Jd=Pd.prototype;function Nn(a){this.mark=a,this.bounds=this.bounds||new Pd()}function On(a){Nn.call(this,a),this.items=this.items||[]}function ql(a,b){if("undefined"!=typeof document&&document.createElement){var c=document.createElement("canvas");if(c&&c.getContext)return c.width=a,c.height=b,c}return null}function VO(){return"undefined"!=typeof Image?Image:null}function Xs(a){this._pending=0,this._loader=a||tn()}Jd.clone=function(){return new Pd(this)},Jd.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},Jd.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},Jd.equals=function(a){return this.x1===a.x1&&this.y1===a.y1&&this.x2===a.x2&&this.y2===a.y2},Jd.set=function(a,b,c,d){return c<a?(this.x2=a,this.x1=c):(this.x1=a,this.x2=c),d<b?(this.y2=b,this.y1=d):(this.y1=b,this.y2=d),this},Jd.add=function(a,b){return a<this.x1&&(this.x1=a),b<this.y1&&(this.y1=b),a>this.x2&&(this.x2=a),b>this.y2&&(this.y2=b),this},Jd.expand=function(a){return this.x1-=a,this.y1-=a,this.x2+=a,this.y2+=a,this},Jd.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},Jd.scale=function(a){return this.x1*=a,this.y1*=a,this.x2*=a,this.y2*=a,this},Jd.translate=function(a,b){return this.x1+=a,this.x2+=a,this.y1+=b,this.y2+=b,this},Jd.rotate=function(a,b,c){const d=this.rotatedPoints(a,b,c);return this.clear().add(d[0],d[1]).add(d[2],d[3]).add(d[4],d[5]).add(d[6],d[7])},Jd.rotatedPoints=function(a,b,c){var{x1:d,y1:e,x2:f,y2:g}=this,h=Math.cos(a),i=Math.sin(a),j=b-b*h+c*i,k=c-b*i-c*h;return[h*d-i*e+j,i*d+h*e+k,h*d-i*g+j,i*d+h*g+k,h*f-i*e+j,i*f+h*e+k,h*f-i*g+j,i*f+h*g+k]},Jd.union=function(a){return a.x1<this.x1&&(this.x1=a.x1),a.y1<this.y1&&(this.y1=a.y1),a.x2>this.x2&&(this.x2=a.x2),a.y2>this.y2&&(this.y2=a.y2),this},Jd.intersect=function(a){return a.x1>this.x1&&(this.x1=a.x1),a.y1>this.y1&&(this.y1=a.y1),a.x2<this.x2&&(this.x2=a.x2),a.y2<this.y2&&(this.y2=a.y2),this},Jd.encloses=function(a){return a&&this.x1<=a.x1&&this.x2>=a.x2&&this.y1<=a.y1&&this.y2>=a.y2},Jd.alignsWith=function(a){return a&&(this.x1==a.x1||this.x2==a.x2||this.y1==a.y1||this.y2==a.y2)},Jd.intersects=function(a){return a&&!(this.x2<a.x1||this.x1>a.x2||this.y2<a.y1||this.y1>a.y2)},Jd.contains=function(a,b){return!(a<this.x1||a>this.x2||b<this.y1||b>this.y2)},Jd.width=function(){return this.x2-this.x1},Jd.height=function(){return this.y2-this.y1},Da(On,Nn);var Pn=Xs.prototype;function yB(a){a._pending+=1}function rl(a){a._pending-=1}function hh(a,b,c){if(b.stroke&&0!==b.opacity&&0!==b.strokeOpacity){const d=null!=b.strokeWidth?+b.strokeWidth:1;a.expand(d+(c?function(e,f){return e.strokeJoin&&"miter"!==e.strokeJoin?0:f}(b,d):0))}return a}Pn.pending=function(){return this._pending},Pn.sanitizeURL=function(a){var b=this;return yB(b),b._loader.sanitize(a,{context:"href"}).then(function(c){return rl(b),c}).catch(function(){return rl(b),null})},Pn.loadImage=function(a){const b=this,c=VO();return yB(b),b._loader.sanitize(a,{context:"image"}).then(function(d){const e=d.href;if(!e||!c)throw{url:e};const f=new c(),g=db(d,"crossOrigin")?d.crossOrigin:"anonymous";return null!=g&&(f.crossOrigin=g),f.onload=()=>rl(b),f.onerror=()=>rl(b),f.src=e,f}).catch(function(d){return rl(b),{complete:!1,width:0,height:0,src:d&&d.url||""}})},Pn.ready=function(){var a=this;return new Promise(function(b){!function c(d){a.pending()?setTimeout(function(){c(!0)},10):b(d)}(!1)})};var Qn,Rn,Sn,WO=Eg-1e-8;function df(a){return Qn=a,df}function zB(){}function Qi(a,b){Qn.add(a,b)}function sl(a,b){Qi(Rn=a,Sn=b)}function AB(a){Qi(a,Qn.y1)}function BB(a){Qi(Qn.x1,a)}function CB(a,b,c,d){const e=(a-b)/(a+c-2*b);0<e&&e<1&&d(a+(b-a)*e)}function DB(a,b,c,d,e){const f=d-a+3*b-3*c,g=a+c-2*b,h=a-b;let i,j=0,k=0;Math.abs(f)>1e-14?(i=g*g+h*f,i>=0&&(i=Math.sqrt(i),j=(-g+i)/f,k=(-g-i)/f)):j=.5*h/g,0<j&&j<1&&e(EB(j,a,b,c,d)),0<k&&k<1&&e(EB(k,a,b,c,d))}function EB(a,b,c,d,e){const f=1-a,g=f*f,h=a*a;return g*f*b+3*g*a*c+3*f*h*d+h*a*e}df.beginPath=zB,df.closePath=zB,df.moveTo=sl,df.lineTo=sl,df.rect=function(a,b,c,d){Qi(a+c,b+d),sl(a,b)},df.quadraticCurveTo=function(a,b,c,d){CB(Rn,a,c,AB),CB(Sn,b,d,BB),sl(c,d)},df.bezierCurveTo=function(a,b,c,d,e,f){DB(Rn,a,c,e,AB),DB(Sn,b,d,f,BB),sl(e,f)},df.arc=function(a,b,c,d,e,f){if(Rn=c*Math.cos(e)+a,Sn=c*Math.sin(e)+b,Math.abs(e-d)>WO)Qi(a-c,b-c),Qi(a+c,b+c);else{const g=j=>Qi(c*Math.cos(j)+a,c*Math.sin(j)+b);let h,i;if(g(d),g(e),e!==d)if((d%=Eg)<0&&(d+=Eg),(e%=Eg)<0&&(e+=Eg),e<d&&(f=!f,h=d,d=e,e=h),f)for(e-=Eg,h=d-d%Pi,i=0;i<4&&h>e;++i,h-=Pi)g(h);else for(h=d-d%Pi+Pi,i=0;i<4&&h<e;++i,h+=Pi)g(h)}};var Uh=(Uh=ql(1,1))?Uh.getContext("2d"):null;const Ys=new Pd();function Zs(a){return function(b,c){if(!Uh)return!0;a(Uh,b),Ys.clear().union(b.bounds).intersect(c).round();const{x1:d,y1:e,x2:f,y2:g}=Ys;for(let h=e;h<=g;++h)for(let i=d;i<=f;++i)if(Uh.isPointInPath(i,h))return!0;return!1}}function _s(a,b){return b.contains(a.x||0,a.y||0)}function FB(a,b){const c=a.x||0,d=a.y||0,e=a.width||0,f=a.height||0;return b.intersects(Ys.set(c,d,c+e,d+f))}function GB(a,b){const c=a.x||0,d=a.y||0;return Wj(b,c,d,null!=a.x2?a.x2:c,null!=a.y2?a.y2:d)}function Wj(a,b,c,d,e){const{x1:f,y1:g,x2:h,y2:i}=a,j=d-b,k=e-c;let l,m,n,o,p=0,q=1;for(o=0;o<4;++o){if(0===o&&(l=-j,m=-(f-b)),1===o&&(l=j,m=h-b),2===o&&(l=-k,m=-(g-c)),3===o&&(l=k,m=i-c),Math.abs(l)<1e-10&&m<0)return!1;if(n=m/l,l<0){if(n>q)return!1;n>p&&(p=n)}else if(l>0){if(n<p)return!1;n<q&&(q=n)}}return!0}function Xj(a,b){a.globalCompositeOperation=b.blend||"source-over"}function dg(a,b){return null==a?b:a}function HB(a,b){const c=b.length;for(let d=0;d<c;++d)a.addColorStop(b[d].offset,b[d].color);return a}function IB(a,b,c){return Gs(c)?function(d,e,f){const g=f.width(),h=f.height();let i;if("radial"===e.gradient)i=d.createRadialGradient(f.x1+dg(e.x1,.5)*g,f.y1+dg(e.y1,.5)*h,Math.max(g,h)*dg(e.r1,0),f.x1+dg(e.x2,.5)*g,f.y1+dg(e.y2,.5)*h,Math.max(g,h)*dg(e.r2,.5));else{const j=dg(e.x1,0),k=dg(e.y1,0),l=dg(e.x2,1),m=dg(e.y2,0);if(j!==l&&k!==m&&g!==h){const n=ql(Math.ceil(g),Math.ceil(h)),o=n.getContext("2d");return o.scale(g,h),o.fillStyle=HB(o.createLinearGradient(j,k,l,m),e.stops),o.fillRect(0,0,g,h),d.createPattern(n,"no-repeat")}i=d.createLinearGradient(f.x1+j*g,f.y1+k*h,f.x1+l*g,f.y1+m*h)}return HB(i,e.stops)}(a,c,b.bounds):c}function Tn(a,b,c){return(c*=null==b.fillOpacity?1:b.fillOpacity)>0&&(a.globalAlpha=c,a.fillStyle=IB(a,b,b.fill),!0)}var XO=[];function Yj(a,b,c){var d=null!=(d=b.strokeWidth)?d:1;return!(d<=0)&&((c*=null==b.strokeOpacity?1:b.strokeOpacity)>0&&(a.globalAlpha=c,a.strokeStyle=IB(a,b,b.stroke),a.lineWidth=d,a.lineCap=b.strokeCap||"butt",a.lineJoin=b.strokeJoin||"miter",a.miterLimit=b.strokeMiterLimit||10,a.setLineDash&&(a.setLineDash(b.strokeDash||XO),a.lineDashOffset=b.strokeDashOffset||0),!0))}function YO(a,b){return a.zindex-b.zindex||a.index-b.index}function $s(a){if(!a.zdirty)return a.zitems;var b,c,d,e=a.items,f=[];for(c=0,d=e.length;c<d;++c)(b=e[c]).index=c,b.zindex&&f.push(b);return a.zdirty=!1,a.zitems=f.sort(YO)}function eg(a,b){var c,d,e=a.items;if(e&&e.length){var f=$s(a);if(f&&f.length){for(c=0,d=e.length;c<d;++c)e[c].zindex||b(e[c]);e=f}for(c=0,d=e.length;c<d;++c)b(e[c])}}function Un(a,b){var c,d,e=a.items;if(!e||!e.length)return null;var f=$s(a);for(f&&f.length&&(e=f),d=e.length;--d>=0;)if(c=b(e[d]))return c;if(e===f){for(d=(e=a.items).length;--d>=0;)if(!e[d].zindex&&(c=b(e[d])))return c}return null}function at(a){return function(b,c,d){eg(c,function(e){d&&!d.intersects(e.bounds)||JB(a,b,e,e)})}}function ZO(a){return function(b,c,d){!c.items.length||d&&!d.intersects(c.bounds)||JB(a,b,c.items[0],c.items)}}function JB(a,b,c,d){var e=null==c.opacity?1:c.opacity;0!==e&&(a(b,d)||(Xj(b,c),c.fill&&Tn(b,c,e)&&b.fill(),c.stroke&&Yj(b,c,e)&&b.stroke()))}function Vn(a){return a=a||de,function(b,c,d,e,f,g){return d*=b.pixelRatio,e*=b.pixelRatio,Un(c,function(h){var i=h.bounds;if((!i||i.contains(f,g))&&i)return a(b,h,d,e,f,g)?h:void 0})}}function Wn(a,b){return function(c,d,e,f){var g,h,i=Array.isArray(d)?d[0]:d,j=null==b?i.fill:b,k=i.stroke&&c.isPointInStroke;return k&&(g=i.strokeWidth,h=i.strokeCap,c.lineWidth=null!=g?g:1,c.lineCap=null!=h?h:"butt"),!a(c,d)&&(j&&c.isPointInPath(e,f)||k&&c.isPointInStroke(e,f))}}function bt(a){return Vn(Wn(a))}function Zj(a,b){return"translate("+a+","+b+")"}function KB(a){return"rotate("+a+")"}function LB(a){return Zj(a.x||0,a.y||0)}function MB(a){return Zj(a.x||0,a.y||0)+(a.angle?" "+KB(a.angle):"")+(a.scaleX||a.scaleY?" "+(b=a.scaleX||1,c=a.scaleY||1,"scale("+b+","+c+")"):"");var b,c}function ct(a,b,c){function d(e,f){var g=f.x||0,h=f.y||0,i=f.angle||0;e.translate(g,h),i&&e.rotate(i*=fh),e.beginPath(),b(e,f),i&&e.rotate(-i),e.translate(-g,-h)}return{type:a,tag:"path",nested:!1,attr:function(e,f){e("transform",MB(f)),e("d",b(null,f))},bound:function(e,f){var g=f.x||0,h=f.y||0;return b(df(e),f),hh(e,f).translate(g,h),f.angle&&e.rotate(f.angle*fh,g,h),e},draw:at(d),pick:bt(d),isect:c||Zs(d)}}var _O=ct("arc",function(a,b){return OO.context(a)(b)});function dt(a,b,c){function d(f,g){f.beginPath(),b(f,g)}var e=Wn(d);return{type:a,tag:"path",nested:!0,attr:function(f,g){var h=g.mark.items;h.length&&f("d",b(null,h))},bound:function(f,g){var h=g.items;return 0===h.length?f:(b(df(f),h),hh(f,h[0]))},draw:ZO(d),pick:function(f,g,h,i,j,k){var l=g.items,m=g.bounds;return!l||!l.length||m&&!m.contains(j,k)?null:(h*=f.pixelRatio,i*=f.pixelRatio,e(f,l,h,i)?l[0]:null)},isect:_s,tip:c}}var $O=dt("area",function(a,b){var c=b[0],d=c.interpolate||"linear";return("horizontal"===c.orient?QO:PO).curve(Rs(d,c.orient,c.tension)).context(a)(b)},function(a,b){for(var c,d,e="horizontal"===a[0].orient?b[1]:b[0],f="horizontal"===a[0].orient?"y":"x",g=a.length,h=1/0;--g>=0;)!1!==a[g].defined&&(d=Math.abs(a[g][f]-e))<h&&(h=d,c=a[g]);return c});function NB(a,b){a.beginPath(),Vs(b)?Vj(a,b,0,0):a.rect(0,0,b.width||0,b.height||0),a.clip()}function OB(a){const b=dg(a.strokeWidth,1);return null!=a.strokeOffset?a.strokeOffset:a.stroke&&b>.5&&b<1.5?.5-Math.abs(b-1):0}function PB(a,b){const c=OB(b);a("d",Vj(null,b,c,c))}function Xn(a,b,c,d){const e=OB(b);a.beginPath(),Vj(a,b,(c||0)+e,(d||0)+e)}const QB=Wn(Xn),aP=Wn(Xn,!1);var bP={type:"group",tag:"g",nested:!1,attr:function(a,b){a("transform",LB(b))},bound:function(a,b){if(!b.clip&&b.items){const c=b.items,d=c.length;for(let e=0;e<d;++e)a.union(c[e].bounds)}return(b.clip||b.width||b.height)&&!b.noBound&&a.add(0,0).add(b.width||0,b.height||0),hh(a,b),a.translate(b.x||0,b.y||0)},draw:function(a,b,c){eg(b,d=>{const e=d.x||0,f=d.y||0,g=d.strokeForeground,h=null==d.opacity?1:d.opacity;(d.stroke||d.fill)&&h&&(Xn(a,d,e,f),Xj(a,d),d.fill&&Tn(a,d,h)&&a.fill(),d.stroke&&!g&&Yj(a,d,h)&&a.stroke()),a.save(),a.translate(e,f),d.clip&&NB(a,d),c&&c.translate(-e,-f),eg(d,i=>{this.draw(a,i,c)}),c&&c.translate(e,f),a.restore(),g&&d.stroke&&h&&(Xn(a,d,e,f),Xj(a,d),Yj(a,d,h)&&a.stroke())})},pick:function(a,b,c,d,e,f){if(b.bounds&&!b.bounds.contains(e,f)||!b.items)return null;const g=c*a.pixelRatio,h=d*a.pixelRatio;return Un(b,i=>{let j,k,l,m,n,o,p,q,s;if(q=i.bounds,(!q||q.contains(e,f))&&(m=i.x||0,n=i.y||0,o=m+(i.width||0),p=n+(i.height||0),s=i.clip,!s||!(e<m||e>o||f<n||f>p)))return a.save(),a.translate(m,n),m=e-m,n=f-n,s&&Vs(i)&&!QB(a,i,g,h)?(a.restore(),null):(k=i.strokeForeground,l=!1!==b.interactive,l&&k&&i.stroke&&aP(a,i,g,h)?(a.restore(),i):(j=Un(i,r=>function(u,t,w){return(!1!==u.interactive||"group"===u.marktype)&&u.bounds&&u.bounds.contains(t,w)}(r,m,n)?this.pick(r,c,d,m,n):null),!j&&l&&(i.fill||!k&&i.stroke)&&QB(a,i,g,h)&&(j=i),a.restore(),j||null))})},isect:FB,content:function(a,b,c){a("clip-path",b.clip?Ws(c,b,b):null)},background:function(a,b){a("class","background"),a("aria-hidden",!0),PB(a,b)},foreground:function(a,b){a("class","foreground"),a("aria-hidden",!0),b.strokeForeground?PB(a,b):a("d","")}},_j={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function et(a,b){var c=a.image;return(!c||a.url&&a.url!==c.url)&&(c={complete:!1,width:0,height:0},b.loadImage(a.url).then(d=>{a.image=d,a.image.url=a.url})),c}function ft(a,b){return null!=a.width?a.width:b&&b.width?!1!==a.aspect&&a.height?a.height*b.width/b.height:b.width:0}function gt(a,b){return null!=a.height?a.height:b&&b.height?!1!==a.aspect&&a.width?a.width*b.height/b.width:b.height:0}function Yn(a,b){return"center"===a?b/2:"right"===a?b:0}function Zn(a,b){return"middle"===a?b/2:"bottom"===a?b:0}var cP={type:"image",tag:"image",nested:!1,attr:function(a,b,c){const d=et(b,c),e=ft(b,d),f=gt(b,d),g=(b.x||0)-Yn(b.align,e),h=(b.y||0)-Zn(b.baseline,f);a("href",!d.src&&d.toDataURL?d.toDataURL():d.src||"",_j["xmlns:xlink"],"xlink:href"),a("transform",Zj(g,h)),a("width",e),a("height",f),a("preserveAspectRatio",!1===b.aspect?"none":"xMidYMid")},bound:function(a,b){const c=b.image,d=ft(b,c),e=gt(b,c),f=(b.x||0)-Yn(b.align,d),g=(b.y||0)-Zn(b.baseline,e);return a.set(f,g,f+d,g+e)},draw:function(a,b,c){eg(b,d=>{if(c&&!c.intersects(d.bounds))return;let e,f,g,h,i=et(d,this),j=ft(d,i),k=gt(d,i),l=(d.x||0)-Yn(d.align,j),m=(d.y||0)-Zn(d.baseline,k);!1!==d.aspect&&(f=i.width/i.height,g=d.width/d.height,f==f&&g==g&&f!==g&&(g<f?(h=j/f,m+=(k-h)/2,k=h):(h=k*f,l+=(j-h)/2,j=h))),(i.complete||i.toDataURL)&&(Xj(a,d),a.globalAlpha=null!=(e=d.opacity)?e:1,a.imageSmoothingEnabled=!1!==d.smooth,a.drawImage(i,l,m,j,k))})},pick:Vn(),isect:de,get:et,xOffset:Yn,yOffset:Zn},dP=dt("line",function(a,b){var c=b[0],d=c.interpolate||"linear";return RO.curve(Rs(d,c.orient,c.tension)).context(a)(b)},function(a,b){for(var c,d,e=Math.pow(a[0].strokeWidth||1,2),f=a.length;--f>=0;)if(!1!==a[f].defined&&(c=a[f].x-b[0])*c+(d=a[f].y-b[1])*d<e)return a[f];return null});function _n(a,b){var c=b.path;if(null==c)return!0;var d=b.x||0,e=b.y||0,f=b.scaleX||1,g=b.scaleY||1,h=(b.angle||0)*fh,i=b.pathCache;i&&i.path===c||((b.pathCache=i=Tj(c)).path=c),h&&a.rotate&&a.translate?(a.translate(d,e),a.rotate(h),ml(a,i,0,0,f,g),a.rotate(-h),a.translate(-d,-e)):ml(a,i,d,e,f,g)}var eP={type:"path",tag:"path",nested:!1,attr:function(a,b){var c=b.scaleX||1,d=b.scaleY||1;1===c&&1===d||a("vector-effect","non-scaling-stroke"),a("transform",MB(b)),a("d",b.path)},bound:function(a,b){return _n(df(a),b)?a.set(0,0,0,0):hh(a,b,!0),b.angle&&a.rotate(b.angle*fh,b.x||0,b.y||0),a},draw:at(_n),pick:bt(_n),isect:Zs(_n)};function RB(a,b){a.beginPath(),Vj(a,b)}var fP={type:"rect",tag:"path",nested:!1,attr:function(a,b){a("d",Vj(null,b))},bound:function(a,b){var c,d;return hh(a.set(c=b.x||0,d=b.y||0,c+b.width||0,d+b.height||0),b)},draw:at(RB),pick:bt(RB),isect:FB};function SB(a,b,c){var d,e,f,g;return!(!b.stroke||!Yj(a,b,c))&&(d=b.x||0,e=b.y||0,f=null!=b.x2?b.x2:d,g=null!=b.y2?b.y2:e,a.beginPath(),a.moveTo(d,e),a.lineTo(f,g),!0)}var gP={type:"rule",tag:"line",nested:!1,attr:function(a,b){a("transform",LB(b)),a("x2",null!=b.x2?b.x2-(b.x||0):0),a("y2",null!=b.y2?b.y2-(b.y||0):0)},bound:function(a,b){var c,d;return hh(a.set(c=b.x||0,d=b.y||0,null!=b.x2?b.x2:c,null!=b.y2?b.y2:d),b)},draw:function(a,b,c){eg(b,function(d){if(!c||c.intersects(d.bounds)){var e=null==d.opacity?1:d.opacity;e&&SB(a,d,e)&&(Xj(a,d),a.stroke())}})},pick:Vn(function(a,b,c,d){return!!a.isPointInStroke&&(SB(a,b,1)&&a.isPointInStroke(c,d))}),isect:GB},hP=ct("shape",function(a,b){return(b.mark.shape||b.shape).context(a)(b)}),iP=ct("symbol",function(a,b){return TO.context(a)(b)},_s);const TB=function(a){let b,c,d;a=+a||1e4;const e=()=>{b={},c={},d=0},f=(g,h)=>(++d>a&&(c=b,b={},d=1),b[g]=h);return e(),{clear:e,has:g=>db(b,g)||db(c,g),get:g=>db(b,g)?b[g]:db(c,g)?f(g,c[g]):void 0,set:(g,h)=>db(b,g)?b[g]=h:f(g,h)}}();var $j={height:Fg,measureWidth:it,estimateWidth:ht,width:ht,canvas:UB};function UB(a){$j.width=a&&Uh?it:ht}function ht(a,b){return VB(Wh(a,b),Fg(a))}function VB(a,b){return~~(.8*a.length*b)}function it(a,b){return Fg(a)<=0||!(b=Wh(a,b))?0:WB(b,$n(a))}function WB(a,b){const c=`(${b}) ${a}`;let d=TB.get(c);return void 0===d&&(Uh.font=b,d=Uh.measureText(a).width,TB.set(c,d)),d}function Fg(a){return null!=a.fontSize?+a.fontSize||0:11}function Vh(a){return null!=a.lineHeight?a.lineHeight:Fg(a)+2}function tl(a){return b=a.lineBreak&&a.text&&!U(a.text)?a.text.split(a.lineBreak):a.text,U(b)?b.length>1?b:b[0]:b;var b}function jt(a){const b=tl(a);return(U(b)?b.length-1:0)*Vh(a)}function Wh(a,b){const c=null==b?"":(b+"").trim();return a.limit>0&&c.length?function(d,e){var f=+d.limit,g=function(m){if($j.width===it){const n=$n(m);return o=>WB(o,n)}{const n=Fg(m);return o=>VB(o,n)}}(d);if(g(e)<f)return e;var h,i=d.ellipsis||"",j="rtl"===d.dir,k=0,l=e.length;if(f-=g(i),j){for(;k<l;)h=k+l>>>1,g(e.slice(h))>f?k=h+1:l=h;return i+e.slice(k)}for(;k<l;)h=1+(k+l>>>1),g(e.slice(0,h))<f?k=h:l=h-1;return e.slice(0,k)+i}(a,c):c}function ul(a,b){var c=a.font;return(b&&c?String(c).replace(/"/g,"'"):c)||"sans-serif"}function $n(a,b){return(a.fontStyle?a.fontStyle+" ":"")+(a.fontVariant?a.fontVariant+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+Fg(a)+"px "+ul(a,b)}function kt(a){var b=a.baseline,c=Fg(a);return Math.round("top"===b?.79*c:"middle"===b?.3*c:"bottom"===b?-.21*c:"line-top"===b?.29*c+.5*Vh(a):"line-bottom"===b?.29*c-.5*Vh(a):0)}UB(!0);var jP={left:"start",center:"middle",right:"end"},vl=new Pd();function ao(a){var b,c=a.x||0,d=a.y||0,e=a.radius||0;return e&&(b=(a.theta||0)-Pi,c+=e*Math.cos(b),d+=e*Math.sin(b)),vl.x1=c,vl.y1=d,vl}function lt(a,b,c){var d,e=$j.height(b),f=b.align,g=ao(b),h=g.x1,i=g.y1,j=b.dx||0,k=(b.dy||0)+kt(b)-Math.round(.8*e),l=tl(b);if(U(l)?(e+=Vh(b)*(l.length-1),d=l.reduce((m,n)=>Math.max(m,$j.width(b,n)),0)):d=$j.width(b,l),"center"===f?j-=d/2:"right"===f&&(j-=d),a.set(j+=h,k+=i,j+d,k+e),b.angle&&!c)a.rotate(b.angle*fh,h,i);else if(2===c)return a.rotatedPoints(b.angle*fh,h,i);return a}var Lf={arc:_O,area:$O,group:bP,image:cP,line:dP,path:eP,rect:fP,rule:gP,shape:hP,symbol:iP,text:{type:"text",tag:"text",nested:!1,attr:function(a,b){var c,d=b.dx||0,e=(b.dy||0)+kt(b),f=ao(b),g=f.x1,h=f.y1,i=b.angle||0;a("text-anchor",jP[b.align]||"start"),i?(c=Zj(g,h)+" "+KB(i),(d||e)&&(c+=" "+Zj(d,e))):c=Zj(g+d,h+e),a("transform",c)},bound:lt,draw:function(a,b,c){eg(b,function(d){var e,f,g,h,i,j,k,l=null==d.opacity?1:d.opacity;if(!(c&&!c.intersects(d.bounds)||0===l||d.fontSize<=0||null==d.text||0===d.text.length)){if(a.font=$n(d),a.textAlign=d.align||"left",f=(e=ao(d)).x1,g=e.y1,d.angle&&(a.save(),a.translate(f,g),a.rotate(d.angle*fh),f=g=0),f+=d.dx||0,g+=(d.dy||0)+kt(d),j=tl(d),Xj(a,d),U(j))for(i=Vh(d),h=0;h<j.length;++h)k=Wh(d,j[h]),d.fill&&Tn(a,d,l)&&a.fillText(k,f,g),d.stroke&&Yj(a,d,l)&&a.strokeText(k,f,g),g+=i;else k=Wh(d,j),d.fill&&Tn(a,d,l)&&a.fillText(k,f,g),d.stroke&&Yj(a,d,l)&&a.strokeText(k,f,g);d.angle&&a.restore()}})},pick:Vn(function(a,b,c,d,e,f){if(b.fontSize<=0)return!1;if(!b.angle)return!0;var g=ao(b),h=g.x1,i=g.y1,j=lt(vl,b,1),k=-b.angle*fh,l=Math.cos(k),m=Math.sin(k),n=l*e-m*f+(h-l*h+m*i),o=m*e+l*f+(i-m*h-l*i);return j.contains(n,o)}),isect:function(a,b){var c=lt(vl,a,2);return Wj(b,c[0],c[1],c[2],c[3])||Wj(b,c[0],c[1],c[4],c[5])||Wj(b,c[4],c[5],c[6],c[7])||Wj(b,c[2],c[3],c[6],c[7])}},trail:dt("trail",function(a,b){return UO.context(a)(b)},function(a,b){for(var c,d,e=a.length;--e>=0;)if(!1!==a[e].defined&&(c=a[e].x-b[0])*c+(d=a[e].y-b[1])*d<(c=a[e].size||1)*c)return a[e];return null})};function mt(a,b,c){var d=Lf[a.mark.marktype],e=b||d.bound;return d.nested&&(a=a.mark),e(a.bounds||(a.bounds=new Pd()),a,c)}var XB={mark:null};function YB(a,b,c){var d,e,f,g,h=Lf[a.marktype],i=h.bound,j=a.items,k=j&&j.length;if(h.nested)return k?f=j[0]:(XB.mark=a,f=XB),g=mt(f,i,c),b=b&&b.union(g)||g;if(b=b||a.bounds&&a.bounds.clear()||new Pd(),k)for(d=0,e=j.length;d<e;++d)b.union(mt(j[d],i,c));return a.bounds=b}var kP=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function ZB(a,b){return JSON.stringify(a,kP,b)}function _B(a){return function b(c){var d,e,f,g=c.marktype,h=c.items;if(h)for(e=0,f=h.length;e<f;++e)d=g?"mark":"group",h[e][d]=c,h[e].zindex&&(h[e][d].zdirty=!0),"group"===(g||d)&&b(h[e]);return g&&YB(c),c}("string"==typeof a?JSON.parse(a):a)}function nt(a){arguments.length?this.root=_B(a):(this.root=aC({marktype:"group",name:"root",role:"frame"}),this.root.items=[new On(this.root)])}var $B=nt.prototype;function aC(a,b){const c={bounds:new Pd(),clip:!!a.clip,group:b,interactive:!1!==a.interactive,items:[],marktype:a.marktype,name:a.name||void 0,role:a.role||void 0,zindex:a.zindex||0};return null!=a.aria&&(c.aria=a.aria),a.description&&(c.description=a.description),c}function Xh(a,b,c){return!a&&"undefined"!=typeof document&&document.createElement&&(a=document),a?c?a.createElementNS(c,b):a.createElement(b):null}function ot(a,b){b=b.toLowerCase();for(var c=a.childNodes,d=0,e=c.length;d<e;++d)if(c[d].tagName.toLowerCase()===b)return c[d]}function vf(a,b,c,d){var e,f=a.childNodes[b];return f&&f.tagName.toLowerCase()===c.toLowerCase()||(e=f||null,f=Xh(a.ownerDocument,c,d),a.insertBefore(f,e)),f}function fg(a,b){for(var c=a.childNodes,d=c.length;d>b;)a.removeChild(c[--d]);return a}function bC(a){return"mark-"+a.marktype+(a.role?" role-"+a.role:"")+(a.name?" "+a.name:"")}function bo(a,b){var c=b.getBoundingClientRect();return[a.clientX-c.left-(b.clientLeft||0),a.clientY-c.top-(b.clientTop||0)]}function Yh(a,b){this._active=null,this._handlers={},this._loader=a||tn(),this._tooltip=b||lP}function lP(a,b,c,d){a.element().setAttribute("title",d||"")}$B.toJSON=function(a){return ZB(this.root,a||0)},$B.mark=function(a,b,c){var d=aC(a,b=b||this.root.items[0]);return b.items[c]=d,d.zindex&&(d.group.zdirty=!0),d};const wf=Yh.prototype;function gg(a){this._el=null,this._bgcolor=null,this._loader=new Xs(a)}wf.initialize=function(a,b,c){return this._el=a,this._obj=c||null,this.origin(b)},wf.element=function(){return this._el},wf.canvas=function(){return this._el&&this._el.firstChild},wf.origin=function(a){return arguments.length?(this._origin=a||[0,0],this):this._origin.slice()},wf.scene=function(a){return arguments.length?(this._scene=a,this):this._scene},wf.on=function(){},wf.off=function(){},wf._handlerIndex=function(a,b,c){for(let d=a?a.length:0;--d>=0;)if(a[d].type===b&&(!c||a[d].handler===c))return d;return-1},wf.handlers=function(a){const b=this._handlers,c=[];if(a)c.push.apply(c,b[this.eventName(a)]);else for(const d in b)c.push.apply(c,b[d]);return c},wf.eventName=function(a){const b=a.indexOf(".");return b<0?a:a.slice(0,b)},wf.handleHref=function(a,b,c){this._loader.sanitize(c,{context:"href"}).then(d=>{const e=new MouseEvent(a.type,a),f=Xh(null,"a");for(const g in d)f.setAttribute(g,d[g]);f.dispatchEvent(e)}).catch(function(){})},wf.handleTooltip=function(a,b,c){if(b&&null!=b.tooltip){b=function(e,f,g,h){var i,j,k=e&&e.mark;if(k&&(i=Lf[k.marktype]).tip){for((j=bo(f,g))[0]-=h[0],j[1]-=h[1];e=e.mark.group;)j[0]-=e.x||0,j[1]-=e.y||0;e=i.tip(k.items,j)}return e}(b,a,this.canvas(),this._origin);const d=c&&b&&b.tooltip||null;this._tooltip.call(this._obj,this,a,b,d)}},wf.getItemBoundingClientRect=function(a){const b=this.canvas();if(!b)return;const c=b.getBoundingClientRect(),d=this._origin,e=a.bounds,f=e.width(),g=e.height();let h=e.x1+d[0]+c.left,i=e.y1+d[1]+c.top;for(;a.mark&&(a=a.mark.group);)h+=a.x||0,i+=a.y||0;return{x:h,y:i,width:f,height:g,left:h,top:i,right:h+f,bottom:i+g}};var Mf=gg.prototype;Mf.initialize=function(a,b,c,d,e){return this._el=a,this.resize(b,c,d,e)},Mf.element=function(){return this._el},Mf.canvas=function(){return this._el&&this._el.firstChild},Mf.background=function(a){return 0===arguments.length?this._bgcolor:(this._bgcolor=a,this)},Mf.resize=function(a,b,c,d){return this._width=a,this._height=b,this._origin=c||[0,0],this._scale=d||1,this},Mf.dirty=function(){},Mf.render=function(a){var b=this;return b._call=function(){b._render(a)},b._call(),b._call=null,b},Mf._render=function(){},Mf.renderAsync=function(a){var b=this.render(a);return this._ready?this._ready.then(function(){return b}):Promise.resolve(b)},Mf._load=function(a,b){var c=this,d=c._loader[a](b);if(!c._ready){var e=c._call;c._ready=c._loader.ready().then(function(f){f&&e(),c._ready=null})}return d},Mf.sanitizeURL=function(a){return this._load("sanitizeURL",a)},Mf.loadImage=function(a){return this._load("loadImage",a)};const co="dragleave",pt="mousedown",eo="mousemove",wl="mouseout",fo="click",mP=["keydown","keypress","keyup","dragenter",co,"dragover",pt,"mouseup",eo,wl,"mouseover",fo,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],qt=eo,xl=wl,rt=fo;function yl(a,b){Yh.call(this,a,b),this._down=null,this._touch=null,this._first=!0,this._events={}}const Qd=Da(yl,Yh);Qd.initialize=function(a,b,c){return this._canvas=a&&ot(a,"canvas"),[fo,pt,eo,wl,co].forEach(d=>cC(this,d)),Yh.prototype.initialize.call(this,a,b,c)};function cC(a,b){(c=>"touchstart"===c||"touchmove"===c||"touchend"===c?["touchstart","touchmove","touchend"]:[c])(b).forEach(c=>function(d,e){const f=d.canvas();f&&!d._events[e]&&(d._events[e]=1,f.addEventListener(e,d[e]?g=>d[e](g):g=>d.fire(e,g)))}(a,c))}function dC(a,b,c){return function(d){const e=this._active,f=this.pickEvent(d);f===e||(e&&e.exit||this.fire(c,d),this._active=f,this.fire(b,d)),this.fire(a,d)}}function eC(a){return function(b){this.fire(a,b),this._active=null}}Qd.canvas=function(){return this._canvas},Qd.context=function(){return this._canvas.getContext("2d")},Qd.events=mP,Qd.DOMMouseScroll=function(a){this.fire("mousewheel",a)},Qd.mousemove=dC(eo,"mouseover",wl),Qd.dragover=dC("dragover","dragenter",co),Qd.mouseout=eC(wl),Qd.dragleave=eC(co),Qd.mousedown=function(a){this._down=this._active,this.fire(pt,a)},Qd.click=function(a){this._down===this._active&&(this.fire(fo,a),this._down=null)},Qd.touchstart=function(a){this._touch=this.pickEvent(a.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",a,!0)},Qd.touchmove=function(a){this.fire("touchmove",a,!0)},Qd.touchend=function(a){this.fire("touchend",a,!0),this._touch=null},Qd.fire=function(a,b,c){const d=c?this._touch:this._active,e=this._handlers[a];if(b.vegaType=a,a===rt&&d&&d.href?this.handleHref(b,d,d.href):a!==qt&&a!==xl||this.handleTooltip(b,d,a!==xl),e)for(let f=0,g=e.length;f<g;++f)e[f].handler.call(this._obj,b,d)},Qd.on=function(a,b){const c=this.eventName(a),d=this._handlers;return this._handlerIndex(d[c],a,b)<0&&(cC(this,a),(d[c]||(d[c]=[])).push({type:a,handler:b})),this},Qd.off=function(a,b){const c=this.eventName(a),d=this._handlers[c],e=this._handlerIndex(d,a,b);return e>=0&&d.splice(e,1),this},Qd.pickEvent=function(a){const b=bo(a,this._canvas),c=this._origin;return this.pick(this._scene,b[0],b[1],b[0]-c[0],b[1]-c[1])},Qd.pick=function(a,b,c,d,e){const f=this.context();return Lf[a.marktype].pick.call(this,f,a,b,c,d,e)};var nP="undefined"!=typeof window&&window.devicePixelRatio||1;function go(a){gg.call(this,a),this._options={},this._redraw=!1,this._dirty=new Pd(),this._tempb=new Pd()}const Zh=Da(go,gg),fC=gg.prototype;Zh.initialize=function(a,b,c,d,e,f){return this._options=f||{},this._canvas=this._options.externalContext?null:ql(1,1,this._options.type),a&&this._canvas&&(fg(a,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),fC.initialize.call(this,a,b,c,d,e)},Zh.resize=function(a,b,c,d){if(fC.resize.call(this,a,b,c,d),this._canvas)!function(e,f,g,h,i,j){const k="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,l=e.getContext("2d"),m=k?nP:i;e.width=f*m,e.height=g*m;for(const n in j)l[n]=j[n];k&&1!==m&&(e.style.width=f+"px",e.style.height=g+"px"),l.pixelRatio=m,l.setTransform(m,0,0,m,m*h[0],m*h[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||ja("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},Zh.canvas=function(){return this._canvas},Zh.context=function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},Zh.dirty=function(a){let b=this._tempb.clear().union(a.bounds),c=a.mark.group;for(;c;)b.translate(c.x||0,c.y||0),c=c.mark.group;this._dirty.union(b)};function st(a,b){Yh.call(this,a,b);const c=this;c._hrefHandler=tt(c,(d,e)=>{e&&e.href&&c.handleHref(d,e,e.href)}),c._tooltipHandler=tt(c,(d,e)=>{c.handleTooltip(d,e,d.type!==xl)})}Zh._render=function(a){const b=this.context(),c=this._origin,d=this._width,e=this._height,f=this._dirty,g=((i,j,k)=>new Pd().set(0,0,j,k).translate(-i[0],-i[1]))(c,d,e);b.save();const h=this._redraw||f.empty()?(this._redraw=!1,g.expand(1)):function(i,j,k){return j.expand(1).round(),i.pixelRatio%1&&j.scale(i.pixelRatio).round().scale(1/i.pixelRatio),j.translate(-k[0]%1,-k[1]%1),i.beginPath(),i.rect(j.x1,j.y1,j.width(),j.height()),i.clip(),j}(b,g.intersect(f),c);return this.clear(-c[0],-c[1],d,e),this.draw(b,a,h),b.restore(),f.clear(),this},Zh.draw=function(a,b,c){const d=Lf[b.marktype];b.clip&&function(e,f){var g=f.clip;e.save(),Ub(g)?(e.beginPath(),g(e),e.clip()):NB(e,f.group)}(a,b),d.draw.call(this,a,b,c),b.clip&&a.restore()},Zh.clear=function(a,b,c,d){const e=this._options,f=this.context();"pdf"===e.type||e.externalContext||f.clearRect(a,b,c,d),null!=this._bgcolor&&(f.fillStyle=this._bgcolor,f.fillRect(a,b,c,d))};const ho=Da(st,Yh);ho.initialize=function(a,b,c){let d=this._svg;return d&&(d.removeEventListener(rt,this._hrefHandler),d.removeEventListener(qt,this._tooltipHandler),d.removeEventListener(xl,this._tooltipHandler)),this._svg=d=a&&ot(a,"svg"),d&&(d.addEventListener(rt,this._hrefHandler),d.addEventListener(qt,this._tooltipHandler),d.addEventListener(xl,this._tooltipHandler)),Yh.prototype.initialize.call(this,a,b,c)},ho.canvas=function(){return this._svg};const tt=(a,b)=>c=>{let d=c.target.__data__;d=Array.isArray(d)?d[0]:d,c.vegaType=c.type,b.call(a._obj,c,d)};function ut(a,b,c){var d=a-b+2*c;return a?d>0?d:1:0}ho.on=function(a,b){const c=this.eventName(a),d=this._handlers;if(this._handlerIndex(d[c],a,b)<0){const e={type:a,handler:b,listener:tt(this,b)};(d[c]||(d[c]=[])).push(e),this._svg&&this._svg.addEventListener(c,e.listener)}return this},ho.off=function(a,b){const c=this.eventName(a),d=this._handlers[c],e=this._handlerIndex(d,a,b);return e>=0&&(this._svg&&this._svg.removeEventListener(c,d[e].listener),d.splice(e,1)),this};const Ri="log",Si="time",Ti="utc",Rd="continuous";function Gg(a,b){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(b).domain(a)}return this}function _h(a,b){switch(arguments.length){case 0:break;case 1:"function"==typeof a?this.interpolator(a):this.range(a);break;default:this.domain(a),"function"==typeof b?this.interpolator(b):this.range(b)}return this}const vt=Symbol("implicit");function wt(){var a=new Map(),b=[],c=[],d=vt;function e(f){var g=f+"",h=a.get(g);if(!h){if(d!==vt)return d;a.set(g,h=b.push(f))}return c[(h-1)%c.length]}return e.domain=function(f){if(!arguments.length)return b.slice();b=[],a=new Map();for(const g of f){const h=g+"";a.has(h)||a.set(h,b.push(g))}return e},e.range=function(f){return arguments.length?(c=Array.from(f),e):c.slice()},e.unknown=function(f){return arguments.length?(d=f,e):d},e.copy=function(){return wt(b,c).unknown(d)},Gg.apply(e,arguments),e}function ak(a,b,c){a.prototype=b.prototype=c,c.constructor=a}function zl(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}function $h(){}var bk="\\s*([+-]?\\d+)\\s*",Al="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oP=/^#([0-9a-f]{3,8})$/,pP=new RegExp("^rgb\\("+[bk,bk,bk]+"\\)$"),qP=new RegExp("^rgb\\("+[Hg,Hg,Hg]+"\\)$"),rP=new RegExp("^rgba\\("+[bk,bk,bk,Al]+"\\)$"),sP=new RegExp("^rgba\\("+[Hg,Hg,Hg,Al]+"\\)$"),tP=new RegExp("^hsl\\("+[Al,Hg,Hg]+"\\)$"),uP=new RegExp("^hsla\\("+[Al,Hg,Hg,Al]+"\\)$"),gC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hC(){return this.rgb().formatHex()}function iC(){return this.rgb().formatRgb()}function Bl(a){var b,c;return a=(a+"").trim().toLowerCase(),(b=oP.exec(a))?(c=b[1].length,b=parseInt(b[1],16),6===c?jC(b):3===c?new ge(b>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1):8===c?io(b>>24&255,b>>16&255,b>>8&255,(255&b)/255):4===c?io(b>>12&15|b>>8&240,b>>8&15|b>>4&240,b>>4&15|240&b,((15&b)<<4|15&b)/255):null):(b=pP.exec(a))?new ge(b[1],b[2],b[3],1):(b=qP.exec(a))?new ge(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=rP.exec(a))?io(b[1],b[2],b[3],b[4]):(b=sP.exec(a))?io(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=tP.exec(a))?mC(b[1],b[2]/100,b[3]/100,1):(b=uP.exec(a))?mC(b[1],b[2]/100,b[3]/100,b[4]):gC.hasOwnProperty(a)?jC(gC[a]):"transparent"===a?new ge(NaN,NaN,NaN,0):null}function jC(a){return new ge(a>>16&255,a>>8&255,255&a,1)}function io(a,b,c,d){return d<=0&&(a=b=c=NaN),new ge(a,b,c,d)}function xt(a){return a instanceof $h||(a=Bl(a)),a?new ge((a=a.rgb()).r,a.g,a.b,a.opacity):new ge()}function ai(a,b,c,d){return 1===arguments.length?xt(a):new ge(a,b,c,null==d?1:d)}function ge(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function kC(){return"#"+yt(this.r)+yt(this.g)+yt(this.b)}function lC(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}function yt(a){return((a=Math.max(0,Math.min(255,Math.round(a)||0)))<16?"0":"")+a.toString(16)}function mC(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new Ig(a,b,c,d)}function nC(a){if(a instanceof Ig)return new Ig(a.h,a.s,a.l,a.opacity);if(a instanceof $h||(a=Bl(a)),!a)return new Ig();if(a instanceof Ig)return a;var b=(a=a.rgb()).r/255,c=a.g/255,d=a.b/255,e=Math.min(b,c,d),f=Math.max(b,c,d),g=NaN,h=f-e,i=(f+e)/2;return h?(g=b===f?(c-d)/h+6*(c<d):c===f?(d-b)/h+2:(b-c)/h+4,h/=i<.5?f+e:2-f-e,g*=60):h=i>0&&i<1?0:g,new Ig(g,h,i,a.opacity)}function jo(a,b,c,d){return 1===arguments.length?nC(a):new Ig(a,b,c,null==d?1:d)}function Ig(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function zt(a,b,c){return 255*(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)}ak($h,Bl,{copy:function(a){return Object.assign(new this.constructor(),this,a)},displayable:function(){return this.rgb().displayable()},hex:hC,formatHex:hC,formatHsl:function(){return nC(this).formatHsl()},formatRgb:iC,toString:iC}),ak(ge,ai,zl($h,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new ge(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new ge(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kC,formatHex:kC,formatRgb:lC,toString:lC})),ak(Ig,jo,zl($h,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new Ig(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new Ig(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(c<.5?c:1-c)*b,e=2*c-d;return new ge(zt(a>=240?a-240:a+120,e,d),zt(a,e,d),zt(a<120?a+240:a-120,e,d),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===a?")":", "+a+")")}}));var oC=Math.PI/180,pC=180/Math.PI,qC=6/29*3*(6/29);function rC(a){if(a instanceof Jg)return new Jg(a.l,a.a,a.b,a.opacity);if(a instanceof ih)return sC(a);a instanceof ge||(a=xt(a));var b,c,d=Dt(a.r),e=Dt(a.g),f=Dt(a.b),g=At((.2225045*d+.7168786*e+.0606169*f)/1);return d===e&&e===f?b=c=g:(b=At((.4360747*d+.3850649*e+.1430804*f)/.96422),c=At((.0139322*d+.0971045*e+.7141733*f)/.82521)),new Jg(116*g-16,500*(b-g),200*(g-c),a.opacity)}function ko(a,b,c,d){return 1===arguments.length?rC(a):new Jg(a,b,c,null==d?1:d)}function Jg(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function At(a){return a>6/29*(6/29)*(6/29)?Math.pow(a,1/3):a/qC+4/29}function Bt(a){return a>6/29?a*a*a:qC*(a-4/29)}function Ct(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Dt(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function vP(a){if(a instanceof ih)return new ih(a.h,a.c,a.l,a.opacity);if(a instanceof Jg||(a=rC(a)),0===a.a&&0===a.b)return new ih(NaN,0<a.l&&a.l<100?0:NaN,a.l,a.opacity);var b=Math.atan2(a.b,a.a)*pC;return new ih(b<0?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function lo(a,b,c,d){return 1===arguments.length?vP(a):new ih(a,b,c,null==d?1:d)}function ih(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}function sC(a){if(isNaN(a.h))return new Jg(a.l,0,0,a.opacity);var b=a.h*oC;return new Jg(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}ak(Jg,ko,zl($h,{brighter:function(a){return new Jg(this.l+18*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new Jg(this.l-18*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return new ge(Ct(3.1338561*(b=.96422*Bt(b))-1.6168667*(a=1*Bt(a))-.4906146*(c=.82521*Bt(c))),Ct(-.9787684*b+1.9161415*a+.033454*c),Ct(.0719453*b-.2289914*a+1.4052427*c),this.opacity)}})),ak(ih,lo,zl($h,{brighter:function(a){return new ih(this.h,this.c,this.l+18*(null==a?1:a),this.opacity)},darker:function(a){return new ih(this.h,this.c,this.l-18*(null==a?1:a),this.opacity)},rgb:function(){return sC(this).rgb()}}));var tC=-.14861,Et=1.78277,Ft=-.29227,mo=-.90649,Cl=1.97294,uC=Cl*mo,vC=Cl*Et,wC=Et*Ft-mo*tC;function wP(a){if(a instanceof Ui)return new Ui(a.h,a.s,a.l,a.opacity);a instanceof ge||(a=xt(a));var b=a.r/255,c=a.g/255,d=a.b/255,e=(wC*d+uC*b-vC*c)/(wC+uC-vC),f=d-e,g=(Cl*(c-e)-Ft*f)/mo,h=Math.sqrt(g*g+f*f)/(Cl*e*(1-e)),i=h?Math.atan2(g,f)*pC-120:NaN;return new Ui(i<0?i+360:i,h,e,a.opacity)}function Gt(a,b,c,d){return 1===arguments.length?wP(a):new Ui(a,b,c,null==d?1:d)}function Ui(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function xC(a,b,c,d,e){var f=a*a,g=f*a;return((1-3*a+3*f-g)*b+(4-6*f+3*g)*c+(1+3*a+3*f-3*g)*d+g*e)/6}function yC(a){var b=a.length-1;return function(c){var d=c<=0?c=0:c>=1?(c=1,b-1):Math.floor(c*b),e=a[d],f=a[d+1],g=d>0?a[d-1]:2*e-f,h=d<b-1?a[d+2]:2*f-e;return xC((c-d/b)*b,g,e,f,h)}}function zC(a){var b=a.length;return function(c){var d=Math.floor(((c%=1)<0?++c:c)*b),e=a[(d+b-1)%b],f=a[d%b],g=a[(d+1)%b],h=a[(d+2)%b];return xC((c-d/b)*b,e,f,g,h)}}function no(a){return function(){return a}}function AC(a,b){return function(c){return a+c*b}}function oo(a,b){var c=b-a;return c?AC(a,c>180||c<-180?c-360*Math.round(c/360):c):no(isNaN(a)?b:a)}function xP(a){return 1==(a=+a)?Wd:function(b,c){return c-b?function(d,e,f){return d=Math.pow(d,f),e=Math.pow(e,f)-d,f=1/f,function(g){return Math.pow(d+g*e,f)}}(b,c,a):no(isNaN(b)?c:b)}}function Wd(a,b){var c=b-a;return c?AC(a,c):no(isNaN(a)?b:a)}ak(Ui,Gt,zl($h,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new Ui(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new Ui(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=isNaN(this.h)?0:(this.h+120)*oC,b=+this.l,c=isNaN(this.s)?0:this.s*b*(1-b),d=Math.cos(a),e=Math.sin(a);return new ge(255*(b+c*(tC*d+Et*e)),255*(b+c*(Ft*d+mo*e)),255*(b+c*(Cl*d)),this.opacity)}}));var Ht=function a(b){var c=xP(b);function d(e,f){var g=c((e=ai(e)).r,(f=ai(f)).r),h=c(e.g,f.g),i=c(e.b,f.b),j=Wd(e.opacity,f.opacity);return function(k){return e.r=g(k),e.g=h(k),e.b=i(k),e.opacity=j(k),e+""}}return d.gamma=a,d}(1);function BC(a){return function(b){var c,d,e=b.length,f=new Array(e),g=new Array(e),h=new Array(e);for(c=0;c<e;++c)d=ai(b[c]),f[c]=d.r||0,g[c]=d.g||0,h[c]=d.b||0;return f=a(f),g=a(g),h=a(h),d.opacity=1,function(i){return d.r=f(i),d.g=g(i),d.b=h(i),d+""}}}var yP=BC(yC),zP=BC(zC);function It(a,b){b||(b=[]);var c,d=a?Math.min(b.length,a.length):0,e=b.slice();return function(f){for(c=0;c<d;++c)e[c]=a[c]*(1-f)+b[c]*f;return e}}function CC(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function DC(a,b){var c,d=b?b.length:0,e=a?Math.min(d,a.length):0,f=new Array(e),g=new Array(d);for(c=0;c<e;++c)f[c]=Vi(a[c],b[c]);for(;c<d;++c)g[c]=b[c];return function(h){for(c=0;c<e;++c)g[c]=f[c](h);return g}}function EC(a,b){var c=new Date();return a=+a,b=+b,function(d){return c.setTime(a*(1-d)+b*d),c}}function hg(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function FC(a,b){var c,d={},e={};for(c in(null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b))c in a?d[c]=Vi(a[c],b[c]):e[c]=b[c];return function(f){for(c in d)e[c]=d[c](f);return e}}var Jt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Kt=new RegExp(Jt.source,"g");function GC(a,b){var c,d,e,f=Jt.lastIndex=Kt.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=Jt.exec(a))&&(d=Kt.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:hg(c,d)})),f=Kt.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?function(j){return function(k){return j(k)+""}}(i[0].x):function(j){return function(){return j}}(b):(b=i.length,function(j){for(var k,l=0;l<b;++l)h[(k=i[l]).i]=k.x(j);return h.join("")})}function Vi(a,b){var c,d=typeof b;return null==b||"boolean"===d?no(b):("number"===d?hg:"string"===d?(c=Bl(b))?(b=c,Ht):GC:b instanceof Bl?Ht:b instanceof Date?EC:CC(b)?It:Array.isArray(b)?DC:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?FC:hg)(a,b)}function Dl(a,b){return a=+a,b=+b,function(c){return Math.round(a*(1-c)+b*c)}}var El,Lt,HC,po,IC=180/Math.PI,Mt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function JC(a,b,c,d,e,f){var g,h,i;return(g=Math.sqrt(a*a+b*b))&&(a/=g,b/=g),(i=a*c+b*d)&&(c-=a*i,d-=b*i),(h=Math.sqrt(c*c+d*d))&&(c/=h,d/=h,i/=h),a*d<b*c&&(a=-a,b=-b,i=-i,g=-g),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*IC,skewX:Math.atan(i)*IC,scaleX:g,scaleY:h}}function KC(a,b,c,d){function e(f){return f.length?f.pop()+" ":""}return function(f,g){var h=[],i=[];return f=a(f),g=a(g),function(j,k,l,m,n,o){if(j!==l||k!==m){var p=n.push("translate(",null,b,null,c);o.push({i:p-4,x:hg(j,l)},{i:p-2,x:hg(k,m)})}else(l||m)&&n.push("translate("+l+b+m+c)}(f.translateX,f.translateY,g.translateX,g.translateY,h,i),function(j,k,l,m){j!==k?(j-k>180?k+=360:k-j>180&&(j+=360),m.push({i:l.push(e(l)+"rotate(",null,d)-2,x:hg(j,k)})):k&&l.push(e(l)+"rotate("+k+d)}(f.rotate,g.rotate,h,i),function(j,k,l,m){j!==k?m.push({i:l.push(e(l)+"skewX(",null,d)-2,x:hg(j,k)}):k&&l.push(e(l)+"skewX("+k+d)}(f.skewX,g.skewX,h,i),function(j,k,l,m,n,o){if(j!==l||k!==m){var p=n.push(e(n)+"scale(",null,",",null,")");o.push({i:p-4,x:hg(j,l)},{i:p-2,x:hg(k,m)})}else 1===l&&1===m||n.push(e(n)+"scale("+l+","+m+")")}(f.scaleX,f.scaleY,g.scaleX,g.scaleY,h,i),f=g=null,function(j){for(var k,l=-1,m=i.length;++l<m;)h[(k=i[l]).i]=k.x(j);return h.join("")}}}var AP=KC(function(a){return"none"===a?Mt:(El||(El=document.createElement("DIV"),Lt=document.documentElement,HC=document.defaultView),El.style.transform=a,a=HC.getComputedStyle(Lt.appendChild(El),null).getPropertyValue("transform"),Lt.removeChild(El),JC(+(a=a.slice(7,-1).split(","))[0],+a[1],+a[2],+a[3],+a[4],+a[5]))},"px, ","px)","deg)"),BP=KC(function(a){return null==a?Mt:(po||(po=document.createElementNS("http://www.w3.org/2000/svg","g")),po.setAttribute("transform",a),(a=po.transform.baseVal.consolidate())?JC((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):Mt)},", ",")",")"),Fl=Math.SQRT2;function LC(a){return((a=Math.exp(a))+1/a)/2}function MC(a){return function(b,c){var d=a((b=jo(b)).h,(c=jo(c)).h),e=Wd(b.s,c.s),f=Wd(b.l,c.l),g=Wd(b.opacity,c.opacity);return function(h){return b.h=d(h),b.s=e(h),b.l=f(h),b.opacity=g(h),b+""}}}var CP=MC(oo),DP=MC(Wd);function NC(a){return function(b,c){var d=a((b=lo(b)).h,(c=lo(c)).h),e=Wd(b.c,c.c),f=Wd(b.l,c.l),g=Wd(b.opacity,c.opacity);return function(h){return b.h=d(h),b.c=e(h),b.l=f(h),b.opacity=g(h),b+""}}}var EP=NC(oo),FP=NC(Wd);function OC(a){return function b(c){function d(e,f){var g=a((e=Gt(e)).h,(f=Gt(f)).h),h=Wd(e.s,f.s),i=Wd(e.l,f.l),j=Wd(e.opacity,f.opacity);return function(k){return e.h=g(k),e.s=h(k),e.l=i(Math.pow(k,c)),e.opacity=j(k),e+""}}return c=+c,d.gamma=b,d}(1)}var GP=OC(oo),HP=OC(Wd);function Nt(a,b){for(var c=0,d=b.length-1,e=b[0],f=new Array(d<0?0:d);c<d;)f[c]=a(e,e=b[++c]);return function(g){var h=Math.max(0,Math.min(d-1,Math.floor(g*=d)));return f[h](g-h)}}var IP=Object.freeze({__proto__:null,interpolate:Vi,interpolateArray:function(a,b){return(CC(b)?It:DC)(a,b)},interpolateBasis:yC,interpolateBasisClosed:zC,interpolateDate:EC,interpolateDiscrete:function(a){var b=a.length;return function(c){return a[Math.max(0,Math.min(b-1,Math.floor(c*b)))]}},interpolateHue:function(a,b){var c=oo(+a,+b);return function(d){var e=c(d);return e-360*Math.floor(e/360)}},interpolateNumber:hg,interpolateNumberArray:It,interpolateObject:FC,interpolateRound:Dl,interpolateString:GC,interpolateTransformCss:AP,interpolateTransformSvg:BP,interpolateZoom:function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(m<1e-12)d=Math.log(j/g)/Fl,c=function(r){return[e+r*k,f+r*l,g*Math.exp(Fl*r*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+4*m)/(2*g*2*n),p=(j*j-g*g-4*m)/(2*j*2*n),q=Math.log(Math.sqrt(o*o+1)-o),s=Math.log(Math.sqrt(p*p+1)-p);d=(s-q)/Fl,c=function(r){var u=r*d,t=LC(q),w=g/(2*n)*(t*function(x){return((x=Math.exp(2*x))-1)/(x+1)}(Fl*u+q)-function(x){return((x=Math.exp(x))-1/x)/2}(q));return[e+w*k,f+w*l,g*t/LC(Fl*u+q)]}}return c.duration=1e3*d,c},interpolateRgb:Ht,interpolateRgbBasis:yP,interpolateRgbBasisClosed:zP,interpolateHsl:CP,interpolateHslLong:DP,interpolateLab:function(a,b){var c=Wd((a=ko(a)).l,(b=ko(b)).l),d=Wd(a.a,b.a),e=Wd(a.b,b.b),f=Wd(a.opacity,b.opacity);return function(g){return a.l=c(g),a.a=d(g),a.b=e(g),a.opacity=f(g),a+""}},interpolateHcl:EP,interpolateHclLong:FP,interpolateCubehelix:GP,interpolateCubehelixLong:HP,piecewise:Nt,quantize:function(a,b){for(var c=new Array(b),d=0;d<b;++d)c[d]=a(d/(b-1));return c}});function Ot(a){return+a}var PC=[0,1];function ef(a){return a}function Pt(a,b){return(b-=a=+a)?function(c){return(c-a)/b}:function(c){return function(){return c}}(isNaN(b)?NaN:.5)}function JP(a,b,c){var d=a[0],e=a[1],f=b[0],g=b[1];return e<d?(d=Pt(e,d),f=c(g,f)):(d=Pt(d,e),f=c(f,g)),function(h){return f(d(h))}}function KP(a,b,c){var d=Math.min(a.length,b.length)-1,e=new Array(d),f=new Array(d),g=-1;for(a[d]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<d;)e[g]=Pt(a[g],a[g+1]),f[g]=c(b[g],b[g+1]);return function(h){var i=Mh(a,h,1,d)-1;return f[i](e[i](h))}}function Gl(a,b){return b.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function qo(){var a,b,c,d,e,f,g=PC,h=PC,i=Vi,j=ef;function k(){var m=Math.min(g.length,h.length);return j!==ef&&(j=function(n,o){var p;return n>o&&(p=n,n=o,o=p),function(q){return Math.max(n,Math.min(o,q))}}(g[0],g[m-1])),d=m>2?KP:JP,e=f=null,l}function l(m){return isNaN(m=+m)?c:(e||(e=d(g.map(a),h,i)))(a(j(m)))}return l.invert=function(m){return j(b((f||(f=d(h,g.map(a),hg)))(m)))},l.domain=function(m){return arguments.length?(g=Array.from(m,Ot),k()):g.slice()},l.range=function(m){return arguments.length?(h=Array.from(m),k()):h.slice()},l.rangeRound=function(m){return h=Array.from(m),i=Dl,k()},l.clamp=function(m){return arguments.length?(j=!!m||ef,k()):j!==ef},l.interpolate=function(m){return arguments.length?(i=m,k()):i},l.unknown=function(m){return arguments.length?(c=m,l):c},function(m,n){return a=m,b=n,k()}}function QC(){return qo()(ef,ef)}function RC(a,b,c,d){var e,f=Nh(a,b,c);switch((d=Gj(null==d?",f":d)).type){case"s":var g=Math.max(Math.abs(a),Math.abs(b));return null!=d.precision||isNaN(e=cz(f,g))||(d.precision=e),kr(d,g);case"":case"e":case"g":case"p":case"r":null!=d.precision||isNaN(e=dz(f,Math.max(Math.abs(a),Math.abs(b))))||(d.precision=e-("e"===d.type));break;case"f":case"%":null!=d.precision||isNaN(e=bz(f))||(d.precision=e-2*("%"===d.type))}return on(d)}function Wi(a){var b=a.domain;return a.ticks=function(c){var d=b();return gr(d[0],d[d.length-1],null==c?10:c)},a.tickFormat=function(c,d){var e=b();return RC(e[0],e[e.length-1],null==c?10:c,d)},a.nice=function(c){null==c&&(c=10);var d,e=b(),f=0,g=e.length-1,h=e[f],i=e[g];return i<h&&(d=h,h=i,i=d,d=f,f=g,g=d),(d=ln(h,i,c))>0?d=ln(h=Math.floor(h/d)*d,i=Math.ceil(i/d)*d,c):d<0&&(d=ln(h=Math.ceil(h*d)/d,i=Math.floor(i*d)/d,c)),d>0?(e[f]=Math.floor(h/d)*d,e[g]=Math.ceil(i/d)*d,b(e)):d<0&&(e[f]=Math.ceil(h*d)/d,e[g]=Math.floor(i*d)/d,b(e)),a},a}function SC(a,b){var c,d=0,e=(a=a.slice()).length-1,f=a[d],g=a[e];return g<f&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function TC(a){return Math.log(a)}function UC(a){return Math.exp(a)}function LP(a){return-Math.log(-a)}function MP(a){return-Math.exp(-a)}function NP(a){return isFinite(a)?+("1e"+a):a<0?0:a}function VC(a){return function(b){return-a(-b)}}function Qt(a){var b,c,d=a(TC,UC),e=d.domain,f=10;function g(){return b=function(h){return h===Math.E?Math.log:10===h&&Math.log10||2===h&&Math.log2||(h=Math.log(h),function(i){return Math.log(i)/h})}(f),c=function(h){return 10===h?NP:h===Math.E?Math.exp:function(i){return Math.pow(h,i)}}(f),e()[0]<0?(b=VC(b),c=VC(c),a(LP,MP)):a(TC,UC),d}return d.base=function(h){return arguments.length?(f=+h,g()):f},d.domain=function(h){return arguments.length?(e(h),g()):e()},d.ticks=function(h){var i,j=e(),k=j[0],l=j[j.length-1];(i=l<k)&&(p=k,k=l,l=p);var m,n,o,p=b(k),q=b(l),s=null==h?10:+h,r=[];if(!(f%1)&&q-p<s){if(p=Math.floor(p),q=Math.ceil(q),k>0){for(;p<=q;++p)for(n=1,m=c(p);n<f;++n)if(!((o=m*n)<k)){if(o>l)break;r.push(o)}}else for(;p<=q;++p)for(n=f-1,m=c(p);n>=1;--n)if(!((o=m*n)<k)){if(o>l)break;r.push(o)}2*r.length<s&&(r=gr(k,l,s))}else r=gr(p,q,Math.min(q-p,s)).map(c);return i?r.reverse():r},d.tickFormat=function(h,i){if(null==i&&(i=10===f?".0e":","),"function"!=typeof i&&(i=on(i)),h===1/0)return i;null==h&&(h=10);var j=Math.max(1,f*h/d.ticks().length);return function(k){var l=k/c(Math.round(b(k)));return l*f<f-.5&&(l*=f),l<=j?i(k):""}},d.nice=function(){return e(SC(e(),{floor:function(h){return c(Math.floor(b(h)))},ceil:function(h){return c(Math.ceil(b(h)))}}))},d}function WC(a){return function(b){return Math.sign(b)*Math.log1p(Math.abs(b/a))}}function XC(a){return function(b){return Math.sign(b)*Math.expm1(Math.abs(b))*a}}function Rt(a){var b=1,c=a(WC(b),XC(b));return c.constant=function(d){return arguments.length?a(WC(b=+d),XC(b)):b},Wi(c)}function YC(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function OP(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function PP(a){return a<0?-a*a:a*a}function St(a){var b=a(ef,ef),c=1;function d(){return 1===c?a(ef,ef):.5===c?a(OP,PP):a(YC(c),YC(1/c))}return b.exponent=function(e){return arguments.length?(c=+e,d()):c},Wi(b)}function Tt(){var a=St(qo());return a.copy=function(){return Gl(a,Tt()).exponent(a.exponent())},Gg.apply(a,arguments),a}function QP(a){return new Date(a)}function RP(a){return a instanceof Date?+a:+new Date(+a)}function Ut(a,b,c,d,e,f,g,h,i){var j=QC(),k=j.invert,l=j.domain,m=i(".%L"),n=i(":%S"),o=i("%I:%M"),p=i("%I %p"),q=i("%a %d"),s=i("%b %d"),r=i("%B"),u=i("%Y"),t=[[g,1,1e3],[g,5,5e3],[g,15,15e3],[g,30,3e4],[f,1,6e4],[f,5,3e5],[f,15,9e5],[f,30,18e5],[e,1,36e5],[e,3,108e5],[e,6,216e5],[e,12,432e5],[d,1,864e5],[d,2,1728e5],[c,1,6048e5],[b,1,2592e6],[b,3,7776e6],[a,1,31536e6]];function w(z){return(g(z)<z?m:f(z)<z?n:e(z)<z?o:d(z)<z?p:b(z)<z?c(z)<z?q:s:a(z)<z?r:u)(z)}function x(z,A,B){if(null==z&&(z=10),"number"==typeof z){var I,J=Math.abs(B-A)/z,D=kn(function(O){return O[2]}).right(t,J);return D===t.length?(I=Nh(A/31536e6,B/31536e6,z),z=a):D?(I=(D=t[J/t[D-1][2]<t[D][2]/J?D-1:D])[1],z=D[0]):(I=Math.max(Nh(A,B,z),1),z=h),z.every(I)}return z}return j.invert=function(z){return new Date(k(z))},j.domain=function(z){return arguments.length?l(Array.from(z,RP)):l().map(QP)},j.ticks=function(z){var A,B=l(),I=B[0],J=B[B.length-1],D=J<I;return D&&(A=I,I=J,J=A),A=(A=x(z,I,J))?A.range(I,J+1):[],D?A.reverse():A},j.tickFormat=function(z,A){return null==A?w:i(A)},j.nice=function(z){var A=l();return(z=x(z,A[0],A[A.length-1]))?l(SC(A,z)):j},j.copy=function(){return Gl(j,Ut(a,b,c,d,e,f,g,h,i))},j}function ro(){var a,b,c,d,e,f=0,g=1,h=ef,i=!1;function j(l){return isNaN(l=+l)?e:h(0===c?.5:(l=(d(l)-a)*c,i?Math.max(0,Math.min(1,l)):l))}function k(l){return function(m){var n,o;return arguments.length?([n,o]=m,h=l(n,o),j):[h(0),h(1)]}}return j.domain=function(l){return arguments.length?([f,g]=l,a=d(f=+f),b=d(g=+g),c=a===b?0:1/(b-a),j):[f,g]},j.clamp=function(l){return arguments.length?(i=!!l,j):i},j.interpolator=function(l){return arguments.length?(h=l,j):h},j.range=k(Vi),j.rangeRound=k(Dl),j.unknown=function(l){return arguments.length?(e=l,j):e},function(l){return d=l,a=l(f),b=l(g),c=a===b?0:1/(b-a),j}}function bi(a,b){return b.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function Vt(){var a=Wi(ro()(ef));return a.copy=function(){return bi(a,Vt())},_h.apply(a,arguments)}function Wt(){var a=St(ro());return a.copy=function(){return bi(a,Wt()).exponent(a.exponent())},_h.apply(a,arguments)}function so(){var a,b,c,d,e,f,g,h=0,i=.5,j=1,k=1,l=ef,m=!1;function n(p){return isNaN(p=+p)?g:(p=.5+((p=+f(p))-b)*(k*p<k*b?d:e),l(m?Math.max(0,Math.min(1,p)):p))}function o(p){return function(q){var s,r,u;return arguments.length?([s,r,u]=q,l=Nt(p,[s,r,u]),n):[l(0),l(.5),l(1)]}}return n.domain=function(p){return arguments.length?([h,i,j]=p,a=f(h=+h),b=f(i=+i),c=f(j=+j),d=a===b?0:.5/(b-a),e=b===c?0:.5/(c-b),k=b<a?-1:1,n):[h,i,j]},n.clamp=function(p){return arguments.length?(m=!!p,n):m},n.interpolator=function(p){return arguments.length?(l=p,n):l},n.range=o(Vi),n.rangeRound=o(Dl),n.unknown=function(p){return arguments.length?(g=p,n):g},function(p){return f=p,a=p(h),b=p(i),c=p(j),d=a===b?0:.5/(b-a),e=b===c?0:.5/(c-b),k=b<a?-1:1,n}}function Xt(){var a=St(so());return a.copy=function(){return bi(a,Xt()).exponent(a.exponent())},_h.apply(a,arguments)}function Yt(){var a,b,c=wt().unknown(void 0),d=c.domain,e=c.range,f=[0,1],g=!1,h=0,i=0,j=.5;function k(){var l=d().length,m=f[1]<f[0],n=f[m-0],o=f[1-m],p=ut(l,h,i);a=(o-n)/(p||1),g&&(a=Math.floor(a)),n+=(o-n-a*(l-h))*j,b=a*(1-h),g&&(n=Math.round(n),b=Math.round(b));var q=Fi(l).map(function(s){return n+a*s});return e(m?q.reverse():q)}return delete c.unknown,c.domain=function(l){return arguments.length?(d(l),k()):d()},c.range=function(l){return arguments.length?(f=[+l[0],+l[1]],k()):f.slice()},c.rangeRound=function(l){return f=[+l[0],+l[1]],g=!0,k()},c.bandwidth=function(){return b},c.step=function(){return a},c.round=function(l){return arguments.length?(g=!!l,k()):g},c.padding=function(l){return arguments.length?(i=Math.max(0,Math.min(1,l)),h=i,k()):h},c.paddingInner=function(l){return arguments.length?(h=Math.max(0,Math.min(1,l)),k()):h},c.paddingOuter=function(l){return arguments.length?(i=Math.max(0,Math.min(1,l)),k()):i},c.align=function(l){return arguments.length?(j=Math.max(0,Math.min(1,l)),k()):j},c.invertRange=function(l){if(null!=l[0]&&null!=l[1]){var m,n,o,p=+l[0],q=+l[1],s=f[1]<f[0],r=s?e().reverse():e(),u=r.length-1;if(p==p&&q==q&&(q<p&&(o=p,p=q,q=o),!(q<r[0]||p>f[1-s])))return m=Math.max(0,Mh(r,p)-1),n=p===q?m:Mh(r,q)-1,p-r[m]>b+1e-10&&++m,s&&(o=m,m=u-n,n=u-o),m>n?void 0:d().slice(m,n+1)}},c.invert=function(l){var m=c.invertRange([l,l]);return m?m[0]:m},c.copy=function(){return Yt().domain(d()).range(f).round(g).paddingInner(h).paddingOuter(i).align(j)},k()}var SP=Array.prototype.map;function TP(a){return SP.call(a,function(b){return+b})}var UP=Array.prototype.slice;const to={};function VP(a,b,c){const d=function(){var e=b();return e.invertRange||(e.invertRange=e.invert?function(f){return function(g){var h,i=g[0],j=g[1];return j<i&&(h=i,i=j,j=h),[f.invert(i),f.invert(j)]}}(e):e.invertExtent?function(f){return function(g){var h,i,j,k,l=f.range(),m=g[0],n=g[1],o=-1;for(n<m&&(i=m,m=n,n=i),j=0,k=l.length;j<k;++j)l[j]>=m&&l[j]<=n&&(o<0&&(o=j),h=j);if(!(o<0))return m=f.invertExtent(l[o]),n=f.invertExtent(l[h]),[void 0===m[0]?m[1]:m[0],void 0===n[1]?n[0]:n[1]]}}(e):void 0),e.type=a,e};return d.metadata=ee(Ra(c)),d}function wc(a,b,c){return arguments.length>1?(to[a]=VP(a,b,c),this):ZC(a)?to[a]:void 0}function ZC(a){return db(to,a)}function Xi(a,b){const c=to[a];return c&&c.metadata[b]}function Zt(a){return Xi(a,Rd)}function ck(a){return Xi(a,"discrete")}function _t(a){return Xi(a,"discretizing")}function _C(a){return Xi(a,Ri)}function $C(a){return Xi(a,"interpolating")}function aD(a){return Xi(a,"quantile")}wc("identity",function a(b){var c;function d(e){return isNaN(e=+e)?c:e}return d.invert=d,d.domain=d.range=function(e){return arguments.length?(b=Array.from(e,Ot),d):b.slice()},d.unknown=function(e){return arguments.length?(c=e,d):c},d.copy=function(){return a(b).unknown(c)},b=arguments.length?Array.from(b,Ot):[0,1],Wi(d)}),wc("linear",function a(){var b=QC();return b.copy=function(){return Gl(b,a())},Gg.apply(b,arguments),Wi(b)},Rd),wc(Ri,function a(){var b=Qt(qo()).domain([1,10]);return b.copy=function(){return Gl(b,a()).base(b.base())},Gg.apply(b,arguments),b},[Rd,Ri]),wc("pow",Tt,Rd),wc("sqrt",function(){return Tt.apply(null,arguments).exponent(.5)},Rd),wc("symlog",function a(){var b=Rt(qo());return b.copy=function(){return Gl(b,a()).constant(b.constant())},Gg.apply(b,arguments)},Rd),wc(Si,function(){return Gg.apply(Ut(Oh,tr,rn,Hi,jz,iz,qn,Hj,Er).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[Rd,"temporal"]),wc(Ti,function(){return Gg.apply(Ut(Ph,wr,sn,Ji,lz,kz,qn,Hj,Fr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[Rd,"temporal"]),wc("sequential",Vt,[Rd,"interpolating"]),wc("sequential-linear",Vt,[Rd,"interpolating"]),wc("sequential-log",function a(){var b=Qt(ro()).domain([1,10]);return b.copy=function(){return bi(b,a()).base(b.base())},_h.apply(b,arguments)},[Rd,"interpolating",Ri]),wc("sequential-pow",Wt,[Rd,"interpolating"]),wc("sequential-sqrt",function(){return Wt.apply(null,arguments).exponent(.5)},[Rd,"interpolating"]),wc("sequential-symlog",function a(){var b=Rt(ro());return b.copy=function(){return bi(b,a()).constant(b.constant())},_h.apply(b,arguments)},[Rd,"interpolating"]),wc("diverging-linear",function a(){var b=Wi(so()(ef));return b.copy=function(){return bi(b,a())},_h.apply(b,arguments)},[Rd,"interpolating"]),wc("diverging-log",function a(){var b=Qt(so()).domain([.1,1,10]);return b.copy=function(){return bi(b,a()).base(b.base())},_h.apply(b,arguments)},[Rd,"interpolating",Ri]),wc("diverging-pow",Xt,[Rd,"interpolating"]),wc("diverging-sqrt",function(){return Xt.apply(null,arguments).exponent(.5)},[Rd,"interpolating"]),wc("diverging-symlog",function a(){var b=Rt(so());return b.copy=function(){return bi(b,a()).constant(b.constant())},_h.apply(b,arguments)},[Rd,"interpolating"]),wc("quantile",function a(){var b,c=[],d=[],e=[];function f(){var h=0,i=Math.max(1,d.length);for(e=new Array(i-1);++h<i;)e[h-1]=mn(c,h/i);return g}function g(h){return isNaN(h=+h)?b:d[Mh(e,h)]}return g.invertExtent=function(h){var i=d.indexOf(h);return i<0?[NaN,NaN]:[i>0?e[i-1]:c[0],i<e.length?e[i]:c[c.length-1]]},g.domain=function(h){if(!arguments.length)return c.slice();c=[];for(let i of h)null==i||isNaN(i=+i)||c.push(i);return c.sort(Ej),f()},g.range=function(h){return arguments.length?(d=Array.from(h),f()):d.slice()},g.unknown=function(h){return arguments.length?(b=h,g):b},g.quantiles=function(){return e.slice()},g.copy=function(){return a().domain(c).range(d).unknown(b)},Gg.apply(g,arguments)},["discretizing","quantile"]),wc("quantize",function a(){var b,c=0,d=1,e=1,f=[.5],g=[0,1];function h(j){return j<=j?g[Mh(f,j,0,e)]:b}function i(){var j=-1;for(f=new Array(e);++j<e;)f[j]=((j+1)*d-(j-e)*c)/(e+1);return h}return h.domain=function(j){return arguments.length?([c,d]=j,c=+c,d=+d,i()):[c,d]},h.range=function(j){return arguments.length?(e=(g=Array.from(j)).length-1,i()):g.slice()},h.invertExtent=function(j){var k=g.indexOf(j);return k<0?[NaN,NaN]:k<1?[c,f[0]]:k>=e?[f[e-1],d]:[f[k-1],f[k]]},h.unknown=function(j){return arguments.length?(b=j,h):h},h.thresholds=function(){return f.slice()},h.copy=function(){return a().domain([c,d]).range(g).unknown(b)},Gg.apply(Wi(h),arguments)},"discretizing"),wc("threshold",function a(){var b,c=[.5],d=[0,1],e=1;function f(g){return g<=g?d[Mh(c,g,0,e)]:b}return f.domain=function(g){return arguments.length?(c=Array.from(g),e=Math.min(c.length,d.length-1),f):c.slice()},f.range=function(g){return arguments.length?(d=Array.from(g),e=Math.min(c.length,d.length-1),f):d.slice()},f.invertExtent=function(g){var h=d.indexOf(g);return[c[h-1],c[h]]},f.unknown=function(g){return arguments.length?(b=g,f):b},f.copy=function(){return a().domain(c).range(d).unknown(b)},Gg.apply(f,arguments)},"discretizing"),wc("bin-ordinal",function a(){var b=[],c=[];function d(e){return null==e||e!=e?void 0:c[(Mh(b,e)-1)%c.length]}return d.domain=function(e){return arguments.length?(b=TP(e),d):b.slice()},d.range=function(e){return arguments.length?(c=UP.call(e),d):c.slice()},d.tickFormat=function(e,f){return RC(b[0],Ha(b),null==e?10:e,f)},d.copy=function(){return a().domain(d.domain()).range(d.range())},d},["discrete","discretizing"]),wc("ordinal",wt,"discrete"),wc("band",Yt,"discrete"),wc("point",function(){return function a(b){var c=b.copy;return b.padding=b.paddingOuter,delete b.paddingInner,b.copy=function(){return a(c())},b}(Yt().paddingInner(1))},"discrete");const WP=["clamp","base","constant","exponent"];function bD(a,b){var c=b[0],d=Ha(b)-c;return function(e){return a(c+e*d)}}function uo(a,b,c){return Nt($t(b||"rgb",c),a)}function cD(a,b){for(var c=new Array(b),d=b+1,e=0;e<b;)c[e]=a(++e/d);return c}function dD(a,b,c){var d,e,f,g=c-b;return g&&Number.isFinite(g)?(d=(e=a.type).indexOf("-"),e=d<0?e:e.slice(d+1),f=wc(e)().domain([b,c]).range([0,1]),WP.forEach(h=>a[h]?f[h](a[h]()):0),f):Nd(.5)}function $t(a,b){var c=IP[function(d){return"interpolate"+d.toLowerCase().split("-").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")}(a)];return null!=b&&c&&c.gamma?c.gamma(b):c}function eD(a){for(var b=a.length/6|0,c=new Array(b),d=0;d<b;)c[d]="#"+a.slice(6*d,6*++d);return c}function fD(a,b){for(let c in a)au(c,b(a[c]))}const gD={};function au(a,b){return a=a&&a.toLowerCase(),arguments.length>1?(gD[a]=b,this):gD[a]}fD({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},eD),fD({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},a=>uo(eD(a)));const XP=a=>U(a)?a.map(b=>String(b)):String(a),YP=(a,b)=>a[1]-b[1],ZP=(a,b)=>b[1]-a[1];function bu(a,b,c){var d;return Yc(b)&&(a.bins&&(b=Math.max(b,a.bins.length)),null!=c&&(b=Math.min(b,Math.floor(an(a.domain())/c||1)))),ka(b)&&(d=b.step,b=b.interval),Xa(b)&&(b=a.type===Si?Jj(b):a.type==Ti?Kj(b):ja("Only time and utc scales accept interval strings."),d&&(b=b.every(d))),b}function hD(a,b,c){let d=a.range(),e=d[0],f=Ha(d),g=YP;if(e>f&&(d=f,f=e,e=d,g=ZP),e=Math.floor(e),f=Math.ceil(f),b=b.map(h=>[h,a(h)]).filter(h=>e<=h[1]&&h[1]<=f).sort(g).map(h=>h[0]),c>0&&b.length>1){const h=[b[0],Ha(b)];for(;b.length>c&&b.length>=3;)b=b.filter((i,j)=>!(j%2));b.length<3&&(b=h)}return b}function cu(a,b){return a.bins?hD(a,a.bins):a.ticks?a.ticks(b):a.domain()}function iD(a,b,c,d,e,f){var g=b.type;let h=XP;if(g===Si||e===Si)h=a.timeFormat(d);else if(g===Ti||e===Ti)h=a.utcFormat(d);else if(_C(g)){const i=a.formatFloat(d);if(f||b.bins)h=i;else{const j=jD(b,c,!1);h=k=>j(k)?i(k):""}}else if(b.tickFormat){const i=b.domain();h=a.formatSpan(i[0],i[i.length-1],c,d)}else d&&(h=a.format(d));return h}function jD(a,b,c){const d=cu(a,b),e=a.base(),f=Math.log(e),g=Math.max(1,e*b/d.length),h=i=>{let j=i/Math.pow(e,Math.round(Math.log(i)/f));return j*e<e-.5&&(j*=e),j<=g};return c?d.filter(h):h}const du={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},kD={quantile:"quantiles",quantize:"domain"};function lD(a,b){return a.bins?function(c){const d=c.slice(0,-1);return d.max=Ha(c),d}(a.bins):a.type===Ri?jD(a,b,!0):du[a.type]?function(c){const d=[-1/0].concat(c);return d.max=1/0,d}(a[du[a.type]]()):cu(a,b)}function mD(a,b,c,d,e,f,g){const h=kD[b.type]&&f!==Si&&f!==Ti?function(i,j,k){var l,m=j[kD[j.type]](),n=m.length,o=n>1?m[1]-m[0]:m[0];for(l=1;l<n;++l)o=Math.min(o,m[l]-m[l-1]);return i.formatSpan(0,o,30,k)}(a,b,e):iD(a,b,c,e,f,g);return"symbol"===d&&function(i){return du[i.type]||i.bins}(b)?function(i){return(j,k,l)=>{var m=nD(l[k+1],nD(l.max,1/0)),n=oD(j,i),o=oD(m,i);return n&&o?n+"  "+o:o?"< "+o:" "+n}}(h):"discrete"===d?function(i){return(j,k)=>k?i(j):null}(h):function(i){return j=>i(j)}(h)}function nD(a,b){return null!=a?a:b}function oD(a,b){return Number.isFinite(a)?b(a):null}function _P(a,b,c,d){const e=d||b.type;return Xa(c)&&function(f){return Xi(f,"temporal")}(e)&&(c=c.replace(/%a/g,"%A").replace(/%b/g,"%B")),c||e!==Si?c||e!==Ti?mD(a,b,5,null,c,d,!0):a.utcFormat("%A, %d %B %Y, %X UTC"):a.timeFormat("%A, %d %B %Y, %X")}function pD(a,b,c){c=c||{};const d=Math.max(3,c.maxlen||7),e=_P(a,b,c.format,c.formatType);if(_t(b.type)){const f=lD(b).slice(1).map(e),g=f.length;return`${g} boundar${1===g?"y":"ies"}: ${f.join(", ")}`}if(ck(b.type)){const f=b.domain(),g=f.length;return`${g} value${1===g?"":"s"}: ${g>d?f.slice(0,d-2).map(e).join(", ")+", ending with "+f.slice(-1).map(e):f.map(e).join(", ")}`}{const f=b.domain();return`values from ${e(f[0])} to ${e(Ha(f))}`}}const qD=(a,b,c)=>({role:a,"aria-roledescription":b,"aria-label":c||void 0}),$P=ee(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),rD={axis:{desc:"axis",caption:function(a){const b=a.datum,c=a.orient,d=b.title?wD(a):null,e=a.context,f=e.scales[b.scale].value,g=e.dataflow.locale(),h=f.type;return("left"===c||"right"===c?"Y":"X")+"-axis"+(d?` titled '${d}'`:"")+` for a ${ck(h)?"discrete":h} scale with `+pD(g,f,a)}},legend:{desc:"legend",caption:function(a){const b=a.datum,c=b.title?wD(a):null,d=((b.type||"")+" legend").trim(),e=b.scales,f=Object.keys(e),g=a.context,h=g.scales[e[f[0]]].value,i=g.dataflow.locale();return j=d,(j.length?j[0].toUpperCase()+j.slice(1):j)+(c?` titled '${c}'`:"")+" for "+function(k){return(k=k.map(l=>l+("fill"===l||"stroke"===l?" color":""))).length<2?k[0]:k.slice(0,-1).join(", ")+" and "+Ha(k)}(f)+" with "+pD(i,h,a);var j}},"title-text":{desc:"title",caption:a=>`Title text '${vD(a)}'`},"title-subtitle":{desc:"subtitle",caption:a=>`Subtitle text '${vD(a)}'`}},sD={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function tD(a,b){const c=!1===b.aria;if(a("aria-hidden",c||void 0),c||null==b.description)for(const d in sD)a(sD[d],void 0);else{const d=b.mark.marktype;a("aria-label",b.description),a("role",b.ariaRole||("group"===d?"graphics-object":"graphics-symbol")),a("aria-roledescription",b.ariaRoleDescription||d+" mark")}}function uD(a){return!1===a.aria?{"aria-hidden":!0}:$P[a.role]?null:rD[a.role]?function(b,c){try{const d=b.items[0],e=c.caption||(()=>"");return qD(c.role||"graphics-symbol",c.desc,d.description||e(d))}catch(d){return null}}(a,rD[a.role]):function(b){const c=b.marktype,d="group"===c||"text"===c||b.items.some(e=>null!=e.description&&!1!==e.aria);return qD(d?"graphics-object":"graphics-symbol",c+" mark container",b.description)}(a)}function vD(a){return Ra(a.text).join(" ")}function wD(a){try{return Ra(Ha(a.items).items[0].text).join(" ")}catch(b){return null}}const aQ=a=>(a+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;");function rd(a,b,c){var d,e,f="<"+a;if(b)for(d in b)null!=(e=b[d])&&(f+=" "+d+'="'+aQ(e)+'"');return c&&(f+=" "+c),f+">"}function yd(a){return"</"+a+">"}const vo={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},eu={fill:"none","stroke-miterlimit":10},he=_j.xmlns;function fu(a){gg.call(this,a),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var ff=Da(fu,gg),gu=gg.prototype;function bQ(a,b,c){var d,e,f;if("radial"===b.gradient){var g=vf(a,c++,"pattern",he);g.setAttribute("id","p_"+b.id),g.setAttribute("viewBox","0,0,1,1"),g.setAttribute("width","100%"),g.setAttribute("height","100%"),g.setAttribute("preserveAspectRatio","xMidYMid slice"),(g=vf(g,0,"rect",he)).setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","url("+zD()+"#"+b.id+")"),(a=vf(a,c++,"radialGradient",he)).setAttribute("id",b.id),a.setAttribute("fx",b.x1),a.setAttribute("fy",b.y1),a.setAttribute("fr",b.r1),a.setAttribute("cx",b.x2),a.setAttribute("cy",b.y2),a.setAttribute("r",b.r2)}else(a=vf(a,c++,"linearGradient",he)).setAttribute("id",b.id),a.setAttribute("x1",b.x1),a.setAttribute("x2",b.x2),a.setAttribute("y1",b.y1),a.setAttribute("y2",b.y2);for(d=0,e=b.stops.length;d<e;++d)(f=vf(a,d,"stop",he)).setAttribute("offset",b.stops[d].offset),f.setAttribute("stop-color",b.stops[d].color);return fg(a,d),c}function cQ(a,b,c){var d;return(a=vf(a,c,"clipPath",he)).setAttribute("id",b.id),b.path?(d=vf(a,0,"path",he)).setAttribute("d",b.path):((d=vf(a,0,"rect",he)).setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",b.width),d.setAttribute("height",b.height)),fg(a,1),c+1}function xD(a,b){for(;a&&a.dirty!==b;a=a.mark.group){if(a.dirty=b,!a.mark||a.mark.dirty===b)return;a.mark.dirty=b}}function yD(a,b,c,d,e){let f,g=a._svg;if(!g&&(f=b.ownerDocument,g=Xh(f,d,he),a._svg=g,a.mark&&(g.__data__=a,g.__values__={fill:"default"},"g"===d))){const h=Xh(f,"path",he);g.appendChild(h),h.__data__=a;const i=Xh(f,"g",he);g.appendChild(i),i.__data__=a;const j=Xh(f,"path",he);g.appendChild(j),j.__data__=a,j.__values__={fill:"default"}}return(g.ownerSVGElement!==e||function(h,i){return h.parentNode&&h.parentNode.childNodes.length>1&&h.previousSibling!=i}(g,c))&&b.insertBefore(g,c?c.nextSibling:b.firstChild),g}ff.initialize=function(a,b,c,d){if(this._defs={gradient:{},clipping:{}},a){this._svg=vf(a,0,"svg",he),this._svg.setAttribute("class","marks"),fg(a,1),this._root=vf(this._svg,0,"g",he);for(const e in eu)this._root.setAttribute(e,eu[e]);fg(this._svg,1)}return this.background(this._bgcolor),gu.initialize.call(this,a,b,c,d)},ff.background=function(a){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",a),gu.background.apply(this,arguments)},ff.resize=function(a,b,c,d){return gu.resize.call(this,a,b,c,d),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},ff.canvas=function(){return this._svg},ff.svg=function(){if(!this._svg)return null;var a={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var b in _j)a[b]=_j[b];var c=this._bgcolor?rd("rect",{width:this._width,height:this._height,fill:this._bgcolor})+yd("rect"):"";return rd("svg",a)+(this._defs.el?this._defs.el.outerHTML:"")+c+this._root.outerHTML+yd("svg")},ff._render=function(a){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,a),fg(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},ff.updateDefs=function(){const a=this._svg,b=this._defs;let c=b.el,d=0;for(const e in b.gradient)c||(b.el=c=vf(a,0,"defs",he)),d=bQ(c,b.gradient[e],d);for(const e in b.clipping)c||(b.el=c=vf(a,0,"defs",he)),d=cQ(c,b.clipping[e],d);c&&(0===d?(a.removeChild(c),b.el=null):fg(c,d))},ff._resetDefs=function(){var a=this._defs;a.gradient={},a.clipping={}},ff.dirty=function(a){a.dirty!==this._dirtyID&&(a.dirty=this._dirtyID,this._dirty.push(a))},ff.isDirty=function(a){return this._dirtyAll||!a._svg||a.dirty===this._dirtyID},ff._dirtyCheck=function(){this._dirtyAll=!0;var a=this._dirty;if(!a.length||!this._dirtyID)return!0;var b,c,d,e,f,g,h,i=++this._dirtyID;for(f=0,g=a.length;f<g;++f)(c=(b=a[f]).mark).marktype!==d&&(d=c.marktype,e=Lf[d]),c.zdirty&&c.dirty!==i&&(this._dirtyAll=!1,xD(b,i),c.items.forEach(function(j){j.dirty=i})),c.zdirty||(b.exit?(e.nested&&c.items.length?(h=c.items[0])._svg&&this._update(e,h._svg,h):b._svg&&(h=b._svg.parentNode)&&h.removeChild(b._svg),b._svg=null):(b=e.nested?c.items[0]:b)._update!==i&&(b._svg&&b._svg.ownerSVGElement?this._update(e,b._svg,b):(this._dirtyAll=!1,xD(b,i)),b._update=i));return!this._dirtyAll},ff.draw=function(a,b,c){if(!this.isDirty(b))return b._svg;var d,e=this._svg,f=Lf[b.marktype],g=!1===b.interactive?"none":null,h="g"===f.tag,i=null,j=0;(d=yD(b,a,c,"g",e)).setAttribute("class",bC(b));const k=uD(b);for(const m in k)gf(d,m,k[m]);h||gf(d,"pointer-events",g),gf(d,"clip-path",b.clip?Ws(this,b,b.group):null);const l=m=>{const n=this.isDirty(m),o=yD(m,d,i,f.tag,e);n&&(this._update(f,o,m),h&&function(p,q,s){q=q.lastChild.previousSibling;let r,u=0;eg(s,t=>{r=p.draw(q,t,r),++u}),fg(q,1+u)}(this,o,m)),i=o,++j};return f.nested?b.items.length&&l(b.items[0]):eg(b,l),fg(d,j),d};var jh=null,te=null,dQ={group:function(a,b,c){const d=jh=b.childNodes[2];te=d.__values__,a.foreground(Hl,c,this),te=b.__values__,jh=b.childNodes[1],a.content(Hl,c,this);const e=jh=b.childNodes[0];a.background(Hl,c,this);const f=!1===c.mark.interactive?"none":null;if(f!==te.events&&(gf(d,"pointer-events",f),gf(e,"pointer-events",f),te.events=f),c.strokeForeground&&c.stroke){const g=c.fill;gf(d,"display",null),this.style(e,c),gf(e,"stroke",null),g&&(c.fill=null),te=d.__values__,this.style(d,c),g&&(c.fill=g),jh=null}else gf(d,"display","none")},image:function(a,b,c){!1===c.smooth?(hu(b,"image-rendering","optimizeSpeed"),hu(b,"image-rendering","pixelated")):hu(b,"image-rendering",null)},text:function(a,b,c){let d,e,f,g,h=tl(c);U(h)?(e=h.map(i=>Wh(c,i)),d=e.join(`
`),d!==te.text&&(fg(b,0),f=b.ownerDocument,g=Vh(c),e.forEach((i,j)=>{const k=Xh(f,"tspan",he);k.__data__=c,k.textContent=i,j&&(k.setAttribute("x",0),k.setAttribute("dy",g)),b.appendChild(k)}),te.text=d)):(e=Wh(c,h),e!==te.text&&(b.textContent=e,te.text=e)),gf(b,"font-family",ul(c)),gf(b,"font-size",Fg(c)+"px"),gf(b,"font-style",c.fontStyle),gf(b,"font-variant",c.fontVariant),gf(b,"font-weight",c.fontWeight)}};function hu(a,b,c){c!==te[b]&&(null==c?a.style.removeProperty(b):a.style.setProperty(b,c+""),te[b]=c)}function Hl(a,b,c){b!==te[a]&&(c?function(d,e,f,g){null!=f?d.setAttributeNS(g,e,f):d.removeAttributeNS(g,e)}(jh,a,b,c):gf(jh,a,b),te[a]=b)}function gf(a,b,c){null!=c?a.setAttribute(b,c):a.removeAttribute(b)}function zD(){let a;return"undefined"==typeof window?"":(a=window.location).hash?a.href.slice(0,-a.hash.length):a.href}function iu(a){gg.call(this,a),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}ff._update=function(a,b,c){jh=b,te=b.__values__,tD(Hl,c),a.attr(Hl,c,this);const d=dQ[a.type];d&&d.call(this,a,b,c),jh&&this.style(jh,c)},ff.style=function(a,b){if(null!=b)for(const c in vo){let d="font"===c?ul(b):b[c];if(d===te[c])continue;const e=vo[c];null==d?a.removeAttribute(e):(Gs(d)&&(d=SA(d,this._defs.gradient,zD())),a.setAttribute(e,d+"")),te[c]=d}};var kh=Da(iu,gg),AD=gg.prototype;function BD(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}kh.resize=function(a,b,c,d){AD.resize.call(this,a,b,c,d);var e=this._origin,f=this._text,g={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var h in _j)g[h]=_j[h];f.head=rd("svg",g);var i=this._bgcolor;return"transparent"!==i&&"none"!==i||(i=null),f.bg=i?rd("rect",{width:this._width,height:this._height,fill:i})+yd("rect"):"",f.root=rd("g",Mb({},eu,{transform:"translate("+e+")"})),f.foot=yd("g")+yd("svg"),this},kh.background=function(){var a=AD.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),a},kh.svg=function(){var a=this._text;return a.head+a.defs+a.bg+a.root+a.body+a.foot},kh._render=function(a){return this._text.body=this.mark(a),this._text.defs=this.buildDefs(),this},kh.buildDefs=function(){let a,b="";for(const c in this._defs.gradient){const d=this._defs.gradient[c],e=d.stops;"radial"===d.gradient?(b+=rd(a="pattern",{id:"p_"+c,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),b+=rd("rect",{width:"1",height:"1",fill:"url(#"+c+")"})+yd("rect"),b+=yd(a),b+=rd(a="radialGradient",{id:c,fx:d.x1,fy:d.y1,fr:d.r1,cx:d.x2,cy:d.y2,r:d.r2})):b+=rd(a="linearGradient",{id:c,x1:d.x1,x2:d.x2,y1:d.y1,y2:d.y2});for(let f=0;f<e.length;++f)b+=rd("stop",{offset:e[f].offset,"stop-color":e[f].color})+yd("stop");b+=yd(a)}for(const c in this._defs.clipping){const d=this._defs.clipping[c];b+=rd("clipPath",{id:c}),d.path?b+=rd("path",{d:d.path})+yd("path"):b+=rd("rect",{x:0,y:0,width:d.width,height:d.height})+yd("rect"),b+=yd("clipPath")}return b?rd("defs")+b+yd("defs"):""},kh.attr=function(a,b,c,d){const e={},f=(g,h,i,j)=>{e[j||g]=h};return Array.isArray(c)?c.forEach(g=>g(f,b,this)):c(f,b,this),d&&function(g,h,i,j,k){if(null==h)return g;"bgrect"===j&&!1===i.interactive&&(g["pointer-events"]="none");if("bgfore"===j&&(!1===i.interactive&&(g["pointer-events"]="none"),g.display="none",null!==h.fill))return g;"image"===j&&!1===h.smooth&&(g.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===j&&(g["font-family"]=ul(h),g["font-size"]=Fg(h)+"px",h.fontStyle&&(g["font-style"]=h.fontStyle),h.fontVariant&&(g["font-variant"]=h.fontVariant),h.fontWeight&&(g["font-weight"]=h.fontWeight));for(const l in vo){let m=h[l];const n=vo[l];("transparent"!==m||"fill"!==n&&"stroke"!==n)&&null!=m&&(Gs(m)&&(m=SA(m,k.gradient,"")),g[n]=m)}}(e,b,a,d,this._defs),e},kh.href=function(a){var b,c=this,d=a.href;if(d){if(b=c._hrefs&&c._hrefs[d])return b;c.sanitizeURL(d).then(e=>{e["xlink:href"]=e.href,e.href=null,(c._hrefs||(c._hrefs={}))[d]=e})}return null},kh.mark=function(a){const b=Lf[a.marktype],c=b.tag,d=[tD,b.attr];let e="";e+=rd("g",Mb({class:bC(a),"clip-path":a.clip?Ws(this,a,a.group):null},uD(a),{"pointer-events":"g"!==c&&!1===a.interactive?"none":null}));const f=g=>{const h=this.href(g);if(h&&(e+=rd("a",h)),e+=rd(c,this.attr(a,g,d,"g"!==c?c:null)),"text"===c){const i=tl(g);if(U(i)){const j={x:0,dy:Vh(g)};for(let k=0;k<i.length;++k)e+=rd("tspan",k?j:null)+BD(Wh(g,i[k]))+yd("tspan")}else e+=BD(Wh(g,i))}else if("g"===c){const i=g.strokeForeground,j=g.fill,k=g.stroke;i&&k&&(g.stroke=null),e+=rd("path",this.attr(a,g,b.background,"bgrect"))+yd("path"),e+=rd("g",this.attr(a,g,b.content))+this.markGroup(g)+yd("g"),i&&k?(j&&(g.fill=null),g.stroke=k,e+=rd("path",this.attr(a,g,b.foreground,"bgrect"))+yd("path"),j&&(g.fill=j)):e+=rd("path",this.attr(a,g,b.foreground,"bgfore"))+yd("path")}e+=yd(c),h&&(e+=yd("a"))};return b.nested?a.items&&a.items.length&&f(a.items[0]):eg(a,f),e+yd("g")},kh.markGroup=function(a){let b="";return eg(a,c=>{b+=this.mark(c)}),b};var ci={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},dk={};function wo(a,b){return a=String(a||"").toLowerCase(),arguments.length>1?(dk[a]=b,this):dk[a]}function CD(a,b,c){const d=[],e=new Pd().union(b),f=a.marktype;return f?DD(a,e,c,d):"group"===f?ED(a,e,c,d):ja("Intersect scene must be mark node or group item.")}function DD(a,b,c,d){if(function(e,f,g){return e.bounds&&f.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!g||g(e)))}(a,b,c)){const e=a.items,f=a.marktype,g=e.length;let h=0;if("group"===f)for(;h<g;++h)ED(e[h],b,c,d);else for(const i=Lf[f].isect;h<g;++h){let j=e[h];FD(j,b,i)&&d.push(j)}}return d}function ED(a,b,c,d){c&&c(a.mark)&&FD(a,b,Lf.group.isect)&&d.push(a);const e=a.items,f=e&&e.length;if(f){const g=a.x||0,h=a.y||0;b.translate(-g,-h);for(let i=0;i<f;++i)DD(e[i],b,c,d);b.translate(g,h)}return d}function FD(a,b,c){const d=a.bounds;return b.encloses(d)||b.intersects(d)&&c(a,b)}dk.canvas=dk.png={renderer:go,headless:go,handler:yl},dk.svg={renderer:fu,headless:iu,handler:st},dk.none={};var ju=new Pd();function GD(a){var b=a.clip;if(Ub(b))b(df(ju.clear()));else{if(!b)return;ju.set(0,0,a.group.width,a.group.height)}a.bounds.intersect(ju)}function ku(a,b,c){return a===b||("path"===c?HD(a,b):a instanceof Date&&b instanceof Date?+a==+b:Yc(a)&&Yc(b)?Math.abs(a-b)<=1e-9:a&&b&&(ka(a)||ka(b))?null!=a&&null!=b&&function(d,e){var f,g,h=Object.keys(d),i=Object.keys(e);if(h.length!==i.length)return!1;for(h.sort(),i.sort(),g=h.length-1;g>=0;g--)if(h[g]!=i[g])return!1;for(g=h.length-1;g>=0;g--)if(f=h[g],!ku(d[f],e[f],f))return!1;return typeof d==typeof e}(a,b):a==b)}function HD(a,b){return ku(Tj(a),Tj(b))}function ID(a){ia.call(this,null,a)}function xo(a,b,c){return b(a.bounds.clear(),a,c)}Da(ID,ia).transform=function(a,b){var c,d=b.dataflow,e=a.mark,f=e.marktype,g=Lf[f],h=g.bound,i=e.bounds;if(g.nested)e.items.length&&d.dirty(e.items[0]),i=xo(e,h),e.items.forEach(function(j){j.bounds.clear().union(i)});else if("group"===f||a.modified())switch(b.visit(b.MOD,j=>d.dirty(j)),i.clear(),e.items.forEach(j=>i.union(xo(j,h))),e.role){case"axis":case"legend":case"title":b.reflow()}else c=b.changed(b.REM),b.visit(b.ADD,j=>{i.union(xo(j,h))}),b.visit(b.MOD,j=>{c=c||i.alignsWith(j.bounds),d.dirty(j),i.union(xo(j,h))}),c&&(i.clear(),e.items.forEach(j=>i.union(j.bounds)));return GD(e),b.modifies("bounds")};function lu(a){ia.call(this,0,a)}function JD(a){ia.call(this,null,a)}function KD(a){ia.call(this,null,a)}lu.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Da(lu,ia).transform=function(a,b){var c=function(f){var g=f._signals[":vega_identifier:"];return g||(f._signals[":vega_identifier:"]=g=f.add(0)),g}(b.dataflow),d=c.value,e=a.as;return b.visit(b.ADD,f=>{f[e]||(f[e]=++d)}),c.set(this.value=d),b},Da(JD,ia).transform=function(a,b){var c=this.value;c||((c=b.dataflow.scenegraph().mark(a.markdef,function(e){var f=e.groups,g=e.parent;return f&&1===f.size?f.get(Object.keys(f.object)[0]):f&&g?f.lookup(g):null}(a),a.index)).group.context=a.context,a.context.group||(a.context.group=c.group),c.source=this.source,c.clip=a.clip,c.interactive=a.interactive,this.value=c);var d="group"===c.marktype?On:Nn;return b.visit(b.ADD,e=>d.call(e,c)),(a.modified("clip")||a.modified("interactive"))&&(c.clip=a.clip,c.interactive=!!a.interactive,c.zdirty=!0,b.reflow()),c.items=b.source,b};var eQ=Da(KD,ia),LD={parity:a=>a.filter((b,c)=>c%2?b.opacity=0:1),greedy:(a,b)=>{var c;return a.filter((d,e)=>e&&MD(c.bounds,d.bounds,b)?d.opacity=0:(c=d,1))}};function MD(a,b,c){return c>Math.max(b.x1-a.x2,a.x1-b.x2,b.y1-a.y2,a.y1-b.y2)}function ND(a,b){for(var c,d=1,e=a.length,f=a[0].bounds;d<e;f=c,++d)if(MD(f,c=a[d].bounds,b))return!0}function fQ(a){var b=a.bounds;return b.width()>1&&b.height()>1}function OD(a){return a.forEach(b=>b.opacity=1),a}function PD(a,b){return a.reflow(b.modified()).modifies("opacity")}function QD(a){ia.call(this,null,a)}eQ.transform=function(a,b){var c,d,e,f=LD[a.method]||LD.parity,g=b.materialize(b.SOURCE).source,h=a.separation||0;if(g&&g.length){if(!a.method)return a.modified("method")&&(OD(g),b=PD(b,a)),b;if((g=g.filter(fQ)).length){if(a.sort&&(g=g.slice().sort(a.sort)),c=OD(g),b=PD(b,a),c.length>=3&&ND(c,h)){do c=f(c,h);while(c.length>=3&&ND(c,h));c.length<3&&!Ha(g).opacity&&(c.length>1&&(Ha(c).opacity=0),Ha(g).opacity=1)}return a.boundScale&&a.boundTolerance>=0&&(d=function(i,j,k){var l=i.range(),m=new Pd();return j===Qj||"bottom"===j?m.set(l[0],-1/0,l[1],1/0):m.set(-1/0,l[0],1/0,l[1]),m.expand(k||1),n=>m.encloses(n.bounds)}(a.boundScale,a.boundOrient,+a.boundTolerance),g.forEach(i=>{d(i)||(i.opacity=0)})),e=c[0].mark.bounds.clear(),g.forEach(i=>{i.opacity&&e.union(i.bounds)}),b}}},Da(QD,ia).transform=function(a,b){var c=b.dataflow;if(b.visit(b.ALL,e=>c.dirty(e)),b.fields&&b.fields.zindex){var d=b.source&&b.source[0];d&&(d.mark.zdirty=!0)}};const ue=new Pd();function ek(a,b,c){return a[b]===c?0:(a[b]=c,1)}function gQ(a){var b=a.items[0].orient;return b===bg||b===cg}function hQ(a,b,c,d){var e,f,g=b.items[0],h=g.datum,i=null!=g.translate?g.translate:.5,j=g.orient,k=function(x){var z=+x.grid;return[x.ticks?z++:-1,x.labels?z++:-1,z+ +x.domain]}(h),l=g.range,m=g.offset,n=g.position,o=g.minExtent,p=g.maxExtent,q=h.title&&g.items[k[2]].items[0],s=g.titlePadding,r=g.bounds,u=q&&jt(q),t=0,w=0;switch(ue.clear().union(r),r.clear(),(e=k[0])>-1&&r.union(g.items[e].bounds),(e=k[1])>-1&&r.union(g.items[e].bounds),j){case Qj:t=n||0,w=-m,f=Math.max(o,Math.min(p,-r.y1)),r.add(0,-f).add(l,0),q&&yo(a,q,f,s,u,0,-1,r);break;case bg:t=-m,w=n||0,f=Math.max(o,Math.min(p,-r.x1)),r.add(-f,0).add(0,l),q&&yo(a,q,f,s,u,1,-1,r);break;case cg:t=c+m,w=n||0,f=Math.max(o,Math.min(p,r.x2)),r.add(0,0).add(f,l),q&&yo(a,q,f,s,u,1,1,r);break;case"bottom":t=n||0,w=d+m,f=Math.max(o,Math.min(p,r.y2)),r.add(0,0).add(l,f),q&&yo(a,q,f,s,0,0,1,r);break;default:t=g.x,w=g.y}return hh(r.translate(t,w),g),ek(g,"x",t+i)|ek(g,"y",w+i)&&(g.bounds=ue,a.dirty(g),g.bounds=r,a.dirty(g)),g.mark.bounds.clear().union(r)}function yo(a,b,c,d,e,f,g,h){const i=b.bounds;if(b.auto){const j=g*(c+e+d);let k=0,l=0;a.dirty(b),f?k=(b.x||0)-(b.x=j):l=(b.y||0)-(b.y=j),b.mark.bounds.clear().union(i.translate(-k,-l)),a.dirty(b)}h.union(i)}const RD=(a,b)=>Math.floor(Math.min(a,b)),SD=(a,b)=>Math.ceil(Math.max(a,b));function iQ(a){return new Pd().set(0,0,a.width||0,a.height||0)}function jQ(a){var b=a.bounds.clone();return b.empty()?b.set(0,0,0,0):b.translate(-(a.x||0),-(a.y||0))}function jd(a,b,c){var d=ka(a)?a[b]:a;return null!=d?d:void 0!==c?c:0}function TD(a){return a<0?Math.ceil(-a):0}function UD(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=!c.nodirty,p="flush"===c.bounds?iQ:jQ,q=ue.set(0,0,0,0),s=jd(c.align,"column"),r=jd(c.align,Rh),u=jd(c.padding,"column"),t=jd(c.padding,Rh),w=c.columns||b.length,x=w<=0?1:Math.ceil(b.length/w),z=b.length,A=Array(z),B=Array(w),I=0,J=Array(z),D=Array(x),O=0,K=Array(z),Q=Array(z),V=Array(z);for(e=0;e<w;++e)B[e]=0;for(e=0;e<x;++e)D[e]=0;for(e=0;e<z;++e)i=b[e],h=V[e]=p(i),i.x=i.x||0,K[e]=0,i.y=i.y||0,Q[e]=0,f=e%w,g=~~(e/w),I=Math.max(I,j=Math.ceil(h.x2)),O=Math.max(O,k=Math.ceil(h.y2)),B[f]=Math.max(B[f],j),D[g]=Math.max(D[g],k),A[e]=u+TD(h.x1),J[e]=t+TD(h.y1),o&&a.dirty(b[e]);for(e=0;e<z;++e)e%w==0&&(A[e]=0),e<w&&(J[e]=0);if("each"===s)for(f=1;f<w;++f){for(n=0,e=f;e<z;e+=w)n<A[e]&&(n=A[e]);for(e=f;e<z;e+=w)A[e]=n+B[f-1]}else if("all"===s){for(n=0,e=0;e<z;++e)e%w&&n<A[e]&&(n=A[e]);for(e=0;e<z;++e)e%w&&(A[e]=n+I)}else for(s=!1,f=1;f<w;++f)for(e=f;e<z;e+=w)A[e]+=B[f-1];if("each"===r)for(g=1;g<x;++g){for(n=0,d=(e=g*w)+w;e<d;++e)n<J[e]&&(n=J[e]);for(e=g*w;e<d;++e)J[e]=n+D[g-1]}else if("all"===r){for(n=0,e=w;e<z;++e)n<J[e]&&(n=J[e]);for(e=w;e<z;++e)J[e]=n+O}else for(r=!1,g=1;g<x;++g)for(d=(e=g*w)+w;e<d;++e)J[e]+=D[g-1];for(l=0,e=0;e<z;++e)l=A[e]+(e%w?l:0),K[e]+=l-b[e].x;for(f=0;f<w;++f)for(m=0,e=f;e<z;e+=w)m+=J[e],Q[e]+=m-b[e].y;if(s&&jd(c.center,"column")&&x>1)for(e=0;e<z;++e)(l=(h="all"===s?I:B[e%w])-V[e].x2-b[e].x-K[e])>0&&(K[e]+=l/2);if(r&&jd(c.center,Rh)&&1!==w)for(e=0;e<z;++e)(m=(h="all"===r?O:D[~~(e/w)])-V[e].y2-b[e].y-Q[e])>0&&(Q[e]+=m/2);for(e=0;e<z;++e)q.union(V[e].translate(K[e],Q[e]));switch(l=jd(c.anchor,"x"),m=jd(c.anchor,"y"),jd(c.anchor,"column")){case Ke:l-=q.width();break;case"middle":l-=q.width()/2}switch(jd(c.anchor,Rh)){case Ke:m-=q.height();break;case"middle":m-=q.height()/2}for(l=Math.round(l),m=Math.round(m),q.clear(),e=0;e<z;++e)b[e].mark.bounds.clear();for(e=0;e<z;++e)(i=b[e]).x+=K[e]+=l,i.y+=Q[e]+=m,q.union(i.mark.bounds.union(i.bounds.translate(K[e],Q[e]))),o&&a.dirty(i);return q}function kQ(a,b){return"x1"===b?a.x||0:"y1"===b?a.y||0:"x2"===b?(a.x||0)+(a.width||0):"y2"===b?(a.y||0)+(a.height||0):void 0}function lQ(a,b){return a.bounds[b]}function zo(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,s,r,u,t,w,x,z=c.length,A=0,B=0;if(!z)return A;for(o=k;o<z;o+=l)c[o]&&(A=g(A,i(c[o],j)));if(!b.length)return A;for(b.length>e&&(a.warn("Grid headers exceed limit: "+e),b=b.slice(0,e)),A+=f,p=0,s=b.length;p<s;++p)a.dirty(b[p]),b[p].mark.bounds.clear();for(o=k,p=0,s=b.length;p<s;++p,o+=l){for(r=(u=b[p]).mark.bounds,q=o;q>=0&&null==(t=c[q]);q-=m);h?(w=null==n?t.x:Math.round(t.bounds.x1+n*t.bounds.width()),x=A):(w=A,x=null==n?t.y:Math.round(t.bounds.y1+n*t.bounds.height())),r.union(u.bounds.translate(w-(u.x||0),x-(u.y||0))),u.x=w,u.y=x,a.dirty(u),B=g(B,r[j])}return B}function VD(a,b,c,d,e,f){if(b){a.dirty(b);var g=c,h=c;d?g=Math.round(e.x1+f*e.width()):h=Math.round(e.y1+f*e.height()),b.bounds.translate(g-(b.x||0),h-(b.y||0)),b.mark.bounds.clear().union(b.bounds),b.x=g,b.y=h,a.dirty(b)}}function mQ(a,b,c,d,e,f,g){const h=function(m,n){const o=m[n]||{};return(p,q)=>null!=o[p]?o[p]:null!=m[p]?m[p]:q}(c,b),i=function(m,n){var o=-1/0;return m.forEach(p=>{null!=p.offset&&(o=Math.max(o,p.offset))}),o>-1/0?o:n}(a,h("offset",0)),j=h("anchor","start"),k=j===Ke?1:"middle"===j?.5:0,l={align:"each",bounds:h("bounds","flush"),columns:"vertical"===h("direction")?1:a.length,padding:h("margin",8),center:h("center"),nodirty:!0};switch(b){case bg:l.anchor={x:Math.floor(d.x1)-i,column:Ke,y:k*(g||d.height()+2*d.y1),row:j};break;case cg:l.anchor={x:Math.ceil(d.x2)+i,y:k*(g||d.height()+2*d.y1),row:j};break;case Qj:l.anchor={y:Math.floor(e.y1)-i,row:Ke,x:k*(f||e.width()+2*e.x1),column:j};break;case"bottom":l.anchor={y:Math.ceil(e.y2)+i,x:k*(f||e.width()+2*e.x1),column:j};break;case"top-left":l.anchor={x:i,y:i};break;case"top-right":l.anchor={x:f-i,y:i,column:Ke};break;case"bottom-left":l.anchor={x:i,y:g-i,row:Ke};break;case"bottom-right":l.anchor={x:f-i,y:g-i,column:Ke,row:Ke}}return l}function nQ(a,b){var c,d,e=b.items[0],f=e.datum,g=e.orient,h=e.bounds,i=e.x,j=e.y;return e._bounds?e._bounds.clear().union(h):e._bounds=h.clone(),h.clear(),function(k,l,m){var n=l.padding,o=n-m.x,p=n-m.y;if(l.datum.title){var q=l.items[1].items[0],s=q.anchor,r=l.titlePadding||0,u=n-q.x,t=n-q.y;switch(q.orient){case bg:o+=Math.ceil(q.bounds.width())+r;break;case cg:case"bottom":break;default:p+=q.bounds.height()+r}switch((o||p)&&Il(k,m,o,p),q.orient){case bg:t+=fk(l,m,q,s,1,1);break;case cg:u+=fk(l,m,q,Ke,0,0)+r,t+=fk(l,m,q,s,1,1);break;case"bottom":u+=fk(l,m,q,s,0,0),t+=fk(l,m,q,Ke,-1,0,1)+r;break;default:u+=fk(l,m,q,s,0,0)}(u||t)&&Il(k,q,u,t),(u=Math.round(q.bounds.x1-n))<0&&(Il(k,m,-u,0),Il(k,q,-u,0))}else(o||p)&&Il(k,m,o,p)}(a,e,e.items[0].items[0]),h=function(k,l){return k.items.forEach(m=>l.union(m.bounds)),l.x1=k.padding,l.y1=k.padding,l}(e,h),c=2*e.padding,d=2*e.padding,h.empty()||(c=Math.ceil(h.width()+c),d=Math.ceil(h.height()+d)),"symbol"===f.type&&function(k){var l=k.reduce((m,n)=>(m[n.column]=Math.max(n.bounds.x2-n.x,m[n.column]||0),m),{});k.forEach(m=>{m.width=l[m.column],m.height=m.bounds.y2-m.y})}(e.items[0].items[0].items[0].items),"none"!==g&&(e.x=i=0,e.y=j=0),e.width=c,e.height=d,hh(h.set(i,j,i+c,j+d),e),e.mark.bounds.clear().union(h),e}function fk(a,b,c,d,e,f,g){const h="symbol"!==a.datum.type,i=c.datum.vgrad,j=(!h||!f&&i||g?b:b.items[0]).bounds[e?"y2":"x2"]-a.padding,k=i&&f?j:0,l=i&&f?0:j,m=e<=0?0:jt(c);return Math.round("start"===d?k:d===Ke?l-m:.5*(j-m))}function Il(a,b,c,d){b.x+=c,b.y+=d,b.bounds.translate(c,d),b.mark.bounds.translate(c,d),a.dirty(b)}function WD(a){ia.call(this,null,a)}Da(WD,ia).transform=function(a,b){var c=b.dataflow;return a.mark.items.forEach(d=>{a.layout&&function(e,f,g){var h,i,j,k,l,m,n,o=function(x){for(var z,A,B=x.items,I=B.length,J=0,D={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};J<I;++J)if(A=(z=B[J]).items,"group"===z.marktype)switch(z.role){case"axis":case"legend":case"title":break;case"row-header":D.rowheaders.push(...A);break;case"row-footer":D.rowfooters.push(...A);break;case"column-header":D.colheaders.push(...A);break;case"column-footer":D.colfooters.push(...A);break;case"row-title":D.rowtitle=A[0];break;case"column-title":D.coltitle=A[0];break;default:D.marks.push(...A)}return D}(f),p=o.marks,q="flush"===g.bounds?kQ:lQ,s=g.offset,r=g.columns||p.length,u=r<=0?1:Math.ceil(p.length/r),t=u*r;const w=UD(e,p,g);w.empty()&&w.set(0,0,0,0),o.rowheaders&&(m=jd(g.headerBand,Rh,null),h=zo(e,o.rowheaders,p,r,u,-jd(s,"rowHeader"),RD,0,q,"x1",0,r,1,m)),o.colheaders&&(m=jd(g.headerBand,"column",null),i=zo(e,o.colheaders,p,r,r,-jd(s,"columnHeader"),RD,1,q,"y1",0,1,r,m)),o.rowfooters&&(m=jd(g.footerBand,Rh,null),j=zo(e,o.rowfooters,p,r,u,jd(s,"rowFooter"),SD,0,q,"x2",r-1,r,1,m)),o.colfooters&&(m=jd(g.footerBand,"column",null),k=zo(e,o.colfooters,p,r,r,jd(s,"columnFooter"),SD,1,q,"y2",t-r,1,r,m)),o.rowtitle&&(l=jd(g.titleAnchor,Rh),n=jd(s,"rowTitle"),n=l===Ke?j+n:h-n,m=jd(g.titleBand,Rh,.5),VD(e,o.rowtitle,n,0,w,m)),o.coltitle&&(l=jd(g.titleAnchor,"column"),n=jd(s,"columnTitle"),n=l===Ke?k+n:i-n,m=jd(g.titleBand,"column",.5),VD(e,o.coltitle,n,1,w,m))}(c,d,a.layout),function(e,f,g){var h,i,j,k,l,m=f.items,n=Math.max(0,f.width||0),o=Math.max(0,f.height||0),p=new Pd().set(0,0,n,o),q=p.clone(),s=p.clone(),r=[];for(k=0,l=m.length;k<l;++k)switch((i=m[k]).role){case"axis":(gQ(i)?q:s).union(hQ(e,i,n,o));break;case"title":h=i;break;case"legend":r.push(nQ(e,i));break;case"frame":case"scope":case"row-header":case"row-footer":case"row-title":case"column-header":case"column-footer":case"column-title":q.union(i.bounds),s.union(i.bounds);break;default:p.union(i.bounds)}if(r.length){const u={};r.forEach(t=>{"none"!==(j=t.orient||cg)&&(u[j]||(u[j]=[])).push(t)});for(let t in u){const w=u[t];UD(e,w,mQ(w,t,g.legends,q,s,n,o))}r.forEach(t=>{const w=t.bounds;if(w.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=w,e.dirty(t)),g.autosize&&"fit"===g.autosize.type)switch(t.orient){case bg:case cg:p.add(w.x1,0).add(w.x2,0);break;case Qj:case"bottom":p.add(0,w.y1).add(0,w.y2)}else p.union(w)})}p.union(q).union(s),h&&p.union(function(u,t,w,x,z){var A,B=t.items[0],I=B.frame,J=B.orient,D=B.anchor,O=B.offset,K=B.padding,Q=B.items[0].items[0],V=B.items[1]&&B.items[1].items[0],$=J===bg||J===cg?x:w,Ia=0,wa=0,xa=0,oa=0,Ma=0;if("group"!==I?J===bg?(Ia=z.y2,$=z.y1):J===cg?(Ia=z.y1,$=z.y2):(Ia=z.x1,$=z.x2):J===bg&&(Ia=x,$=0),A="start"===D?Ia:D===Ke?$:(Ia+$)/2,V&&V.text){switch(J){case Qj:case"bottom":Ma=Q.bounds.height()+K;break;case bg:oa=Q.bounds.width()+K;break;case cg:oa=-Q.bounds.width()-K}ue.clear().union(V.bounds),ue.translate(oa-(V.x||0),Ma-(V.y||0)),ek(V,"x",oa)|ek(V,"y",Ma)&&(u.dirty(V),V.bounds.clear().union(ue),V.mark.bounds.clear().union(ue),u.dirty(V)),ue.clear().union(V.bounds)}else ue.clear();switch(ue.union(Q.bounds),J){case Qj:wa=A,xa=z.y1-ue.height()-O;break;case bg:wa=z.x1-ue.width()-O,xa=A;break;case cg:wa=z.x2+ue.width()+O,xa=A;break;case"bottom":wa=A,xa=z.y2+O;break;default:wa=B.x,xa=B.y}return ek(B,"x",wa)|ek(B,"y",xa)&&(ue.translate(wa,xa),u.dirty(B),B.bounds.clear().union(ue),t.bounds.clear().union(ue),u.dirty(B)),B.bounds}(e,h,n,o,p)),f.clip&&p.set(0,0,f.width||0,f.height||0),!function(u,t,w,x){const z=x.autosize||{},A=z.type;if(u._autosize<1||!A)return;let B=u._width,I=u._height,J=Math.max(0,t.width||0),D=Math.max(0,Math.ceil(-w.x1)),O=Math.max(0,Math.ceil(w.x2-J)),K=Math.max(0,t.height||0),Q=Math.max(0,Math.ceil(-w.y1)),V=Math.max(0,Math.ceil(w.y2-K));if("padding"===z.contains){const $=u.padding();B-=$.left+$.right,I-=$.top+$.bottom}"none"===A?(D=0,Q=0,J=B,K=I):"fit"===A?(J=Math.max(0,B-D-O),K=Math.max(0,I-Q-V)):"fit-x"===A?(J=Math.max(0,B-D-O),I=K+Q+V):"fit-y"===A?(B=J+D+O,K=Math.max(0,I-Q-V)):"pad"===A&&(B=J+D+O,I=K+Q+V),u._resizeView(B,I,J,K,[D,Q],z.resize)}(e,f,p,g)}(c,d,a)}),function(d){return d&&"legend-entry"!==d.mark.role}(a.mark.group)?b.reflow():b};var oQ=Object.freeze({__proto__:null,bound:ID,identifier:lu,mark:JD,overlap:KD,render:QD,viewlayout:WD});function XD(a){ia.call(this,null,a)}function YD(a){ia.call(this,null,a)}function pQ(){return Ac({})}function ZD(a){ia.call(this,null,a)}function _D(a){ia.call(this,[],a)}Da(XD,ia).transform=function(a,b){if(this.value&&!a.modified())return b.StopPropagation;var c=b.dataflow.locale(),d=b.fork(b.NO_SOURCE|b.NO_FIELDS),e=this.value,f=a.scale,g=bu(f,null==a.count?a.values?a.values.length:10:a.count,a.minstep),h=a.format||iD(c,f,g,a.formatSpecifier,a.formatType,!!a.values),i=a.values?hD(f,a.values,g):cu(f,g);return e&&(d.rem=e),e=i.map(function(j,k){return Ac({index:k/(i.length-1||1),value:j,label:h(j)})}),a.extra&&e.length&&e.push(Ac({index:-1,extra:{value:e[0].value},label:""})),d.source=e,d.add=e,this.value=e,d},Da(YD,ia).transform=function(a,b){var c=b.dataflow,d=b.fork(b.NO_SOURCE|b.NO_FIELDS),e=a.item||pQ,f=a.key||hb,g=this.value;return U(d.encode)&&(d.encode=null),g&&(a.modified("key")||b.modified(f))&&ja("DataJoin does not support modified key function or fields."),g||(b=b.addAll(),this.value=g=function(h){const i=Tk().test(j=>j.exit);return i.lookup=j=>i.get(h(j)),i}(f)),b.visit(b.ADD,h=>{const i=f(h);let j=g.get(i);j?j.exit?(g.empty--,d.add.push(j)):d.mod.push(j):(j=e(h),g.set(i,j),d.add.push(j)),j.datum=h,j.exit=!1}),b.visit(b.MOD,h=>{const i=f(h),j=g.get(i);j&&(j.datum=h,d.mod.push(j))}),b.visit(b.REM,h=>{const i=f(h),j=g.get(i);h!==j.datum||j.exit||(d.rem.push(j),j.exit=!0,++g.empty)}),b.changed(b.ADD_MOD)&&d.modifies("datum"),(b.clean()||a.clean&&g.empty>c.cleanThreshold)&&c.runAfter(g.clean),d},Da(ZD,ia).transform=function(a,b){var c=b.fork(b.ADD_REM),d=a.mod||!1,e=a.encoders,f=b.encode;if(U(f)){if(!c.changed()&&!f.every(function(m){return e[m]}))return b.StopPropagation;f=f[0],c.encode=null}var g="enter"===f,h=e.update||Z,i=e.enter||Z,j=e.exit||Z,k=(f&&!g?e[f]:h)||Z;if(b.changed(b.ADD)&&(b.visit(b.ADD,function(m){i(m,a),h(m,a)}),c.modifies(i.output),c.modifies(h.output),k!==Z&&k!==h&&(b.visit(b.ADD,function(m){k(m,a)}),c.modifies(k.output))),b.changed(b.REM)&&j!==Z&&(b.visit(b.REM,function(m){j(m,a)}),c.modifies(j.output)),g||k!==Z){var l=b.MOD|(a.modified()?b.REFLOW:0);g?(b.visit(l,function(m){var n=i(m,a)||d;(k(m,a)||n)&&c.mod.push(m)}),c.mod.length&&c.modifies(i.output)):b.visit(l,function(m){(k(m,a)||d)&&c.mod.push(m)}),c.mod.length&&c.modifies(k.output)}return c.changed()?c:b.StopPropagation},Da(_D,ia).transform=function(a,b){if(null!=this.value&&!a.modified())return b.StopPropagation;var c,d,e,f,g,h=b.dataflow.locale(),i=b.fork(b.NO_SOURCE|b.NO_FIELDS),j=this.value,k=a.type||"symbol",l=a.scale,m=+a.limit,n=bu(l,null==a.count?5:a.count,a.minstep),o=!!a.values||"symbol"===k,p=a.format||mD(h,l,n,k,a.formatSpecifier,a.formatType,o),q=a.values||lD(l,n);return j&&(i.rem=j),"symbol"===k?(m&&q.length>m?(b.dataflow.warn("Symbol legend count exceeds limit, filtering items."),j=q.slice(0,m-1),g=!0):j=q,Ub(e=a.size)?(a.values||0!==l(j[0])||(j=j.slice(1)),f=j.reduce(function(s,r){return Math.max(s,e(r,a))},0)):e=Nd(f=e||8),j=j.map(function(s,r){return Ac({index:r,label:p(s,r,j),value:s,offset:f,size:e(s,a)})}),g&&(g=q[j.length],j.push(Ac({index:j.length,label:`${q.length-j.length} entries`,value:g,offset:f,size:e(g,a)})))):"gradient"===k?(c=l.domain(),d=dD(l,c[0],Ha(c)),q.length<3&&!a.values&&c[0]!==Ha(c)&&(q=[c[0],Ha(c)]),j=q.map(function(s,r){return Ac({index:r,label:p(s,r,q),value:s,perc:d(s)})})):(e=q.length-1,d=function(s){var r=s.domain(),u=r.length-1,t=+r[0],w=+Ha(r),x=w-t;if("threshold"===s.type){const z=u?x/u:.1;x=(w+=z)-(t-=z)}return z=>(z-t)/x}(l),j=q.map(function(s,r){return Ac({index:r,label:p(s,r,q),value:s,perc:r?d(s):0,perc2:r===e?1:d(q[r+1])})})),i.source=j,i.add=j,this.value=j,i};var $D=Tk({line:aE,"line-radial":function(a,b,c,d){return aE(b*Math.cos(a),b*Math.sin(a),d*Math.cos(c),d*Math.sin(c))},arc:bE,"arc-radial":function(a,b,c,d){return bE(b*Math.cos(a),b*Math.sin(a),d*Math.cos(c),d*Math.sin(c))},curve:cE,"curve-radial":function(a,b,c,d){return cE(b*Math.cos(a),b*Math.sin(a),d*Math.cos(c),d*Math.sin(c))},"orthogonal-horizontal":function(a,b,c,d){return"M"+a+","+b+"V"+d+"H"+c},"orthogonal-vertical":function(a,b,c,d){return"M"+a+","+b+"H"+c+"V"+d},"orthogonal-radial":function(a,b,c,d){var e=Math.cos(a),f=Math.sin(a),g=Math.cos(c),h=Math.sin(c),i=Math.abs(c-a)>Math.PI?c<=a:c>a;return"M"+b*e+","+b*f+"A"+b+","+b+" 0 0,"+(i?1:0)+" "+b*g+","+b*h+"L"+d*g+","+d*h},"diagonal-horizontal":function(a,b,c,d){var e=(a+c)/2;return"M"+a+","+b+"C"+e+","+b+" "+e+","+d+" "+c+","+d},"diagonal-vertical":function(a,b,c,d){var e=(b+d)/2;return"M"+a+","+b+"C"+a+","+e+" "+c+","+e+" "+c+","+d},"diagonal-radial":function(a,b,c,d){var e=Math.cos(a),f=Math.sin(a),g=Math.cos(c),h=Math.sin(c),i=(b+d)/2;return"M"+b*e+","+b*f+"C"+i*e+","+i*f+" "+i*g+","+i*h+" "+d*g+","+d*h}});function qQ(a){return a.source.x}function rQ(a){return a.source.y}function sQ(a){return a.target.x}function tQ(a){return a.target.y}function mu(a){ia.call(this,{},a)}function aE(a,b,c,d){return"M"+a+","+b+"L"+c+","+d}function bE(a,b,c,d){var e=c-a,f=d-b,g=Math.sqrt(e*e+f*f)/2;return"M"+a+","+b+"A"+g+","+g+" "+180*Math.atan2(f,e)/Math.PI+" 0 1 "+c+","+d}function cE(a,b,c,d){var e=c-a,f=d-b,g=.2*(e+f),h=.2*(f-e);return"M"+a+","+b+"C"+(a+g)+","+(b+h)+" "+(c+h)+","+(d-g)+" "+c+","+d}function nu(a){ia.call(this,null,a)}mu.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Da(mu,ia).transform=function(a,b){var c=a.sourceX||qQ,d=a.sourceY||rQ,e=a.targetX||sQ,f=a.targetY||tQ,g=a.as||"path",h=a.orient||"vertical",i=a.shape||"line",j=$D.get(i+"-"+h)||$D.get(i);return j||ja("LinkPath unsupported type: "+a.shape+(a.orient?"-"+a.orient:"")),b.visit(b.SOURCE,function(k){k[g]=j(c(k),d(k),e(k),f(k))}),b.reflow(a.modified()).modifies(g)},nu.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Da(nu,ia).transform=function(a,b){var c,d,e,f=a.as||["startAngle","endAngle"],g=f[0],h=f[1],i=a.field||Ef,j=a.startAngle||0,k=null!=a.endAngle?a.endAngle:2*Math.PI,l=b.source,m=l.map(i),n=m.length,o=j,p=(k-j)/Vy(m),q=Fi(n);for(a.sort&&q.sort(function(s,r){return m[s]-m[r]}),c=0;c<n;++c)e=m[q[c]],(d=l[q[c]])[g]=o,d[h]=o+=e*p;return this.value=m,b.reflow(a.modified()).modifies(f)};function dE(a){return Zt(a)&&"sequential"!==a}var uQ=ee(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function eE(a){ia.call(this,null,a),this.modified(!0)}function fE(a,b,c){return _C(a)&&(Math.abs(b.reduce(function(d,e){return d+(e<0?-1:e>0?1:0)},0))!==b.length&&c.warn("Log scale domain includes zero: "+Ga(b))),b}function gE(a,b,c){return Ub(a)&&(b||c)?bD(a,ou(b||[0,1],c)):a}function ou(a,b){return b?a.slice().reverse():a}function hE(a){ia.call(this,null,a)}Da(eE,ia).transform=function(a,b){var c=b.dataflow,d=this.value,e=function(f){var g,h=f.type,i="";return"sequential"===h?"sequential-linear":(function(j){const k=j.type;return Zt(k)&&k!==Si&&k!==Ti&&(j.scheme||j.range&&j.range.length&&j.range.every(Xa))}(f)&&(g=f.rawDomain?f.rawDomain.length:f.domain?f.domain.length+ +(null!=f.domainMid):0,i=2===g?"sequential-":3===g?"diverging-":""),(i+h||"linear").toLowerCase())}(a);for(e in(d&&e===d.type||(this.value=d=wc(e)()),a))if(!uQ[e]){if("padding"===e&&dE(d.type))continue;Ub(d[e])?d[e](a[e]):c.warn("Unsupported scale property: "+e)}return function(f,g,h){var i=f.type,j=g.round||!1,k=g.range;if(null!=g.rangeStep)k=function(l,m,n){"band"!==l&&"point"!==l&&ja("Only band and point scales support rangeStep.");var o=(null!=m.paddingOuter?m.paddingOuter:m.padding)||0,p="point"===l?1:(null!=m.paddingInner?m.paddingInner:m.padding)||0;return[0,m.rangeStep*ut(n,p,o)]}(i,g,h);else if(g.scheme&&(k=function(l,m,n){var o,p,q=m.schemeExtent;return U(m.scheme)?p=uo(m.scheme,m.interpolate,m.interpolateGamma):(o=m.scheme.toLowerCase(),(p=au(o))||ja("Unrecognized scheme name: "+m.scheme)),n="threshold"===l?n+1:"bin-ordinal"===l?n-1:"quantile"===l||"quantize"===l?+m.schemeCount||5:n,$C(l)?gE(p,q,m.reverse):Ub(p)?cD(gE(p,q),n):"ordinal"===l?p:p.slice(0,n)}(i,g,h),Ub(k))){if(f.interpolator)return f.interpolator(k);ja(`Scale type ${i} does not support interpolating color schemes.`)}if(k&&$C(i))return f.interpolator(uo(ou(k,g.reverse),g.interpolate,g.interpolateGamma));k&&g.interpolate&&f.interpolate?f.interpolate($t(g.interpolate,g.interpolateGamma)):Ub(f.round)?f.round(j):Ub(f.rangeRound)&&f.interpolate(j?Dl:Vi),k&&f.range(ou(k,g.reverse))}(d,a,function(f,g,h){let i=g.bins;if(i&&!U(i)){let j=f.domain(),k=j[0],l=Ha(j),m=null==i.start?k:i.start,n=null==i.stop?l:i.stop,o=i.step;o||ja("Scale bins parameter missing step property."),m<k&&(m=o*Math.ceil(k/o)),n>l&&(n=o*Math.floor(l/o)),i=Fi(m,n+o/2,o)}return i?f.bins=i:f.bins&&delete f.bins,"bin-ordinal"===f.type&&(i?g.domain||g.domainRaw||(f.domain(i),h=i.length):f.bins=f.domain()),h}(d,a,function(f,g,h){var i=function(o,p,q){return p?(o.domain(fE(o.type,p,q)),p.length):-1}(f,g.domainRaw,h);if(i>-1)return i;var j,k,l=g.domain,m=f.type,n=g.zero||void 0===g.zero&&function(o){const p=o.type;return!o.bins&&("linear"===p||"pow"===p||"sqrt"===p)}(f);if(!l)return 0;dE(m)&&g.padding&&l[0]!==Ha(l)&&(l=function(o,p,q,s,r,u){var t=Math.abs(Ha(q)-q[0]),w=t/(t-2*s),x=o===Ri?Ie(p,null,w):"sqrt"===o?Xc(p,null,w,.5):"pow"===o?Xc(p,null,w,r||1):"symlog"===o?Ai(p,null,w,u||1):He(p,null,w);return(p=p.slice())[0]=x[0],p[p.length-1]=x[1],p}(m,l,g.range,g.padding,g.exponent,g.constant));if((n||null!=g.domainMin||null!=g.domainMax||null!=g.domainMid)&&(j=(l=l.slice()).length-1||1,n&&(l[0]>0&&(l[0]=0),l[j]<0&&(l[j]=0)),null!=g.domainMin&&(l[0]=g.domainMin),null!=g.domainMax&&(l[j]=g.domainMax),null!=g.domainMid)){const o=(k=g.domainMid)>l[j]?j+1:k<l[0]?0:j;o!==j&&h.warn("Scale domainMid exceeds domain min or max.",k),l.splice(o,0,k)}return f.domain(fE(m,l,h)),"ordinal"===m&&f.unknown(g.domainImplicit?vt:void 0),g.nice&&f.nice&&f.nice(!0!==g.nice&&bu(f,g.nice)||null),l.length}(d,a,c))),b.fork(b.NO_SOURCE|b.NO_FIELDS)},Da(hE,ia).transform=function(a,b){var c=a.modified("sort")||b.changed(b.ADD)||b.modified(a.sort.fields)||b.modified("datum");return c&&b.source.sort(Di(a.sort)),this.modified(c),b};var iE=["y0","y1"];function pu(a){ia.call(this,null,a)}function vQ(a,b,c,d,e){for(var f,g=(b-a.sum)/2,h=a.length,i=0;i<h;++i)(f=a[i])[d]=g,f[e]=g+=Math.abs(c(f))}function wQ(a,b,c,d,e){for(var f,g=1/a.sum,h=0,i=a.length,j=0,k=0;j<i;++j)(f=a[j])[d]=h,f[e]=h=g*(k+=Math.abs(c(f)))}function xQ(a,b,c,d,e){for(var f,g,h=0,i=0,j=a.length,k=0;k<j;++k)(f=+c(g=a[k]))<0?(g[d]=i,g[e]=i+=f):(g[d]=h,g[e]=h+=f)}pu.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:iE}]},Da(pu,ia).transform=function(a,b){var c,d,e,f,g=a.as||iE,h=g[0],i=g[1],j=Di(a.sort),k=a.field||Ef,l="center"===a.offset?vQ:"normalize"===a.offset?wQ:xQ;for(c=function(m,n,o,p){var q,s,r,u,t,w,x,z,A,B=[],I=function(J){return J(t)};if(null==n)B.push(m.slice());else for(q={},s=0,r=m.length;s<r;++s)t=m[s],w=n.map(I),(x=q[w])||(q[w]=x=[],B.push(x)),x.push(t);for(w=0,A=0,u=B.length;w<u;++w){for(x=B[w],s=0,z=0,r=x.length;s<r;++s)z+=Math.abs(p(x[s]));x.sum=z,z>A&&(A=z),o&&x.sort(o)}return B.max=A,B}(b.source,a.groupby,j,k),d=0,e=c.length,f=c.max;d<e;++d)l(c[d],f,k,h,i);return b.reflow(a.modified()).modifies(g)};var yQ=Object.freeze({__proto__:null,axisticks:XD,datajoin:YD,encode:ZD,legendentries:_D,linkpath:mu,pie:nu,scale:eE,sortitems:hE,stack:pu});function zQ(){}const lh=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function jE(){var a=1,b=1,c=g;function d(h,i){return i.map(j=>e(h,j))}function e(h,i){var j=[],k=[];return function(l,m,n){var o,p,q,s,r,u,t=new Array(),w=new Array();for(o=p=-1,s=l[0]>=m,lh[s<<1].forEach(x);++o<a-1;)q=s,s=l[o+1]>=m,lh[q|s<<1].forEach(x);for(lh[s<<0].forEach(x);++p<b-1;){for(o=-1,s=l[p*a+a]>=m,r=l[p*a]>=m,lh[s<<1|r<<2].forEach(x);++o<a-1;)q=s,s=l[p*a+a+o+1]>=m,u=r,r=l[p*a+o+1]>=m,lh[q|s<<1|r<<2|u<<3].forEach(x);lh[s|r<<3].forEach(x)}for(o=-1,r=l[p*a]>=m,lh[r<<2].forEach(x);++o<a-1;)u=r,r=l[p*a+o+1]>=m,lh[r<<2|u<<3].forEach(x);function x(z){var A,B,I=[z[0][0]+o,z[0][1]+p],J=[z[1][0]+o,z[1][1]+p],D=f(I),O=f(J);(A=w[D])?(B=t[O])?(delete w[A.end],delete t[B.start],A===B?(A.ring.push(J),n(A.ring)):t[A.start]=w[B.end]={start:A.start,end:B.end,ring:A.ring.concat(B.ring)}):(delete w[A.end],A.ring.push(J),w[A.end=O]=A):(A=t[O])?(B=w[D])?(delete t[A.start],delete w[B.end],A===B?(A.ring.push(J),n(A.ring)):t[B.start]=w[A.end]={start:B.start,end:A.end,ring:B.ring.concat(A.ring)}):(delete t[A.start],A.ring.unshift(I),t[A.start=D]=A):t[D]=w[O]={start:D,end:O,ring:[I,J]}}lh[r<<3].forEach(x)}(h,i,function(l){c(l,h,i),function(m){for(var n=0,o=m.length,p=m[o-1][1]*m[0][0]-m[o-1][0]*m[0][1];++n<o;)p+=m[n-1][1]*m[n][0]-m[n-1][0]*m[n][1];return p}(l)>0?j.push([l]):k.push(l)}),k.forEach(function(l){for(var m,n=0,o=j.length;n<o;++n)if(-1!==AQ((m=j[n])[0],l))return void m.push(l)}),{type:"MultiPolygon",value:i,coordinates:j}}function f(h){return 2*h[0]+h[1]*(a+1)*4}function g(h,i,j){h.forEach(function(k){var l,m=k[0],n=k[1],o=0|m,p=0|n,q=i[p*a+o];m>0&&m<a&&o===m&&(l=i[p*a+o-1],k[0]=m+(j-l)/(q-l)-.5),n>0&&n<b&&p===n&&(l=i[(p-1)*a+o],k[1]=n+(j-l)/(q-l)-.5)})}return d.contour=e,d.size=function(h){if(!arguments.length)return[a,b];var i=Math.floor(h[0]),j=Math.floor(h[1]);return i>=0&&j>=0||ja("invalid size"),a=i,b=j,d},d.smooth=function(h){return arguments.length?(c=h?g:zQ,d):c===g},d}function AQ(a,b){for(var c,d=-1,e=b.length;++d<e;)if(c=BQ(a,b[d]))return c;return 0}function BQ(a,b){for(var c=b[0],d=b[1],e=-1,f=0,g=a.length,h=g-1;f<g;h=f++){var i=a[f],j=i[0],k=i[1],l=a[h],m=l[0],n=l[1];if(CQ(i,l,b))return 0;k>d!=n>d&&c<(m-j)*(d-k)/(n-k)+j&&(e=-e)}return e}function CQ(a,b,c){var d,e,f,g;return function(h,i,j){return(i[0]-h[0])*(j[1]-h[1])==(j[0]-h[0])*(i[1]-h[1])}(a,b,c)&&(e=a[d=+(a[0]===b[0])],f=c[d],g=b[d],e<=f&&f<=g||g<=f&&f<=e)}function kE(a,b,c){return function(d){var e=dh(d),f=c?Math.min(e[0],0):e[0],g=e[1],h=g-f,i=b?Nh(f,g,a):h/(a+1);return Fi(i,g,i)}}function qu(a){ia.call(this,null,a)}function lE(a,b,c,d,e){const f=a.x1||0,g=a.y1||0,h=b*c<0;function i(l){l.forEach(j)}function j(l){h&&l.reverse(),l.forEach(k)}function k(l){l[0]=(l[0]-f)*b+d,l[1]=(l[1]-g)*c+e}return function(l){return l.coordinates.forEach(i),l}}function mE(a,b,c){const d=a>=0?a:Rr(b,c);return Math.round((Math.sqrt(4*d*d+1)-1)/2)}function ru(a){return Ub(a)?a:Nd(+a)}function nE(){var a=i=>i[0],b=i=>i[1],c=Ef,d=[-1,-1],e=960,f=500,g=2;function h(i,j){const k=mE(d[0],i,a)>>g,l=mE(d[1],i,b)>>g,m=k?k+2:0,n=l?l+2:0,o=2*m+(e>>g),p=2*n+(f>>g),q=new Float32Array(o*p),s=new Float32Array(o*p);let r=q;i.forEach(t=>{const w=m+(+a(t)>>g),x=n+(+b(t)>>g);w>=0&&w<o&&x>=0&&x<p&&(q[w+x*o]+=+c(t))}),k>0&&l>0?(gk(o,p,q,s,k),hk(o,p,s,q,l),gk(o,p,q,s,k),hk(o,p,s,q,l),gk(o,p,q,s,k),hk(o,p,s,q,l)):k>0?(gk(o,p,q,s,k),gk(o,p,s,q,k),gk(o,p,q,s,k),r=s):l>0&&(hk(o,p,q,s,l),hk(o,p,s,q,l),hk(o,p,q,s,l),r=s);let u=j?Math.pow(2,-2*g):1/Vy(r);for(let t=0,w=o*p;t<w;++t)r[t]*=u;return{values:r,scale:1<<g,width:o,height:p,x1:m,y1:n,x2:m+(e>>g),y2:n+(f>>g)}}return h.x=function(i){return arguments.length?(a=ru(i),h):a},h.y=function(i){return arguments.length?(b=ru(i),h):b},h.weight=function(i){return arguments.length?(c=ru(i),h):c},h.size=function(i){if(!arguments.length)return[e,f];var j=+i[0],k=+i[1];return j>=0&&k>=0||ja("invalid size"),e=j,f=k,h},h.cellSize=function(i){return arguments.length?((i=+i)>=1||ja("invalid cell size"),g=Math.floor(Math.log(i)/Math.LN2),h):1<<g},h.bandwidth=function(i){return arguments.length?(1===(i=Ra(i)).length&&(i=[+i[0],+i[0]]),2!==i.length&&ja("invalid bandwidth"),d=i,h):d},h}function gk(a,b,c,d,e){const f=1+(e<<1);for(let g=0;g<b;++g)for(let h=0,i=0;h<a+e;++h)h<a&&(i+=c[h+g*a]),h>=e&&(h>=f&&(i-=c[h-f+g*a]),d[h-e+g*a]=i/Math.min(h+1,a-1+f-h,f))}function hk(a,b,c,d,e){const f=1+(e<<1);for(let g=0;g<a;++g)for(let h=0,i=0;h<b+e;++h)h<b&&(i+=c[g+h*a]),h>=e&&(h>=f&&(i-=c[g+(h-f)*a]),d[g+(h-e)*a]=i/Math.min(h+1,b-1+f-h,f))}function su(a){ia.call(this,null,a)}qu.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Da(qu,ia).transform=function(a,b){if(this.value&&!b.changed()&&!a.modified())return b.StopPropagation;var c=b.fork(b.NO_SOURCE|b.NO_FIELDS),d=b.materialize(b.SOURCE).source,e=a.field||fc,f=jE().smooth(!1!==a.smooth),g=a.thresholds||function(j,k,l){const m=kE(l.levels||10,l.nice,!1!==l.zero);return"shared"!==l.resolve?m:m(j.map(n=>Gi(k(n).values)))}(d,e,a),h=null===a.as?null:a.as||"contour",i=[];return d.forEach(j=>{const k=e(j),l=f.size([k.width,k.height])(k.values,U(g)?g:g(k.values));!function(m,n,o,p){let q=p.scale||n.scale,s=p.translate||n.translate;Ub(q)&&(q=q(o,p)),Ub(s)&&(s=s(o,p));if((1===q||null==q)&&!s)return;const r=(Yc(q)?q:q[0])||1,u=(Yc(q)?q:q[1])||1,t=s&&s[0]||0,w=s&&s[1]||0;m.forEach(lE(n,r,u,t,w))}(l,k,j,a),l.forEach(m=>{i.push(Yq(j,Ac(null!=h?{[h]:m}:m)))})}),this.value&&(c.rem=this.value),this.value=c.source=c.add=i,c},su.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var DQ=Da(su,ia);const EQ=["x","y","weight","size","cellSize","bandwidth"];function oE(a,b){return EQ.forEach(c=>null!=b[c]?a[c](b[c]):0),a}function tu(a){ia.call(this,null,a)}DQ.transform=function(a,b){if(this.value&&!b.changed()&&!a.modified())return b.StopPropagation;var c,d=b.fork(b.NO_SOURCE|b.NO_FIELDS),e=function(i,j){var k,l,m,n,o,p,q=[],s=r=>r(n);if(null==j)q.push(i);else for(k={},l=0,m=i.length;l<m;++l)n=i[l],o=j.map(s),(p=k[o])||(k[o]=p=[],p.dims=o,q.push(p)),p.push(n);return q}(b.materialize(b.SOURCE).source,a.groupby),f=(a.groupby||[]).map(gb),g=oE(nE(),a),h=a.as||"grid";return c=e.map(i=>Ac(function(j,k){for(let l=0;l<f.length;++l)j[f[l]]=k[l];return j}({[h]:g(i,a.counts)},i.dims))),this.value&&(d.rem=this.value),this.value=d.source=d.add=c,d},tu.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Da(tu,ia).transform=function(a,b){if(this.value&&!b.changed()&&!a.modified())return b.StopPropagation;var c,d,e=b.fork(b.NO_SOURCE|b.NO_FIELDS),f=jE().smooth(!1!==a.smooth),g=a.values,h=a.thresholds||kE(a.count||10,a.nice,!!g),i=a.size;return g||(g=b.materialize(b.SOURCE).source,d=lE(c=oE(nE(),a)(g,!0),c.scale||1,c.scale||1,0,0),i=[c.width,c.height],g=c.values),h=U(h)?h:h(g),g=f.size(i)(g,h),d&&g.forEach(d),this.value&&(e.rem=this.value),this.value=e.source=e.add=(g||[]).map(Ac),e};function uu(a){ia.call(this,null,a)}function Yi(){return new Ao()}function Ao(){this.reset()}uu.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Da(uu,ia).transform=function(a,b){var c,d=this._features,e=this._points,f=a.fields,g=f&&f[0],h=f&&f[1],i=a.geojson||!f&&fc,j=b.ADD;c=a.modified()||b.changed(b.REM)||b.modified(ed(i))||g&&b.modified(ed(g))||h&&b.modified(ed(h)),this.value&&!c||(j=b.SOURCE,this._features=d=[],this._points=e=[]),i&&b.visit(j,function(k){d.push(i(k))}),g&&h&&(b.visit(j,function(k){var l=g(k),m=h(k);null!=l&&null!=m&&(l=+l)===l&&(m=+m)===m&&e.push([l,m])}),d=d.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:e}})),this.value={type:"FeatureCollection",features:d}},Ao.prototype={constructor:Ao,reset:function(){this.s=this.t=0},add:function(a){pE(Bo,a,this.t),pE(this,Bo.s,this.s),this.s?this.t+=Bo.t:this.s=Bo.t},valueOf:function(){return this.s}};var Bo=new Ao();function pE(a,b,c){var d=a.s=b+c,e=d-b,f=d-e;a.t=b-f+(c-e)}var _b=Math.PI,zd=_b/2,Co=_b/4,Le=2*_b,Ed=180/_b,$b=_b/180,oc=Math.abs,ik=Math.atan,Nf=Math.atan2,mb=Math.cos,Do=Math.ceil,qE=Math.exp,Eo=Math.log,vu=Math.pow,ib=Math.sin,Of=Math.sign||function(a){return a>0?1:a<0?-1:0},ie=Math.sqrt,wu=Math.tan;function rE(a){return a>1?0:a<-1?_b:Math.acos(a)}function hf(a){return a>1?zd:a<-1?-zd:Math.asin(a)}function je(){}function Fo(a,b){a&&tE.hasOwnProperty(a.type)&&tE[a.type](a,b)}var sE={Feature:function(a,b){Fo(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)Fo(c[d].geometry,b)}},tE={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){xu(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)xu(c[d],b,0)},Polygon:function(a,b){uE(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)uE(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)Fo(c[d],b)}};function xu(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function uE(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)xu(a[c],b,1);b.polygonEnd()}function mh(a,b){a&&sE.hasOwnProperty(a.type)?sE[a.type](a,b):Fo(a,b)}var vE,wE,yu,zu,Au,Go=Yi(),Ho=Yi(),Kg={point:je,lineStart:je,lineEnd:je,polygonStart:function(){Go.reset(),Kg.lineStart=FQ,Kg.lineEnd=GQ},polygonEnd:function(){var a=+Go;Ho.add(a<0?Le+a:a),this.lineStart=this.lineEnd=this.point=je},sphere:function(){Ho.add(Le)}};function FQ(){Kg.point=HQ}function GQ(){xE(vE,wE)}function HQ(a,b){Kg.point=xE,vE=a,wE=b,yu=a*=$b,zu=mb(b=(b*=$b)/2+Co),Au=ib(b)}function xE(a,b){var c=(a*=$b)-yu,d=c>=0?1:-1,e=d*c,f=mb(b=(b*=$b)/2+Co),g=ib(b),h=Au*g,i=zu*f+h*mb(e),j=h*d*ib(e);Go.add(Nf(j,i)),yu=a,zu=f,Au=g}function Io(a){return[Nf(a[1],a[0]),hf(a[2])]}function Zi(a){var b=a[0],c=a[1],d=mb(c);return[d*mb(b),d*ib(b),ib(c)]}function Jo(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function jk(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function Bu(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function Ko(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function Lo(a){var b=ie(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}var sd,jf,Ad,xf,_i,yE,zE,kk,di,nh,Jl,Mo,No,Oo,Po,Qo,Ro,So,Cu,Du,Eu,AE,BE,Me,Ne,Oe,Kl=Yi(),oh={point:Fu,lineStart:DE,lineEnd:EE,polygonStart:function(){oh.point=FE,oh.lineStart=IQ,oh.lineEnd=JQ,Kl.reset(),Kg.polygonStart()},polygonEnd:function(){Kg.polygonEnd(),oh.point=Fu,oh.lineStart=DE,oh.lineEnd=EE,Go<0?(sd=-(Ad=180),jf=-(xf=90)):Kl>1e-6?xf=90:Kl<-1e-6&&(jf=-90),nh[0]=sd,nh[1]=Ad},sphere:function(){sd=-(Ad=180),jf=-(xf=90)}};function Fu(a,b){di.push(nh=[sd=a,Ad=a]),b<jf&&(jf=b),b>xf&&(xf=b)}function CE(a,b){var c=Zi([a*$b,b*$b]);if(kk){var d=jk(kk,c),e=jk([d[1],-d[0],0],d);Lo(e),e=Io(e);var f,g=a-_i,h=g>0?1:-1,i=e[0]*Ed*h,j=oc(g)>180;j^(h*_i<i&&i<h*a)?(f=e[1]*Ed)>xf&&(xf=f):j^(h*_i<(i=(i+360)%360-180)&&i<h*a)?(f=-e[1]*Ed)<jf&&(jf=f):(b<jf&&(jf=b),b>xf&&(xf=b)),j?a<_i?yf(sd,a)>yf(sd,Ad)&&(Ad=a):yf(a,Ad)>yf(sd,Ad)&&(sd=a):Ad>=sd?(a<sd&&(sd=a),a>Ad&&(Ad=a)):a>_i?yf(sd,a)>yf(sd,Ad)&&(Ad=a):yf(a,Ad)>yf(sd,Ad)&&(sd=a)}else di.push(nh=[sd=a,Ad=a]);b<jf&&(jf=b),b>xf&&(xf=b),kk=c,_i=a}function DE(){oh.point=CE}function EE(){nh[0]=sd,nh[1]=Ad,oh.point=Fu,kk=null}function FE(a,b){if(kk){var c=a-_i;Kl.add(oc(c)>180?c+(c>0?360:-360):c)}else yE=a,zE=b;Kg.point(a,b),CE(a,b)}function IQ(){Kg.lineStart()}function JQ(){FE(yE,zE),Kg.lineEnd(),oc(Kl)>1e-6&&(sd=-(Ad=180)),nh[0]=sd,nh[1]=Ad,kk=null}function yf(a,b){return(b-=a)<0?b+360:b}function KQ(a,b){return a[0]-b[0]}function GE(a,b){return a[0]<=a[1]?a[0]<=b&&b<=a[1]:b<a[0]||a[1]<b}var ig={sphere:je,point:Gu,lineStart:HE,lineEnd:IE,polygonStart:function(){ig.lineStart=NQ,ig.lineEnd=OQ},polygonEnd:function(){ig.lineStart=HE,ig.lineEnd=IE}};function Gu(a,b){a*=$b;var c=mb(b*=$b);Ll(c*mb(a),c*ib(a),ib(b))}function Ll(a,b,c){++Jl,No+=(a-No)/Jl,Oo+=(b-Oo)/Jl,Po+=(c-Po)/Jl}function HE(){ig.point=LQ}function LQ(a,b){a*=$b;var c=mb(b*=$b);Me=c*mb(a),Ne=c*ib(a),Oe=ib(b),ig.point=MQ,Ll(Me,Ne,Oe)}function MQ(a,b){a*=$b;var c=mb(b*=$b),d=c*mb(a),e=c*ib(a),f=ib(b),g=Nf(ie((g=Ne*f-Oe*e)*g+(g=Oe*d-Me*f)*g+(g=Me*e-Ne*d)*g),Me*d+Ne*e+Oe*f);Mo+=g,Qo+=g*(Me+(Me=d)),Ro+=g*(Ne+(Ne=e)),So+=g*(Oe+(Oe=f)),Ll(Me,Ne,Oe)}function IE(){ig.point=Gu}function NQ(){ig.point=PQ}function OQ(){JE(AE,BE),ig.point=Gu}function PQ(a,b){AE=a,BE=b,a*=$b,b*=$b,ig.point=JE;var c=mb(b);Me=c*mb(a),Ne=c*ib(a),Oe=ib(b),Ll(Me,Ne,Oe)}function JE(a,b){a*=$b;var c=mb(b*=$b),d=c*mb(a),e=c*ib(a),f=ib(b),g=Ne*f-Oe*e,h=Oe*d-Me*f,i=Me*e-Ne*d,j=ie(g*g+h*h+i*i),k=hf(j),l=j&&-k/j;Cu+=l*g,Du+=l*h,Eu+=l*i,Mo+=k,Qo+=k*(Me+(Me=d)),Ro+=k*(Ne+(Ne=e)),So+=k*(Oe+(Oe=f)),Ll(Me,Ne,Oe)}function Hu(a,b){function c(d,e){return d=a(d,e),b(d[0],d[1])}return a.invert&&b.invert&&(c.invert=function(d,e){return(d=b.invert(d,e))&&a.invert(d[0],d[1])}),c}function Iu(a,b){return[oc(a)>_b?a+Math.round(-a/Le)*Le:a,b]}function KE(a,b,c){return(a%=Le)?b||c?Hu(ME(a),NE(b,c)):ME(a):b||c?NE(b,c):Iu}function LE(a){return function(b,c){return[(b+=a)>_b?b-Le:b<-_b?b+Le:b,c]}}function ME(a){var b=LE(a);return b.invert=LE(-a),b}function NE(a,b){var c=mb(a),d=ib(a),e=mb(b),f=ib(b);function g(h,i){var j=mb(i),k=mb(h)*j,l=ib(h)*j,m=ib(i),n=m*c+k*d;return[Nf(l*e-n*f,k*c-m*d),hf(n*e+l*f)]}return g.invert=function(h,i){var j=mb(i),k=mb(h)*j,l=ib(h)*j,m=ib(i),n=m*e-l*f;return[Nf(l*e+m*f,k*c+n*d),hf(n*c-k*d)]},g}function OE(a,b){(b=Zi(b))[0]-=a,Lo(b);var c=rE(-b[1]);return((-b[2]<0?-c:c)+Le-1e-6)%Le}function PE(){var a,b=[];return{point:function(c,d,e){a.push([c,d,e])},lineStart:function(){b.push(a=[])},lineEnd:je,rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))},result:function(){var c=b;return b=[],a=null,c}}}function To(a,b){return oc(a[0]-b[0])<1e-6&&oc(a[1]-b[1])<1e-6}function Uo(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function QE(a,b,c,d,e){var f,g,h=[],i=[];if(a.forEach(function(o){if(!((p=o.length-1)<=0)){var p,q,s=o[0],r=o[p];if(To(s,r)){if(!s[2]&&!r[2]){for(e.lineStart(),f=0;f<p;++f)e.point((s=o[f])[0],s[1]);return void e.lineEnd()}r[0]+=2e-6}h.push(q=new Uo(s,o,null,!0)),i.push(q.o=new Uo(s,null,q,!1)),h.push(q=new Uo(r,o,null,!1)),i.push(q.o=new Uo(r,null,q,!0))}}),h.length){for(i.sort(b),RE(h),RE(i),f=0,g=i.length;f<g;++f)i[f].e=c=!c;for(var j,k,l=h[0];;){for(var m=l,n=!0;m.v;)if((m=m.n)===l)return;j=m.z,e.lineStart();do{if(m.v=m.o.v=!0,m.e){if(n)for(f=0,g=j.length;f<g;++f)e.point((k=j[f])[0],k[1]);else d(m.x,m.n.x,1,e);m=m.n}else{if(n)for(j=m.p.z,f=j.length-1;f>=0;--f)e.point((k=j[f])[0],k[1]);else d(m.x,m.p.x,-1,e);m=m.p}j=(m=m.o).z,n=!n}while(!m.v);e.lineEnd()}}}function RE(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}Iu.invert=Iu;var Ju=Yi();function Ku(a){return oc(a[0])<=_b?a[0]:Of(a[0])*((oc(a[0])+_b)%Le-_b)}function SE(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}!function(a){var b;1===a.length&&(b=a,a=function(c,d){return SE(b(c),d)})}(SE);function lk(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):e<3?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f}function TE(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(b=(d=a[e]).length;--b>=0;)c[--g]=d[b];return c}function UE(a,b,c,d){return function(e){var f,g,h,i=b(e),j=PE(),k=b(j),l=!1,m={point:n,lineStart:p,lineEnd:q,polygonStart:function(){m.point=s,m.lineStart=r,m.lineEnd=u,g=[],f=[]},polygonEnd:function(){m.point=n,m.lineStart=p,m.lineEnd=q,g=TE(g);var t=function(w,x){var z=Ku(x),A=x[1],B=ib(A),I=[ib(z),-mb(z),0],J=0,D=0;Ju.reset(),1===B?A=zd+1e-6:-1===B&&(A=-zd-1e-6);for(var O=0,K=w.length;O<K;++O)if(V=(Q=w[O]).length)for(var Q,V,$=Q[V-1],Ia=Ku($),wa=$[1]/2+Co,xa=ib(wa),oa=mb(wa),Ma=0;Ma<V;++Ma,Ia=Pa,xa=wb,oa=tc,$=Za){var Za=Q[Ma],Pa=Ku(Za),La=Za[1]/2+Co,wb=ib(La),tc=mb(La),Oc=Pa-Ia,xb=Oc>=0?1:-1,hd=xb*Oc,Ae=hd>_b,Gd=xa*wb;if(Ju.add(Nf(Gd*xb*ib(hd),oa*tc+Gd*mb(hd))),J+=Ae?Oc+xb*Le:Oc,Ae^Ia>=z^Pa>=z){var Td=jk(Zi($),Zi(Za));Lo(Td);var tg=jk(I,Td);Lo(tg);var ug=(Ae^Oc>=0?-1:1)*hf(tg[2]);(A>ug||A===ug&&(Td[0]||Td[1]))&&(D+=Ae^Oc>=0?1:-1)}}return(J<-1e-6||J<1e-6&&Ju<-1e-6)^1&D}(f,d);g.length?(l||(e.polygonStart(),l=!0),QE(g,RQ,t,c,e)):t&&(l||(e.polygonStart(),l=!0),e.lineStart(),c(null,null,1,e),e.lineEnd()),l&&(e.polygonEnd(),l=!1),g=f=null},sphere:function(){e.polygonStart(),e.lineStart(),c(null,null,1,e),e.lineEnd(),e.polygonEnd()}};function n(t,w){a(t,w)&&e.point(t,w)}function o(t,w){i.point(t,w)}function p(){m.point=o,i.lineStart()}function q(){m.point=n,i.lineEnd()}function s(t,w){h.push([t,w]),k.point(t,w)}function r(){k.lineStart(),h=[]}function u(){s(h[0][0],h[0][1]),k.lineEnd();var t,w,x,z,A=k.clean(),B=j.result(),I=B.length;if(h.pop(),f.push(h),h=null,I)if(1&A){if((w=(x=B[0]).length-1)>0){for(l||(e.polygonStart(),l=!0),e.lineStart(),t=0;t<w;++t)e.point((z=x[t])[0],z[1]);e.lineEnd()}}else I>1&&2&A&&B.push(B.pop().concat(B.shift())),g.push(B.filter(QQ))}return m}}function QQ(a){return a.length>1}function RQ(a,b){return((a=a.x)[0]<0?a[1]-zd-1e-6:zd-a[1])-((b=b.x)[0]<0?b[1]-zd-1e-6:zd-b[1])}var VE=UE(function(){return!0},function(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?_b:-_b,i=oc(f-c);oc(i-_b)<1e-6?(a.point(c,d=(d+g)/2>0?zd:-zd),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=_b&&(oc(c-e)<1e-6&&(c-=1e-6*e),oc(f-h)<1e-6&&(f-=1e-6*h),d=function(j,k,l,m){var n,o,p=ib(j-l);return oc(p)>1e-6?ik((ib(k)*(o=mb(m))*ib(l)-ib(m)*(n=mb(k))*ib(j))/(n*o*p)):(k+m)/2}(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}},function(a,b,c,d){var e;if(null==a)e=c*zd,d.point(-_b,e),d.point(0,e),d.point(_b,e),d.point(_b,0),d.point(_b,-e),d.point(0,-e),d.point(-_b,-e),d.point(-_b,0),d.point(-_b,e);else if(oc(a[0]-b[0])>1e-6){var f=a[0]<b[0]?_b:-_b;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])},[-_b,-zd]);function SQ(a){var b=mb(a),c=6*$b,d=b>0,e=oc(b)>1e-6;function f(i,j){return mb(i)*mb(j)>b}function g(i,j,k){var l=[1,0,0],m=jk(Zi(i),Zi(j)),n=Jo(m,m),o=m[0],p=n-o*o;if(!p)return!k&&i;var q=b*n/p,s=-b*o/p,r=jk(l,m),u=Ko(l,q);Bu(u,Ko(m,s));var t=r,w=Jo(u,t),x=Jo(t,t),z=w*w-x*(Jo(u,u)-1);if(!(z<0)){var A=ie(z),B=Ko(t,(-w-A)/x);if(Bu(B,u),B=Io(B),!k)return B;var I,J=i[0],D=j[0],O=i[1],K=j[1];D<J&&(I=J,J=D,D=I);var Q=D-J,V=oc(Q-_b)<1e-6;if(!V&&K<O&&(I=O,O=K,K=I),V||Q<1e-6?V?O+K>0^B[1]<(oc(B[0]-J)<1e-6?O:K):O<=B[1]&&B[1]<=K:Q>_b^(J<=B[0]&&B[0]<=D)){var $=Ko(t,(-w+A)/x);return Bu($,u),[B,Io($)]}}}function h(i,j){var k=d?a:_b-a,l=0;return i<-k?l|=1:i>k&&(l|=2),j<-k?l|=4:j>k&&(l|=8),l}return UE(f,function(i){var j,k,l,m,n;return{lineStart:function(){m=l=!1,n=1},point:function(o,p){var q,s=[o,p],r=f(o,p),u=d?r?0:h(o,p):r?h(o+(o<0?_b:-_b),p):0;if(!j&&(m=l=r)&&i.lineStart(),r!==l&&(!(q=g(j,s))||To(j,q)||To(s,q))&&(s[2]=1),r!==l)n=0,r?(i.lineStart(),q=g(s,j),i.point(q[0],q[1])):(q=g(j,s),i.point(q[0],q[1],2),i.lineEnd()),j=q;else if(e&&j&&d^r){var t;u&k||!(t=g(s,j,!0))||(n=0,d?(i.lineStart(),i.point(t[0][0],t[0][1]),i.point(t[1][0],t[1][1]),i.lineEnd()):(i.point(t[1][0],t[1][1]),i.lineEnd(),i.lineStart(),i.point(t[0][0],t[0][1],3)))}!r||j&&To(j,s)||i.point(s[0],s[1]),j=s,l=r,k=u},lineEnd:function(){l&&i.lineEnd(),j=null},clean:function(){return n|(m&&l)<<1}}},function(i,j,k,l){!function(m,n,o,p,q,s){if(o){var r=mb(n),u=ib(n),t=p*o;null==q?(q=n+p*Le,s=n-t/2):(q=OE(r,q),s=OE(r,s),(p>0?q<s:q>s)&&(q+=p*Le));for(var w,x=q;p>0?x>s:x<s;x-=t)w=Io([r,-u*mb(x),-u*ib(x)]),m.point(w[0],w[1])}}(l,a,c,k,i,j)},d?[0,-a]:[-_b,a-_b])}function WE(a,b,c,d){function e(j,k){return a<=j&&j<=c&&b<=k&&k<=d}function f(j,k,l,m){var n=0,o=0;if(null==j||(n=g(j,l))!==(o=g(k,l))||i(j,k)<0^l>0)do m.point(0===n||3===n?a:c,n>1?d:b);while((n=(n+l+4)%4)!==o);else m.point(k[0],k[1])}function g(j,k){return oc(j[0]-a)<1e-6?k>0?0:3:oc(j[0]-c)<1e-6?k>0?2:1:oc(j[1]-b)<1e-6?k>0?1:0:k>0?3:2}function h(j,k){return i(j.x,k.x)}function i(j,k){var l=g(j,1),m=g(k,1);return l!==m?l-m:0===l?k[1]-j[1]:1===l?j[0]-k[0]:2===l?j[1]-k[1]:k[0]-j[0]}return function(j){var k,l,m,n,o,p,q,s,r,u,t,w=j,x=PE(),z={point:A,lineStart:function(){z.point=B,l&&l.push(m=[]),u=!0,r=!1,q=s=NaN},lineEnd:function(){k&&(B(n,o),p&&r&&x.rejoin(),k.push(x.result())),z.point=A,r&&w.lineEnd()},polygonStart:function(){w=x,k=[],l=[],t=!0},polygonEnd:function(){var I=function(){for(var O=0,K=0,Q=l.length;K<Q;++K)for(var V,$,Ia=l[K],wa=1,xa=Ia.length,oa=Ia[0],Ma=oa[0],Za=oa[1];wa<xa;++wa)V=Ma,$=Za,oa=Ia[wa],Ma=oa[0],Za=oa[1],$<=d?Za>d&&(Ma-V)*(d-$)>(Za-$)*(a-V)&&++O:Za<=d&&(Ma-V)*(d-$)<(Za-$)*(a-V)&&--O;return O}(),J=t&&I,D=(k=TE(k)).length;(J||D)&&(j.polygonStart(),J&&(j.lineStart(),f(null,null,1,j),j.lineEnd()),D&&QE(k,h,I,f,j),j.polygonEnd()),w=j,k=l=m=null}};function A(I,J){e(I,J)&&w.point(I,J)}function B(I,J){var D=e(I,J);if(l&&m.push([I,J]),u)n=I,o=J,p=D,u=!1,D&&(w.lineStart(),w.point(I,J));else if(D&&r)w.point(I,J);else{var O=[q=Math.max(-1e9,Math.min(1e9,q)),s=Math.max(-1e9,Math.min(1e9,s))],K=[I=Math.max(-1e9,Math.min(1e9,I)),J=Math.max(-1e9,Math.min(1e9,J))];(function(Q,V,$,Ia,wa,xa){var oa,Ma=Q[0],Za=Q[1],Pa=0,La=1,wb=V[0]-Ma,tc=V[1]-Za;if(oa=$-Ma,wb||!(oa>0)){if(oa/=wb,wb<0){if(oa<Pa)return;oa<La&&(La=oa)}else if(wb>0){if(oa>La)return;oa>Pa&&(Pa=oa)}if(oa=wa-Ma,wb||!(oa<0)){if(oa/=wb,wb<0){if(oa>La)return;oa>Pa&&(Pa=oa)}else if(wb>0){if(oa<Pa)return;oa<La&&(La=oa)}if(oa=Ia-Za,tc||!(oa>0)){if(oa/=tc,tc<0){if(oa<Pa)return;oa<La&&(La=oa)}else if(tc>0){if(oa>La)return;oa>Pa&&(Pa=oa)}if(oa=xa-Za,tc||!(oa<0)){if(oa/=tc,tc<0){if(oa>La)return;oa>Pa&&(Pa=oa)}else if(tc>0){if(oa<Pa)return;oa<La&&(La=oa)}return Pa>0&&(Q[0]=Ma+Pa*wb,Q[1]=Za+Pa*tc),La<1&&(V[0]=Ma+La*wb,V[1]=Za+La*tc),!0}}}}})(O,K,a,b,c,d)?(r||(w.lineStart(),w.point(O[0],O[1])),w.point(K[0],K[1]),D||w.lineEnd(),t=!1):D&&(w.lineStart(),w.point(I,J),t=!1)}q=I,s=J,r=D}return z}}function XE(a,b,c){var d=lk(a,b-1e-6,c).concat(b);return function(e){return d.map(function(f){return[e,f]})}}function YE(a,b,c){var d=lk(a,b-1e-6,c).concat(b);return function(e){return d.map(function(f){return[f,e]})}}function Ml(a){return a}var ZE,_E,Lu,Mu,Nu=Yi(),Ou=Yi(),ph={point:je,lineStart:je,lineEnd:je,polygonStart:function(){ph.lineStart=TQ,ph.lineEnd=VQ},polygonEnd:function(){ph.lineStart=ph.lineEnd=ph.point=je,Nu.add(oc(Ou)),Ou.reset()},result:function(){var a=Nu/2;return Nu.reset(),a}};function TQ(){ph.point=UQ}function UQ(a,b){ph.point=$E,ZE=Lu=a,_E=Mu=b}function $E(a,b){Ou.add(Mu*a-Lu*b),Lu=a,Mu=b}function VQ(){$E(ZE,_E)}var mk=1/0,Vo=mk,Nl=-mk,Wo=Nl,Xo={point:function(a,b){a<mk&&(mk=a),a>Nl&&(Nl=a),b<Vo&&(Vo=b),b>Wo&&(Wo=b)},lineStart:je,lineEnd:je,polygonStart:je,polygonEnd:je,result:function(){var a=[[mk,Vo],[Nl,Wo]];return Nl=Wo=-(Vo=mk=1/0),a}},aF,bF,Lg,Mg,Pu=0,Qu=0,Ol=0,Yo=0,Zo=0,nk=0,Ru=0,Su=0,Pl=0,Pf={point:$i,lineStart:cF,lineEnd:dF,polygonStart:function(){Pf.lineStart=YQ,Pf.lineEnd=ZQ},polygonEnd:function(){Pf.point=$i,Pf.lineStart=cF,Pf.lineEnd=dF},result:function(){var a=Pl?[Ru/Pl,Su/Pl]:nk?[Yo/nk,Zo/nk]:Ol?[Pu/Ol,Qu/Ol]:[NaN,NaN];return Pu=Qu=Ol=Yo=Zo=nk=Ru=Su=Pl=0,a}};function $i(a,b){Pu+=a,Qu+=b,++Ol}function cF(){Pf.point=WQ}function WQ(a,b){Pf.point=XQ,$i(Lg=a,Mg=b)}function XQ(a,b){var c=a-Lg,d=b-Mg,e=ie(c*c+d*d);Yo+=e*(Lg+a)/2,Zo+=e*(Mg+b)/2,nk+=e,$i(Lg=a,Mg=b)}function dF(){Pf.point=$i}function YQ(){Pf.point=_Q}function ZQ(){eF(aF,bF)}function _Q(a,b){Pf.point=eF,$i(aF=Lg=a,bF=Mg=b)}function eF(a,b){var c=a-Lg,d=b-Mg,e=ie(c*c+d*d);Yo+=e*(Lg+a)/2,Zo+=e*(Mg+b)/2,nk+=e,Ru+=(e=Mg*a-Lg*b)*(Lg+a),Su+=e*(Mg+b),Pl+=3*e,$i(Lg=a,Mg=b)}function fF(a){this._context=a}fF.prototype={_radius:4.5,pointRadius:function(a){return this._radius=a,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(a,b){switch(this._point){case 0:this._context.moveTo(a,b),this._point=1;break;case 1:this._context.lineTo(a,b);break;default:this._context.moveTo(a+this._radius,b),this._context.arc(a,b,this._radius,0,Le)}},result:je};var Tu,gF,hF,Ql,Rl,Uu=Yi(),Sl={point:je,lineStart:function(){Sl.point=$Q},lineEnd:function(){Tu&&iF(gF,hF),Sl.point=je},polygonStart:function(){Tu=!0},polygonEnd:function(){Tu=null},result:function(){var a=+Uu;return Uu.reset(),a}};function $Q(a,b){Sl.point=iF,gF=Ql=a,hF=Rl=b}function iF(a,b){Ql-=a,Rl-=b,Uu.add(ie(Ql*Ql+Rl*Rl)),Ql=a,Rl=b}function jF(){this._string=[]}function kF(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function lF(a,b){var c,d,e=4.5;function f(g){return g&&("function"==typeof e&&d.pointRadius(+e.apply(this,arguments)),mh(g,c(d))),d.result()}return f.area=function(g){return mh(g,c(ph)),ph.result()},f.measure=function(g){return mh(g,c(Sl)),Sl.result()},f.bounds=function(g){return mh(g,c(Xo)),Xo.result()},f.centroid=function(g){return mh(g,c(Pf)),Pf.result()},f.projection=function(g){return arguments.length?(c=null==g?(a=null,Ml):(a=g).stream,f):a},f.context=function(g){return arguments.length?(d=null==g?(b=null,new jF()):new fF(b=g),"function"!=typeof e&&d.pointRadius(e),f):b},f.pointRadius=function(g){return arguments.length?(e="function"==typeof g?g:(d.pointRadius(+g),+g),f):e},f.projection(a).context(b)}function _o(a){return function(b){var c=new Vu();for(var d in a)c[d]=a[d];return c.stream=b,c}}function Vu(){}function Wu(a,b,c){var d=a.clipExtent&&a.clipExtent();return a.scale(150).translate([0,0]),null!=d&&a.clipExtent(null),mh(c,a.stream(Xo)),b(Xo.result()),null!=d&&a.clipExtent(d),a}function $o(a,b,c){return Wu(a,function(d){var e=b[1][0]-b[0][0],f=b[1][1]-b[0][1],g=Math.min(e/(d[1][0]-d[0][0]),f/(d[1][1]-d[0][1])),h=+b[0][0]+(e-g*(d[1][0]+d[0][0]))/2,i=+b[0][1]+(f-g*(d[1][1]+d[0][1]))/2;a.scale(150*g).translate([h,i])},c)}function Xu(a,b,c){return $o(a,[[0,0],b],c)}function Yu(a,b,c){return Wu(a,function(d){var e=+b,f=e/(d[1][0]-d[0][0]),g=(e-f*(d[1][0]+d[0][0]))/2,h=-f*d[0][1];a.scale(150*f).translate([g,h])},c)}function Zu(a,b,c){return Wu(a,function(d){var e=+b,f=e/(d[1][1]-d[0][1]),g=-f*d[0][0],h=(e-f*(d[1][1]+d[0][1]))/2;a.scale(150*f).translate([g,h])},c)}jF.prototype={_radius:4.5,_circle:kF(4.5),pointRadius:function(a){return(a=+a)!==this._radius&&(this._radius=a,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(a,b){switch(this._point){case 0:this._string.push("M",a,",",b),this._point=1;break;case 1:this._string.push("L",a,",",b);break;default:null==this._circle&&(this._circle=kF(this._radius)),this._string.push("M",a,",",b,this._circle)}},result:function(){if(this._string.length){var a=this._string.join("");return this._string=[],a}return null}},Vu.prototype={constructor:Vu,point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var aR=mb(30*$b);function mF(a,b){return+b?function(c,d){function e(f,g,h,i,j,k,l,m,n,o,p,q,s,r){var u=l-f,t=m-g,w=u*u+t*t;if(w>4*d&&s--){var x=i+o,z=j+p,A=k+q,B=ie(x*x+z*z+A*A),I=hf(A/=B),J=oc(oc(A)-1)<1e-6||oc(h-n)<1e-6?(h+n)/2:Nf(z,x),D=c(J,I),O=D[0],K=D[1],Q=O-f,V=K-g,$=t*Q-u*V;($*$/w>d||oc((u*Q+t*V)/w-.5)>.3||i*o+j*p+k*q<aR)&&(e(f,g,h,i,j,k,O,K,J,x/=B,z/=B,A,s,r),r.point(O,K),e(O,K,J,x,z,A,l,m,n,o,p,q,s,r))}}return function(f){var g,h,i,j,k,l,m,n,o,p,q,s,r={point:u,lineStart:t,lineEnd:x,polygonStart:function(){f.polygonStart(),r.lineStart=z},polygonEnd:function(){f.polygonEnd(),r.lineStart=t}};function u(I,J){I=c(I,J),f.point(I[0],I[1])}function t(){n=NaN,r.point=w,f.lineStart()}function w(I,J){var D=Zi([I,J]),O=c(I,J);e(n,o,m,p,q,s,n=O[0],o=O[1],m=I,p=D[0],q=D[1],s=D[2],16,f),f.point(n,o)}function x(){r.point=u,f.lineEnd()}function z(){t(),r.point=A,r.lineEnd=B}function A(I,J){w(g=I,J),h=n,i=o,j=p,k=q,l=s,r.point=w}function B(){e(n,o,m,p,q,s,h,i,g,j,k,l,16,f),r.lineEnd=x,x()}return r}}(a,b):function(c){return _o({point:function(d,e){d=c(d,e),this.stream.point(d[0],d[1])}})}(a)}var bR=_o({point:function(a,b){this.stream.point(a*$b,b*$b)}});function cR(a,b,c,d,e){function f(g,h){return[b+a*(g*=d),c-a*(h*=e)]}return f.invert=function(g,h){return[(g-b)/a*d,(c-h)/a*e]},f}function nF(a,b,c,d,e,f){var g=mb(f),h=ib(f),i=g*a,j=h*a,k=g/a,l=h/a,m=(h*c-g*b)/a,n=(h*b+g*c)/a;function o(p,q){return[i*(p*=d)-j*(q*=e)+b,c-j*p-i*q]}return o.invert=function(p,q){return[d*(k*p-l*q+m),e*(n-l*p-k*q)]},o}function Ng(a){return oF(function(){return a})()}function oF(a){var b,c,d,e,f,g,h,i,j,k,l=150,m=480,n=250,o=0,p=0,q=0,s=0,r=0,u=0,t=1,w=1,x=null,z=VE,A=null,B=Ml,I=.5;function J(Q){return i(Q[0]*$b,Q[1]*$b)}function D(Q){return(Q=i.invert(Q[0],Q[1]))&&[Q[0]*Ed,Q[1]*Ed]}function O(){var Q=nF(l,0,0,t,w,u).apply(null,b(o,p)),V=(u?nF:cR)(l,m-Q[0],n-Q[1],t,w,u);return c=KE(q,s,r),h=Hu(b,V),i=Hu(c,h),g=mF(h,I),K()}function K(){return j=k=null,J}return J.stream=function(Q){return j&&k===Q?j:j=bR(function(V){return _o({point:function($,Ia){var wa=V($,Ia);return this.stream.point(wa[0],wa[1])}})}(c)(z(g(B(k=Q)))))},J.preclip=function(Q){return arguments.length?(z=Q,x=void 0,K()):z},J.postclip=function(Q){return arguments.length?(B=Q,A=d=e=f=null,K()):B},J.clipAngle=function(Q){return arguments.length?(z=+Q?SQ(x=Q*$b):(x=null,VE),K()):x*Ed},J.clipExtent=function(Q){return arguments.length?(B=null==Q?(A=d=e=f=null,Ml):WE(A=+Q[0][0],d=+Q[0][1],e=+Q[1][0],f=+Q[1][1]),K()):null==A?null:[[A,d],[e,f]]},J.scale=function(Q){return arguments.length?(l=+Q,O()):l},J.translate=function(Q){return arguments.length?(m=+Q[0],n=+Q[1],O()):[m,n]},J.center=function(Q){return arguments.length?(o=Q[0]%360*$b,p=Q[1]%360*$b,O()):[o*Ed,p*Ed]},J.rotate=function(Q){return arguments.length?(q=Q[0]%360*$b,s=Q[1]%360*$b,r=Q.length>2?Q[2]%360*$b:0,O()):[q*Ed,s*Ed,r*Ed]},J.angle=function(Q){return arguments.length?(u=Q%360*$b,O()):u*Ed},J.reflectX=function(Q){return arguments.length?(t=Q?-1:1,O()):t<0},J.reflectY=function(Q){return arguments.length?(w=Q?-1:1,O()):w<0},J.precision=function(Q){return arguments.length?(g=mF(h,I=Q*Q),K()):ie(I)},J.fitExtent=function(Q,V){return $o(J,Q,V)},J.fitSize=function(Q,V){return Xu(J,Q,V)},J.fitWidth=function(Q,V){return Yu(J,Q,V)},J.fitHeight=function(Q,V){return Zu(J,Q,V)},function(){return b=a.apply(this,arguments),J.invert=b.invert&&D,O()}}function _u(a){var b=0,c=_b/3,d=oF(a),e=d(b,c);return e.parallels=function(f){return arguments.length?d(b=f[0]*$b,c=f[1]*$b):[b*Ed,c*Ed]},e}function dR(a,b){var c=ib(a),d=(c+ib(b))/2;if(oc(d)<1e-6)return function(h){var i=mb(h);function j(k,l){return[k*i,ib(l)/i]}return j.invert=function(k,l){return[k/i,hf(l*i)]},j}(a);var e=1+c*(2*d-c),f=ie(e)/d;function g(h,i){var j=ie(e-2*d*ib(i))/d;return[j*ib(h*=d),f-j*mb(h)]}return g.invert=function(h,i){var j=f-i,k=Nf(h,oc(j))*Of(j);return j*d<0&&(k-=_b*Of(h)*Of(j)),[k/d,hf((e-(h*h+j*j)*d*d)/(2*d))]},g}function ap(){return _u(dR).scale(155.424).center([0,33.6442])}function pF(){return ap().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function qF(a){return function(b,c){var d=mb(b),e=mb(c),f=a(d*e);return[f*e*ib(b),f*ib(c)]}}function Tl(a){return function(b,c){var d=ie(b*b+c*c),e=a(d),f=ib(e),g=mb(e);return[Nf(b*f,d*g),hf(d&&c*f/d)]}}var rF=qF(function(a){return ie(2/(1+a))});rF.invert=Tl(function(a){return 2*hf(a/2)});var sF=qF(function(a){return(a=rE(a))&&a/ib(a)});function bp(a,b){return[a,Eo(wu((zd+b)/2))]}function tF(a){var b,c,d,e=Ng(a),f=e.center,g=e.scale,h=e.translate,i=e.clipExtent,j=null;function k(){var l=_b*g(),m=e(function(n){function o(p){return(p=n(p[0]*$b,p[1]*$b))[0]*=Ed,p[1]*=Ed,p}return n=KE(n[0]*$b,n[1]*$b,n.length>2?n[2]*$b:0),o.invert=function(p){return(p=n.invert(p[0]*$b,p[1]*$b))[0]*=Ed,p[1]*=Ed,p},o}(e.rotate()).invert([0,0]));return i(null==j?[[m[0]-l,m[1]-l],[m[0]+l,m[1]+l]]:a===bp?[[Math.max(m[0]-l,j),b],[Math.min(m[0]+l,c),d]]:[[j,Math.max(m[1]-l,b)],[c,Math.min(m[1]+l,d)]])}return e.scale=function(l){return arguments.length?(g(l),k()):g()},e.translate=function(l){return arguments.length?(h(l),k()):h()},e.center=function(l){return arguments.length?(f(l),k()):f()},e.clipExtent=function(l){return arguments.length?(null==l?j=b=c=d=null:(j=+l[0][0],b=+l[0][1],c=+l[1][0],d=+l[1][1]),k()):null==j?null:[[j,b],[c,d]]},k()}function cp(a){return wu((zd+a)/2)}function eR(a,b){var c=mb(a),d=a===b?ib(a):Eo(c/mb(b))/Eo(cp(b)/cp(a)),e=c*vu(cp(a),d)/d;if(!d)return bp;function f(g,h){e>0?h<1e-6-zd&&(h=1e-6-zd):h>zd-1e-6&&(h=zd-1e-6);var i=e/vu(cp(h),d);return[i*ib(d*g),e-i*mb(d*g)]}return f.invert=function(g,h){var i=e-h,j=Of(d)*ie(g*g+i*i),k=Nf(g,oc(i))*Of(i);return i*d<0&&(k-=_b*Of(g)*Of(i)),[k/d,2*ik(vu(e/j,1/d))-zd]},f}function dp(a,b){return[a,b]}function fR(a,b){var c=mb(a),d=a===b?ib(a):(c-mb(b))/(b-a),e=c/d+a;if(oc(d)<1e-6)return dp;function f(g,h){var i=e-h,j=d*g;return[i*ib(j),e-i*mb(j)]}return f.invert=function(g,h){var i=e-h,j=Nf(g,oc(i))*Of(i);return i*d<0&&(j-=_b*Of(g)*Of(i)),[j/d,e-Of(d)*ie(g*g+i*i)]},f}sF.invert=Tl(function(a){return a}),bp.invert=function(a,b){return[a,2*ik(qE(b))-zd]},dp.invert=dp;var Ul=1.340264,Vl=-.081106,Wl=893e-6,Xl=.003796,ep=ie(3)/2;function uF(a,b){var c=hf(ep*ib(b)),d=c*c,e=d*d*d;return[a*mb(c)/(ep*(Ul+3*Vl*d+e*(7*Wl+9*Xl*d))),c*(Ul+Vl*d+e*(Wl+Xl*d))]}function vF(a,b){var c=mb(b),d=mb(a)*c;return[c*ib(a)/d,ib(b)/d]}function wF(a,b){var c=b*b,d=c*c;return[a*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791)),b*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))]}function xF(a,b){return[mb(b)*ib(a),ib(b)]}function yF(a,b){var c=mb(b),d=1+mb(a)*c;return[c*ib(a)/d,ib(b)/d]}function zF(a,b){return[Eo(wu((zd+b)/2)),-a]}uF.invert=function(a,b){for(var c,d=b,e=d*d,f=e*e*e,g=0;g<12&&(f=(e=(d-=c=(d*(Ul+Vl*e+f*(Wl+Xl*e))-b)/(Ul+3*Vl*e+f*(7*Wl+9*Xl*e)))*d)*e*e,!(oc(c)<1e-12));++g);return[ep*a*(Ul+3*Vl*e+f*(7*Wl+9*Xl*e))/mb(d),hf(ib(d)/ep)]},vF.invert=Tl(ik),wF.invert=function(a,b){var c,d=b,e=25;do{var f=d*d,g=f*f;d-=c=(d*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))-b)/(1.007226+f*(.045255+g*(.259866*f-.311325-.005916*11*g)))}while(oc(c)>1e-6&&--e>0);return[a/(.8707+(f=d*d)*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979)),d]},xF.invert=Tl(hf),yF.invert=Tl(function(a){return 2*ik(a)}),zF.invert=function(a,b){return[-b,2*ik(qE(a))-zd]};var gR=Math.abs,$u=Math.cos,fp=Math.sin,AF=Math.PI,av=AF/2,BF=function(a){return a>0?Math.sqrt(a):0}(2);function CF(a){return a>1?av:a<-1?-av:Math.asin(a)}function hR(a,b){var c,d=a*fp(b),e=30;do b-=c=(b+fp(b)-d)/(1+$u(b));while(gR(c)>1e-6&&--e>0);return b/2}var iR=function(a,b,c){function d(e,f){return[a*e*$u(f=hR(c,f)),b*fp(f)]}return d.invert=function(e,f){return f=CF(f/b),[e/(a*$u(f)),CF((2*f+fp(2*f))/c)]},d}(BF/av,BF,AF),jR=lF(),bv=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function kR(a,b){return function c(){var d=b();return d.type=a,d.path=lF().projection(d),d.copy=d.copy||function(){var e=c();return bv.forEach(function(f){d[f]&&e[f](d[f]())}),e.path.pointRadius(d.path.pointRadius()),e},d}}function cv(a,b){if(!a||"string"!=typeof a)throw new Error("Projection type must be a name string.");return a=a.toLowerCase(),arguments.length>1?(gp[a]=kR(a,b),this):gp[a]||null}function DF(a){return a&&a.path||jR}var gp={albers:pF,albersusa:function(){var a,b,c,d,e,f,g=pF(),h=ap().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i=ap().rotate([157,0]).center([-3,19.9]).parallels([8,18]),j={point:function(m,n){f=[m,n]}};function k(m){var n=m[0],o=m[1];return f=null,c.point(n,o),f||(d.point(n,o),f)||(e.point(n,o),f)}function l(){return a=b=null,k}return k.invert=function(m){var n=g.scale(),o=g.translate(),p=(m[0]-o[0])/n,q=(m[1]-o[1])/n;return(q>=.12&&q<.234&&p>=-.425&&p<-.214?h:q>=.166&&q<.234&&p>=-.214&&p<-.115?i:g).invert(m)},k.stream=function(m){return a&&b===m?a:(n=[g.stream(b=m),h.stream(m),i.stream(m)],o=n.length,a={point:function(p,q){for(var s=-1;++s<o;)n[s].point(p,q)},sphere:function(){for(var p=-1;++p<o;)n[p].sphere()},lineStart:function(){for(var p=-1;++p<o;)n[p].lineStart()},lineEnd:function(){for(var p=-1;++p<o;)n[p].lineEnd()},polygonStart:function(){for(var p=-1;++p<o;)n[p].polygonStart()},polygonEnd:function(){for(var p=-1;++p<o;)n[p].polygonEnd()}});var n,o},k.precision=function(m){return arguments.length?(g.precision(m),h.precision(m),i.precision(m),l()):g.precision()},k.scale=function(m){return arguments.length?(g.scale(m),h.scale(.35*m),i.scale(m),k.translate(g.translate())):g.scale()},k.translate=function(m){if(!arguments.length)return g.translate();var n=g.scale(),o=+m[0],p=+m[1];return c=g.translate(m).clipExtent([[o-.455*n,p-.238*n],[o+.455*n,p+.238*n]]).stream(j),d=h.translate([o-.307*n,p+.201*n]).clipExtent([[o-.425*n+1e-6,p+.12*n+1e-6],[o-.214*n-1e-6,p+.234*n-1e-6]]).stream(j),e=i.translate([o-.205*n,p+.212*n]).clipExtent([[o-.214*n+1e-6,p+.166*n+1e-6],[o-.115*n-1e-6,p+.234*n-1e-6]]).stream(j),l()},k.fitExtent=function(m,n){return $o(k,m,n)},k.fitSize=function(m,n){return Xu(k,m,n)},k.fitWidth=function(m,n){return Yu(k,m,n)},k.fitHeight=function(m,n){return Zu(k,m,n)},k.scale(1070)},azimuthalequalarea:function(){return Ng(rF).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Ng(sF).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return _u(eR).scale(109.5).parallels([30,30])},conicequalarea:ap,conicequidistant:function(){return _u(fR).scale(131.154).center([0,13.9389])},equalEarth:function(){return Ng(uF).scale(177.158)},equirectangular:function(){return Ng(dp).scale(152.63)},gnomonic:function(){return Ng(vF).scale(144.049).clipAngle(60)},identity:function(){var a,b,c,d,e,f,g,h=1,i=0,j=0,k=1,l=1,m=0,n=null,o=1,p=1,q=_o({point:function(t,w){var x=u([t,w]);this.stream.point(x[0],x[1])}}),s=Ml;function r(){return o=h*k,p=h*l,f=g=null,u}function u(t){var w=t[0]*o,x=t[1]*p;if(m){var z=x*a-w*b;w=w*a+x*b,x=z}return[w+i,x+j]}return u.invert=function(t){var w=t[0]-i,x=t[1]-j;if(m){var z=x*a+w*b;w=w*a-x*b,x=z}return[w/o,x/p]},u.stream=function(t){return f&&g===t?f:f=q(s(g=t))},u.postclip=function(t){return arguments.length?(s=t,n=c=d=e=null,r()):s},u.clipExtent=function(t){return arguments.length?(s=null==t?(n=c=d=e=null,Ml):WE(n=+t[0][0],c=+t[0][1],d=+t[1][0],e=+t[1][1]),r()):null==n?null:[[n,c],[d,e]]},u.scale=function(t){return arguments.length?(h=+t,r()):h},u.translate=function(t){return arguments.length?(i=+t[0],j=+t[1],r()):[i,j]},u.angle=function(t){return arguments.length?(b=ib(m=t%360*$b),a=mb(m),r()):m*Ed},u.reflectX=function(t){return arguments.length?(k=t?-1:1,r()):k<0},u.reflectY=function(t){return arguments.length?(l=t?-1:1,r()):l<0},u.fitExtent=function(t,w){return $o(u,t,w)},u.fitSize=function(t,w){return Xu(u,t,w)},u.fitWidth=function(t,w){return Yu(u,t,w)},u.fitHeight=function(t,w){return Zu(u,t,w)},u},mercator:function(){return tF(bp).scale(961/Le)},mollweide:function(){return Ng(iR).scale(169.529)},naturalEarth1:function(){return Ng(wF).scale(175.295)},orthographic:function(){return Ng(xF).scale(249.5).clipAngle(90.000001)},stereographic:function(){return Ng(yF).scale(250).clipAngle(142)},transversemercator:function(){var a=tF(zF),b=a.center,c=a.rotate;return a.center=function(d){return arguments.length?b([-d[1],d[0]]):[(d=b())[1],-d[0]]},a.rotate=function(d){return arguments.length?c([d[0],d[1],d.length>2?d[2]+90:90]):[(d=c())[0],d[1],d[2]-90]},c([0,0,90]).scale(159.155)}};for(var EF in gp)cv(EF,gp[EF]);function dv(a){ia.call(this,null,a)}function ev(a){ia.call(this,null,a)}function fv(a){ia.call(this,null,a)}function gv(a){ia.call(this,[],a),this.generator=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n=10,o=n,p=90,q=360,s=2.5;function r(){return{type:"MultiLineString",coordinates:u()}}function u(){return lk(Do(e/p)*p,d,p).map(l).concat(lk(Do(i/q)*q,h,q).map(m)).concat(lk(Do(c/n)*n,b,n).filter(function(t){return oc(t%p)>1e-6}).map(j)).concat(lk(Do(g/o)*o,f,o).filter(function(t){return oc(t%q)>1e-6}).map(k))}return r.lines=function(){return u().map(function(t){return{type:"LineString",coordinates:t}})},r.outline=function(){return{type:"Polygon",coordinates:[l(e).concat(m(h).slice(1),l(d).reverse().slice(1),m(i).reverse().slice(1))]}},r.extent=function(t){return arguments.length?r.extentMajor(t).extentMinor(t):r.extentMinor()},r.extentMajor=function(t){return arguments.length?(e=+t[0][0],d=+t[1][0],i=+t[0][1],h=+t[1][1],e>d&&(t=e,e=d,d=t),i>h&&(t=i,i=h,h=t),r.precision(s)):[[e,i],[d,h]]},r.extentMinor=function(t){return arguments.length?(c=+t[0][0],b=+t[1][0],g=+t[0][1],f=+t[1][1],c>b&&(t=c,c=b,b=t),g>f&&(t=g,g=f,f=t),r.precision(s)):[[c,g],[b,f]]},r.step=function(t){return arguments.length?r.stepMajor(t).stepMinor(t):r.stepMinor()},r.stepMajor=function(t){return arguments.length?(p=+t[0],q=+t[1],r):[p,q]},r.stepMinor=function(t){return arguments.length?(n=+t[0],o=+t[1],r):[n,o]},r.precision=function(t){return arguments.length?(s=+t,j=XE(g,f,90),k=YE(c,b,s),l=XE(i,h,90),m=YE(e,d,s),r):s},r.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()}function hv(a){ia.call(this,null,a)}function FF(a){if(!Ub(a))return!1;const b=ee(ed(a));return b.$x||b.$y||b.$value||b.$max}function GF(a){ia.call(this,null,a),this.modified(!0)}function HF(a,b,c){Ub(a[b])&&a[b](c)}dv.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Da(dv,ia).transform=function(a,b){var c=b.fork(b.ALL),d=this.value,e=a.field||fc,f=a.as||"path",g=c.SOURCE;!d||a.modified()?(this.value=d=DF(a.projection),c.materialize().reflow()):g=e===fc||b.modified(e.fields)?c.ADD_MOD:c.ADD;var h=function(i,j){var k=i.pointRadius();return i.context(null),null!=j&&i.pointRadius(j),k}(d,a.pointRadius);return c.visit(g,function(i){i[f]=d(e(i))}),d.pointRadius(h),c.modifies(f)},ev.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Da(ev,ia).transform=function(a,b){var c,d=a.projection,e=a.fields[0],f=a.fields[1],g=a.as||["x","y"],h=g[0],i=g[1];function j(k){var l=d([e(k),f(k)]);l?(k[h]=l[0],k[i]=l[1]):(k[h]=void 0,k[i]=void 0)}return a.modified()?b=b.materialize().reflow(!0).visit(b.SOURCE,j):(c=b.modified(e.fields)||b.modified(f.fields),b.visit(c?b.ADD_MOD:b.ADD,j)),b.modifies(g)},fv.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Da(fv,ia).transform=function(a,b){var c=b.fork(b.ALL),d=this.value,e=a.as||"shape",f=c.ADD;return d&&!a.modified()||(this.value=d=function(g,h,i){var j=null==i?function(k){return g(h(k))}:function(k){var l=g.pointRadius(),m=g.pointRadius(i)(h(k));return g.pointRadius(l),m};return j.context=function(k){return g.context(k),j},j}(DF(a.projection),a.field||ce("datum"),a.pointRadius),c.materialize().reflow(),f=c.SOURCE),c.visit(f,function(g){g[e]=d}),c.modifies(e)},gv.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Da(gv,ia).transform=function(a,b){var c,d=this.value,e=this.generator;if(!d.length||a.modified())for(var f in a)Ub(e[f])&&e[f](a[f]);return c=e(),d.length?b.mod.push(Fy(d[0],c)):b.add.push(Ac(c)),d[0]=c,b},hv.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Da(hv,ia).transform=function(a,b){if(!b.changed()&&!a.modified())return b.StopPropagation;var c=b.materialize(b.SOURCE).source,d="shared"===a.resolve,e=a.field||fc,f=function(j,k){let l;return Ub(j)?(l=m=>j(m,k),l.dep=FF(j)):j?l=Nd(j):(l=m=>m.$value/m.$max||0,l.dep=!0),l}(a.opacity,a),g=function(j,k){let l;return Ub(j)?(l=m=>ai(j(m,k)),l.dep=FF(j)):l=Nd(ai(j||"#888")),l}(a.color,a),h=a.as||"image",i={$x:0,$y:0,$value:0,$max:d?Gi(c.map(j=>Gi(e(j).values))):0};return c.forEach(j=>{const k=e(j),l=Mb({},j,i);d||(l.$max=Gi(k.values||[])),j[h]=function(m,n,o,p){const q=m.width,s=m.height,r=m.x1||0,u=m.y1||0,t=m.x2||q,w=m.y2||s,x=m.values,z=x?D=>x[D]:pe,A=ql(t-r,w-u),B=A.getContext("2d"),I=B.getImageData(0,0,t-r,w-u),J=I.data;for(let D=u,O=0;D<w;++D){n.$y=D-u;for(let K=r,Q=D*q;K<t;++K,O+=4){n.$x=K-r,n.$value=z(K+Q);const V=o(n);J[O+0]=V.r,J[O+1]=V.g,J[O+2]=V.b,J[O+3]=~~(255*p(n))}}return B.putImageData(I,0,0),A}(k,l,g.dep?g:Nd(g(l)),f.dep?f:Nd(f(l)))}),b.reflow(!0).modifies(h)},Da(GF,ia).transform=function(a,b){var c=this.value;return!c||a.modified("type")?(this.value=c=function(d){var e=cv((d||"mercator").toLowerCase());return e||ja("Unrecognized projection type: "+d),e()}(a.type),bv.forEach(function(d){null!=a[d]&&HF(c,d,a[d])})):bv.forEach(function(d){a.modified(d)&&HF(c,d,a[d])}),null!=a.pointRadius&&c.path.pointRadius(a.pointRadius),a.fit&&function(d,e){var f=function(g){return 1===(g=Ra(g)).length?g[0]:{type:"FeatureCollection",features:g.reduce((h,i)=>h.concat(function(j){return"FeatureCollection"===j.type?j.features:Ra(j).filter(k=>null!=k).map(k=>"Feature"===k.type?k:{type:"Feature",geometry:k})}(i)),[])}}(e.fit);e.extent?d.fitExtent(e.extent,f):e.size&&d.fitSize(e.size,f)}(c,a),b.fork(b.NO_SOURCE|b.NO_FIELDS)};var lR=Object.freeze({__proto__:null,contour:tu,geojson:uu,geopath:dv,geopoint:ev,geoshape:fv,graticule:gv,heatmap:hv,isocontour:qu,kde2d:su,projection:GF});function IF(a,b,c,d){if(isNaN(b)||isNaN(c))return a;var e,f,g,h,i,j,k,l,m,n=a._root,o={data:d},p=a._x0,q=a._y0,s=a._x1,r=a._y1;if(!n)return a._root=o,a;for(;n.length;)if((j=b>=(f=(p+s)/2))?p=f:s=f,(k=c>=(g=(q+r)/2))?q=g:r=g,e=n,!(n=n[l=k<<1|j]))return e[l]=o,a;if(h=+a._x.call(null,n.data),i=+a._y.call(null,n.data),b===h&&c===i)return o.next=n,e?e[l]=o:a._root=o,a;do e=e?e[l]=new Array(4):a._root=new Array(4),(j=b>=(f=(p+s)/2))?p=f:s=f,(k=c>=(g=(q+r)/2))?q=g:r=g;while((l=k<<1|j)==(m=(i>=g)<<1|h>=f));return e[m]=n,e[l]=o,a}function Pe(a,b,c,d,e){this.node=a,this.x0=b,this.y0=c,this.x1=d,this.y1=e}function mR(a){return a[0]}function nR(a){return a[1]}function iv(a,b,c){var d=new jv(null==b?mR:b,null==c?nR:c,NaN,NaN,NaN,NaN);return null==a?d:d.addAll(a)}function jv(a,b,c,d,e,f){this._x=a,this._y=b,this._x0=c,this._y0=d,this._x1=e,this._y1=f,this._root=void 0}function JF(a){for(var b={data:a.data},c=b;a=a.next;)c=c.next={data:a.data};return b}var Qe=iv.prototype=jv.prototype;function Re(a){return function(){return a}}function ei(){return 1e-6*(Math.random()-.5)}function oR(a){return a.x+a.vx}function pR(a){return a.y+a.vy}function qR(a){return a.index}function KF(a,b){var c=a.get(b);if(!c)throw new Error("missing: "+b);return c}Qe.copy=function(){var a,b,c=new jv(this._x,this._y,this._x0,this._y0,this._x1,this._y1),d=this._root;if(!d)return c;if(!d.length)return c._root=JF(d),c;for(a=[{source:d,target:c._root=new Array(4)}];d=a.pop();)for(var e=0;e<4;++e)(b=d.source[e])&&(b.length?a.push({source:b,target:d.target[e]=new Array(4)}):d.target[e]=JF(b));return c},Qe.add=function(a){var b=+this._x.call(null,a),c=+this._y.call(null,a);return IF(this.cover(b,c),b,c,a)},Qe.addAll=function(a){var b,c,d,e,f=a.length,g=new Array(f),h=new Array(f),i=1/0,j=1/0,k=-1/0,l=-1/0;for(c=0;c<f;++c)isNaN(d=+this._x.call(null,b=a[c]))||isNaN(e=+this._y.call(null,b))||(g[c]=d,h[c]=e,d<i&&(i=d),d>k&&(k=d),e<j&&(j=e),e>l&&(l=e));if(i>k||j>l)return this;for(this.cover(i,j).cover(k,l),c=0;c<f;++c)IF(this,g[c],h[c],a[c]);return this},Qe.cover=function(a,b){if(isNaN(a=+a)||isNaN(b=+b))return this;var c=this._x0,d=this._y0,e=this._x1,f=this._y1;if(isNaN(c))e=(c=Math.floor(a))+1,f=(d=Math.floor(b))+1;else{for(var g,h,i=e-c,j=this._root;c>a||a>=e||d>b||b>=f;)switch(h=(b<d)<<1|a<c,(g=new Array(4))[h]=j,j=g,i*=2,h){case 0:e=c+i,f=d+i;break;case 1:c=e-i,f=d+i;break;case 2:e=c+i,d=f-i;break;case 3:c=e-i,d=f-i}this._root&&this._root.length&&(this._root=j)}return this._x0=c,this._y0=d,this._x1=e,this._y1=f,this},Qe.data=function(){var a=[];return this.visit(function(b){if(!b.length)do a.push(b.data);while(b=b.next)}),a},Qe.extent=function(a){return arguments.length?this.cover(+a[0][0],+a[0][1]).cover(+a[1][0],+a[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Qe.find=function(a,b,c){var d,e,f,g,h,i,j,k=this._x0,l=this._y0,m=this._x1,n=this._y1,o=[],p=this._root;for(p&&o.push(new Pe(p,k,l,m,n)),null==c?c=1/0:(k=a-c,l=b-c,m=a+c,n=b+c,c*=c);i=o.pop();)if(!(!(p=i.node)||(e=i.x0)>m||(f=i.y0)>n||(g=i.x1)<k||(h=i.y1)<l))if(p.length){var q=(e+g)/2,s=(f+h)/2;o.push(new Pe(p[3],q,s,g,h),new Pe(p[2],e,s,q,h),new Pe(p[1],q,f,g,s),new Pe(p[0],e,f,q,s)),(j=(b>=s)<<1|a>=q)&&(i=o[o.length-1],o[o.length-1]=o[o.length-1-j],o[o.length-1-j]=i)}else{var r=a-+this._x.call(null,p.data),u=b-+this._y.call(null,p.data),t=r*r+u*u;if(t<c){var w=Math.sqrt(c=t);k=a-w,l=b-w,m=a+w,n=b+w,d=p.data}}return d},Qe.remove=function(a){if(isNaN(f=+this._x.call(null,a))||isNaN(g=+this._y.call(null,a)))return this;var b,c,d,e,f,g,h,i,j,k,l,m,n=this._root,o=this._x0,p=this._y0,q=this._x1,s=this._y1;if(!n)return this;if(n.length)for(;;){if((j=f>=(h=(o+q)/2))?o=h:q=h,(k=g>=(i=(p+s)/2))?p=i:s=i,b=n,!(n=n[l=k<<1|j]))return this;if(!n.length)break;(b[l+1&3]||b[l+2&3]||b[l+3&3])&&(c=b,m=l)}for(;n.data!==a;)if(d=n,!(n=n.next))return this;return(e=n.next)&&delete n.next,d?(e?d.next=e:delete d.next,this):b?(e?b[l]=e:delete b[l],(n=b[0]||b[1]||b[2]||b[3])&&n===(b[3]||b[2]||b[1]||b[0])&&!n.length&&(c?c[m]=n:this._root=n),this):(this._root=e,this)},Qe.removeAll=function(a){for(var b=0,c=a.length;b<c;++b)this.remove(a[b]);return this},Qe.root=function(){return this._root},Qe.size=function(){var a=0;return this.visit(function(b){if(!b.length)do++a;while(b=b.next)}),a},Qe.visit=function(a){var b,c,d,e,f,g,h=[],i=this._root;for(i&&h.push(new Pe(i,this._x0,this._y0,this._x1,this._y1));b=h.pop();)if(!a(i=b.node,d=b.x0,e=b.y0,f=b.x1,g=b.y1)&&i.length){var j=(d+f)/2,k=(e+g)/2;(c=i[3])&&h.push(new Pe(c,j,k,f,g)),(c=i[2])&&h.push(new Pe(c,d,k,j,g)),(c=i[1])&&h.push(new Pe(c,j,e,f,k)),(c=i[0])&&h.push(new Pe(c,d,e,j,k))}return this},Qe.visitAfter=function(a){var b,c=[],d=[];for(this._root&&c.push(new Pe(this._root,this._x0,this._y0,this._x1,this._y1));b=c.pop();){var e=b.node;if(e.length){var f,g=b.x0,h=b.y0,i=b.x1,j=b.y1,k=(g+i)/2,l=(h+j)/2;(f=e[0])&&c.push(new Pe(f,g,h,k,l)),(f=e[1])&&c.push(new Pe(f,k,h,i,l)),(f=e[2])&&c.push(new Pe(f,g,l,k,j)),(f=e[3])&&c.push(new Pe(f,k,l,i,j))}d.push(b)}for(;b=d.pop();)a(b.node,b.x0,b.y0,b.x1,b.y1);return this},Qe.x=function(a){return arguments.length?(this._x=a,this):this._x},Qe.y=function(a){return arguments.length?(this._y=a,this):this._y};var rR={value:function(){}};function LF(){for(var a,b=0,c=arguments.length,d={};b<c;++b){if(!(a=arguments[b]+"")||a in d||/[\s.]/.test(a))throw new Error("illegal type: "+a);d[a]=[]}return new hp(d)}function hp(a){this._=a}function sR(a,b){return a.trim().split(/^|\s+/).map(function(c){var d="",e=c.indexOf(".");if(e>=0&&(d=c.slice(e+1),c=c.slice(0,e)),c&&!b.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:d}})}function tR(a,b){for(var c,d=0,e=a.length;d<e;++d)if((c=a[d]).name===b)return c.value}function MF(a,b,c){for(var d=0,e=a.length;d<e;++d)if(a[d].name===b){a[d]=rR,a=a.slice(0,d).concat(a.slice(d+1));break}return null!=c&&a.push({name:b,value:c}),a}hp.prototype=LF.prototype={constructor:hp,on:function(a,b){var c,d=this._,e=sR(a+"",d),f=-1,g=e.length;if(!(arguments.length<2)){if(null!=b&&"function"!=typeof b)throw new Error("invalid callback: "+b);for(;++f<g;)if(c=(a=e[f]).type)d[c]=MF(d[c],a.name,b);else if(null==b)for(c in d)d[c]=MF(d[c],a.name,null);return this}for(;++f<g;)if((c=(a=e[f]).type)&&(c=tR(d[c],a.name)))return c},copy:function(){var a={},b=this._;for(var c in b)a[c]=b[c].slice();return new hp(a)},call:function(a,b){if((c=arguments.length-2)>0)for(var c,d,e=new Array(c),f=0;f<c;++f)e[f]=arguments[f+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(f=0,c=(d=this._[a]).length;f<c;++f)d[f].value.apply(b,e)},apply:function(a,b,c){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var d=this._[a],e=0,f=d.length;e<f;++e)d[e].value.apply(b,c)}};var ip,Yl,ok=0,Zl=0,_l=0,jp=0,aj=0,kp=0,$l="object"==typeof performance&&performance.now?performance:Date,NF="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(a){setTimeout(a,17)};function kv(){return aj||(NF(uR),aj=$l.now()+kp)}function uR(){aj=0}function lp(){this._call=this._time=this._next=null}function OF(a,b,c){var d=new lp();return d.restart(a,b,c),d}function PF(){aj=(jp=$l.now())+kp,ok=Zl=0;try{!function(){kv(),++ok;for(var a,b=ip;b;)(a=aj-b._time)>=0&&b._call.call(null,a),b=b._next;--ok}()}finally{ok=0,function(){for(var a,b,c=ip,d=1/0;c;)c._call?(d>c._time&&(d=c._time),a=c,c=c._next):(b=c._next,c._next=null,c=a?a._next=b:ip=b);Yl=a,lv(d)}(),aj=0}}function vR(){var a=$l.now(),b=a-jp;b>1e3&&(kp-=b,jp=a)}function lv(a){ok||(Zl&&(Zl=clearTimeout(Zl)),a-aj>24?(a<1/0&&(Zl=setTimeout(PF,a-$l.now()-kp)),_l&&(_l=clearInterval(_l))):(_l||(jp=$l.now(),_l=setInterval(vR,1e3)),ok=1,NF(PF)))}function wR(a){return a.x}function xR(a){return a.y}lp.prototype=OF.prototype={constructor:lp,restart:function(a,b,c){if("function"!=typeof a)throw new TypeError("callback is not a function");c=(null==c?kv():+c)+(null==b?0:+b),this._next||Yl===this||(Yl?Yl._next=this:ip=this,Yl=this),this._call=a,this._time=c,lv()},stop:function(){this._call&&(this._call=null,this._time=1/0,lv())}};var yR=Math.PI*(3-Math.sqrt(5)),QF={center:function(a,b){var c;function d(){var e,f,g=c.length,h=0,i=0;for(e=0;e<g;++e)h+=(f=c[e]).x,i+=f.y;for(h=h/g-a,i=i/g-b,e=0;e<g;++e)(f=c[e]).x-=h,f.y-=i}return null==a&&(a=0),null==b&&(b=0),d.initialize=function(e){c=e},d.x=function(e){return arguments.length?(a=+e,d):a},d.y=function(e){return arguments.length?(b=+e,d):b},d},collide:function(a){var b,c,d=1,e=1;function f(){for(var i,j,k,l,m,n,o,p=b.length,q=0;q<e;++q)for(j=iv(b,oR,pR).visitAfter(g),i=0;i<p;++i)k=b[i],n=c[k.index],o=n*n,l=k.x+k.vx,m=k.y+k.vy,j.visit(s);function s(r,u,t,w,x){var z=r.data,A=r.r,B=n+A;if(!z)return u>l+B||w<l-B||t>m+B||x<m-B;if(z.index>k.index){var I=l-z.x-z.vx,J=m-z.y-z.vy,D=I*I+J*J;D<B*B&&(0===I&&(D+=(I=ei())*I),0===J&&(D+=(J=ei())*J),D=(B-(D=Math.sqrt(D)))/D*d,k.vx+=(I*=D)*(B=(A*=A)/(o+A)),k.vy+=(J*=D)*B,z.vx-=I*(B=1-B),z.vy-=J*B)}}}function g(i){if(i.data)return i.r=c[i.data.index];for(var j=i.r=0;j<4;++j)i[j]&&i[j].r>i.r&&(i.r=i[j].r)}function h(){if(b){var i,j,k=b.length;for(c=new Array(k),i=0;i<k;++i)j=b[i],c[j.index]=+a(j,i,b)}}return"function"!=typeof a&&(a=Re(null==a?1:+a)),f.initialize=function(i){b=i,h()},f.iterations=function(i){return arguments.length?(e=+i,f):e},f.strength=function(i){return arguments.length?(d=+i,f):d},f.radius=function(i){return arguments.length?(a="function"==typeof i?i:Re(+i),h(),f):a},f},nbody:function(){var a,b,c,d,e=Re(-30),f=1,g=1/0,h=.81;function i(m){var n,o=a.length,p=iv(a,wR,xR).visitAfter(k);for(c=m,n=0;n<o;++n)b=a[n],p.visit(l)}function j(){if(a){var m,n,o=a.length;for(d=new Array(o),m=0;m<o;++m)n=a[m],d[n.index]=+e(n,m,a)}}function k(m){var n,o,p,q,s,r=0,u=0;if(m.length){for(p=q=s=0;s<4;++s)(n=m[s])&&(o=Math.abs(n.value))&&(r+=n.value,u+=o,p+=o*n.x,q+=o*n.y);m.x=p/u,m.y=q/u}else{(n=m).x=n.data.x,n.y=n.data.y;do r+=d[n.data.index];while(n=n.next)}m.value=r}function l(m,n,o,p){if(!m.value)return!0;var q=m.x-b.x,s=m.y-b.y,r=p-n,u=q*q+s*s;if(r*r/h<u)return u<g&&(0===q&&(u+=(q=ei())*q),0===s&&(u+=(s=ei())*s),u<f&&(u=Math.sqrt(f*u)),b.vx+=q*m.value*c/u,b.vy+=s*m.value*c/u),!0;if(!(m.length||u>=g)){(m.data!==b||m.next)&&(0===q&&(u+=(q=ei())*q),0===s&&(u+=(s=ei())*s),u<f&&(u=Math.sqrt(f*u)));do m.data!==b&&(r=d[m.data.index]*c/u,b.vx+=q*r,b.vy+=s*r);while(m=m.next)}}return i.initialize=function(m){a=m,j()},i.strength=function(m){return arguments.length?(e="function"==typeof m?m:Re(+m),j(),i):e},i.distanceMin=function(m){return arguments.length?(f=m*m,i):Math.sqrt(f)},i.distanceMax=function(m){return arguments.length?(g=m*m,i):Math.sqrt(g)},i.theta=function(m){return arguments.length?(h=m*m,i):Math.sqrt(h)},i},link:function(a){var b,c,d,e,f,g=qR,h=function(o){return 1/Math.min(e[o.source.index],e[o.target.index])},i=Re(30),j=1;function k(o){for(var p=0,q=a.length;p<j;++p)for(var s,r,u,t,w,x,z,A=0;A<q;++A)r=(s=a[A]).source,t=(u=s.target).x+u.vx-r.x-r.vx||ei(),w=u.y+u.vy-r.y-r.vy||ei(),t*=x=((x=Math.sqrt(t*t+w*w))-c[A])/x*o*b[A],w*=x,u.vx-=t*(z=f[A]),u.vy-=w*z,r.vx+=t*(z=1-z),r.vy+=w*z}function l(){if(d){var o,p,q=d.length,s=a.length,r=new Map(d.map((u,t)=>[g(u,t,d),u]));for(o=0,e=new Array(q);o<s;++o)(p=a[o]).index=o,"object"!=typeof p.source&&(p.source=KF(r,p.source)),"object"!=typeof p.target&&(p.target=KF(r,p.target)),e[p.source.index]=(e[p.source.index]||0)+1,e[p.target.index]=(e[p.target.index]||0)+1;for(o=0,f=new Array(s);o<s;++o)p=a[o],f[o]=e[p.source.index]/(e[p.source.index]+e[p.target.index]);b=new Array(s),m(),c=new Array(s),n()}}function m(){if(d)for(var o=0,p=a.length;o<p;++o)b[o]=+h(a[o],o,a)}function n(){if(d)for(var o=0,p=a.length;o<p;++o)c[o]=+i(a[o],o,a)}return null==a&&(a=[]),k.initialize=function(o){d=o,l()},k.links=function(o){return arguments.length?(a=o,l(),k):a},k.id=function(o){return arguments.length?(g=o,k):g},k.iterations=function(o){return arguments.length?(j=+o,k):j},k.strength=function(o){return arguments.length?(h="function"==typeof o?o:Re(+o),m(),k):h},k.distance=function(o){return arguments.length?(i="function"==typeof o?o:Re(+o),n(),k):i},k},x:function(a){var b,c,d,e=Re(.1);function f(h){for(var i,j=0,k=b.length;j<k;++j)(i=b[j]).vx+=(d[j]-i.x)*c[j]*h}function g(){if(b){var h,i=b.length;for(c=new Array(i),d=new Array(i),h=0;h<i;++h)c[h]=isNaN(d[h]=+a(b[h],h,b))?0:+e(b[h],h,b)}}return"function"!=typeof a&&(a=Re(null==a?0:+a)),f.initialize=function(h){b=h,g()},f.strength=function(h){return arguments.length?(e="function"==typeof h?h:Re(+h),g(),f):e},f.x=function(h){return arguments.length?(a="function"==typeof h?h:Re(+h),g(),f):a},f},y:function(a){var b,c,d,e=Re(.1);function f(h){for(var i,j=0,k=b.length;j<k;++j)(i=b[j]).vy+=(d[j]-i.y)*c[j]*h}function g(){if(b){var h,i=b.length;for(c=new Array(i),d=new Array(i),h=0;h<i;++h)c[h]=isNaN(d[h]=+a(b[h],h,b))?0:+e(b[h],h,b)}}return"function"!=typeof a&&(a=Re(null==a?0:+a)),f.initialize=function(h){b=h,g()},f.strength=function(h){return arguments.length?(e="function"==typeof h?h:Re(+h),g(),f):e},f.y=function(h){return arguments.length?(a="function"==typeof h?h:Re(+h),g(),f):a},f}},mv=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],zR=["static","iterations"],RF=["x","y","vx","vy"];function nv(a){ia.call(this,null,a)}nv.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:RF}]};var SF=Da(nv,ia);function TF(a,b,c,d){var e,f,g,h,i=Ra(b.forces);for(e=0,f=mv.length;e<f;++e)"forces"!==(g=mv[e])&&b.modified(g)&&a[g](b[g]);for(e=0,f=i.length;e<f;++e)h="forces"+e,(g=c||b.modified("forces",e)?BR(i[e]):d&&AR(i[e],d)?a.force(h):null)&&a.force(h,g);for(f=a.numForces||0;e<f;++e)a.force("forces"+e,null);return a.numForces=i.length,a}function AR(a,b){var c,d;for(c in a)if(Ub(d=a[c])&&b.modified(ed(d)))return 1;return 0}function BR(a){var b,c;for(c in(db(QF,a.force)||ja("Unrecognized force: "+a.force),b=QF[a.force](),a))Ub(b[c])&&CR(b[c],a[c],a);return b}function CR(a,b,c){a(Ub(b)?function(d){return b(d,c)}:b)}SF.transform=function(a,b){var c,d,e=this.value,f=b.changed(b.ADD_REM),g=a.modified(mv),h=a.iterations||300;if(e?(f&&(b.modifies("index"),e.nodes(b.source)),(g||b.changed(b.MOD))&&TF(e,a,0,b)):(this.value=e=function(i,j){var k=function(o){var p,q=1,s=.001,r=1-Math.pow(s,1/300),u=0,t=.6,w=new Map(),x=OF(A),z=LF("tick","end");function A(){B(),z.call("tick",p),q<s&&(x.stop(),z.call("end",p))}function B(D){var O,K,Q=o.length;void 0===D&&(D=1);for(var V=0;V<D;++V)for(q+=(u-q)*r,w.forEach(function($){$(q)}),O=0;O<Q;++O)null==(K=o[O]).fx?K.x+=K.vx*=t:(K.x=K.fx,K.vx=0),null==K.fy?K.y+=K.vy*=t:(K.y=K.fy,K.vy=0);return p}function I(){for(var D,O=0,K=o.length;O<K;++O){if((D=o[O]).index=O,null!=D.fx&&(D.x=D.fx),null!=D.fy&&(D.y=D.fy),isNaN(D.x)||isNaN(D.y)){var Q=10*Math.sqrt(O),V=O*yR;D.x=Q*Math.cos(V),D.y=Q*Math.sin(V)}(isNaN(D.vx)||isNaN(D.vy))&&(D.vx=D.vy=0)}}function J(D){return D.initialize&&D.initialize(o),D}return null==o&&(o=[]),I(),p={tick:B,restart:function(){return x.restart(A),p},stop:function(){return x.stop(),p},nodes:function(D){return arguments.length?(o=D,I(),w.forEach(J),p):o},alpha:function(D){return arguments.length?(q=+D,p):q},alphaMin:function(D){return arguments.length?(s=+D,p):s},alphaDecay:function(D){return arguments.length?(r=+D,p):+r},alphaTarget:function(D){return arguments.length?(u=+D,p):u},velocityDecay:function(D){return arguments.length?(t=1-D,p):1-t},force:function(D,O){return arguments.length>1?(null==O?w.delete(D):w.set(D,J(O)),p):w.get(D)},find:function(D,O,K){var Q,V,$,Ia,wa,xa=0,oa=o.length;for(null==K?K=1/0:K*=K,xa=0;xa<oa;++xa)($=(Q=D-(Ia=o[xa]).x)*Q+(V=O-Ia.y)*V)<K&&(wa=Ia,K=$);return wa},on:function(D,O){return arguments.length>1?(z.on(D,O),p):z.on(D)}}}(i),l=!1,m=k.stop,n=k.restart;return k.stopped=function(){return l},k.restart=function(){return l=!1,n()},k.stop=function(){return l=!0,m()},TF(k,j,!0).on("end",function(){l=!0})}(b.source,a),e.on("tick",(c=b.dataflow,d=this,function(){c.touch(d).run()})),a.static||(f=!0,e.tick()),b.modifies("index")),g||f||a.modified(zR)||b.changed()&&a.restart){if(e.alpha(Math.max(e.alpha(),a.alpha||1)).alphaDecay(1-Math.pow(e.alphaMin(),1/h)),a.static)for(e.stop();--h>=0;)e.tick();else if(e.stopped()&&e.restart(),!f)return b.StopPropagation}return this.finish(a,b)},SF.finish=function(a,b){for(var c,d=b.dataflow,e=this._argops,f=0,g=e.length;f<g;++f)if("forces"===(c=e[f]).name&&"link"===c.op._argval.force){for(var h,i=c.op._argops,j=0,k=i.length;j<k;++j)if("links"===i[j].name&&(h=i[j].op.source)){d.pulse(h,d.changeset().reflow());break}}return b.reflow(a.modified()).modifies(RF)};var DR=Object.freeze({__proto__:null,force:nv});function ov(a,b,c){var d={};return a.each(function(e){var f=e.data;c(f)&&(d[b(f)]=e)}),a.lookup=d,a}function ER(a,b){return a.parent===b.parent?1:2}function FR(a,b){return a+b.x}function GR(a,b){return Math.max(a,b.y)}function HR(a){var b=0,c=a.children,d=c&&c.length;if(d)for(;--d>=0;)b+=c[d].value;else b=1;a.value=b}function pv(a,b){var c,d,e,f,g,h=new pk(a),i=+a.value&&(h.value=a.value),j=[h];for(null==b&&(b=IR);c=j.pop();)if(i&&(c.value=+c.data.value),(e=b(c.data))&&(g=e.length))for(c.children=new Array(g),f=g-1;f>=0;--f)j.push(d=c.children[f]=new pk(e[f])),d.parent=c,d.depth=c.depth+1;return h.eachBefore(UF)}function IR(a){return a.children}function JR(a){a.data=a.data.data}function UF(a){var b=0;do a.height=b;while((a=a.parent)&&a.height<++b)}function pk(a){this.data=a,this.depth=this.height=0,this.parent=null}pk.prototype=pv.prototype={constructor:pk,count:function(){return this.eachAfter(HR)},each:function(a){var b,c,d,e,f=this,g=[f];do for(b=g.reverse(),g=[];f=b.pop();)if(a(f),c=f.children)for(d=0,e=c.length;d<e;++d)g.push(c[d]);while(g.length);return this},eachAfter:function(a){for(var b,c,d,e=this,f=[e],g=[];e=f.pop();)if(g.push(e),b=e.children)for(c=0,d=b.length;c<d;++c)f.push(b[c]);for(;e=g.pop();)a(e);return this},eachBefore:function(a){for(var b,c,d=this,e=[d];d=e.pop();)if(a(d),b=d.children)for(c=b.length-1;c>=0;--c)e.push(b[c]);return this},sum:function(a){return this.eachAfter(function(b){for(var c=+a(b.data)||0,d=b.children,e=d&&d.length;--e>=0;)c+=d[e].value;b.value=c})},sort:function(a){return this.eachBefore(function(b){b.children&&b.children.sort(a)})},path:function(a){for(var b=this,c=function(f,g){if(f===g)return f;var h=f.ancestors(),i=g.ancestors(),j=null;for(f=h.pop(),g=i.pop();f===g;)j=f,f=h.pop(),g=i.pop();return j}(b,a),d=[b];b!==c;)b=b.parent,d.push(b);for(var e=d.length;a!==c;)d.splice(e,0,a),a=a.parent;return d},ancestors:function(){for(var a=this,b=[a];a=a.parent;)b.push(a);return b},descendants:function(){var a=[];return this.each(function(b){a.push(b)}),a},leaves:function(){var a=[];return this.eachBefore(function(b){b.children||a.push(b)}),a},links:function(){var a=this,b=[];return a.each(function(c){c!==a&&b.push({source:c.parent,target:c})}),b},copy:function(){return pv(this).eachBefore(JR)}};var KR=Array.prototype.slice;function LR(a){for(var b,c,d=0,e=(a=function(g){for(var h,i,j=g.length;j;)i=Math.random()*j--|0,h=g[j],g[j]=g[i],g[i]=h;return g}(KR.call(a))).length,f=[];d<e;)b=a[d],c&&VF(c,b)?++d:(c=NR(f=MR(f,b)),d=0);return c}function MR(a,b){var c,d;if(qv(b,a))return[b];for(c=0;c<a.length;++c)if(mp(b,a[c])&&qv(am(a[c],b),a))return[a[c],b];for(c=0;c<a.length-1;++c)for(d=c+1;d<a.length;++d)if(mp(am(a[c],a[d]),b)&&mp(am(a[c],b),a[d])&&mp(am(a[d],b),a[c])&&qv(WF(a[c],a[d],b),a))return[a[c],a[d],b];throw new Error()}function mp(a,b){var c=a.r-b.r,d=b.x-a.x,e=b.y-a.y;return c<0||c*c<d*d+e*e}function VF(a,b){var c=a.r-b.r+1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function qv(a,b){for(var c=0;c<b.length;++c)if(!VF(a,b[c]))return!1;return!0}function NR(a){switch(a.length){case 1:return{x:(b=a[0]).x,y:b.y,r:b.r};case 2:return am(a[0],a[1]);case 3:return WF(a[0],a[1],a[2])}var b}function am(a,b){var c=a.x,d=a.y,e=a.r,f=b.x,g=b.y,h=b.r,i=f-c,j=g-d,k=h-e,l=Math.sqrt(i*i+j*j);return{x:(c+f+i/l*k)/2,y:(d+g+j/l*k)/2,r:(l+e+h)/2}}function WF(a,b,c){var d=a.x,e=a.y,f=a.r,g=b.x,h=b.y,i=b.r,j=c.x,k=c.y,l=c.r,m=d-g,n=d-j,o=e-h,p=e-k,q=i-f,s=l-f,r=d*d+e*e-f*f,u=r-g*g-h*h+i*i,t=r-j*j-k*k+l*l,w=n*o-m*p,x=(o*t-p*u)/(2*w)-d,z=(p*q-o*s)/w,A=(n*u-m*t)/(2*w)-e,B=(m*s-n*q)/w,I=z*z+B*B-1,J=2*(f+x*z+A*B),D=x*x+A*A-f*f,O=-(I?(J+Math.sqrt(J*J-4*I*D))/(2*I):D/J);return{x:d+x+z*O,y:e+A+B*O,r:O}}function XF(a,b,c){var d,e,f,g,h=a.x-b.x,i=a.y-b.y,j=h*h+i*i;j?(e=b.r+c.r,e*=e,g=a.r+c.r,e>(g*=g)?(d=(j+g-e)/(2*j),f=Math.sqrt(Math.max(0,g/j-d*d)),c.x=a.x-d*h-f*i,c.y=a.y-d*i+f*h):(d=(j+e-g)/(2*j),f=Math.sqrt(Math.max(0,e/j-d*d)),c.x=b.x+d*h-f*i,c.y=b.y+d*i+f*h)):(c.x=b.x+c.r,c.y=b.y)}function YF(a,b){var c=a.r+b.r-1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function ZF(a){var b=a._,c=a.next._,d=b.r+c.r,e=(b.x*c.r+c.x*b.r)/d,f=(b.y*c.r+c.y*b.r)/d;return e*e+f*f}function np(a){this._=a,this.next=null,this.previous=null}function OR(a){return null==a?null:op(a)}function op(a){if("function"!=typeof a)throw new Error();return a}function bj(){return 0}function qk(a){return function(){return a}}function PR(a){return Math.sqrt(a.value)}function _F(a){return function(b){b.children||(b.r=Math.max(0,+a(b)||0))}}function rv(a,b){return function(c){if(d=c.children){var d,e,f,g=d.length,h=a(c)*b||0;if(h)for(e=0;e<g;++e)d[e].r+=h;if(f=function(i){if(!(m=i.length))return 0;var j,k,l,m,n,o,p,q,s,r,u;if((j=i[0]).x=0,j.y=0,!(m>1))return j.r;if(k=i[1],j.x=-k.r,k.x=j.r,k.y=0,!(m>2))return j.r+k.r;XF(k,j,l=i[2]),j=new np(j),k=new np(k),l=new np(l),j.next=l.previous=k,k.next=j.previous=l,l.next=k.previous=j;qf:for(p=3;p<m;++p){XF(j._,k._,l=i[p]),l=new np(l),q=k.next,s=j.previous,r=k._.r,u=j._.r;do if(r<=u){if(YF(q._,l._)){k=q,j.next=k,k.previous=j,--p;continue qf}r+=q._.r,q=q.next}else{if(YF(s._,l._)){(j=s).next=k,k.previous=j,--p;continue qf}u+=s._.r,s=s.previous}while(q!==s.next);for(l.previous=j,l.next=k,j.next=k.previous=k=l,n=ZF(j);(l=l.next)!==k;)(o=ZF(l))<n&&(j=l,n=o);k=j.next}for(j=[k._],l=k;(l=l.next)!==k;)j.push(l._);for(l=LR(j),p=0;p<m;++p)(j=i[p]).x-=l.x,j.y-=l.y;return l.r}(d),h)for(e=0;e<g;++e)d[e].r-=h;c.r=f+h}}}function $F(a){return function(b){var c=b.parent;b.r*=a,c&&(b.x=c.x+a*b.x,b.y=c.y+a*b.y)}}function aG(a){a.x0=Math.round(a.x0),a.y0=Math.round(a.y0),a.x1=Math.round(a.x1),a.y1=Math.round(a.y1)}function bm(a,b,c,d,e){for(var f,g=a.children,h=-1,i=g.length,j=a.value&&(d-b)/a.value;++h<i;)(f=g[h]).y0=c,f.y1=e,f.x0=b,f.x1=b+=f.value*j}var QR={depth:-1},bG={};function RR(a){return a.id}function SR(a){return a.parentId}function cG(){var a=RR,b=SR;function c(d){var e,f,g,h,i,j,k,l=d.length,m=new Array(l),n={};for(f=0;f<l;++f)e=d[f],i=m[f]=new pk(e),null!=(j=a(e,f,d))&&(j+="")&&(n[k="$"+(i.id=j)]=k in n?bG:i);for(f=0;f<l;++f)if(i=m[f],null!=(j=b(d[f],f,d))&&(j+="")){if(!(h=n["$"+j]))throw new Error("missing: "+j);if(h===bG)throw new Error("ambiguous: "+j);h.children?h.children.push(i):h.children=[i],i.parent=h}else{if(g)throw new Error("multiple roots");g=i}if(!g)throw new Error("no root");if(g.parent=QR,g.eachBefore(function(o){o.depth=o.parent.depth+1,--l}).eachBefore(UF),g.parent=null,l>0)throw new Error("cycle");return g}return c.id=function(d){return arguments.length?(a=op(d),c):a},c.parentId=function(d){return arguments.length?(b=op(d),c):b},c}function TR(a,b){return a.parent===b.parent?1:2}function sv(a){var b=a.children;return b?b[0]:a.t}function tv(a){var b=a.children;return b?b[b.length-1]:a.t}function UR(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function VR(a,b,c){return a.a.parent===b.parent?a.a:c}function pp(a,b){this._=a,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=b}function qp(a,b,c,d,e){for(var f,g=a.children,h=-1,i=g.length,j=a.value&&(e-c)/a.value;++h<i;)(f=g[h]).x0=b,f.x1=d,f.y0=c,f.y1=c+=f.value*j}pp.prototype=Object.create(pk.prototype);var dG=(1+Math.sqrt(5))/2;function eG(a,b,c,d,e,f){for(var g,h,i,j,k,l,m,n,o,p,q,s=[],r=b.children,u=0,t=0,w=r.length,x=b.value;u<w;){i=e-c,j=f-d;do k=r[t++].value;while(!k&&t<w);for(l=m=k,q=k*k*(p=Math.max(j/i,i/j)/(x*a)),o=Math.max(m/q,q/l);t<w;++t){if(k+=h=r[t].value,h<l&&(l=h),h>m&&(m=h),q=k*k*p,(n=Math.max(m/q,q/l))>o){k-=h;break}o=n}s.push(g={value:k,dice:i<j,children:r.slice(u,t)}),g.dice?bm(g,c,d,e,x?d+=j*k/x:f):qp(g,c,d,x?c+=i*k/x:e,f),x-=k,u=t}return s}var fG=function a(b){function c(d,e,f,g,h){eG(b,d,e,f,g,h)}return c.ratio=function(d){return a((d=+d)>1?d:1)},c}(dG),WR=function a(b){function c(d,e,f,g,h){if((i=d._squarify)&&i.ratio===b)for(var i,j,k,l,m,n=-1,o=i.length,p=d.value;++n<o;){for(k=(j=i[n]).children,l=j.value=0,m=k.length;l<m;++l)j.value+=k[l].value;j.dice?bm(j,e,f,g,f+=(h-f)*j.value/p):qp(j,e,f,e+=(g-e)*j.value/p,h),p-=j.value}else d._squarify=i=eG(b,d,e,f,g,h),i.ratio=b}return c.ratio=function(d){return a((d=+d)>1?d:1)},c}(dG);function uv(a){ia.call(this,null,a)}function XR(a){return a.values}function YR(){var a,b=[];return a={entries:c=>function d(e,f){if(++f>b.length)return e;var g,h=[];for(g in e)h.push({key:g,values:d(e[g],f)});return h}(function d(e,f){if(f>=b.length)return e;for(var g,h,i,j=-1,k=e.length,l=b[f++],m={},n={};++j<k;)(i=m[g=l(h=e[j])+""])?i.push(h):m[g]=[h];for(g in m)n[g]=d(m[g],f);return n}(c,0),0),key:c=>(b.push(c),a)}}function qh(a){ia.call(this,null,a)}function ZR(a,b){return a.parent===b.parent?1:2}uv.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]},Da(uv,ia).transform=function(a,b){b.source||ja("Nest transform requires an upstream data source.");var c=a.generate,d=a.modified(),e=b.clone(),f=this.value;return(!f||d||b.changed())&&(f&&f.each(g=>{g.children&&dn(g.data)&&e.rem.push(g.data)}),this.value=f=pv({values:Ra(a.keys).reduce((g,h)=>(g.key(h),g),YR()).entries(e.source)},XR),c&&f.each(g=>{g.children&&(g=Ac(g.data),e.add.push(g),e.source.push(g))}),ov(f,hb,hb)),e.source.root=f,e},Da(qh,ia).transform=function(a,b){b.source&&b.source.root||ja(this.constructor.name+" transform requires a backing tree data source.");var c=this.layout(a.method),d=this.fields,e=b.source.root,f=a.as||d;a.field?e.sum(a.field):e.count(),a.sort&&e.sort(Di(a.sort,g=>g.data)),function(g,h,i){for(var j,k=0,l=h.length;k<l;++k)(j=h[k])in i&&g[j](i[j])}(c,this.params,a),c.separation&&c.separation(!1!==a.separation?ZR:Ef);try{this.value=c(e)}catch(g){ja(g)}return e.each(function(g){!function(h,i,j){for(var k=h.data,l=0,m=i.length-1;l<m;++l)k[j[l]]=h[i[l]];k[j[m]]=h.children?h.children.length:0}(g,d,f)}),b.reflow(a.modified()).modifies(f).modifies("leaf")};var vv=["x","y","r","depth","children"];function wv(a){qh.call(this,a)}wv.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:vv.length,default:vv}]};var xv=Da(wv,qh);xv.layout=function(){var a=null,b=1,c=1,d=bj;function e(f){return f.x=b/2,f.y=c/2,a?f.eachBefore(_F(a)).eachAfter(rv(d,.5)).eachBefore($F(1)):f.eachBefore(_F(PR)).eachAfter(rv(bj,1)).eachAfter(rv(d,f.r/Math.min(b,c))).eachBefore($F(Math.min(b,c)/(2*f.r))),f}return e.radius=function(f){return arguments.length?(a=OR(f),e):a},e.size=function(f){return arguments.length?(b=+f[0],c=+f[1],e):[b,c]},e.padding=function(f){return arguments.length?(d="function"==typeof f?f:qk(+f),e):d},e},xv.params=["radius","size","padding"],xv.fields=vv;var yv=["x0","y0","x1","y1","depth","children"];function zv(a){qh.call(this,a)}zv.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:yv.length,default:yv}]};var Av=Da(zv,qh);function Bv(a){ia.call(this,null,a)}Av.layout=function(){var a=1,b=1,c=0,d=!1;function e(f){var g=f.height+1;return f.x0=f.y0=c,f.x1=a,f.y1=b/g,f.eachBefore(function(h,i){return function(j){j.children&&bm(j,j.x0,h*(j.depth+1)/i,j.x1,h*(j.depth+2)/i);var k=j.x0,l=j.y0,m=j.x1-c,n=j.y1-c;m<k&&(k=m=(k+m)/2),n<l&&(l=n=(l+n)/2),j.x0=k,j.y0=l,j.x1=m,j.y1=n}}(b,g)),d&&f.eachBefore(aG),f}return e.round=function(f){return arguments.length?(d=!!f,e):d},e.size=function(f){return arguments.length?(a=+f[0],b=+f[1],e):[a,b]},e.padding=function(f){return arguments.length?(c=+f,e):c},e},Av.params=["size","round","padding"],Av.fields=yv,Bv.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Da(Bv,ia).transform=function(a,b){b.source||ja("Stratify transform requires an upstream data source.");var c=this.value,d=a.modified(),e=b.fork(b.ALL).materialize(b.SOURCE),f=!this.value||d||b.changed(b.ADD_REM)||b.modified(a.key.fields)||b.modified(a.parentKey.fields);return e.source=e.source.slice(),f&&(c=e.source.length?ov(cG().id(a.key).parentId(a.parentKey)(e.source),a.key,de):ov(cG()([{}]),a.key,a.key)),e.source.root=this.value=c,e};var gG={tidy:function(){var a=TR,b=1,c=1,d=null;function e(i){var j=function(s){for(var r,u,t,w,x,z=new pp(s,0),A=[z];r=A.pop();)if(t=r._.children)for(r.children=new Array(x=t.length),w=x-1;w>=0;--w)A.push(u=r.children[w]=new pp(t[w],w)),u.parent=r;return(z.parent=new pp(null,0)).children=[z],z}(i);if(j.eachAfter(f),j.parent.m=-j.z,j.eachBefore(g),d)i.eachBefore(h);else{var k=i,l=i,m=i;i.eachBefore(function(s){s.x<k.x&&(k=s),s.x>l.x&&(l=s),s.depth>m.depth&&(m=s)});var n=k===l?1:a(k,l)/2,o=n-k.x,p=b/(l.x+n+o),q=c/(m.depth||1);i.eachBefore(function(s){s.x=(s.x+o)*p,s.y=s.depth*q})}return i}function f(i){var j=i.children,k=i.parent.children,l=i.i?k[i.i-1]:null;if(j){!function(n){for(var o,p=0,q=0,s=n.children,r=s.length;--r>=0;)(o=s[r]).z+=p,o.m+=p,p+=o.s+(q+=o.c)}(i);var m=(j[0].z+j[j.length-1].z)/2;l?(i.z=l.z+a(i._,l._),i.m=i.z-m):i.z=m}else l&&(i.z=l.z+a(i._,l._));i.parent.A=function(n,o,p){if(o){for(var q,s=n,r=n,u=o,t=s.parent.children[0],w=s.m,x=r.m,z=u.m,A=t.m;u=tv(u),s=sv(s),u&&s;)t=sv(t),(r=tv(r)).a=n,(q=u.z+z-s.z-w+a(u._,s._))>0&&(UR(VR(u,n,p),n,q),w+=q,x+=q),z+=u.m,w+=s.m,A+=t.m,x+=r.m;u&&!tv(r)&&(r.t=u,r.m+=z-x),s&&!sv(t)&&(t.t=s,t.m+=w-A,p=n)}return p}(i,l,i.parent.A||k[0])}function g(i){i._.x=i.z+i.parent.m,i.m+=i.parent.m}function h(i){i.x*=b,i.y=i.depth*c}return e.separation=function(i){return arguments.length?(a=i,e):a},e.size=function(i){return arguments.length?(d=!1,b=+i[0],c=+i[1],e):d?null:[b,c]},e.nodeSize=function(i){return arguments.length?(d=!0,b=+i[0],c=+i[1],e):d?[b,c]:null},e},cluster:function(){var a=ER,b=1,c=1,d=!1;function e(f){var g,h=0;f.eachAfter(function(m){var n=m.children;n?(m.x=function(o){return o.reduce(FR,0)/o.length}(n),m.y=function(o){return 1+o.reduce(GR,0)}(n)):(m.x=g?h+=a(m,g):0,m.y=0,g=m)});var i=function(m){for(var n;n=m.children;)m=n[0];return m}(f),j=function(m){for(var n;n=m.children;)m=n[n.length-1];return m}(f),k=i.x-a(i,j)/2,l=j.x+a(j,i)/2;return f.eachAfter(d?function(m){m.x=(m.x-f.x)*b,m.y=(f.y-m.y)*c}:function(m){m.x=(m.x-k)/(l-k)*b,m.y=(1-(f.y?m.y/f.y:1))*c})}return e.separation=function(f){return arguments.length?(a=f,e):a},e.size=function(f){return arguments.length?(d=!1,b=+f[0],c=+f[1],e):d?null:[b,c]},e.nodeSize=function(f){return arguments.length?(d=!0,b=+f[0],c=+f[1],e):d?[b,c]:null},e}},Cv=["x","y","depth","children"];function Dv(a){qh.call(this,a)}Dv.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Cv.length,default:Cv}]};var Ev=Da(Dv,qh);function Fv(a){ia.call(this,[],a)}Ev.layout=function(a){var b=a||"tidy";if(db(gG,b))return gG[b]();ja("Unrecognized Tree layout method: "+b)},Ev.params=["size","nodeSize"],Ev.fields=Cv,Fv.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Da(Fv,ia).transform=function(a,b){var c=this.value,d=b.source&&b.source.root,e=b.fork(b.NO_SOURCE),f={};return d||ja("TreeLinks transform requires a tree data source."),b.changed(b.ADD_REM)?(e.rem=c,b.visit(b.SOURCE,function(g){f[hb(g)]=1}),d.each(function(g){var h=g.data,i=g.parent&&g.parent.data;i&&f[hb(h)]&&f[hb(i)]&&e.add.push(Ac({source:i,target:h}))}),this.value=e.add):b.changed(b.MOD)&&(b.visit(b.MOD,function(g){f[hb(g)]=1}),c.forEach(function(g){(f[hb(g.source)]||f[hb(g.target)])&&e.mod.push(g)})),e};var hG={binary:function(a,b,c,d,e){var f,g,h=a.children,i=h.length,j=new Array(i+1);for(j[0]=g=f=0;f<i;++f)j[f+1]=g+=h[f].value;!function k(l,m,n,o,p,q,s){if(l>=m-1){var r=h[l];return r.x0=o,r.y0=p,r.x1=q,void(r.y1=s)}for(var u=j[l],t=n/2+u,w=l+1,x=m-1;w<x;){var z=w+x>>>1;j[z]<t?w=z+1:x=z}t-j[w-1]<j[w]-t&&l+1<w&&--w;var A=j[w]-u,B=n-A;if(q-o>s-p){var I=(o*B+q*A)/n;k(l,w,A,o,p,I,s),k(w,m,B,I,p,q,s)}else{var J=(p*B+s*A)/n;k(l,w,A,o,p,q,J),k(w,m,B,o,J,q,s)}}(0,i,a.value,b,c,d,e)},dice:bm,slice:qp,slicedice:function(a,b,c,d,e){(1&a.depth?qp:bm)(a,b,c,d,e)},squarify:fG,resquarify:WR},Gv=["x0","y0","x1","y1","depth","children"];function Hv(a){qh.call(this,a)}Hv.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Gv.length,default:Gv}]};var Iv=Da(Hv,qh);Iv.layout=function(){var a=function(){var b=fG,c=!1,d=1,e=1,f=[0],g=bj,h=bj,i=bj,j=bj,k=bj;function l(n){return n.x0=n.y0=0,n.x1=d,n.y1=e,n.eachBefore(m),f=[0],c&&n.eachBefore(aG),n}function m(n){var o=f[n.depth],p=n.x0+o,q=n.y0+o,s=n.x1-o,r=n.y1-o;s<p&&(p=s=(p+s)/2),r<q&&(q=r=(q+r)/2),n.x0=p,n.y0=q,n.x1=s,n.y1=r,n.children&&(o=f[n.depth+1]=g(n)/2,p+=k(n)-o,q+=h(n)-o,(s-=i(n)-o)<p&&(p=s=(p+s)/2),(r-=j(n)-o)<q&&(q=r=(q+r)/2),b(n,p,q,s,r))}return l.round=function(n){return arguments.length?(c=!!n,l):c},l.size=function(n){return arguments.length?(d=+n[0],e=+n[1],l):[d,e]},l.tile=function(n){return arguments.length?(b=op(n),l):b},l.padding=function(n){return arguments.length?l.paddingInner(n).paddingOuter(n):l.paddingInner()},l.paddingInner=function(n){return arguments.length?(g="function"==typeof n?n:qk(+n),l):g},l.paddingOuter=function(n){return arguments.length?l.paddingTop(n).paddingRight(n).paddingBottom(n).paddingLeft(n):l.paddingTop()},l.paddingTop=function(n){return arguments.length?(h="function"==typeof n?n:qk(+n),l):h},l.paddingRight=function(n){return arguments.length?(i="function"==typeof n?n:qk(+n),l):i},l.paddingBottom=function(n){return arguments.length?(j="function"==typeof n?n:qk(+n),l):j},l.paddingLeft=function(n){return arguments.length?(k="function"==typeof n?n:qk(+n),l):k},l}();return a.ratio=function(b){var c=a.tile();c.ratio&&a.tile(c.ratio(b))},a.method=function(b){db(hG,b)?a.tile(hG[b]):ja("Unrecognized Treemap layout method: "+b)},a},Iv.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],Iv.fields=Gv;var _R=Object.freeze({__proto__:null,nest:uv,pack:wv,partition:zv,stratify:Bv,tree:Dv,treelinks:Fv,treemap:Hv});function iG(a,b){var c,d,e,f,g,h,i=[],j=function(k){return k(f)};if(null==b)i.push(a);else for(c={},d=0,e=a.length;d<e;++d)f=a[d],(h=c[g=b.map(j)])||(c[g]=h=[],h.dims=g,i.push(h)),h.push(f);return i}function Jv(a){ia.call(this,null,a)}Jv.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Da(Jv,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE|b.NO_FIELDS);if(!this.value||b.changed()||a.modified()){const d=iG(b.materialize(b.SOURCE).source,a.groupby),e=(a.groupby||[]).map(gb),f=e.length,g=a.as||[gb(a.x),gb(a.y)],h=[];d.forEach(i=>{rA(i,a.x,a.y,a.bandwidth||.3).forEach(j=>{const k={};for(let l=0;l<f;++l)k[e[l]]=i.dims[l];k[g[0]]=j[0],k[g[1]]=j[1],h.push(Ac(k))})}),this.value&&(c.rem=this.value),this.value=c.add=c.source=h}return c};const Kv={linear:bs,log:nA,exp:oA,pow:pA,quad:cs,poly:qA};function Lv(a){ia.call(this,null,a)}Lv.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Kv)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Da(Lv,ia).transform=function(a,b){var c=b.fork(b.NO_SOURCE|b.NO_FIELDS);if(!this.value||b.changed()||a.modified()){const d=iG(b.materialize(b.SOURCE).source,a.groupby),e=(a.groupby||[]).map(gb),f=a.method||"linear",g=a.order||3,h=function(m,n){return"poly"===m?n:"quad"===m?2:1}(f,g),i=a.as||[gb(a.x),gb(a.y)],j=Kv[f],k=[];let l=a.extent;db(Kv,f)||ja("Invalid regression method: "+f),null!=l&&"log"===f&&l[0]<=0&&(b.dataflow.warn("Ignoring extent with values <= 0 for log regression."),l=null),d.forEach(m=>{if(m.length<=h)return void b.dataflow.warn("Skipping regression with more parameters than data points.");const n=j(m,a.x,a.y,g);if(a.params)return void k.push(Ac({keys:m.dims,coef:n.coef,rSquared:n.rSquared}));const o=l||dh(m,a.x),p=q=>{const s={};for(let r=0;r<e.length;++r)s[e[r]]=m.dims[r];s[i[0]]=q[0],s[i[1]]=q[1],k.push(Ac(s))};"linear"===f?o.forEach(q=>p([q,n.predict(q)])):An(n.predict,o,25,200).forEach(p)}),this.value&&(c.rem=this.value),this.value=c.add=c.source=k}return c};var $R=Object.freeze({__proto__:null,loess:Jv,regression:Lv});const jG=Math.pow(2,-52),rp=new Uint32Array(512);class Mv{static from(a,b=cS,c=dS){const d=a.length,e=new Float64Array(2*d);for(let f=0;f<d;f++){const g=a[f];e[2*f]=b(g),e[2*f+1]=c(g)}return new Mv(e)}constructor(a){const b=a.length>>1;if(b>0&&"number"!=typeof a[0])throw new Error("Expected coords to contain numbers.");this.coords=a;const c=Math.max(2*b-5,0);this._triangles=new Uint32Array(3*c),this._halfedges=new Int32Array(3*c),this._hashSize=Math.ceil(Math.sqrt(b)),this._hullPrev=new Uint32Array(b),this._hullNext=new Uint32Array(b),this._hullTri=new Uint32Array(b),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(b),this._dists=new Float64Array(b),this.update()}update(){const{coords:a,_hullPrev:b,_hullNext:c,_hullTri:d,_hullHash:e}=this,f=a.length>>1;let g=1/0,h=1/0,i=-1/0,j=-1/0;for(let B=0;B<f;B++){const I=a[2*B],J=a[2*B+1];I<g&&(g=I),J<h&&(h=J),I>i&&(i=I),J>j&&(j=J),this._ids[B]=B}const k=(g+i)/2,l=(h+j)/2;let m,n,o,p=1/0;for(let B=0;B<f;B++){const I=Nv(k,l,a[2*B],a[2*B+1]);I<p&&(m=B,p=I)}const q=a[2*m],s=a[2*m+1];p=1/0;for(let B=0;B<f;B++){if(B===m)continue;const I=Nv(q,s,a[2*B],a[2*B+1]);I<p&&I>0&&(n=B,p=I)}let r=a[2*n],u=a[2*n+1],t=1/0;for(let B=0;B<f;B++){if(B===m||B===n)continue;const I=bS(q,s,r,u,a[2*B],a[2*B+1]);I<t&&(o=B,t=I)}let w=a[2*o],x=a[2*o+1];if(t===1/0){for(let J=0;J<f;J++)this._dists[J]=a[2*J]-a[0]||a[2*J+1]-a[1];rk(this._ids,this._dists,0,f-1);const B=new Uint32Array(f);let I=0;for(let J=0,D=-1/0;J<f;J++){const O=this._ids[J];this._dists[O]>D&&(B[I++]=O,D=this._dists[O])}return this.hull=B.subarray(0,I),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(sp(q,s,r,u,w,x)){const B=n,I=r,J=u;n=o,r=w,u=x,o=B,w=I,x=J}const z=function(B,I,J,D,O,K){const Q=J-B,V=D-I,$=O-B,Ia=K-I,wa=Q*Q+V*V,xa=$*$+Ia*Ia,oa=.5/(Q*Ia-V*$);return{x:B+(Ia*wa-V*xa)*oa,y:I+(Q*xa-$*wa)*oa}}(q,s,r,u,w,x);this._cx=z.x,this._cy=z.y;for(let B=0;B<f;B++)this._dists[B]=Nv(a[2*B],a[2*B+1],z.x,z.y);rk(this._ids,this._dists,0,f-1),this._hullStart=m;let A=3;c[m]=b[o]=n,c[n]=b[m]=o,c[o]=b[n]=m,d[m]=0,d[n]=1,d[o]=2,e.fill(-1),e[this._hashKey(q,s)]=m,e[this._hashKey(r,u)]=n,e[this._hashKey(w,x)]=o,this.trianglesLen=0,this._addTriangle(m,n,o,-1,-1,-1);for(let B,I,J=0;J<this._ids.length;J++){const D=this._ids[J],O=a[2*D],K=a[2*D+1];if(J>0&&Math.abs(O-B)<=jG&&Math.abs(K-I)<=jG)continue;if(B=O,I=K,D===m||D===n||D===o)continue;let Q=0;for(let xa=0,oa=this._hashKey(O,K);xa<this._hashSize&&(Q=e[(oa+xa)%this._hashSize],-1===Q||Q===c[Q]);xa++);Q=b[Q];let V,$=Q;for(;V=c[$],!sp(O,K,a[2*$],a[2*$+1],a[2*V],a[2*V+1]);)if($=V,$===Q){$=-1;break}if(-1===$)continue;let Ia=this._addTriangle($,D,c[$],-1,-1,d[$]);d[D]=this._legalize(Ia+2),d[$]=Ia,A++;let wa=c[$];for(;V=c[wa],sp(O,K,a[2*wa],a[2*wa+1],a[2*V],a[2*V+1]);)Ia=this._addTriangle(wa,D,V,d[D],-1,d[wa]),d[D]=this._legalize(Ia+2),c[wa]=wa,A--,wa=V;if($===Q)for(;V=b[$],sp(O,K,a[2*V],a[2*V+1],a[2*$],a[2*$+1]);)Ia=this._addTriangle(V,D,$,-1,d[$],d[V]),this._legalize(Ia+2),d[V]=Ia,c[$]=$,A--,$=V;this._hullStart=b[D]=$,c[$]=b[wa]=D,c[D]=wa,e[this._hashKey(O,K)]=D,e[this._hashKey(a[2*$],a[2*$+1])]=$}this.hull=new Uint32Array(A);for(let B=0,I=this._hullStart;B<A;B++)this.hull[B]=I,I=c[I];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(a,b){return Math.floor(function(c,d){const e=c/(Math.abs(c)+Math.abs(d));return(d>0?3-e:1+e)/4}(a-this._cx,b-this._cy)*this._hashSize)%this._hashSize}_legalize(a){const{_triangles:b,_halfedges:c,coords:d}=this;let e=0,f=0;for(;;){const g=c[a],h=a-a%3;if(f=h+(a+2)%3,-1===g){if(0===e)break;a=rp[--e];continue}const i=g-g%3,j=h+(a+1)%3,k=i+(g+2)%3,l=b[f],m=b[a],n=b[j],o=b[k];if(aS(d[2*l],d[2*l+1],d[2*m],d[2*m+1],d[2*n],d[2*n+1],d[2*o],d[2*o+1])){b[a]=o,b[g]=l;const p=c[k];if(-1===p){let s=this._hullStart;do{if(this._hullTri[s]===k){this._hullTri[s]=a;break}s=this._hullPrev[s]}while(s!==this._hullStart)}this._link(a,p),this._link(g,c[f]),this._link(f,k);const q=i+(g+1)%3;e<rp.length&&(rp[e++]=q)}else{if(0===e)break;a=rp[--e]}}return f}_link(a,b){this._halfedges[a]=b,-1!==b&&(this._halfedges[b]=a)}_addTriangle(a,b,c,d,e,f){const g=this.trianglesLen;return this._triangles[g]=a,this._triangles[g+1]=b,this._triangles[g+2]=c,this._link(g,d),this._link(g+1,e),this._link(g+2,f),this.trianglesLen+=3,g}}function Nv(a,b,c,d){const e=a-c,f=b-d;return e*e+f*f}function Ov(a,b,c,d,e,f){const g=(d-b)*(e-a),h=(c-a)*(f-b);return Math.abs(g-h)>=33306690738754716e-32*Math.abs(g+h)?g-h:0}function sp(a,b,c,d,e,f){return(Ov(e,f,a,b,c,d)||Ov(a,b,c,d,e,f)||Ov(c,d,e,f,a,b))<0}function aS(a,b,c,d,e,f,g,h){const i=a-g,j=b-h,k=c-g,l=d-h,m=e-g,n=f-h,o=k*k+l*l,p=m*m+n*n;return i*(l*p-o*n)-j*(k*p-o*m)+(i*i+j*j)*(k*n-l*m)<0}function bS(a,b,c,d,e,f){const g=c-a,h=d-b,i=e-a,j=f-b,k=g*g+h*h,l=i*i+j*j,m=.5/(g*j-h*i),n=(j*k-h*l)*m,o=(g*l-i*k)*m;return n*n+o*o}function rk(a,b,c,d){if(d-c<=20)for(let e=c+1;e<=d;e++){const f=a[e],g=b[f];let h=e-1;for(;h>=c&&b[a[h]]>g;)a[h+1]=a[h--];a[h+1]=f}else{let e=c+1,f=d;cm(a,c+d>>1,e),b[a[c]]>b[a[d]]&&cm(a,c,d),b[a[e]]>b[a[d]]&&cm(a,e,d),b[a[c]]>b[a[e]]&&cm(a,c,e);const g=a[e],h=b[g];for(;;){do e++;while(b[a[e]]<h);do f--;while(b[a[f]]>h);if(f<e)break;cm(a,e,f)}a[c+1]=a[f],a[f]=g,d-e+1>=f-c?(rk(a,b,e,d),rk(a,b,c,f-1)):(rk(a,b,c,f-1),rk(a,b,e,d))}}function cm(a,b,c){const d=a[b];a[b]=a[c],a[c]=d}function cS(a){return a[0]}function dS(a){return a[1]}class cj{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(a,b){this._+=`M${this._x0=this._x1=+a},${this._y0=this._y1=+b}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(a,b){this._+=`L${this._x1=+a},${this._y1=+b}`}arc(a,b,c){const d=(a=+a)+(c=+c),e=b=+b;if(c<0)throw new Error("negative radius");null===this._x1?this._+=`M${d},${e}`:(Math.abs(this._x1-d)>1e-6||Math.abs(this._y1-e)>1e-6)&&(this._+="L"+d+","+e),c&&(this._+=`A${c},${c},0,1,1,${a-c},${b}A${c},${c},0,1,1,${this._x1=d},${this._y1=e}`)}rect(a,b,c,d){this._+=`M${this._x0=this._x1=+a},${this._y0=this._y1=+b}h${+c}v${+d}h${-c}Z`}value(){return this._||null}}class Pv{constructor(){this._=[]}moveTo(a,b){this._.push([a,b])}closePath(){this._.push(this._[0].slice())}lineTo(a,b){this._.push([a,b])}value(){return this._.length?this._:null}}class eS{constructor(a,[b,c,d,e]=[0,0,960,500]){if(!((d=+d)>=(b=+b)&&(e=+e)>=(c=+c)))throw new Error("invalid bounds");this.delaunay=a,this._circumcenters=new Float64Array(2*a.points.length),this.vectors=new Float64Array(2*a.points.length),this.xmax=d,this.xmin=b,this.ymax=e,this.ymin=c,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:a,hull:b,triangles:c},vectors:d}=this,e=this.circumcenters=this._circumcenters.subarray(0,c.length/3*2);for(let m,n,o=0,p=0,q=c.length;o<q;o+=3,p+=2){const s=2*c[o],r=2*c[o+1],u=2*c[o+2],t=a[s],w=a[s+1],x=a[r],z=a[r+1],A=a[u],B=a[u+1],I=x-t,J=z-w,D=A-t,O=B-w,K=I*I+J*J,Q=D*D+O*O,V=2*(I*O-J*D);if(V)if(Math.abs(V)<1e-8)m=(t+A)/2,n=(w+B)/2;else{const $=1/V;m=t+(O*K-J*Q)*$,n=w+(I*Q-D*K)*$}else m=(t+A)/2-1e8*O,n=(w+B)/2+1e8*D;e[p]=m,e[p+1]=n}let f,g,h,i=b[b.length-1],j=4*i,k=a[2*i],l=a[2*i+1];d.fill(0);for(let m=0;m<b.length;++m)i=b[m],f=j,g=k,h=l,j=4*i,k=a[2*i],l=a[2*i+1],d[f+2]=d[j]=h-l,d[f+3]=d[j+1]=k-g}render(a){const b=null==a?a=new cj():void 0,{delaunay:{halfedges:c,inedges:d,hull:e},circumcenters:f,vectors:g}=this;if(e.length<=1)return null;for(let j=0,k=c.length;j<k;++j){const l=c[j];if(l<j)continue;const m=2*Math.floor(j/3),n=2*Math.floor(l/3),o=f[m],p=f[m+1],q=f[n],s=f[n+1];this._renderSegment(o,p,q,s,a)}let h,i=e[e.length-1];for(let j=0;j<e.length;++j){h=i,i=e[j];const k=2*Math.floor(d[i]/3),l=f[k],m=f[k+1],n=4*h,o=this._project(l,m,g[n+2],g[n+3]);o&&this._renderSegment(l,m,o[0],o[1],a)}return b&&b.value()}renderBounds(a){const b=null==a?a=new cj():void 0;return a.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),b&&b.value()}renderCell(a,b){const c=null==b?b=new cj():void 0,d=this._clip(a);if(null===d||!d.length)return;b.moveTo(d[0],d[1]);let e=d.length;for(;d[0]===d[e-2]&&d[1]===d[e-1]&&e>1;)e-=2;for(let f=2;f<e;f+=2)d[f]===d[f-2]&&d[f+1]===d[f-1]||b.lineTo(d[f],d[f+1]);return b.closePath(),c&&c.value()}*cellPolygons(){const{delaunay:{points:a}}=this;for(let b=0,c=a.length/2;b<c;++b){const d=this.cellPolygon(b);d&&(d.index=b,yield d)}}cellPolygon(a){const b=new Pv();return this.renderCell(a,b),b.value()}_renderSegment(a,b,c,d,e){let f;const g=this._regioncode(a,b),h=this._regioncode(c,d);0===g&&0===h?(e.moveTo(a,b),e.lineTo(c,d)):(f=this._clipSegment(a,b,c,d,g,h))&&(e.moveTo(f[0],f[1]),e.lineTo(f[2],f[3]))}contains(a,b,c){return(b=+b)==b&&(c=+c)==c&&this.delaunay._step(a,b,c)===a}*neighbors(a){const b=this._clip(a);if(b)for(const c of this.delaunay.neighbors(a)){const d=this._clip(c);if(d)qf:for(let e=0,f=b.length;e<f;e+=2)for(let g=0,h=d.length;g<h;g+=2)if(b[e]==d[g]&&b[e+1]==d[g+1]&&b[(e+2)%f]==d[(g+h-2)%h]&&b[(e+3)%f]==d[(g+h-1)%h]){yield c;break qf}}}_cell(a){const{circumcenters:b,delaunay:{inedges:c,halfedges:d,triangles:e}}=this,f=c[a];if(-1===f)return null;const g=[];let h=f;do{const i=Math.floor(h/3);if(g.push(b[2*i],b[2*i+1]),h=h%3==2?h-2:h+1,e[h]!==a)break;h=d[h]}while(h!==f&&-1!==h);return g}_clip(a){if(0===a&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const b=this._cell(a);if(null===b)return null;const{vectors:c}=this,d=4*a;return c[d]||c[d+1]?this._clipInfinite(a,b,c[d],c[d+1],c[d+2],c[d+3]):this._clipFinite(a,b)}_clipFinite(a,b){const c=b.length;let d,e,f,g,h,i=null,j=b[c-2],k=b[c-1],l=this._regioncode(j,k);for(let m=0;m<c;m+=2)if(d=j,e=k,j=b[m],k=b[m+1],f=l,l=this._regioncode(j,k),0===f&&0===l)g=h,h=0,i?i.push(j,k):i=[j,k];else{let n,o,p,q,s;if(0===f){if(null===(n=this._clipSegment(d,e,j,k,f,l)))continue;[o,p,q,s]=n}else{if(null===(n=this._clipSegment(j,k,d,e,l,f)))continue;[q,s,o,p]=n,g=h,h=this._edgecode(o,p),g&&h&&this._edge(a,g,h,i,i.length),i?i.push(o,p):i=[o,p]}g=h,h=this._edgecode(q,s),g&&h&&this._edge(a,g,h,i,i.length),i?i.push(q,s):i=[q,s]}if(i)g=h,h=this._edgecode(i[0],i[1]),g&&h&&this._edge(a,g,h,i,i.length);else if(this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(a,b,c,d,e,f){for(;;){if(0===e&&0===f)return[a,b,c,d];if(e&f)return null;let g,h,i=e||f;8&i?(g=a+(c-a)*(this.ymax-b)/(d-b),h=this.ymax):4&i?(g=a+(c-a)*(this.ymin-b)/(d-b),h=this.ymin):2&i?(h=b+(d-b)*(this.xmax-a)/(c-a),g=this.xmax):(h=b+(d-b)*(this.xmin-a)/(c-a),g=this.xmin),e?(a=g,b=h,e=this._regioncode(a,b)):(c=g,d=h,f=this._regioncode(c,d))}}_clipInfinite(a,b,c,d,e,f){let g,h=Array.from(b);if((g=this._project(h[0],h[1],c,d))&&h.unshift(g[0],g[1]),(g=this._project(h[h.length-2],h[h.length-1],e,f))&&h.push(g[0],g[1]),h=this._clipFinite(a,h))for(let i,j=0,k=h.length,l=this._edgecode(h[k-2],h[k-1]);j<k;j+=2)i=l,l=this._edgecode(h[j],h[j+1]),i&&l&&(j=this._edge(a,i,l,h,j),k=h.length);else this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(h=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return h}_edge(a,b,c,d,e){for(;b!==c;){let f,g;switch(b){case 5:b=4;continue;case 4:b=6,f=this.xmax,g=this.ymin;break;case 6:b=2;continue;case 2:b=10,f=this.xmax,g=this.ymax;break;case 10:b=8;continue;case 8:b=9,f=this.xmin,g=this.ymax;break;case 9:b=1;continue;case 1:b=5,f=this.xmin,g=this.ymin}d[e]===f&&d[e+1]===g||!this.contains(a,f,g)||(d.splice(e,0,f,g),e+=2)}if(d.length>4)for(let f=0;f<d.length;f+=2){const g=(f+2)%d.length,h=(f+4)%d.length;(d[f]===d[g]&&d[g]===d[h]||d[f+1]===d[g+1]&&d[g+1]===d[h+1])&&(d.splice(g,2),f-=2)}return e}_project(a,b,c,d){let e,f,g,h=1/0;if(d<0){if(b<=this.ymin)return null;(e=(this.ymin-b)/d)<h&&(g=this.ymin,f=a+(h=e)*c)}else if(d>0){if(b>=this.ymax)return null;(e=(this.ymax-b)/d)<h&&(g=this.ymax,f=a+(h=e)*c)}if(c>0){if(a>=this.xmax)return null;(e=(this.xmax-a)/c)<h&&(f=this.xmax,g=b+(h=e)*d)}else if(c<0){if(a<=this.xmin)return null;(e=(this.xmin-a)/c)<h&&(f=this.xmin,g=b+(h=e)*d)}return[f,g]}_edgecode(a,b){return(a===this.xmin?1:a===this.xmax?2:0)|(b===this.ymin?4:b===this.ymax?8:0)}_regioncode(a,b){return(a<this.xmin?1:a>this.xmax?2:0)|(b<this.ymin?4:b>this.ymax?8:0)}}const fS=2*Math.PI,sk=Math.pow;function gS(a){return a[0]}function hS(a){return a[1]}function iS(a,b,c){return[a+Math.sin(a+b)*c,b+Math.cos(a-b)*c]}class kG{static from(a,b=gS,c=hS,d){return new kG("length"in a?function(e,f,g,h){const i=e.length,j=new Float64Array(2*i);for(let k=0;k<i;++k){const l=e[k];j[2*k]=f.call(h,l,k,e),j[2*k+1]=g.call(h,l,k,e)}return j}(a,b,c,d):Float64Array.from(function*(e,f,g,h){let i=0;for(const j of e)yield f.call(h,j,i,e),yield g.call(h,j,i,e),++i}(a,b,c,d)))}constructor(a){this._delaunator=new Mv(a),this.inedges=new Int32Array(a.length/2),this._hullIndex=new Int32Array(a.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const a=this._delaunator,b=this.points;if(a.hull&&a.hull.length>2&&function(h){const{triangles:i,coords:j}=h;for(let k=0;k<i.length;k+=3){const l=2*i[k],m=2*i[k+1],n=2*i[k+2];if((j[n]-j[l])*(j[m+1]-j[l+1])-(j[m]-j[l])*(j[n+1]-j[l+1])>1e-10)return!1}return!0}(a)){this.collinear=Int32Array.from({length:b.length/2},(l,m)=>m).sort((l,m)=>b[2*l]-b[2*m]||b[2*l+1]-b[2*m+1]);const h=this.collinear[0],i=this.collinear[this.collinear.length-1],j=[b[2*h],b[2*h+1],b[2*i],b[2*i+1]],k=1e-8*Math.hypot(j[3]-j[1],j[2]-j[0]);for(let l=0,m=b.length/2;l<m;++l){const n=iS(b[2*l],b[2*l+1],k);b[2*l]=n[0],b[2*l+1]=n[1]}this._delaunator=new Mv(b)}else delete this.collinear;const c=this.halfedges=this._delaunator.halfedges,d=this.hull=this._delaunator.hull,e=this.triangles=this._delaunator.triangles,f=this.inedges.fill(-1),g=this._hullIndex.fill(-1);for(let h=0,i=c.length;h<i;++h){const j=e[h%3==2?h-2:h+1];-1!==c[h]&&-1!==f[j]||(f[j]=h)}for(let h=0,i=d.length;h<i;++h)g[d[h]]=h;d.length<=2&&d.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=d[0],this.triangles[1]=d[1],this.triangles[2]=d[1],f[d[0]]=1,2===d.length&&(f[d[1]]=0))}voronoi(a){return new eS(this,a)}*neighbors(a){const{inedges:b,hull:c,_hullIndex:d,halfedges:e,triangles:f,collinear:g}=this;if(g){const k=g.indexOf(a);return k>0&&(yield g[k-1]),void(k<g.length-1&&(yield g[k+1]))}const h=b[a];if(-1===h)return;let i=h,j=-1;do{if(yield j=f[i],i=i%3==2?i-2:i+1,f[i]!==a)return;if(i=e[i],-1===i){const k=c[(d[a]+1)%c.length];return void(k!==j&&(yield k))}}while(i!==h)}find(a,b,c=0){if((a=+a)!=a||(b=+b)!=b)return-1;const d=c;let e;for(;(e=this._step(c,a,b))>=0&&e!==c&&e!==d;)c=e;return e}_step(a,b,c){const{inedges:d,hull:e,_hullIndex:f,halfedges:g,triangles:h,points:i}=this;if(-1===d[a]||!i.length)return(a+1)%(i.length>>1);let j=a,k=sk(b-i[2*a],2)+sk(c-i[2*a+1],2);const l=d[a];let m=l;do{let n=h[m];const o=sk(b-i[2*n],2)+sk(c-i[2*n+1],2);if(o<k&&(k=o,j=n),m=m%3==2?m-2:m+1,h[m]!==a)break;if(m=g[m],-1===m){if(m=e[(f[a]+1)%e.length],m!==n&&sk(b-i[2*m],2)+sk(c-i[2*m+1],2)<k)return m;break}}while(m!==l);return j}render(a){const b=null==a?a=new cj():void 0,{points:c,halfedges:d,triangles:e}=this;for(let f=0,g=d.length;f<g;++f){const h=d[f];if(h<f)continue;const i=2*e[f],j=2*e[h];a.moveTo(c[i],c[i+1]),a.lineTo(c[j],c[j+1])}return this.renderHull(a),b&&b.value()}renderPoints(a,b=2){const c=null==a?a=new cj():void 0,{points:d}=this;for(let e=0,f=d.length;e<f;e+=2){const g=d[e],h=d[e+1];a.moveTo(g+b,h),a.arc(g,h,b,0,fS)}return c&&c.value()}renderHull(a){const b=null==a?a=new cj():void 0,{hull:c,points:d}=this,e=2*c[0],f=c.length;a.moveTo(d[e],d[e+1]);for(let g=1;g<f;++g){const h=2*c[g];a.lineTo(d[h],d[h+1])}return a.closePath(),b&&b.value()}hullPolygon(){const a=new Pv();return this.renderHull(a),a.value()}renderTriangle(a,b){const c=null==b?b=new cj():void 0,{points:d,triangles:e}=this,f=2*e[a*=3],g=2*e[a+1],h=2*e[a+2];return b.moveTo(d[f],d[f+1]),b.lineTo(d[g],d[g+1]),b.lineTo(d[h],d[h+1]),b.closePath(),c&&c.value()}*trianglePolygons(){const{triangles:a}=this;for(let b=0,c=a.length/3;b<c;++b)yield this.trianglePolygon(b)}trianglePolygon(a){const b=new Pv();return this.renderTriangle(a,b),b.value()}}function Qv(a){ia.call(this,null,a)}Qv.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const jS=Da(Qv,ia),kS=[-1e5,-1e5,1e5,1e5];function lS(a){const b=a[0][0],c=a[0][1];let d=a.length-1;for(;a[d][0]===b&&a[d][1]===c;--d);return"M"+a.slice(0,d+1).join("L")+"Z"}jS.transform=function(a,b){const c=a.as||"path",d=b.source;if(!d||!d.length)return b;let e=a.size;e=e?[0,0,e[0],e[1]]:(e=a.extent)?[e[0][0],e[0][1],e[1][0],e[1][1]]:kS;const f=this.value=kG.from(d,a.x,a.y).voronoi(e);for(let g=0,h=d.length;g<h;++g){const i=f.cellPolygon(g);d[g][c]=i?lS(i):null}return b.reflow(a.modified()).modifies(c)};var mS=Object.freeze({__proto__:null,voronoi:Qv}),Rv=Math.PI/180;function nS(){var a,b,c,d,e,f,g,h=[256,256],i=lG,j=[],k=Math.random,l={};function m(n,o,p){for(var q,s,r,u=o.x,t=o.y,w=Math.sqrt(h[0]*h[0]+h[1]*h[1]),x=i(h),z=k()<.5?1:-1,A=-z;(q=x(A+=z))&&(s=~~q[0],r=~~q[1],!(Math.min(Math.abs(s),Math.abs(r))>=w));)if(o.x=u+s,o.y=t+r,!(o.x+o.x0<0||o.y+o.y0<0||o.x+o.x1>h[0]||o.y+o.y1>h[1])&&(!p||!pS(o,n,h[0]))&&(!p||rS(o,p))){for(var B,I=o.sprite,J=o.width>>5,D=h[0]>>5,O=o.x-(J<<4),K=127&O,Q=32-K,V=o.y1-o.y0,$=(o.y+o.y0)*D+(O>>5),Ia=0;Ia<V;Ia++){B=0;for(var wa=0;wa<=J;wa++)n[$+wa]|=B<<Q|(wa<J?(B=I[Ia*J+wa])>>>K:0);$+=D}return o.sprite=null,!0}return!1}return l.layout=function(){for(var n=function(w){w.width=w.height=1;var x=Math.sqrt(w.getContext("2d").getImageData(0,0,1,1).data.length>>2);w.width=2048/x,w.height=2048/x;var z=w.getContext("2d");return z.fillStyle=z.strokeStyle="red",z.textAlign="center",{context:z,ratio:x}}(ql()),o=function(w){for(var x=[],z=-1;++z<w;)x[z]=0;return x}((h[0]>>5)*h[1]),p=null,q=j.length,s=-1,r=[],u=j.map(function(w){return{text:a(w),font:b(w),style:d(w),weight:e(w),rotate:f(w),size:~~(c(w)+1e-14),padding:g(w),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:w}}).sort(function(w,x){return x.size-w.size});++s<q;){var t=u[s];t.x=h[0]*(k()+.5)>>1,t.y=h[1]*(k()+.5)>>1,oS(n,t,u,s),t.hasText&&m(o,t,p)&&(r.push(t),p?qS(p,t):p=[{x:t.x+t.x0,y:t.y+t.y0},{x:t.x+t.x1,y:t.y+t.y1}],t.x-=h[0]>>1,t.y-=h[1]>>1)}return r},l.words=function(n){return arguments.length?(j=n,l):j},l.size=function(n){return arguments.length?(h=[+n[0],+n[1]],l):h},l.font=function(n){return arguments.length?(b=dj(n),l):b},l.fontStyle=function(n){return arguments.length?(d=dj(n),l):d},l.fontWeight=function(n){return arguments.length?(e=dj(n),l):e},l.rotate=function(n){return arguments.length?(f=dj(n),l):f},l.text=function(n){return arguments.length?(a=dj(n),l):a},l.spiral=function(n){return arguments.length?(i=sS[n]||n,l):i},l.fontSize=function(n){return arguments.length?(c=dj(n),l):c},l.padding=function(n){return arguments.length?(g=dj(n),l):g},l.random=function(n){return arguments.length?(k=n,l):k},l}function oS(a,b,c,d){if(!b.sprite){var e=a.context,f=a.ratio;e.clearRect(0,0,2048/f,2048/f);var g,h,i,j,k,l=0,m=0,n=0,o=c.length;for(--d;++d<o;){if(b=c[d],e.save(),e.font=b.style+" "+b.weight+" "+~~((b.size+1)/f)+"px "+b.font,g=e.measureText(b.text+"m").width*f,i=b.size<<1,b.rotate){var p=Math.sin(b.rotate*Rv),q=Math.cos(b.rotate*Rv),s=g*q,r=g*p,u=i*q,t=i*p;g=Math.max(Math.abs(s+t),Math.abs(s-t))+31>>5<<5,i=~~Math.max(Math.abs(r+u),Math.abs(r-u))}else g=g+31>>5<<5;if(i>n&&(n=i),l+g>=2048&&(l=0,m+=n,n=0),m+i>=2048)break;e.translate((l+(g>>1))/f,(m+(i>>1))/f),b.rotate&&e.rotate(b.rotate*Rv),e.fillText(b.text,0,0),b.padding&&(e.lineWidth=2*b.padding,e.strokeText(b.text,0,0)),e.restore(),b.width=g,b.height=i,b.xoff=l,b.yoff=m,b.x1=g>>1,b.y1=i>>1,b.x0=-b.x1,b.y0=-b.y1,b.hasText=!0,l+=g}for(var w=e.getImageData(0,0,2048/f,2048/f).data,x=[];--d>=0;)if((b=c[d]).hasText){for(h=(g=b.width)>>5,i=b.y1-b.y0,j=0;j<i*h;j++)x[j]=0;if(null==(l=b.xoff))return;m=b.yoff;var z=0,A=-1;for(k=0;k<i;k++){for(j=0;j<g;j++){var B=h*k+(j>>5),I=w[2048*(m+k)+(l+j)<<2]?1<<31-j%32:0;x[B]|=I,z|=I}z?A=k:(b.y0++,i--,k--,m++)}b.y1=b.y0+A,b.sprite=x.slice(0,(b.y1-b.y0)*h)}}}function pS(a,b,c){c>>=5;for(var d,e=a.sprite,f=a.width>>5,g=a.x-(f<<4),h=127&g,i=32-h,j=a.y1-a.y0,k=(a.y+a.y0)*c+(g>>5),l=0;l<j;l++){d=0;for(var m=0;m<=f;m++)if((d<<i|(m<f?(d=e[l*f+m])>>>h:0))&b[k+m])return!0;k+=c}return!1}function qS(a,b){var c=a[0],d=a[1];b.x+b.x0<c.x&&(c.x=b.x+b.x0),b.y+b.y0<c.y&&(c.y=b.y+b.y0),b.x+b.x1>d.x&&(d.x=b.x+b.x1),b.y+b.y1>d.y&&(d.y=b.y+b.y1)}function rS(a,b){return a.x+a.x1>b[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y}function lG(a){var b=a[0]/a[1];return function(c){return[b*(c*=.1)*Math.cos(c),c*Math.sin(c)]}}function dj(a){return"function"==typeof a?a:function(){return a}}var sS={archimedean:lG,rectangular:function(a){var b=4*a[0]/a[1],c=0,d=0;return function(e){var f=e<0?-1:1;switch(Math.sqrt(1+4*f*e)-f&3){case 0:c+=b;break;case 1:d+=4;break;case 2:c-=b;break;default:d-=4}return[c,d]}}},mG=["x","y","font","fontSize","fontStyle","fontWeight","angle"],tS=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Sv(a){ia.call(this,nS(),a)}Sv.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:mG}]},Da(Sv,ia).transform=function(a,b){!a.size||a.size[0]&&a.size[1]||ja("Wordcloud size dimensions must be non-zero.");var c=a.modified();if(c||b.changed(b.ADD_REM)||tS.some(function(r){var u=a[r];return Ub(u)&&b.modified(u.fields)})){var d,e=b.materialize(b.SOURCE).source,f=this.value,g=a.as||mG,h=a.fontSize||14;if(Ub(h)?d=a.fontSizeRange:h=Nd(h),d){var i=h,j=wc("sqrt")().domain(dh(e,i)).range(d);h=function(r){return j(i(r))}}e.forEach(function(r){r[g[0]]=NaN,r[g[1]]=NaN,r[g[3]]=0});for(var k,l,m=f.words(e).text(a.text).size(a.size||[500,500]).padding(a.padding||1).spiral(a.spiral||"archimedean").rotate(a.rotate||0).font(a.font||"sans-serif").fontStyle(a.fontStyle||"normal").fontWeight(a.fontWeight||"normal").fontSize(h).random(If).layout(),n=f.size(),o=n[0]>>1,p=n[1]>>1,q=0,s=m.length;q<s;++q)(l=(k=m[q]).datum)[g[0]]=k.x+o,l[g[1]]=k.y+p,l[g[2]]=k.font,l[g[3]]=k.size,l[g[4]]=k.style,l[g[5]]=k.weight,l[g[6]]=k.rotate;return b.reflow(c).modifies(g)}};var uS=Object.freeze({__proto__:null,wordcloud:Sv});function vS(a){return new Uint8Array(a)}function wS(a){return new Uint16Array(a)}function dm(a){return new Uint32Array(a)}function tp(a,b,c){var d=(b<257?vS:b<65537?wS:dm)(a);return c&&d.set(c),d}function nG(a,b,c){var d=1<<b;return{one:d,zero:~d,range:c.slice(),bisect:a.bisect,index:a.index,size:a.size,onAdd:function(e,f){var g,h=this.bisect(this.range,e.value),i=e.index,j=h[0],k=h[1],l=i.length;for(g=0;g<j;++g)f[i[g]]|=d;for(g=k;g<l;++g)f[i[g]]|=d;return this}}}function oG(){var a=dm(0),b=[],c=0;return{insert:function(d,e,f){if(!e.length)return[];var g,h,i,j=c,k=e.length,l=Array(k),m=dm(k);for(i=0;i<k;++i)l[i]=d(e[i]),m[i]=i;if(l=function(n,o){return n.sort.call(o,function(p,q){var s=n[p],r=n[q];return s<r?-1:s>r?1:0}),function(p,q){return Array.from(q,s=>p[s])}(n,o)}(l,m),j)g=b,h=a,b=Array(j+k),a=dm(j+k),function(n,o,p,q,s,r,u,t,w){var x,z=0,A=0;for(x=0;z<q&&A<u;++x)o[z]<s[A]?(t[x]=o[z],w[x]=p[z++]):(t[x]=s[A],w[x]=r[A++]+n);for(;z<q;++z,++x)t[x]=o[z],w[x]=p[z];for(;A<u;++A,++x)t[x]=s[A],w[x]=r[A]+n}(f,g,h,j,l,m,k,b,a);else{if(f>0)for(i=0;i<k;++i)m[i]+=f;b=l,a=m}return c=j+k,{index:m,value:l}},remove:function(d,e){var f,g,h,i=c;for(g=0;!e[a[g]]&&g<i;++g);for(h=g;g<i;++g)e[f=a[g]]||(a[h]=f,b[h]=b[g],++h);c=i-d},bisect:function(d,e){var f;return e?f=e.length:(e=b,f=c),[FM(e,d[0],0,f),Mh(e,d[1],0,f)]},reindex:function(d){for(var e=0,f=c;e<f;++e)a[e]=d[a[e]]},index:function(){return a},size:function(){return c}}}function Tv(a){ia.call(this,function(){var b=8,c=[],d=dm(0),e=tp(0,b),f=tp(0,b);return{data:function(){return c},seen:function(){return d=function(g,h,i){return g.length>=h?g:((i=i||new g.constructor(h)).set(g),i)}(d,c.length)},add:function(g){for(var h,i=0,j=c.length,k=g.length;i<k;++i)(h=g[i])._index=j++,c.push(h)},remove:function(g,h){var i,j,k,l=c.length,m=Array(l-g),n=c;for(j=0;!h[j]&&j<l;++j)m[j]=c[j],n[j]=j;for(k=j;j<l;++j)i=c[j],h[j]?n[j]=-1:(n[j]=k,e[k]=e[j],f[k]=f[j],m[k]=i,i._index=k++),e[j]=0;return c=m,n},size:function(){return c.length},curr:function(){return e},prev:function(){return f},reset:function(g){f[g]=e[g]},all:function(){return b<257?255:b<65537?65535:4294967295},set:function(g,h){e[g]|=h},clear:function(g,h){e[g]&=~h},resize:function(g,h){(g>e.length||h>b)&&(b=Math.max(h,b),e=tp(g,b,e),f=tp(g,b))}}}(),a),this._indices=null,this._dims=null}Tv.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var jg=Da(Tv,ia);function Uv(a){ia.call(this,null,a)}jg.transform=function(a,b){return this._dims?a.modified("fields")||a.fields.some(function(c){return b.modified(c.fields)})?this.reinit(a,b):this.eval(a,b):this.init(a,b)},jg.init=function(a,b){for(var c,d,e=a.fields,f=a.query,g=this._indices={},h=this._dims=[],i=f.length,j=0;j<i;++j)d=g[c=e[j].fname]||(g[c]=oG()),h.push(nG(d,j,f[j]));return this.eval(a,b)},jg.reinit=function(a,b){var c,d,e,f,g,h,i,j,k,l=b.materialize().fork(),m=a.fields,n=a.query,o=this._indices,p=this._dims,q=this.value,s=q.curr(),r=q.prev(),u=q.all(),t=l.rem=l.add,w=l.mod,x=n.length,z={};if(r.set(s),b.rem.length&&(g=this.remove(a,b,l)),b.add.length&&q.add(b.add),b.mod.length)for(h={},i=0,j=(f=b.mod).length;i<j;++i)h[f[i]._index]=1;for(i=0;i<x;++i)k=m[i],(!p[i]||a.modified("fields",i)||b.modified(k.fields))&&((c=z[e=k.fname])||(o[e]=d=oG(),z[e]=c=d.insert(k,b.source,0)),p[i]=nG(d,i,n[i]).onAdd(c,s));for(i=0,j=q.data().length;i<j;++i)g[i]||(r[i]!==s[i]?t.push(i):h[i]&&s[i]!==u&&w.push(i));return q.mask=(1<<x)-1,l},jg.eval=function(a,b){var c=b.materialize().fork(),d=this._dims.length,e=0;return b.rem.length&&(this.remove(a,b,c),e|=(1<<d)-1),a.modified("query")&&!a.modified("fields")&&(e|=this.update(a,b,c)),b.add.length&&(this.insert(a,b,c),e|=(1<<d)-1),b.mod.length&&(this.modify(b,c),e|=(1<<d)-1),this.value.mask=e,c},jg.insert=function(a,b,c){var d,e,f,g=b.add,h=this.value,i=this._dims,j=this._indices,k=a.fields,l={},m=c.add,n=h.size(),o=n+g.length,p=i.length;h.resize(o,p),h.add(g);var q=h.curr(),s=h.prev(),r=h.all();for(d=0;d<p;++d)f=l[e=k[d].fname]||(l[e]=j[e].insert(k[d],g,n)),i[d].onAdd(f,q);for(;n<o;++n)s[n]=r,q[n]!==r&&m.push(n)},jg.modify=function(a,b){var c,d,e,f=b.mod,g=this.value,h=g.curr(),i=g.all(),j=a.mod;for(c=0,d=j.length;c<d;++c)h[e=j[c]._index]!==i&&f.push(e)},jg.remove=function(a,b,c){var d,e,f,g,h=this._indices,i=this.value,j=i.curr(),k=i.prev(),l=i.all(),m={},n=c.rem,o=b.rem;for(d=0,e=o.length;d<e;++d)m[f=o[d]._index]=1,k[f]=g=j[f],j[f]=l,g!==l&&n.push(f);for(f in h)h[f].remove(e,m);return this.reindex(b,e,m),m},jg.reindex=function(a,b,c){var d=this._indices,e=this.value;a.runAfter(function(){var f=e.remove(b,c);for(var g in d)d[g].reindex(f)})},jg.update=function(a,b,c){var d,e,f=this._dims,g=a.query,h=b.stamp,i=f.length,j=0;for(c.filters=0,e=0;e<i;++e)a.modified("query",e)&&(d=e,++j);if(1===j)j=f[d].one,this.incrementOne(f[d],g[d],c.add,c.rem);else for(e=0,j=0;e<i;++e)a.modified("query",e)&&(j|=f[e].one,this.incrementAll(f[e],g[e],h,c.add),c.rem=c.add);return j},jg.incrementAll=function(a,b,c,d){var e,f,g,h=this.value,i=h.seen(),j=h.curr(),k=h.prev(),l=a.index(),m=a.bisect(a.range),n=a.bisect(b),o=n[0],p=n[1],q=m[0],s=m[1],r=a.one;if(o<q)for(e=o,f=Math.min(q,p);e<f;++e)i[g=l[e]]!==c&&(k[g]=j[g],i[g]=c,d.push(g)),j[g]^=r;else if(o>q)for(e=q,f=Math.min(o,s);e<f;++e)i[g=l[e]]!==c&&(k[g]=j[g],i[g]=c,d.push(g)),j[g]^=r;if(p>s)for(e=Math.max(o,s),f=p;e<f;++e)i[g=l[e]]!==c&&(k[g]=j[g],i[g]=c,d.push(g)),j[g]^=r;else if(p<s)for(e=Math.max(q,p),f=s;e<f;++e)i[g=l[e]]!==c&&(k[g]=j[g],i[g]=c,d.push(g)),j[g]^=r;a.range=b.slice()},jg.incrementOne=function(a,b,c,d){var e,f,g,h=this.value.curr(),i=a.index(),j=a.bisect(a.range),k=a.bisect(b),l=k[0],m=k[1],n=j[0],o=j[1],p=a.one;if(l<n)for(e=l,f=Math.min(n,m);e<f;++e)h[g=i[e]]^=p,c.push(g);else if(l>n)for(e=n,f=Math.min(l,o);e<f;++e)h[g=i[e]]^=p,d.push(g);if(m>o)for(e=Math.max(l,o),f=m;e<f;++e)h[g=i[e]]^=p,c.push(g);else if(m<o)for(e=Math.max(n,m),f=o;e<f;++e)h[g=i[e]]^=p,d.push(g);a.range=b.slice()},Uv.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Da(Uv,ia).transform=function(a,b){var c=~(a.ignore||0),d=a.filter,e=d.mask;if(0==(e&c))return b.StopPropagation;var f=b.fork(b.ALL),g=d.data(),h=d.curr(),i=d.prev(),j=function(k){return h[k]&c?null:g[k]};return f.filter(f.MOD,j),e&e-1?(f.filter(f.ADD,function(k){var l=h[k]&c;return!l&&l^i[k]&c?g[k]:null}),f.filter(f.REM,function(k){var l=h[k]&c;return l&&!(l^l^i[k]&c)?g[k]:null})):(f.filter(f.ADD,j),f.filter(f.REM,function(k){return(h[k]&c)===e?g[k]:null})),f.filter(f.SOURCE,function(k){return j(k._index)})};var xS=Object.freeze({__proto__:null,crossfilter:Tv,resolvefilter:Uv});function pG(a,b){a&&(null==b?a.removeAttribute("aria-label"):a.setAttribute("aria-label",b))}function Vv(a,b){const c=a.globalCursor()?"undefined"!=typeof document&&document.body:a.container();if(c)return null==b?c.style.removeProperty("cursor"):c.style.cursor=b}function up(a,b){var c=a._runtime.data;return db(c,b)||ja("Unrecognized data set: "+b),c[b]}function vp(a,b){Gy(b)||ja("Second argument to changes must be a changeset.");var c=up(this,a);return c.modified=!0,this.pulse(c.input,b)}function qG(a){var b=a.padding();return Math.max(0,a._viewWidth+b.left+b.right)}function rG(a){var b=a.padding();return Math.max(0,a._viewHeight+b.top+b.bottom)}function wp(a){var b=a.padding(),c=a._origin;return[b.left+c[0],b.top+c[1]]}function yS(a,b,c){var d,e,f=a._renderer,g=f&&f.canvas();return g&&(e=wp(a),(d=bo(b.changedTouches?b.changedTouches[0]:b,g))[0]-=e[0],d[1]-=e[1]),b.dataflow=a,b.item=c,b.vega=function(h,i,j){var k=i?"group"===i.mark.marktype?i:i.mark.group:null;function l(n){var o,p=k;if(n){for(o=i;o;o=o.mark.group)if(o.mark.name===n){p=o;break}}return p&&p.mark&&p.mark.interactive?p:{}}function m(n){if(!n)return j;Xa(n)&&(n=l(n));for(var o=j.slice();n;)o[0]-=n.x||0,o[1]-=n.y||0,n=n.mark&&n.mark.group;return o}return{view:Nd(h),item:Nd(i||{}),group:l,xy:m,x:function(n){return m(n)[0]},y:function(n){return m(n)[1]}}}(a,c,d),b}const zS={trap:!1};function xp(a,b,c){const d=a._eventConfig&&a._eventConfig[b];return!(!1===d||ka(d)&&!d[c])||(a.warn(`Blocked ${b} ${c} event listener.`),!1)}function sG(a){return a.item}function tG(a){return a.item.mark.source}function uG(a){return function(b,c){return c.vega.view().changeset().encode(c.item,a)}}function zf(a,b,c){var d=document.createElement(a);for(var e in b)d.setAttribute(e,b[e]);return null!=c&&(d.textContent=c),d}function AS(a,b,c){if(!b)return;const d=c.param;let e=c.state;return e||(e=c.state={elements:null,active:!1,set:null,update:f=>{f!==a.signal(d.signal)&&a.runAsync(null,function(){e.source=!0,a.signal(d.signal,f)})}},d.debounce&&(e.update=Kh(d.debounce,e.update))),function(f,g,h,i){const j=zf("div",{class:"vega-bind"}),k="radio"===h.input?j:j.appendChild(zf("label"));k.appendChild(zf("span",{class:"vega-bind-name"},h.name||h.signal)),g.appendChild(j);let l=BS;switch(h.input){case"checkbox":l=CS;break;case"select":l=DS;break;case"radio":l=ES;break;case"range":l=FS}l(f,k,h,i)}(e,b,d,a.signal(d.signal)),e.active||(a.on(a._signals[d.signal],null,()=>{e.source?e.source=!1:e.set(a.signal(d.signal))}),e.active=!0),e}function BS(a,b,c,d){const e=zf("input");for(const f in c)"signal"!==f&&"element"!==f&&e.setAttribute("input"===f?"type":f,c[f]);e.setAttribute("name",c.signal),e.value=d,b.appendChild(e),e.addEventListener("input",()=>a.update(e.value)),a.elements=[e],a.set=f=>e.value=f}function CS(a,b,c,d){const e={type:"checkbox",name:c.signal};d&&(e.checked=!0);const f=zf("input",e);b.appendChild(f),f.addEventListener("change",()=>a.update(f.checked)),a.elements=[f],a.set=g=>f.checked=!!g||null}function DS(a,b,c,d){const e=zf("select",{name:c.signal}),f=c.labels||[];c.options.forEach((g,h)=>{const i={value:g};yp(g,d)&&(i.selected=!0),e.appendChild(zf("option",i,(f[h]||g)+""))}),b.appendChild(e),e.addEventListener("change",()=>{a.update(c.options[e.selectedIndex])}),a.elements=[e],a.set=g=>{for(let h=0,i=c.options.length;h<i;++h)if(yp(c.options[h],g))return void(e.selectedIndex=h)}}function ES(a,b,c,d){const e=zf("span",{class:"vega-bind-radio"}),f=c.labels||[];b.appendChild(e),a.elements=c.options.map((g,h)=>{const i={type:"radio",name:c.signal,value:g};yp(g,d)&&(i.checked=!0);const j=zf("input",i);j.addEventListener("change",()=>a.update(g));const k=zf("label",{},(f[h]||g)+"");return k.prepend(j),e.appendChild(k),j}),a.set=g=>{const h=a.elements,i=h.length;for(let j=0;j<i;++j)yp(h[j].value,g)&&(h[j].checked=!0)}}function FS(a,b,c,d){d=void 0!==d?d:(+c.max+ +c.min)/2;const e=null!=c.max?c.max:Math.max(100,+d)||100,f=c.min||Math.min(0,e,+d)||0,g=c.step||Nh(f,e,100),h=zf("input",{type:"range",name:c.signal,min:f,max:e,step:g});h.value=d;const i=zf("span",{},+d);b.appendChild(h),b.appendChild(i);const j=()=>{i.textContent=h.value,a.update(+h.value)};h.addEventListener("input",j),h.addEventListener("change",j),a.elements=[h],a.set=k=>{h.value=k,i.textContent=k}}function yp(a,b){return a===b||a+""==b+""}function vG(a,b,c,d,e,f){return(b=b||new d(a.loader())).initialize(c,qG(a),rG(a),wp(a),e,f).background(a.background())}function Wv(a,b){return b?function(){try{b.apply(this,arguments)}catch(c){a.error(c)}}:null}function Xv(a,b){if("string"==typeof b){if("undefined"==typeof document)return a.error("DOM document instance not found."),null;if(!(b=document.querySelector(b)))return a.error("Signal bind element not found: "+b),null}if(b)try{b.innerHTML=""}catch(c){b=null,a.error(c)}return b}const em=a=>+a||0;function wG(a){return ka(a)?{top:em(a.top),bottom:em(a.bottom),left:em(a.left),right:em(a.right)}:(b=>({top:b,bottom:b,left:b,right:b}))(em(a))}async function Yv(a,b,c,d){const e=wo(b),f=e&&e.headless;return f||ja("Unrecognized renderer type: "+b),await a.runAsync(),vG(a,null,null,f,c,d).renderAsync(a._scenegraph.root)}function xG(a){const b=this.context.data[a];return b?b.values.value:[]}const fm=a=>function(b,c){return this.context.dataflow.locale()[a](c)(b)},GS=fm("format"),yG=fm("timeFormat"),HS=fm("utcFormat"),IS=fm("timeParse"),JS=fm("utcParse");var zp=new Date(2e3,0,1);function Ap(a,b,c){return Number.isInteger(a)&&Number.isInteger(b)?(zp.setYear(2e3),zp.setMonth(a),zp.setDate(b),yG.call(this,zp,c)):""}var rh,ab,na,ve,Nc;function kg(a){this.type=a}kg.prototype.visit=function(a){var b,c,d;if(a(this))return 1;for(c=0,d=(b=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":var f=e.arguments.slice();return f.unshift(e.callee),f;case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this)).length;c<d;++c)if(b[c].visit(a))return 1},(rh={})[1]="Boolean",rh[2]="<end>",rh[3]="Identifier",rh[4]="Keyword",rh[5]="Null",rh[6]="Numeric",rh[7]="Punctuator",rh[8]="String",rh[9]="RegularExpression";var we="ILLEGAL",KS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),LS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Bp(a,b){if(!a)throw new Error("ASSERT: "+b)}function sh(a){return a>=48&&a<=57}function Zv(a){return"0123456789abcdefABCDEF".indexOf(a)>=0}function gm(a){return"01234567".indexOf(a)>=0}function MS(a){return 32===a||9===a||11===a||12===a||160===a||a>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a)>=0}function hm(a){return 10===a||13===a||8232===a||8233===a}function im(a){return 36===a||95===a||a>=65&&a<=90||a>=97&&a<=122||92===a||a>=128&&KS.test(String.fromCharCode(a))}function Cp(a){return 36===a||95===a||a>=65&&a<=90||a>=97&&a<=122||a>=48&&a<=57||92===a||a>=128&&LS.test(String.fromCharCode(a))}var NS={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function zG(){for(var a;na<ve&&(MS(a=ab.charCodeAt(na))||hm(a));)++na}function _v(a){var b,c,d,e=0;for(c="u"===a?4:2,b=0;b<c;++b)na<ve&&Zv(ab[na])?(d=ab[na++],e=16*e+"0123456789abcdef".indexOf(d.toLowerCase())):Bc({},"Unexpected token %0",we);return String.fromCharCode(e)}function OS(){var a,b,c,d;for(b=0,"}"===(a=ab[na])&&Bc({},"Unexpected token %0",we);na<ve&&Zv(a=ab[na++]);)b=16*b+"0123456789abcdef".indexOf(a.toLowerCase());return(b>1114111||"}"!==a)&&Bc({},"Unexpected token %0",we),b<=65535?String.fromCharCode(b):(c=55296+(b-65536>>10),d=56320+(b-65536&1023),String.fromCharCode(c,d))}function AG(){var a,b;for(a=ab.charCodeAt(na++),b=String.fromCharCode(a),92===a&&(117!==ab.charCodeAt(na)&&Bc({},"Unexpected token %0",we),++na,(a=_v("u"))&&"\\"!==a&&im(a.charCodeAt(0))||Bc({},"Unexpected token %0",we),b=a);na<ve&&Cp(a=ab.charCodeAt(na));)++na,b+=String.fromCharCode(a),92===a&&(b=b.substr(0,b.length-1),117!==ab.charCodeAt(na)&&Bc({},"Unexpected token %0",we),++na,(a=_v("u"))&&"\\"!==a&&Cp(a.charCodeAt(0))||Bc({},"Unexpected token %0",we),b+=a);return b}function PS(){var a,b;return a=na,{type:1===(b=92===ab.charCodeAt(na)?AG():function(){var c,d;for(c=na++;na<ve;){if(92===(d=ab.charCodeAt(na)))return na=c,AG();if(!Cp(d))break;++na}return ab.slice(c,na)}()).length?3:NS.hasOwnProperty(b)?4:"null"===b?5:"true"===b||"false"===b?1:3,value:b,start:a,end:na}}function $v(){var a,b,c,d,e=na,f=ab.charCodeAt(na),g=ab[na];switch(f){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++na,{type:7,value:String.fromCharCode(f),start:e,end:na};default:if(61===(a=ab.charCodeAt(na+1)))switch(f){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return na+=2,{type:7,value:String.fromCharCode(f)+String.fromCharCode(a),start:e,end:na};case 33:case 61:return na+=2,61===ab.charCodeAt(na)&&++na,{type:7,value:ab.slice(e,na),start:e,end:na}}}return">>>="===(d=ab.substr(na,4))?{type:7,value:d,start:e,end:na+=4}:">>>"===(c=d.substr(0,3))||"<<="===c||">>="===c?{type:7,value:c,start:e,end:na+=3}:g===(b=c.substr(0,2))[1]&&"+-<>&|".indexOf(g)>=0||"=>"===b?{type:7,value:b,start:e,end:na+=2}:"<>=!+-*%&|^/".indexOf(g)>=0?{type:7,value:g,start:e,end:++na}:void Bc({},"Unexpected token %0",we)}function BG(){var a,b,c;if(Bp(sh((c=ab[na]).charCodeAt(0))||"."===c,"Numeric literal must start with a decimal digit or a decimal point"),b=na,a="","."!==c){if(a=ab[na++],c=ab[na],"0"===a){if("x"===c||"X"===c)return++na,function(d){for(var e="";na<ve&&Zv(ab[na]);)e+=ab[na++];return 0===e.length&&Bc({},"Unexpected token %0",we),im(ab.charCodeAt(na))&&Bc({},"Unexpected token %0",we),{type:6,value:parseInt("0x"+e,16),start:d,end:na}}(b);if(gm(c))return function(d){for(var e="0"+ab[na++];na<ve&&gm(ab[na]);)e+=ab[na++];return(im(ab.charCodeAt(na))||sh(ab.charCodeAt(na)))&&Bc({},"Unexpected token %0",we),{type:6,value:parseInt(e,8),octal:!0,start:d,end:na}}(b);c&&sh(c.charCodeAt(0))&&Bc({},"Unexpected token %0",we)}for(;sh(ab.charCodeAt(na));)a+=ab[na++];c=ab[na]}if("."===c){for(a+=ab[na++];sh(ab.charCodeAt(na));)a+=ab[na++];c=ab[na]}if("e"===c||"E"===c)if(a+=ab[na++],"+"!==(c=ab[na])&&"-"!==c||(a+=ab[na++]),sh(ab.charCodeAt(na)))for(;sh(ab.charCodeAt(na));)a+=ab[na++];else Bc({},"Unexpected token %0",we);return im(ab.charCodeAt(na))&&Bc({},"Unexpected token %0",we),{type:6,value:parseFloat(a),start:b,end:na}}function QS(){var a,b,c,d;return Nc=null,zG(),a=na,b=function(){var e,f,g,h;for(Bp("/"===(e=ab[na]),"Regular expression literal must start with a slash"),f=ab[na++],g=!1,h=!1;na<ve;)if(f+=e=ab[na++],"\\"===e)hm((e=ab[na++]).charCodeAt(0))&&Bc({},"Invalid regular expression: missing /"),f+=e;else if(hm(e.charCodeAt(0)))Bc({},"Invalid regular expression: missing /");else if(g)"]"===e&&(g=!1);else{if("/"===e){h=!0;break}"["===e&&(g=!0)}return h||Bc({},"Invalid regular expression: missing /"),{value:f.substr(1,f.length-2),literal:f}}(),c=function(){var e,f,g;for(f="",g="";na<ve&&Cp((e=ab[na]).charCodeAt(0));)++na,"\\"===e&&na<ve?Bc({},"Unexpected token %0",we):(g+=e,f+=e);return g.search(/[^gimuy]/g)>=0&&Bc({},"Invalid regular expression",g),{value:g,literal:f}}(),d=function(e,f){var g=e;f.indexOf("u")>=0&&(g=g.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(h,i){if(parseInt(i,16)<=1114111)return"x";Bc({},"Invalid regular expression")}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(g)}catch(h){Bc({},"Invalid regular expression")}try{return new RegExp(e,f)}catch(h){return null}}(b.value,c.value),{literal:b.literal+c.literal,value:d,regex:{pattern:b.value,flags:c.value},start:a,end:na}}function CG(){var a;return zG(),na>=ve?{type:2,start:na,end:na}:im(a=ab.charCodeAt(na))?PS():40===a||41===a||59===a?$v():39===a||34===a?function(){var b,c,d,e,f="",g=!1;for(Bp("'"===(b=ab[na])||'"'===b,"String literal must starts with a quote"),c=na,++na;na<ve;){if((d=ab[na++])===b){b="";break}if("\\"===d)if((d=ab[na++])&&hm(d.charCodeAt(0)))"\r"===d&&`
`===ab[na]&&++na;else switch(d){case"u":case"x":"{"===ab[na]?(++na,f+=OS()):f+=_v(d);break;case"n":f+=`
`;break;case"r":f+="\r";break;case"t":f+="	";break;case"b":f+="\b";break;case"f":f+="\f";break;case"v":f+="\v";break;default:gm(d)?(0!==(e="01234567".indexOf(d))&&(g=!0),na<ve&&gm(ab[na])&&(g=!0,e=8*e+"01234567".indexOf(ab[na++]),"0123".indexOf(d)>=0&&na<ve&&gm(ab[na])&&(e=8*e+"01234567".indexOf(ab[na++]))),f+=String.fromCharCode(e)):f+=d}else{if(hm(d.charCodeAt(0)))break;f+=d}}return""!==b&&Bc({},"Unexpected token %0",we),{type:8,value:f,octal:g,start:c,end:na}}():46===a?sh(ab.charCodeAt(na+1))?BG():$v():sh(a)?BG():$v()}function kf(){var a;return na=(a=Nc).end,Nc=CG(),na=a.end,a}function DG(){var a;a=na,Nc=CG(),na=a}function EG(a,b,c){var d=new kg("||"===a||"&&"===a?"LogicalExpression":"BinaryExpression");return d.operator=a,d.left=b,d.right=c,d}function RS(a,b){var c=new kg("CallExpression");return c.callee=a,c.arguments=b,c}function aw(a){var b=new kg("Identifier");return b.name=a,b}function jm(a){var b=new kg("Literal");return b.value=a.value,b.raw=ab.slice(a.start,a.end),a.regex&&("//"===b.raw&&(b.raw="/(?:)/"),b.regex=a.regex),b}function FG(a,b,c){var d=new kg("MemberExpression");return d.computed="["===a,d.object=b,d.property=c,d.computed||(c.member=!0),d}function GG(a,b,c){var d=new kg("Property");return d.key=b,d.value=c,d.kind=a,d}function Bc(a,b){var c,d=Array.prototype.slice.call(arguments,2),e=b.replace(/%(\d)/g,function(f,g){return Bp(g<d.length,"Message reference must be in range"),d[g]});throw(c=new Error(e)).index=na,c.description=e,c}function Dp(a){2===a.type&&Bc(a,"Unexpected end of input"),6===a.type&&Bc(a,"Unexpected number"),8===a.type&&Bc(a,"Unexpected string"),3===a.type&&Bc(a,"Unexpected identifier"),4===a.type&&Bc(a,"Unexpected reserved word"),Bc(a,"Unexpected token %0",a.value)}function xe(a){var b=kf();7===b.type&&b.value===a||Dp(b)}function gd(a){return 7===Nc.type&&Nc.value===a}function bw(a){return 4===Nc.type&&Nc.value===a}function SS(){var a=[];for(na=Nc.start,xe("[");!gd("]");)gd(",")?(kf(),a.push(null)):(a.push(ej()),gd("]")||xe(","));return kf(),function(b){var c=new kg("ArrayExpression");return c.elements=b,c}(a)}function HG(){var a;return na=Nc.start,8===(a=kf()).type||6===a.type?(a.octal&&Bc(a,"Octal literals are not allowed in strict mode."),jm(a)):aw(a.value)}function TS(){var a,b,c;return na=Nc.start,3===(a=Nc).type?(c=HG(),xe(":"),GG("init",c,ej())):2!==a.type&&7!==a.type?(b=HG(),xe(":"),GG("init",b,ej())):void Dp(a)}function US(){var a,b,c=[],d={},e=String;for(na=Nc.start,xe("{");!gd("}");)b="$"+("Identifier"===(a=TS()).key.type?a.key.name:e(a.key.value)),Object.prototype.hasOwnProperty.call(d,b)?Bc({},"Duplicate data property in object literal not allowed in strict mode"):d[b]=!0,c.push(a),gd("}")||xe(",");return xe("}"),function(f){var g=new kg("ObjectExpression");return g.properties=f,g}(c)}var VS={if:1};function WS(){var a,b,c;if(gd("("))return function(){var d;return xe("("),d=cw(),xe(")"),d}();if(gd("["))return SS();if(gd("{"))return US();if(a=Nc.type,na=Nc.start,3===a||VS[Nc.value])c=aw(kf().value);else if(8===a||6===a)Nc.octal&&Bc(Nc,"Octal literals are not allowed in strict mode."),c=jm(kf());else{if(4===a)throw new Error("Disabled.");1===a?((b=kf()).value="true"===b.value,c=jm(b)):5===a?((b=kf()).value=null,c=jm(b)):gd("/")||gd("/=")?(c=jm(QS()),DG()):Dp(kf())}return c}function XS(){var a=[];if(xe("("),!gd(")"))for(;na<ve&&(a.push(ej()),!gd(")"));)xe(",");return xe(")"),a}function YS(){return xe("."),na=Nc.start,function(b){return 3===b.type||4===b.type||1===b.type||5===b.type}(a=kf())||Dp(a),aw(a.value);var a}function ZS(){var a;return xe("["),a=cw(),xe("]"),a}function IG(){var a=function(){var b;for(b=WS();;)if(gd("."))b=FG(".",b,YS());else if(gd("("))b=RS(b,XS());else{if(!gd("["))break;b=FG("[",b,ZS())}return b}();if(7===Nc.type&&(gd("++")||gd("--")))throw new Error("Disabled.");return a}function Ep(){var a,b;if(7!==Nc.type&&4!==Nc.type)b=IG();else{if(gd("++")||gd("--"))throw new Error("Disabled.");if(gd("+")||gd("-")||gd("~")||gd("!"))a=kf(),b=Ep(),b=function(c,d){var e=new kg("UnaryExpression");return e.operator=c,e.argument=d,e.prefix=!0,e}(a.value,b);else{if(bw("delete")||bw("void")||bw("typeof"))throw new Error("Disabled.");b=IG()}}return b}function JG(a){var b=0;if(7!==a.type&&4!==a.type)return 0;switch(a.value){case"||":b=1;break;case"&&":b=2;break;case"|":b=3;break;case"^":b=4;break;case"&":b=5;break;case"==":case"!=":case"===":case"!==":b=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":b=7;break;case"<<":case">>":case">>>":b=8;break;case"+":case"-":b=9;break;case"*":case"/":case"%":b=11}return b}function ej(){var a,b;return a=function(){var c,d,e,f,g,h,i,j,k,l;if(c=Nc,k=Ep(),0===(g=JG(f=Nc)))return k;for(f.prec=g,kf(),d=[c,Nc],h=[k,f,i=Ep()];(g=JG(Nc))>0;){for(;h.length>2&&g<=h[h.length-2].prec;)i=h.pop(),j=h.pop().value,k=h.pop(),d.pop(),e=EG(j,k,i),h.push(e);(f=kf()).prec=g,h.push(f),d.push(Nc),e=Ep(),h.push(e)}for(e=h[l=h.length-1],d.pop();l>1;)d.pop(),e=EG(h[l-1].value,h[l-2],e),l-=2;return e}(),gd("?")&&(kf(),b=ej(),xe(":"),a=function(c,d,e){var f=new kg("ConditionalExpression");return f.test=c,f.consequent=d,f.alternate=e,f}(a,b,ej())),a}function cw(){var a=ej();if(gd(","))throw new Error("Disabled.");return a}function KG(a){na=0,ve=(ab=a).length,Nc=null,DG();var b=cw();if(2!==Nc.type)throw new Error("Unexpect token after expression.");return b}var LG={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function MG(a){function b(d,e,f){return function(g){return function(h,i,j,k){var l=a(i[0]);return j&&(l=j+"("+l+")",0===j.lastIndexOf("new ",0)&&(l="("+l+")")),l+"."+h+(k<0?"":0===k?"()":"("+i.slice(1).map(a).join(",")+")")}(d,g,e,f)}}var c="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(d){d.length<3&&ja("Missing arguments to clamp function."),d.length>3&&ja("Too many arguments to clamp function.");var e=d.map(a);return"Math.max("+e[1]+", Math.min("+e[2]+","+e[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:c,date:b("getDate",c,0),day:b("getDay",c,0),year:b("getFullYear",c,0),month:b("getMonth",c,0),hours:b("getHours",c,0),minutes:b("getMinutes",c,0),seconds:b("getSeconds",c,0),milliseconds:b("getMilliseconds",c,0),time:b("getTime",c,0),timezoneoffset:b("getTimezoneOffset",c,0),utcdate:b("getUTCDate",c,0),utcday:b("getUTCDay",c,0),utcyear:b("getUTCFullYear",c,0),utcmonth:b("getUTCMonth",c,0),utchours:b("getUTCHours",c,0),utcminutes:b("getUTCMinutes",c,0),utcseconds:b("getUTCSeconds",c,0),utcmilliseconds:b("getUTCMilliseconds",c,0),length:b("length",null,-1),join:b("join",null),indexof:b("indexOf",null),lastindexof:b("lastIndexOf",null),slice:b("slice",null),reverse:function(d){return"("+a(d[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:b("toUpperCase","String",0),lower:b("toLowerCase","String",0),substring:b("substring","String"),split:b("split","String"),replace:b("replace","String"),trim:b("trim","String",0),regexp:"RegExp",test:b("test","RegExp"),if:function(d){d.length<3&&ja("Missing arguments to if function."),d.length>3&&ja("Too many arguments to if function.");var e=d.map(a);return"("+e[0]+"?"+e[1]+":"+e[2]+")"}}}function dw(a,b,c,d){"Literal"!==b[0].type&&ja("First argument to data functions must be a string literal.");const e=b[0].value,f=":"+e;if(!db(f,d))try{d[f]=c.getData(e).tuplesRef()}catch(g){}}function lf(a,b,c,d){if("Literal"===b[0].type)NG(c,d,b[0].value);else for(a in c.scales)NG(c,d,a)}function NG(a,b,c){const d="%"+c;if(!db(b,d))try{b[d]=a.scaleRef(c)}catch(e){}}function th(a,b){let c;return Ub(a)?a:Xa(a)?(c=b.scales[a])&&c.value:void 0}function ew(a,b){return function(c,d,e){if(c){const f=th(c,(e||this).context);return f&&f.path[a](d)}return b(d)}}const _S=ew("area",function(a){return Ho.reset(),mh(a,Kg),2*Ho}),$S=ew("bounds",function(a){var b,c,d,e,f,g,h;if(xf=Ad=-(sd=jf=1/0),di=[],mh(a,oh),c=di.length){for(di.sort(KQ),b=1,f=[d=di[0]];b<c;++b)GE(d,(e=di[b])[0])||GE(d,e[1])?(yf(d[0],e[1])>yf(d[0],d[1])&&(d[1]=e[1]),yf(e[0],d[1])>yf(d[0],d[1])&&(d[0]=e[0])):f.push(d=e);for(g=-1/0,b=0,d=f[c=f.length-1];b<=c;d=e,++b)e=f[b],(h=yf(d[1],e[0]))>g&&(g=h,sd=e[0],Ad=d[1])}return di=nh=null,sd===1/0||jf===1/0?[[NaN,NaN],[NaN,NaN]]:[[sd,jf],[Ad,xf]]}),aT=ew("centroid",function(a){Jl=Mo=No=Oo=Po=Qo=Ro=So=Cu=Du=Eu=0,mh(a,ig);var b=Cu,c=Du,d=Eu,e=b*b+c*c+d*d;return e<1e-12&&(b=Qo,c=Ro,d=So,Mo<1e-6&&(b=No,c=Oo,d=Po),(e=b*b+c*c+d*d)<1e-12)?[NaN,NaN]:[Nf(c,b)*Ed,hf(d/ie(e))*Ed]});function fw(a,b,c){try{a[b].apply(a,["EXPRESSION"].concat([].slice.call(c)))}catch(d){a.warn(d)}return c[c.length-1]}function gw(a){const b=a/255;return b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4)}function hw(a){const b=ai(a);return .2126*gw(b.r)+.7152*gw(b.g)+.0722*gw(b.b)}function OG(a,b){return a===b||a!=a&&b!=b||(U(a)?!(!U(b)||a.length!==b.length)&&function(c,d){for(let e=0,f=c.length;e<f;++e)if(!OG(c[e],d[e]))return!1;return!0}(a,b):!(!ka(a)||!ka(b))&&PG(a,b))}function PG(a,b){for(let c in a)if(!OG(a[c],b[c]))return!1;return!0}function QG(a){return b=>PG(a,b)}const RG=a=>a.data;function SG(a,b){const c=xG.call(b,a);return c.root&&c.root.lookup||{}}const TG=()=>"undefined"!=typeof window&&window||null;function UG(a,b){for(var c,d,e=b.fields,f=b.values,g=e.length,h=0;h<g;++h)if((d=e[h]).getter=ce.getter||ce(d.field),Ci(c=d.getter(a))&&(c=Eb(c)),Ci(f[h])&&(f[h]=Eb(f[h])),Ci(f[h][0])&&(f[h]=f[h].map(Eb)),"E"===d.type){if(U(f[h])?f[h].indexOf(c)<0:c!==f[h])return!1}else if("R"===d.type){if(!Uk(c,f[h]))return!1}else if("R-RE"===d.type){if(!Uk(c,f[h],!0,!1))return!1}else if("R-E"===d.type){if(!Uk(c,f[h],!1,!1))return!1}else if("R-LE"===d.type&&!Uk(c,f[h],!1,!0))return!1;return!0}var VG={E_union:function(a,b){if(!a.length)return b;for(var c=0,d=b.length;c<d;++c)a.indexOf(b[c])<0&&a.push(b[c]);return a},E_intersect:function(a,b){return a.length?a.filter(function(c){return b.indexOf(c)>=0}):b},R_union:function(a,b){var c=Eb(b[0]),d=Eb(b[1]);return c>d&&(c=b[1],d=b[0]),a.length?(a[0]>c&&(a[0]=c),a[1]<d&&(a[1]=d),a):[c,d]},R_intersect:function(a,b){var c=Eb(b[0]),d=Eb(b[1]);return c>d&&(c=b[1],d=b[0]),a.length?d<a[0]||a[1]<c?[]:(a[0]<c&&(a[0]=c),a[1]>d&&(a[1]=d),a):[c,d]}};function WG(a,b,c,d){"Literal"!==b[0].type&&ja("First argument to selection functions must be a string literal.");const e=b[0].value,f=":"+e;"intersect"!==(b.length>=2&&Ha(b).value)||db(d,"@unit")||(d["@unit"]=c.getData(e).indataRef(c,"unit")),db(d,f)||(d[f]=c.getData(e).tuplesRef())}const km={random:function(){return If()},cumulativeNormal:xn,cumulativeLogNormal:Xr,cumulativeUniform:$r,densityNormal:Sr,densityLogNormal:Wr,densityUniform:_r,quantileNormal:yn,quantileLogNormal:Yr,quantileUniform:as,sampleNormal:wn,sampleLogNormal:Vr,sampleUniform:Zr,isArray:U,isBoolean:Bi,isDate:Ci,isDefined:function(a){return void 0!==a},isNumber:Yc,isObject:ka,isRegExp:function(a){return"[object RegExp]"===Object.prototype.toString.call(a)},isString:Xa,isTuple:dn,isValid:function(a){return null!=a&&a==a},toBoolean:Ay,toDate:By,toNumber:Eb,toString:Cy,flush:function(a,b,c,d,e,f){if(!c&&0!==c)return f;var g,h,i=a[0],j=Ha(a),k=+c;return j<i&&(g=i,i=j,j=g),(g=Math.abs(b-i))<(h=Math.abs(j-b))&&g<=k?d:h<=k?e:f},lerp:function(a,b){const c=a[0],d=Ha(a),e=+b;return e?1===e?d:c+e*(d-c):c},merge:function(){var a=[].slice.call(arguments);return a.unshift({}),Mb.apply(null,a)},pad:function(a,b,c,d){var e=c||" ",f=a+"",g=b-f.length;return g<=0?f:"left"===d?$m(e,g)+f:"center"===d?$m(e,~~(g/2))+f+$m(e,Math.ceil(g/2)):f+$m(e,g)},peek:Ha,span:an,inrange:Uk,truncate:function(a,b,c,d){var e=null!=d?d:"",f=a+"",g=f.length,h=Math.max(0,b-e.length);return g<=b?f:"left"===c?e+f.slice(g-h):"center"===c?f.slice(0,Math.ceil(h/2))+e+f.slice(g-~~(h/2)):f.slice(0,h)+e},rgb:ai,lab:ko,hcl:lo,hsl:jo,luminance:hw,contrast:function(a,b){const c=hw(a),d=hw(b);return(Math.max(c,d)+.05)/(Math.min(c,d)+.05)},sequence:Fi,format:GS,utcFormat:HS,utcParse:JS,utcOffset:xz,utcSequence:Az,timeFormat:yG,timeParse:IS,timeOffset:wz,timeSequence:zz,timeUnitSpecifier:hz,monthFormat:function(a){return Ap.call(this,a,1,"%B")},monthAbbrevFormat:function(a){return Ap.call(this,a,1,"%b")},dayFormat:function(a){return Ap.call(this,0,2+a,"%A")},dayAbbrevFormat:function(a){return Ap.call(this,0,2+a,"%a")},quarter:function(a){return 1+~~(new Date(a).getMonth()/3)},utcquarter:function(a){return 1+~~(new Date(a).getUTCMonth()/3)},week:nz,utcweek:qz,dayofyear:mz,utcdayofyear:pz,warn:function(){return fw(this.context.dataflow,"warn",arguments)},info:function(){return fw(this.context.dataflow,"info",arguments)},debug:function(){return fw(this.context.dataflow,"debug",arguments)},extent:dh,inScope:function(a){let b=this.context.group,c=!1;if(b)for(;a;){if(a===b){c=!0;break}a=a.mark.group}return c},intersect:function(a,b,c){if(!a)return[];const[d,e]=a,f=new Pd().set(d[0],d[1],e[0],e[1]);return CD(c||this.context.dataflow.scenegraph().root,f,function(g){let h=null;if(g){const i=Ra(g.marktype),j=Ra(g.markname);h=k=>(!i.length||i.some(l=>k.marktype===l))&&(!j.length||j.some(l=>k.name===l))}return h}(b))},clampRange:function(a,b,c){var d,e=a[0],f=a[1];return f<e&&(d=f,f=e,e=d),(d=f-e)>=c-b?[b,c]:[e=Math.min(Math.max(e,b),c-d),e+d]},pinchDistance:function(a){const b=a.touches,c=b[0].clientX-b[1].clientX,d=b[0].clientY-b[1].clientY;return Math.sqrt(c*c+d*d)},pinchAngle:function(a){const b=a.touches;return Math.atan2(b[0].clientY-b[1].clientY,b[0].clientX-b[1].clientX)},screen:function(){const a=TG();return a?a.screen:{}},containerSize:function(){const a=this.context.dataflow,b=a.container&&a.container();return b?[b.clientWidth,b.clientHeight]:[void 0,void 0]},windowSize:function(){const a=TG();return a?[a.innerWidth,a.innerHeight]:[void 0,void 0]},bandspace:function(a,b,c){return ut(a||0,b||0,c||0)},setdata:function(a,b){const c=this.context.dataflow,d=this.context.data[a].input;return c.pulse(d,c.changeset().remove(de).insert(b)),1},pathShape:function(a){let b=null;return function(c){return c?ml(c,b=b||Tj(a)):a}},panLinear:function(a,b){return Ge(a,b,Eb,fc)},panLog:function(a,b){var c=Math.sign(a[0]);return Ge(a,b,rc(c),qd(c))},panPow:function(a,b,c){return Ge(a,b,qe(c),qe(1/c))},panSymlog:function(a,b,c){return Ge(a,b,Id(c),Bg(c))},zoomLinear:He,zoomLog:Ie,zoomPow:Xc,zoomSymlog:Ai,encode:function(a,b,c){if(a){const d=this.context.dataflow,e=a.mark.source;d.pulse(e,d.changeset().encode(a,b))}return void 0!==c?c:a},modify:function(a,b,c,d,e,f){let g,h,i=this.context.dataflow,j=this.context.data[a],k=j.input,l=j.changes,m=i.stamp();if(!1===i._trigger||!(k.value.length||b||d))return 0;if((!l||l.stamp<m)&&(j.changes=l=i.changeset(),l.stamp=m,i.runAfter(function(){j.modified=!0,i.pulse(k,l).run()},!0,1)),c&&(g=!0===c?de:U(c)||dn(c)?c:QG(c),l.remove(g)),b&&l.insert(b),d&&(g=QG(d),k.value.some(g)?l.remove(g):l.insert(d)),e)for(h in f)l.modify(e,h,f[h]);return 1}},bT=["view","item","group","xy","x","y"],iw={};function Xd(a,b,c){return 1===arguments.length?km[a]:(km[a]=b,c&&(iw[a]=c),jw&&(jw.functions[a]="this."+a),this)}Xd("bandwidth",function(a,b){const c=th(a,(b||this).context);return c&&c.bandwidth?c.bandwidth():0},lf),Xd("copy",function(a,b){const c=th(a,(b||this).context);return c?c.copy():void 0},lf),Xd("domain",function(a,b){const c=th(a,(b||this).context);return c?c.domain():[]},lf),Xd("range",function(a,b){const c=th(a,(b||this).context);return c&&c.range?c.range():[]},lf),Xd("invert",function(a,b,c){const d=th(a,(c||this).context);return d?U(b)?(d.invertRange||d.invert)(b):(d.invert||d.invertExtent)(b):void 0},lf),Xd("scale",function(a,b,c){const d=th(a,(c||this).context);return d?d(b):void 0},lf),Xd("gradient",function(a,b,c,d,e){a=th(a,(e||this).context);const f=TA(b,c);let g=a.domain(),h=g[0],i=Ha(g),j=fc;return i-h?j=dD(a,h,i):a=(a.interpolator?wc("sequential")().interpolator(a.interpolator()):wc("linear")().interpolate(a.interpolate()).range(a.range())).domain([h=0,i=1]),a.ticks&&(g=a.ticks(+d||15),h!==g[0]&&g.unshift(h),i!==Ha(g)&&g.push(i)),g.forEach(k=>f.stop(j(k),a(k))),f},lf),Xd("geoArea",_S,lf),Xd("geoBounds",$S,lf),Xd("geoCentroid",aT,lf),Xd("geoShape",function(a,b,c){const d=th(a,(c||this).context);return function(e){return d?d.path.context(e)(b):""}},lf),Xd("indata",function(a,b,c){const d=this.context.data[a]["index:"+b],e=d?d.value.get(c):void 0;return e?e.count:e},function(a,b,c,d){"Literal"!==b[0].type&&ja("First argument to indata must be a string literal."),"Literal"!==b[1].type&&ja("Second argument to indata must be a string literal.");const e=b[0].value,f=b[1].value,g="@"+f;db(g,d)||(d[g]=c.getData(e).indataRef(c,f))}),Xd("data",xG,dw),Xd("treePath",function(a,b,c){const d=SG(a,this),e=d[b],f=d[c];return e&&f?e.path(f).map(RG):void 0},dw),Xd("treeAncestors",function(a,b){const c=SG(a,this)[b];return c?c.ancestors().map(RG):void 0},dw),Xd("vlSelectionTest",function(a,b,c){for(var d,e,f,g,h,i=this.context.data[a],j=i?i.values.value:[],k=i?i["index:unit"]&&i["index:unit"].value:void 0,l="intersect"===c,m=j.length,n=0;n<m;++n)if(d=j[n],k&&l){if(-1===(f=(e=e||{})[g=d.unit]||0))continue;if(h=UG(b,d),e[g]=h?-1:++f,h&&1===k.size)return!0;if(!h&&f===k.get(g).count)return!1}else if(l^(h=UG(b,d)))return h;return m&&l},WG),Xd("vlSelectionResolve",function(a,b,c){for(var d,e,f,g,h,i,j,k,l,m,n,o=this.context.data[a],p=o?o.values.value:[],q={},s={},r={},u=p.length,t=0;t<u;++t){for(g=(d=p[t]).unit,e=d.fields,f=d.values,m=0,n=e.length;m<n;++m)h=e[m],j=(i=q[h.field]||(q[h.field]={}))[g]||(i[g]=[]),r[h.field]=k=h.type.charAt(0),l=VG[k+"_union"],i[g]=l(j,Ra(f[m]));c&&(j=s[g]||(s[g]=[])).push(Ra(f).reduce((w,x,z)=>(w[e[z].field]=x,w),{}))}return b=b||"union",Object.keys(q).forEach(function(w){q[w]=Object.keys(q[w]).map(x=>q[w][x]).reduce((x,z)=>void 0===x?z:VG[r[w]+"_"+b](x,z))}),p=Object.keys(s),c&&p.length&&(q.vlMulti="union"===b?{or:p.reduce((w,x)=>(w.push.apply(w,s[x]),w),[])}:{and:p.map(w=>({or:s[w]}))}),q},WG);const XG={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:a=>"_["+Ga("$"+a)+"]",functions:function(a){const b=MG(a);bT.forEach(c=>b[c]="event.vega."+c);for(let c in km)b[c]="this."+c;return Mb(b,function(c,d,e){d.__bandwidth=g=>g&&g.bandwidth?g.bandwidth():0,e._bandwidth=lf,e._range=lf,e._scale=lf;const f=g=>"_["+("Literal"===g.type?Ga("%"+g.value):Ga("%")+"+"+c(g))+"]";return{_bandwidth:g=>`this.__bandwidth(${f(g[0])})`,_range:g=>f(g[0])+".range()",_scale:g=>`${f(g[0])}(${c(g[1])})`}}(a,km,iw)),b},constants:LG,visitors:iw};var jw=function(a){var b=(a=a||{}).whitelist?ee(a.whitelist):{},c=a.blacklist?ee(a.blacklist):{},d=a.constants||LG,e=(a.functions||MG)(l),f=a.globalvar,g=a.fieldvar,h={},i={},j=0,k=Ub(f)?f:function(o){return f+'["'+o+'"]'};function l(o){if(Xa(o))return o;var p=m[o.type];return null==p&&ja("Unsupported type: "+o.type),p(o)}var m={Literal:function(o){return o.raw},Identifier:function(o){var p=o.name;return j>0?p:db(c,p)?ja("Illegal identifier: "+p):db(d,p)?d[p]:db(b,p)?p:(h[p]=1,k(p))},MemberExpression:function(o){var p=!o.computed,q=l(o.object);p&&(j+=1);var s=l(o.property);return q===g&&(i[function(r){var u=r&&r.length-1;return u&&('"'===r[0]&&'"'===r[u]||"'"===r[0]&&"'"===r[u])?r.slice(1,-1):r}(s)]=1),p&&(j-=1),q+(p?"."+s:"["+s+"]")},CallExpression:function(o){"Identifier"!==o.callee.type&&ja("Illegal callee type: "+o.callee.type);var p=o.callee.name,q=o.arguments,s=db(e,p)&&e[p];return s||ja("Unrecognized function: "+p),Ub(s)?s(q):s+"("+q.map(l).join(",")+")"},ArrayExpression:function(o){return"["+o.elements.map(l).join(",")+"]"},BinaryExpression:function(o){return"("+l(o.left)+o.operator+l(o.right)+")"},UnaryExpression:function(o){return"("+o.operator+l(o.argument)+")"},ConditionalExpression:function(o){return"("+l(o.test)+"?"+l(o.consequent)+":"+l(o.alternate)+")"},LogicalExpression:function(o){return"("+l(o.left)+o.operator+l(o.right)+")"},ObjectExpression:function(o){return"{"+o.properties.map(l).join(",")+"}"},Property:function(o){j+=1;var p=l(o.key);return j-=1,p+":"+l(o.value)}};function n(o){var p={code:l(o),globals:Object.keys(h),fields:Object.keys(i)};return h={},i={},p}return n.functions=e,n.constants=d,n}(XG);function Og(a,b){var c,d,e={};try{c=KG(a=Xa(a)?a:Ga(a)+"")}catch(f){ja("Expression parse error: "+a)}return c.visit(f=>{if("CallExpression"===f.type){var g=f.callee.name,h=XG.visitors[g];h&&h(g,f.arguments,b,e)}}),(d=jw(c)).globals.forEach(f=>{var g="$"+f;!db(e,g)&&b.getSignal(f)&&(e[g]=b.signalRef(f))}),{$expr:Mb({code:d.code},b.options.ast?{ast:c}:null),$fields:d.fields,$params:e}}const cT=ee(["rule"]),YG=ee(["group","image","rect"]);function kw(a){return(a+"").toLowerCase()}function lm(a,b,c){";"!==c[c.length-1]&&(c="return("+c+");");var d=Function.apply(null,b.concat(c));return a&&a.functions?d.bind(a.functions):d}var dT={operator:(a,b)=>lm(a,["_"],b.code),parameter:(a,b)=>lm(a,["datum","_"],b.code),event:(a,b)=>lm(a,["event"],b.code),handler:(a,b)=>lm(a,["_","event"],`var datum=event.item&&event.item.datum;return ${b.code};`),encode:(a,b)=>{const{marktype:c,channels:d}=b;let e="var o=item,datum=o.datum,m=0,$;";for(const f in d){const g="o["+Ga(f)+"]";e+=`$=${d[f].code};if(${g}!==$)${g}=$,m=1;`}return e+=function(f,g){let h="";return cT[g]||(f.x2&&(f.x?(YG[g]&&(h+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),h+="o.width=o.x2-o.x;"):h+="o.x=o.x2-(o.width||0);"),f.xc&&(h+="o.x=o.xc-(o.width||0)/2;"),f.y2&&(f.y?(YG[g]&&(h+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),h+="o.height=o.y2-o.y;"):h+="o.y=o.y2-(o.height||0);"),f.yc&&(h+="o.y=o.yc-(o.height||0)/2;")),h}(d,c),e+="return m;",lm(a,["item","_"],e)},codegen:{get(a){const b=`[${a.map(Ga).join("][")}]`,c=Function("_",`return _${b};`);return c.path=b,c},comparator(a,b){let c;const d=Function("a","b","var u, v; return "+a.map((e,f)=>{const g=b[f];let h,i;return e.path?(h="a"+e.path,i="b"+e.path):((c=c||{})["f"+f]=e,h=`this.f${f}(a)`,i=`this.f${f}(b)`),function(j,k,l,m){return`((u = ${j}) < (v = ${k}) || u == null) && v != null ? ${l}
  : (u > v || v == null) && u != null ? ${m}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${l}
  : v !== v && u === u ? ${m} : `}(h,i,-g,g)}).join("")+"0;");return c?d.bind(c):d}}};function ZG(a,b,c){if(!a||!ka(a))return a;for(let d,e=0,f=_G.length;e<f;++e)if(d=_G[e],db(a,d.key))return d.parse(a,b,c);return a}var _G=[{key:"$ref",parse:function(a,b){return b.get(a.$ref)||ja("Operator not defined: "+a.$ref)}},{key:"$key",parse:function(a,b){const c="k:"+a.$key+"_"+!!a.$flat;return b.fn[c]||(b.fn[c]=zy(a.$key,a.$flat,b.expr.codegen))}},{key:"$expr",parse:function(a,b,c){a.$params&&b.parseParameters(a.$params,c);const d="e:"+a.$expr.code+"_"+a.$name;return b.fn[d]||(b.fn[d]=Zb(b.parameterExpression(a.$expr),a.$fields,a.$name))}},{key:"$field",parse:function(a,b){if(!a.$field)return null;const c="f:"+a.$field+"_"+a.$name;return b.fn[c]||(b.fn[c]=ce(a.$field,a.$name,b.expr.codegen))}},{key:"$encode",parse:function(a,b){const c=a.$encode,d={};for(const e in c){const f=c[e];d[e]=Zb(b.encodeExpression(f.$expr),f.$fields),d[e].output=f.$output}return d}},{key:"$compare",parse:function(a,b){const c="c:"+a.$compare+"_"+a.$order,d=Ra(a.$compare).map(e=>e&&e.$tupleid?hb:e);return b.fn[c]||(b.fn[c]=Sk(d,a.$order,b.expr.codegen))}},{key:"$context",parse:function(a,b){return b}},{key:"$subflow",parse:function(a,b){const c=a.$subflow;return function(d,e,f){const g=b.fork().parse(c),h=g.get(c.operators[0].id),i=g.signals.parent;return i&&i.set(f),h.detachSubflow=()=>b.detach(g),h}}},{key:"$tupleid",parse:function(){return hb}}],eT={skip:!0};function $G(a,b,c,d){return new aH(a,b,c,d)}function aH(a,b,c,d){this.dataflow=a,this.transforms=b,this.events=a.events.bind(a),this.expr=d||dT,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},c&&(this.functions=Object.create(c),this.functions.context=this)}function bH(a){this.dataflow=a.dataflow,this.transforms=a.transforms,this.events=a.events,this.expr=a.expr,this.signals=Object.create(a.signals),this.scales=Object.create(a.scales),this.nodes=Object.create(a.nodes),this.data=Object.create(a.data),this.fn=Object.create(a.fn),a.functions&&(this.functions=Object.create(a.functions),this.functions.context=this)}aH.prototype=bH.prototype={fork(){const a=new bH(this);return(this.subcontext||(this.subcontext=[])).push(a),a},detach(a){this.subcontext=this.subcontext.filter(c=>c!==a);const b=Object.keys(a.nodes);for(const c of b)a.nodes[c]._targets=null;for(const c of b)a.nodes[c].detach();a.nodes=null},get(a){return this.nodes[a]},set(a,b){return this.nodes[a]=b},add(a,b){const c=this,d=c.dataflow,e=a.value;if(c.set(a.id,b),function(g){return"collect"===kw(g)}(a.type)&&e&&(e.$ingest?d.ingest(b,e.$ingest,e.$format):e.$request?d.preload(b,e.$request,e.$format):d.pulse(b,d.changeset().insert(e))),a.root&&(c.root=b),a.parent){var f=c.get(a.parent.$ref);f?(d.connect(f,[b]),b.targets().add(f)):(c.unresolved=c.unresolved||[]).push(()=>{f=c.get(a.parent.$ref),d.connect(f,[b]),b.targets().add(f)})}if(a.signal&&(c.signals[a.signal]=b),a.scale&&(c.scales[a.scale]=b),a.data)for(const g in a.data){const h=c.data[g]||(c.data[g]={});a.data[g].forEach(i=>h[i]=b)}},resolve(){return(this.unresolved||[]).forEach(a=>a()),delete this.unresolved,this},operator(a,b){this.add(a,this.dataflow.add(a.value,b))},transform(a,b){this.add(a,this.dataflow.add(this.transforms[kw(b)]))},stream(a,b){this.set(a.id,b)},update(a,b,c,d,e){this.dataflow.on(b,c,d,e,a.options)},operatorExpression(a){return this.expr.operator(this,a)},parameterExpression(a){return this.expr.parameter(this,a)},eventExpression(a){return this.expr.event(this,a)},handlerExpression(a){return this.expr.handler(this,a)},encodeExpression(a){return this.expr.encode(this,a)},parse:function(a){const b=this,c=a.operators||[];return a.background&&(b.background=a.background),a.eventConfig&&(b.eventConfig=a.eventConfig),a.locale&&(b.locale=a.locale),c.forEach(d=>b.parseOperator(d)),c.forEach(d=>b.parseOperatorParameters(d)),(a.streams||[]).forEach(d=>b.parseStream(d)),(a.updates||[]).forEach(d=>b.parseUpdate(d)),b.resolve()},parseOperator:function(a){const b=this;!function(c){return"operator"===kw(c)}(a.type)&&a.type?b.transform(a,a.type):b.operator(a,a.update?b.operatorExpression(a.update):null)},parseOperatorParameters:function(a){const b=this;if(a.params){const c=b.get(a.id);c||ja("Invalid operator id: "+a.id),b.dataflow.connect(c,c.parameters(b.parseParameters(a.params),a.react,a.initonly))}},parseParameters:function(a,b){b=b||{};const c=this;for(const d in a){const e=a[d];b[d]=U(e)?e.map(f=>ZG(f,c,b)):ZG(e,c,b)}return b},parseStream:function(a){var b,c=this,d=null!=a.filter?c.eventExpression(a.filter):void 0,e=null!=a.stream?c.get(a.stream):void 0;a.source?e=c.events(a.source,a.type,d):a.merge&&(e=(b=a.merge.map(f=>c.get(f)))[0].merge.apply(b[0],b.slice(1))),a.between&&(b=a.between.map(f=>c.get(f)),e=e.between(b[0],b[1])),a.filter&&(e=e.filter(d)),null!=a.throttle&&(e=e.throttle(+a.throttle)),null!=a.debounce&&(e=e.debounce(+a.debounce)),null==e&&ja("Invalid stream definition: "+JSON.stringify(a)),a.consume&&e.consume(!0),c.stream(a,e)},parseUpdate:function(a){var b,c=ka(c=a.source)?c.$ref:c,d=this.get(c),e=a.update,f=void 0;d||ja("Source not defined: "+a.source),b=a.target&&a.target.$expr?this.eventExpression(a.target.$expr):this.get(a.target),e&&e.$expr&&(e.$params&&(f=this.parseParameters(e.$params)),e=this.handlerExpression(e.$expr)),this.update(a,d,b,e,f)},getState:function(a){var b=this,c={};if(a.signals){var d=c.signals={};Object.keys(b.signals).forEach(f=>{var g=b.signals[f];a.signals(f,g)&&(d[f]=g.value)})}if(a.data){var e=c.data={};Object.keys(b.data).forEach(f=>{var g=b.data[f];a.data(f,g)&&(e[f]=g.input.value)})}return b.subcontext&&!1!==a.recurse&&(c.subcontext=b.subcontext.map(f=>f.getState(a))),c},setState:function(a){var b=this,c=b.dataflow,d=a.data,e=a.signals;Object.keys(e||{}).forEach(f=>{c.update(b.signals[f],e[f],eT)}),Object.keys(d||{}).forEach(f=>{c.pulse(b.data[f].input,c.changeset().remove(de).insert(d[f]))}),(a.subcontext||[]).forEach((f,g)=>{var h=b.subcontext[g];h&&h.setState(f)})}};var cH={skip:!0};function dH(a,b){var c=a.autosize(),d=a.padding();return b-(c&&"padding"===c.contains?d.left+d.right:0)}function eH(a,b){var c=a.autosize(),d=a.padding();return b-(c&&"padding"===c.contains?d.top+d.bottom:0)}function fT(a,b){return b.modified&&U(b.input.value)&&a.indexOf("_:vega:_")}function gT(a,b){return!("parent"===a||b instanceof Nj.proxy)}function hT(a,b,c,d){var e=a.element();e&&e.setAttribute("title",function(f){return null==f?"":U(f)?fH(f):ka(f)&&!Ci(f)?(g=f,Object.keys(g).map(function(h){var i=g[h];return h+": "+(U(i)?fH(i):gH(i))}).join(`
`)):f+"";var g}(d))}function fH(a){return"["+a.map(gH).join(", ")+"]"}function gH(a){return U(a)?"[]":ka(a)&&!Ci(a)?"{}":a}function hH(a,b){const c=this;if(b=b||{},Mj.call(c),b.loader&&c.loader(b.loader),b.logger&&c.logger(b.logger),null!=b.logLevel&&c.logLevel(b.logLevel),b.locale||a.locale){const f=Mb({},a.locale,b.locale);c.locale(Wz(f.number,f.time))}c._el=null,c._elBind=null,c._renderType=b.renderer||ci.Canvas,c._scenegraph=new nt();const d=c._scenegraph.root;c._renderer=null,c._tooltip=b.tooltip||hT,c._redraw=!0,c._handler=new yl().scene(d),c._globalCursor=!1,c._preventDefault=!1,c._timers=[],c._eventListeners=[],c._resizeListeners=[],c._eventConfig=function(f){const g=Mb({defaults:{}},f),h=(i,j)=>{j.forEach(k=>{U(i[k])&&(i[k]=ee(i[k]))})};return h(g.defaults,["prevent","allow"]),h(g,["view","window","selector"]),g}(a.eventConfig),c.globalCursor(c._eventConfig.globalCursor);const e=function(f,g,h){return $G(f,Nj,km,h).parse(g)}(c,a,b.expr);c._runtime=e,c._signals=e.signals,c._bind=(a.bindings||[]).map(f=>({state:null,param:Mb({},f)})),e.root&&e.root.set(d),d.source=e.data.root.input,c.pulse(e.data.root.input,c.changeset().insert(d.items)),c._width=c.width(),c._height=c.height(),c._viewWidth=dH(c,c._width),c._viewHeight=eH(c,c._height),c._origin=[0,0],c._resize=0,c._autosize=1,function(f){var g=f._signals,h=g.width,i=g.height,j=g.padding;function k(){f._autosize=f._resize=1}f._resizeWidth=f.add(null,function(m){f._width=m.size,f._viewWidth=dH(f,m.size),k()},{size:h}),f._resizeHeight=f.add(null,function(m){f._height=m.size,f._viewHeight=eH(f,m.size),k()},{size:i});var l=f.add(null,k,{pad:j});f._resizeWidth.rank=h.rank+1,f._resizeHeight.rank=i.rank+1,l.rank=j.rank+1}(c),function(f){f.add(null,g=>(f._background=g.bg,f._resize=1,g.bg),{bg:f._signals.background})}(c),function(f){const g=f._signals.cursor||(f._signals.cursor=f.add({user:"default",item:null}));f.on(f.events("view","mousemove"),g,function(h,i){const j=g.value,k=j?Xa(j)?j:j.user:"default",l=i.item&&i.item.cursor||null;return j&&k===j.user&&l==j.item?j:{user:k,item:l}}),f.add(null,function(h){let i=h.cursor,j=this.value;return Xa(i)||(j=i.item,i=i.user),Vv(f,i&&"default"!==i?i:j||i),j},{cursor:g})}(c),c.description(a.description),b.hover&&c.hover(),b.container&&c.initialize(b.container,b.bind)}var Fb=Da(hH,Mj);function Fp(a,b){return db(a._signals,b)?a._signals[b]:ja("Unrecognized signal name: "+Ga(b))}function iH(a,b){const c=(a._targets||[]).filter(d=>d._update&&d._update.handler===b);return c.length?c[0]:null}function jH(a,b,c,d){var e=iH(c,d);return e||((e=Wv(a,()=>d(b,c.value))).handler=d,a.on(c,null,e)),a}function kH(a,b,c){var d=iH(b,c);return d&&b._targets.remove(d),a}function iT(a){return ka(a)?a:{type:a||"pad"}}Fb.evaluate=async function(a,b,c){if(await Mj.prototype.evaluate.call(this,a,b),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(d){var e=wp(d),f=qG(d),g=rG(d);d._renderer.background(d.background()),d._renderer.resize(f,g,e),d._handler.origin(e),d._resizeListeners.forEach(function(h){try{h(f,g)}catch(i){d.error(i)}})}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(d){this.error(d)}return c&&cn(this,c),this},Fb.dirty=function(a){this._redraw=!0,this._renderer&&this._renderer.dirty(a)},Fb.description=function(a){if(arguments.length){const b=null!=a?a+"":null;return b!==this._desc&&pG(this._el,this._desc=b),this}return this._desc},Fb.container=function(){return this._el},Fb.scenegraph=function(){return this._scenegraph},Fb.origin=function(){return this._origin.slice()},Fb.signal=function(a,b,c){var d=Fp(this,a);return 1===arguments.length?d.value:this.update(d,b,c)},Fb.width=function(a){return arguments.length?this.signal("width",a):this.signal("width")},Fb.height=function(a){return arguments.length?this.signal("height",a):this.signal("height")},Fb.padding=function(a){return arguments.length?this.signal("padding",wG(a)):wG(this.signal("padding"))},Fb.autosize=function(a){return arguments.length?this.signal("autosize",a):this.signal("autosize")},Fb.background=function(a){return arguments.length?this.signal("background",a):this.signal("background")},Fb.renderer=function(a){return arguments.length?(wo(a)||ja("Unrecognized renderer type: "+a),a!==this._renderType&&(this._renderType=a,this._resetRenderer()),this):this._renderType},Fb.tooltip=function(a){return arguments.length?(a!==this._tooltip&&(this._tooltip=a,this._resetRenderer()),this):this._tooltip},Fb.loader=function(a){return arguments.length?(a!==this._loader&&(Mj.prototype.loader.call(this,a),this._resetRenderer()),this):this._loader},Fb.resize=function(){return this._autosize=1,this.touch(Fp(this,"autosize"))},Fb._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},Fb._resizeView=function(a,b,c,d,e,f){this.runAfter(function(g){var h=0;g._autosize=0,g.width()!==c&&(h=1,g.signal("width",c,cH),g._resizeWidth.skip(!0)),g.height()!==d&&(h=1,g.signal("height",d,cH),g._resizeHeight.skip(!0)),g._viewWidth!==a&&(g._resize=1,g._viewWidth=a),g._viewHeight!==b&&(g._resize=1,g._viewHeight=b),g._origin[0]===e[0]&&g._origin[1]===e[1]||(g._resize=1,g._origin=e),h&&g.run("enter"),f&&g.runAfter(i=>i.resize())},!1,1)},Fb.addEventListener=function(a,b,c){var d=b;return c&&!1===c.trap||((d=Wv(this,b)).raw=b),this._handler.on(a,d),this},Fb.removeEventListener=function(a,b){for(var c,d,e=this._handler.handlers(a),f=e.length;--f>=0;)if(d=e[f].type,c=e[f].handler,a===d&&(b===c||b===c.raw)){this._handler.off(d,c);break}return this},Fb.addResizeListener=function(a){var b=this._resizeListeners;return b.indexOf(a)<0&&b.push(a),this},Fb.removeResizeListener=function(a){var b=this._resizeListeners,c=b.indexOf(a);return c>=0&&b.splice(c,1),this},Fb.addSignalListener=function(a,b){return jH(this,a,Fp(this,a),b)},Fb.removeSignalListener=function(a,b){return kH(this,Fp(this,a),b)},Fb.addDataListener=function(a,b){return jH(this,a,up(this,a).values,b)},Fb.removeDataListener=function(a,b){return kH(this,up(this,a).values,b)},Fb.globalCursor=function(a){if(arguments.length){if(this._globalCursor!==!!a){const b=Vv(this,null);this._globalCursor=!!a,b&&Vv(this,b)}return this}return this._globalCursor},Fb.preventDefault=function(a){return arguments.length?(this._preventDefault=a,this):this._preventDefault},Fb.timer=function(a,b){this._timers.push(function(c,d,e){var f=new lp(),g=d;return null==d?(f.restart(c,d,e),f):(d=+d,e=null==e?kv():+e,f.restart(function h(i){i+=g,f.restart(h,g+=d,e),c(i)},d,e),f)}(function(c){a({timestamp:Date.now(),elapsed:c})},b))},Fb.events=function(a,b,c){var d,e=this,f=new gn(c),g=function(j,k){e.runAsync(null,()=>{"view"===a&&function(l,m){var n=l._eventConfig.defaults,o=n.prevent,p=n.allow;return!1!==o&&!0!==p&&(!0===o||!1===p||(o?o[m]:p?!p[m]:l.preventDefault()))}(e,b)&&j.preventDefault(),f.receive(yS(e,j,k))})};if("timer"===a)xp(e,"timer",b)&&e.timer(g,b);else if("view"===a)xp(e,"view",b)&&e.addEventListener(b,g,zS);else if("window"===a?xp(e,"window",b)&&"undefined"!=typeof window&&(d=[window]):"undefined"!=typeof document&&xp(e,"selector",b)&&(d=document.querySelectorAll(a)),d){for(var h=0,i=d.length;h<i;++h)d[h].addEventListener(b,g);e._eventListeners.push({type:b,sources:d,handler:g})}else e.warn("Can not resolve event source: "+a);return f},Fb.finalize=function(){var a,b,c,d=this._tooltip,e=this._timers,f=this._eventListeners;for(a=e.length;--a>=0;)e[a].stop();for(a=f.length;--a>=0;)for(b=(c=f[a]).sources.length;--b>=0;)c.sources[b].removeEventListener(c.type,c.handler);return d&&d.call(this,this._handler,null,null,null),this},Fb.hover=function(a,b){return b=[b||"update",(a=[a||"hover"])[0]],this.on(this.events("view","mouseover",sG),tG,uG(a)),this.on(this.events("view","mouseout",sG),tG,uG(b)),this},Fb.data=function(a,b){return arguments.length<2?up(this,a).values.value:vp.call(this,a,Ei().remove(de).insert(b))},Fb.change=vp,Fb.insert=function(a,b){return vp.call(this,a,Ei().insert(b))},Fb.remove=function(a,b){return vp.call(this,a,Ei().remove(b))},Fb.scale=function(a){var b=this._runtime.scales;return db(b,a)||ja("Unrecognized scale or projection: "+a),b[a].value},Fb.initialize=function(a,b){const c=this,d=c._renderType,e=c._eventConfig.bind,f=wo(d);a=c._el=a?Xv(c,a):null,function(i){const j=i.container();j&&(j.setAttribute("role","graphics-document"),j.setAttribute("aria-roleDescription","visualization"),pG(j,i.description()))}(c),f||c.error("Unrecognized renderer type: "+d);const g=f.handler||yl,h=a?f.renderer:f.headless;return c._renderer=h?vG(c,c._renderer,a,h):null,c._handler=function(i,j,k,l){var m=new l(i.loader(),Wv(i,i.tooltip())).scene(i.scenegraph().root).initialize(k,wp(i),i);return j&&j.handlers().forEach(function(n){m.on(n.type,n.handler)}),m}(c,c._handler,a,g),c._redraw=!0,a&&"none"!==e&&(b=b?c._elBind=Xv(c,b):a.appendChild(zf("form",{class:"vega-bindings"})),c._bind.forEach(function(i){i.param.element&&"container"!==e&&(i.element=Xv(c,i.param.element))}),c._bind.forEach(function(i){AS(c,i.element||b,i)})),c},Fb.toImageURL=async function(a,b){a!==ci.Canvas&&a!==ci.SVG&&a!==ci.PNG&&ja("Unrecognized image type: "+a);const c=await Yv(this,a,b);return a===ci.SVG?function(d,e){var f=new Blob([d],{type:e});return window.URL.createObjectURL(f)}(c.svg(),"image/svg+xml"):c.canvas().toDataURL("image/png")},Fb.toCanvas=async function(a,b){return(await Yv(this,ci.Canvas,a,b)).canvas()},Fb.toSVG=async function(a){return(await Yv(this,ci.SVG,a)).svg()},Fb.getState=function(a){return this._runtime.getState(a||{data:fT,signals:gT,recurse:!0})},Fb.setState=function(a){return this.runAsync(null,b=>{b._trigger=!1,b._runtime.setState(a)},b=>{b._trigger=!0}),this};const mm=a=>+a||0;function jT(a){return ka(a)?a.signal?a:{top:mm(a.top),bottom:mm(a.bottom),left:mm(a.left),right:mm(a.right)}:{top:b=mm(a),bottom:b,left:b,right:b};var b}const Yd=a=>ka(a)&&!U(a)?Mb({},a):{value:a};function lH(a,b,c,d){return null!=c?(ka(c)&&!U(c)?a.update[b]=c:a[d||"enter"][b]={value:c},1):0}function ke(a,b,c){for(const d in b)lH(a,d,b[d]);for(const d in c)lH(a,d,c[d],"update")}function tk(a,b,c){for(const d in b)c&&db(c,d)||(a[d]=Mb(a[d]||{},b[d]));return a}function uk(a,b){return b&&(b.enter&&b.enter[a]||b.update&&b.update[a])}function lw(a,b,c){a[b]=c&&c.signal?{signal:c.signal}:{value:c}}const mH=a=>Xa(a)?Ga(a):a.signal?`(${a.signal})`:nH(a);function Gp(a){if(null!=a.gradient)return function(c){const d=[c.start,c.stop,c.count].map(e=>null==e?null:Ga(e));for(;d.length&&null==Ha(d);)d.pop();return d.unshift(mH(c.gradient)),`gradient(${d.join(",")})`}(a);let b=a.signal?`(${a.signal})`:a.color?function(c){return c.c?Hp("hcl",c.h,c.c,c.l):c.h||c.s?Hp("hsl",c.h,c.s,c.l):c.l||c.a?Hp("lab",c.l,c.a,c.b):c.r||c.g||c.b?Hp("rgb",c.r,c.g,c.b):null}(a.color):null!=a.field?nH(a.field):void 0!==a.value?Ga(a.value):void 0;return null!=a.scale&&(b=function(c,d){const e=mH(c.scale);return null!=c.range?d=`lerp(_range(${e}), ${+c.range})`:(void 0!==d&&(d=`_scale(${e}, ${d})`),c.band&&(d=(d?d+"+":"")+`_bandwidth(${e})`+(1==+c.band?"":"*"+Ip(c.band)),c.extra&&(d=`(datum.extra ? _scale(${e}, datum.extra.value) : ${d})`)),null==d&&(d="0")),d}(a,b)),void 0===b&&(b=null),null!=a.exponent&&(b=`pow(${b},${Ip(a.exponent)})`),null!=a.mult&&(b+="*"+Ip(a.mult)),null!=a.offset&&(b+="+"+Ip(a.offset)),a.round&&(b=`round(${b})`),b}const Hp=(a,b,c,d)=>`(${a}(${[b,c,d].map(Gp).join(",")})+'')`;function Ip(a){return ka(a)?"("+Gp(a)+")":a}function nH(a){return function b(c){let d,e,f;if(c.signal)d="datum",f=c.signal;else if(c.group||c.parent){for(e=Math.max(1,c.level||1),d="item";e-- >0;)d+=".mark.group";c.parent?(f=c.parent,d+=".datum"):f=c.group}else c.datum?(d="datum",f=c.datum):ja("Invalid field reference: "+Ga(c));return c.signal||(f=Xa(f)?$e(f).map(Ga).join("]["):b(f)),d+"["+f+"]"}(ka(a)?a:{datum:a})}function oH(a,b,c,d,e,f){const g={};(f=f||{}).encoders={$encode:g},a=function(h,i,j,k,l){const m={},n={};let o,p,q,s;for(p in(p="lineBreak","text"!==i||null==l[p]||uk(p,h)||lw(m,p,l[p]),("legend"==j||String(j).startsWith("axis"))&&(j=null),s="frame"===j?l.group:"mark"===j?Mb({},l.mark,l[i]):null,s))q=uk(p,h)||("fill"===p||"stroke"===p)&&(uk("fill",h)||uk("stroke",h)),q||lw(m,p,s[p]);for(p in(Ra(k).forEach(r=>{const u=l.style&&l.style[r];for(const t in u)uk(t,h)||lw(m,t,u[t])}),h=Mb({},h),m))s=m[p],s.signal?(o=o||{})[p]=s:n[p]=s;return h.enter=Mb(n,h.enter),o&&(h.update=Mb(o,h.update)),h}(a,b,c,d,e.config);for(const h in a)g[h]=kT(a[h],b,f,e);return f}function kT(a,b,c,d){const e={},f={};for(const h in a)null!=a[h]&&(e[h]=lT((g=a[h],U(g)?function(i){let j="";return i.forEach(k=>{const l=Gp(k);j+=k.test?`(${k.test})?${l}:`:l}),":"===Ha(j)&&(j+="null"),j}(g):Gp(g)),d,c,f));var g;return{$expr:{marktype:b,channels:e},$fields:Object.keys(f),$output:Object.keys(a)}}function lT(a,b,c,d){const e=Og(a,b);return e.$fields.forEach(f=>d[f]=1),Mb(c,e.$params),e.$expr}var mT=["value","update","init","react","bind"];function pH(a,b){ja(a+' for "outer" push: '+Ga(b))}function qH(a,b){var c=a.name;if("outer"===a.push)b.signals[c]||pH("No prior signal definition",c),mT.forEach(function(e){void 0!==a[e]&&pH("Invalid property ",e)});else{var d=b.addSignal(c,a.value);!1===a.react&&(d.react=!1),a.bind&&b.addBinding(c,a.bind)}}function mw(a,b,c,d){this.id=-1,this.type=a,this.value=b,this.params=c,d&&(this.parent=d)}function Jp(a,b,c,d){return new mw(a,b,c,d)}function Kp(a,b){return Jp("operator",a,b)}function jb(a){var b={$ref:a.id};return a.id<0&&(a.refs=a.refs||[]).push(b),b}function nm(a,b){return b?{$field:a,$name:b}:{$field:a}}var nw=nm("key");function rH(a,b){return{$compare:a,$order:b}}function Lp(a,b){return(a&&a.signal?"$"+a.signal:a||"")+(a&&b?"_":"")+(b&&b.signal?"$"+b.signal:b||"")}function Zd(a){return a&&a.signal}function om(a){if(Zd(a))return!0;if(ka(a)){for(var b in a)if(om(a[b]))return!0}return!1}function lg(a,b){return null!=a?a:b}function fj(a){return a&&a.signal||a}function pm(a,b){return(a.merge?nT:a.stream?oT:a.type?pT:ja("Invalid stream specification: "+Ga(a)))(a,b)}function nT(a,b){var c=ow({merge:a.merge.map(d=>pm(d,b))},a,b);return b.addStream(c).id}function oT(a,b){var c=ow({stream:pm(a.stream,b)},a,b);return b.addStream(c).id}function pT(a,b){var c,d;return"timer"===a.type?(c=b.event("timer",a.throttle),a={between:a.between,filter:a.filter}):c=b.event(function(e){return"scope"===e?"view":e||"view"}(a.source),a.type),d=ow({stream:c},a,b),1===Object.keys(d).length?c:b.addStream(d).id}function ow(a,b,c){var d=b.between;return d&&(2!==d.length&&ja('Stream "between" parameter must have 2 entries: '+Ga(b)),a.between=[pm(d[0],c),pm(d[1],c)]),d=b.filter?[].concat(b.filter):[],(b.marktype||b.markname||b.markrole)&&d.push(function(e,f,g){var h="event.item";return h+(e&&"*"!==e?"&&"+h+".mark.marktype==='"+e+"'":"")+(g?"&&"+h+".mark.role==='"+g+"'":"")+(f?"&&"+h+".mark.name==='"+f+"'":"")}(b.marktype,b.markname,b.markrole)),"scope"===b.source&&d.push("inScope(event.item)"),d.length&&(a.filter=Og("("+d.join(")&&(")+")",c).$expr),null!=(d=b.throttle)&&(a.throttle=+d),null!=(d=b.debounce)&&(a.debounce=+d),b.consume&&(a.consume=!0),a}function gj(a,b,c){return sH=b||qT,tH=c||sT,uH(a.trim()).map(pw)}var sH,tH,qT="view",rT=/[[\]{}]/,sT={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function qm(a,b,c,d,e){for(var f,g=0,h=a.length;b<h;++b){if(f=a[b],!g&&f===c)return b;e&&e.indexOf(f)>=0?--g:d&&d.indexOf(f)>=0&&++g}return b}function uH(a){for(var b=[],c=0,d=a.length,e=0;e<d;)e=qm(a,e,",","[{","]}"),b.push(a.substring(c,e).trim()),c=++e;if(0===b.length)throw"Empty event selector: "+a;return b}function pw(a){return"["===a[0]?function(b){var c,d,e=b.length,f=1;if((f=qm(b,f,"]","[","]"))===e)throw"Empty between selector: "+b;if(2!==(c=uH(b.substring(1,f))).length)throw"Between selector must have two elements: "+b;if(">"!==(b=b.slice(f+1).trim())[0])throw"Expected '>' after between selector: "+b;return(c=c.map(pw),(d=pw(b.slice(1).trim())).between)?{between:c,stream:d}:(d.between=c,d)}(a):function(b){var c,d,e={source:sH},f=[],g=[0,0],h=0,i=0,j=b.length,k=0;if("}"===b[j-1]){if(!((k=b.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+b;try{g=function(l){var m=l.split(",");if(!l.length||m.length>2)throw l;return m.map(function(n){var o=+n;if(o!=o)throw l;return o})}(b.substring(k+1,j-1))}catch(l){throw"Invalid throttle specification: "+b}b=b.slice(0,k).trim(),j=b.length,k=0}if(!j)throw b;"@"===b[0]&&(h=++k),(c=qm(b,k,":"))<j&&(f.push(b.substring(i,c).trim()),i=k=++c);if((k=qm(b,k,"["))===j)f.push(b.substring(i,j).trim());else if(f.push(b.substring(i,k).trim()),d=[],(i=++k)===j)throw"Unmatched left bracket: "+b;for(;k<j;){if((k=qm(b,k,"]"))===j)throw"Unmatched left bracket: "+b;if(d.push(b.substring(i,k).trim()),k<j-1&&"["!==b[++k])throw"Expected left bracket: "+b;i=++k}if(!(j=f.length)||rT.test(f[j-1]))throw"Invalid event selector: "+b;return j>1?(e.type=f[1],h?e.markname=f[0].slice(1):function(l){return tH[l]}(f[0])?e.marktype=f[0]:e.source=f[0]):e.type=f[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=d&&(e.filter=d),g[0]&&(e.throttle=g[0]),g[1]&&(e.debounce=g[1]),e}(a)}const tT={code:"_.$value",ast:{type:"Identifier",value:"value"}};function uT(a,b,c){var d=a.events,e=a.update,f=a.encode,g=[],h={target:c};d||ja("Signal update missing events specification."),Xa(d)&&(d=gj(d,b.isSubscope()?"scope":"view")),d=Ra(d).filter(i=>i.signal||i.scale?(g.push(i),0):1),g.length>1&&(g=[vT(g)]),d.length&&g.push(d.length>1?{merge:d}:d[0]),null!=f&&(e&&ja("Signal encode and update are mutually exclusive."),e="encode(item(),"+Ga(f)+")"),h.update=Xa(e)?Og(e,b):null!=e.expr?Og(e.expr,b):null!=e.value?e.value:null!=e.signal?{$expr:tT,$params:{$value:b.signalRef(e.signal)}}:ja("Invalid signal update specification."),a.force&&(h.options={force:!0}),g.forEach(function(i){b.addUpdate(Mb(function(j,k){return{source:j.signal?k.signalRef(j.signal):j.scale?k.scaleRef(j.scale):pm(j,k)}}(i,b),h))})}function vT(a){return{signal:"["+a.map(b=>b.scale?'scale("'+b.scale+'")':b.signal)+"]"}}const Sc=a=>(b,c,d)=>Jp(a,c,b||void 0,d);var vH=Sc("aggregate"),wT=Sc("axisticks"),wH=Sc("bound"),mg=Sc("collect"),xH=Sc("compare"),xT=Sc("datajoin"),yH=Sc("encode"),yT=Sc("expression"),zT=Sc("facet"),AT=Sc("field"),BT=Sc("key"),CT=Sc("legendentries"),DT=Sc("load"),ET=Sc("mark"),FT=Sc("multiextent"),GT=Sc("multivalues"),HT=Sc("overlap"),IT=Sc("params"),zH=Sc("prefacet"),JT=Sc("projection"),KT=Sc("proxy"),LT=Sc("relay"),AH=Sc("render"),MT=Sc("scale"),hj=Sc("sieve"),NT=Sc("sortitems"),BH=Sc("viewlayout"),OT=Sc("values"),PT=0,CH={min:"min",max:"max",count:"sum"};function QT(a,b){var c,d=b.getScale(a.name).params;for(c in(d.domain=DH(a.domain,a,b),null!=a.range&&(d.range=function e(f,g,h){var i=f.range,j=g.config.range;if(i.signal)return g.signalRef(i.signal);if(Xa(i)){if(j&&db(j,i))return f=Mb({},f,{range:j[i]}),e(f,g,h);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=ck(f.type)?[0,{signal:"height"}]:[{signal:"height"},0]:ja("Unrecognized scale range value: "+Ga(i))}else{if(i.scheme)return h.scheme=U(i.scheme)?Mp(i.scheme,g):Qf(i.scheme,g),i.extent&&(h.schemeExtent=Mp(i.extent,g)),void(i.count&&(h.schemeCount=Qf(i.count,g)));if(i.step)return void(h.rangeStep=Qf(i.step,g));if(ck(f.type)&&!U(i))return DH(i,f,g);U(i)||ja("Unsupported range type: "+Ga(i))}return i.map(k=>(U(k)?Mp:Qf)(k,g))}(a,b,d)),null!=a.interpolate&&function(e,f){f.interpolate=Qf(e.type||e),null!=e.gamma&&(f.interpolateGamma=Qf(e.gamma))}(a.interpolate,d),null!=a.nice&&(d.nice=function(e){return ka(e)?{interval:Qf(e.interval),step:Qf(e.step)}:Qf(e)}(a.nice)),null!=a.bins&&(d.bins=function(e,f){return e.signal||U(e)?Mp(e,f):f.objectProperty(e)}(a.bins,b)),a))db(d,c)||"name"===c||(d[c]=Qf(a[c],b))}function Qf(a,b){return ka(a)?a.signal?b.signalRef(a.signal):ja("Unsupported object: "+Ga(a)):a}function Mp(a,b){return a.signal?b.signalRef(a.signal):a.map(c=>Qf(c,b))}function Np(a){ja("Can not find data set: "+Ga(a))}function DH(a,b,c){if(a)return a.signal?c.signalRef(a.signal):(U(a)?RT:a.fields?TT:ST)(a,b,c);null==b.domainMin&&null==b.domainMax||ja("No scale domain defined for domainMin/domainMax to override.")}function RT(a,b,c){return a.map(function(d){return Qf(d,c)})}function ST(a,b,c){var d=c.getData(a.data);return d||Np(a.data),ck(b.type)?d.valuesRef(c,a.field,EH(a.sort,!1)):aD(b.type)?d.domainRef(c,a.field):d.extentRef(c,a.field)}function TT(a,b,c){var d=a.data,e=a.fields.reduce(function(f,g){return g=Xa(g)?{data:d,field:g}:U(g)||g.signal?function(h,i){var j="_:vega:_"+PT++,k=mg({});if(U(h))k.value={$ingest:h};else if(h.signal){var l="setdata("+Ga(j)+","+h.signal+")";k.params.input=i.signalRef(l)}return i.addDataPipeline(j,[k,hj({})]),{data:j,field:"data"}}(g,c):g,f.push(g),f},[]);return(ck(b.type)?UT:aD(b.type)?VT:WT)(a,c,e)}function UT(a,b,c){var d,e,f,g,h,i=EH(a.sort,!0);return d=c.map(function(j){var k=b.getData(j.data);return k||Np(j.data),k.countsRef(b,j.field,i)}),e={groupby:nw,pulse:d},i&&(f=i.op||"count",h=i.field?Lp(f,i.field):"count",e.ops=[CH[f]],e.fields=[b.fieldRef(h)],e.as=[h]),f=b.add(vH(e)),g=b.add(mg({pulse:jb(f)})),h=b.add(OT({field:nw,sort:b.sortRef(i),pulse:jb(g)})),jb(h)}function EH(a,b){return a&&(a.field||a.op?a.field||"count"===a.op?b&&a.field&&a.op&&!CH[a.op]&&ja("Multiple domain scales can not be sorted using "+a.op):ja("No field provided for sort aggregate op: "+a.op):ka(a)?a.field="key":a={field:"key"}),a}function VT(a,b,c){var d=c.map(function(e){var f=b.getData(e.data);return f||Np(e.data),f.domainRef(b,e.field)});return jb(b.add(GT({values:d})))}function WT(a,b,c){var d=c.map(function(e){var f=b.getData(e.data);return f||Np(e.data),f.extentRef(b,e.field)});return jb(b.add(FT({extents:d})))}function qw(a,b,c){return U(a)?a.map(function(d){return qw(d,b,c)}):ka(a)?a.signal?c.signalRef(a.signal):"fit"===b?a:ja("Unsupported parameter object: "+Ga(a)):a}const Rf="value",rw=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],rm={name:1,style:1,interactive:1},pc={value:0},Sf={value:1};function sm(a){return a.type="group",a.interactive=a.interactive||!1,a}function mf(a,b){const c=(d,e)=>lg(a[d],lg(b[d],e));return c.isVertical=d=>"vertical"===lg(a.direction,b.direction||(d?b.symbolDirection:b.gradientDirection)),c.gradientLength=()=>lg(a.gradientLength,b.gradientLength||b.gradientWidth),c.gradientThickness=()=>lg(a.gradientThickness,b.gradientThickness||b.gradientHeight),c.entryColumns=()=>lg(a.columns,lg(b.columns,+c.isVertical(!0))),c}function FH(a,b){var c=b&&(b.update&&b.update[a]||b.enter&&b.enter[a]);return c&&c.signal?c:c?c.value:null}function Op(a,b,c){return`item.anchor === 'start' ? ${a} : item.anchor === 'end' ? ${b} : ${c}`}const sw=Op(Ga("left"),Ga("right"),Ga("center"));function GH(a,b){return b?a?ka(a)?Object.assign({},a,{offset:GH(a.offset,b)}):{value:a,offset:b}:b:a}function Af(a,b){return b?(a.name=b.name,a.style=b.style||a.style,a.interactive=!!b.interactive,a.encode=tk(a.encode,b,rm)):a.interactive=!1,a}function XT(a,b,c,d){var e,f,g,h,i,j,k=mf(a,c),l=k.isVertical(),m=k.gradientThickness(),n=k.gradientLength();return l?(g=[0,1],h=[0,0],i=m,j=n):(g=[0,0],h=[1,0],i=n,j=m),ke(e={enter:f={opacity:pc,x:pc,y:pc,width:Yd(i),height:Yd(j)},update:Mb({},f,{opacity:Sf,fill:{gradient:b,start:g,stop:h}}),exit:{opacity:pc}},{stroke:k("gradientStrokeColor"),strokeWidth:k("gradientStrokeWidth")},{opacity:k("gradientOpacity")}),Af({type:"rect",role:"legend-gradient",encode:e},d)}function YT(a,b,c,d,e){var f,g,h,i,j,k,l=mf(a,c),m=l.isVertical(),n=l.gradientThickness(),o=l.gradientLength(),p="";return m?(h="y",j="y2",i="x",k="width",p="1-"):(h="x",j="x2",i="y",k="height"),(g={opacity:pc,fill:{scale:b,field:Rf}})[h]={signal:p+"datum.perc",mult:o},g[i]=pc,g[j]={signal:p+"datum.perc2",mult:o},g[k]=Yd(n),ke(f={enter:g,update:Mb({},g,{opacity:Sf}),exit:{opacity:pc}},{stroke:l("gradientStrokeColor"),strokeWidth:l("gradientStrokeWidth")},{opacity:l("gradientOpacity")}),Af({type:"rect",role:"legend-band",key:Rf,from:e,encode:f},d)}function HH(a,b,c,d){var e,f,g,h,i,j=mf(a,b),k=j.isVertical(),l=Yd(j.gradientThickness()),m=j.gradientLength(),n=j("labelOverlap"),o="";return ke(e={enter:f={opacity:pc},update:g={opacity:Sf,text:{field:"label"}},exit:{opacity:pc}},{fill:j("labelColor"),fillOpacity:j("labelOpacity"),font:j("labelFont"),fontSize:j("labelFontSize"),fontStyle:j("labelFontStyle"),fontWeight:j("labelFontWeight"),limit:lg(a.labelLimit,b.gradientLabelLimit)}),k?(f.align={value:"left"},f.baseline=g.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},h="y",i="x",o="1-"):(f.align=g.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},f.baseline={value:"top"},h="x",i="y"),f[h]=g[h]={signal:o+"datum.perc",mult:m},f[i]=g[i]=l,l.offset=lg(a.labelOffset,b.gradientLabelOffset)||0,n=n?{separation:j("labelSeparation"),method:n,order:"datum.index"}:void 0,Af({type:"text",role:"legend-label",style:"guide-label",key:Rf,from:d,encode:e,overlap:n},c)}function ZT(a,b,c,d,e){var f,g,h,i,j,k,l,m=mf(a,b),n=c.entries,o=!(!n||!n.interactive),p=n?n.name:void 0,q=m("clipHeight"),s=m("symbolOffset"),r={data:"value"},u={},t=`(${e}) ? datum.offset : datum.size`,w=q?Yd(q):{field:"size"},x="datum.index",z=`max(1, ${e})`;w.mult=.5,u={enter:f={opacity:pc,x:{signal:t,mult:.5,offset:s},y:w},update:g={opacity:Sf,x:f.x,y:f.y},exit:{opacity:pc}};var A=null,B=null;return a.fill||(A=b.symbolBaseFillColor,B=b.symbolBaseStrokeColor),ke(u,{fill:m("symbolFillColor",A),shape:m("symbolType"),size:m("symbolSize"),stroke:m("symbolStrokeColor",B),strokeDash:m("symbolDash"),strokeDashOffset:m("symbolDashOffset"),strokeWidth:m("symbolStrokeWidth")},{opacity:m("symbolOpacity")}),rw.forEach(function(I){a[I]&&(g[I]=f[I]={scale:a[I],field:Rf})}),i=Af({type:"symbol",role:"legend-symbol",key:Rf,from:r,clip:!!q||void 0,encode:u},c.symbols),(h=Yd(s)).offset=m("labelOffset"),ke(u={enter:f={opacity:pc,x:{signal:t,offset:h},y:w},update:g={opacity:Sf,text:{field:"label"},x:f.x,y:f.y},exit:{opacity:pc}},{align:m("labelAlign"),baseline:m("labelBaseline"),fill:m("labelColor"),fillOpacity:m("labelOpacity"),font:m("labelFont"),fontSize:m("labelFontSize"),fontStyle:m("labelFontStyle"),fontWeight:m("labelFontWeight"),limit:m("labelLimit")}),j=Af({type:"text",role:"legend-label",style:"guide-label",key:Rf,from:r,encode:u},c.labels),u={enter:{noBound:{value:!q},width:pc,height:q?Yd(q):pc,opacity:pc},exit:{opacity:pc},update:g={opacity:Sf,row:{signal:null},column:{signal:null}}},m.isVertical(!0)?(k=`ceil(item.mark.items.length / ${z})`,g.row.signal=`${x}%${k}`,g.column.signal=`floor(${x} / ${k})`,l={field:["row",x]}):(g.row.signal=`floor(${x} / ${z})`,g.column.signal=`${x} % ${z}`,l={field:x}),g.column.signal=`(${e})?${g.column.signal}:${x}`,sm({role:"scope",from:d={facet:{data:d,name:"value",groupby:"index"}},encode:tk(u,n,rm),marks:[i,j],name:p,interactive:o,sort:l})}const tw='item.orient === "left"',uw='item.orient === "right"',Pp=`(${tw} || ${uw})`,_T="datum.vgrad && "+Pp,$T=Op('"top"','"bottom"','"middle"'),aU=`datum.vgrad && ${uw} ? (${Op('"right"','"left"','"center"')}) : (${Pp} && !(datum.vgrad && ${tw})) ? "left" : ${sw}`,bU=`item._anchor || (${Pp} ? "middle" : "start")`,cU=`${_T} ? (${tw} ? -90 : 90) : 0`,dU=`${Pp} ? (datum.vgrad ? (${uw} ? "bottom" : "top") : ${$T}) : "top"`;function eU(a,b){var c;return ka(a)&&(a.signal?c=a.signal:a.path?c="pathShape("+IH(a.path)+")":a.sphere&&(c="geoShape("+IH(a.sphere)+', {type: "Sphere"})')),c?b.signalRef(c):!!a}function IH(a){return ka(a)&&a.signal?a.signal:Ga(a)}function JH(a){var b=a.role||"";return b.indexOf("axis")&&b.indexOf("legend")&&b.indexOf("title")?"group"===a.type?"scope":b||"mark":b}function fU(a){return{marktype:a.type,name:a.name||void 0,role:a.role||JH(a),zindex:+a.zindex||void 0,aria:a.aria,description:a.description}}function gU(a,b){return a&&a.signal?b.signalRef(a.signal):!1!==a}function vw(a,b){var c=$z(a.type);c||ja("Unrecognized transform type: "+Ga(a.type));var d=Jp(c.type.toLowerCase(),null,KH(c,a,b));return a.signal&&b.addSignal(a.signal,b.proxy(d)),d.metadata=c.metadata||{},d}function KH(a,b,c){var d,e,f,g={};for(e=0,f=a.params.length;e<f;++e)g[(d=a.params[e]).name]=hU(d,b,c);return g}function hU(a,b,c){var d=a.type,e=b[a.name];return"index"===d?function(f,g,h){return Xa(g.from)||ja('Lookup "from" parameter must be a string literal.'),h.getData(g.from).lookupRef(h,g.key)}(0,b,c):void 0!==e?"param"===d?function(f,g,h){var i=g[f.name];return f.array?(U(i)||ja("Expected an array of sub-parameters. Instead: "+Ga(i)),i.map(function(j){return MH(f,j,h)})):MH(f,i,h)}(a,b,c):"projection"===d?c.projectionRef(b[a.name]):a.array&&!Zd(e)?e.map(function(f){return LH(a,f,c)}):LH(a,e,c):void(a.required&&ja("Missing required "+Ga(b.type)+" parameter: "+Ga(a.name)))}function LH(a,b,c){var d=a.type;if(Zd(b))return NH(d)?ja("Expression references can not be signals."):ww(d)?c.fieldRef(b):OH(d)?c.compareRef(b):c.signalRef(b.signal);var e,f=a.expr||ww(d);return f&&((e=b)&&e.expr)?c.exprRef(b.expr,b.as):f&&function(g){return g&&g.field}(b)?nm(b.field,b.as):NH(d)?Og(b,c):function(g){return"data"===g}(d)?jb(c.getData(b).values):ww(d)?nm(b):OH(d)?c.compareRef(b):b}function MH(a,b,c){var d,e,f,g,h;for(g=0,h=a.params.length;g<h;++g){for(f in(e=a.params[g]).key)if(e.key[f]!==b[f]){e=null;break}if(e)break}return e||ja("Unsupported parameter: "+Ga(b)),d=Mb(KH(e,b,c),e.key),jb(c.add(IT(d)))}function NH(a){return"expr"===a}function ww(a){return"field"===a}function OH(a){return"compare"===a}function Qp(a,b){return a.$ref?a:a.data&&a.data.$ref?a.data:jb(b.getData(a.data).output)}function ij(a,b,c,d,e){this.scope=a,this.input=b,this.output=c,this.values=d,this.aggregate=e,this.index={}}ij.fromEntries=function(a,b){var c=b.length,d=1,e=b[0],f=b[c-1],g=b[c-2],h=null;for(e&&"load"===e.type&&(e=b[1]),a.add(b[0]);d<c;++d)b[d].params.pulse=jb(b[d-1]),a.add(b[d]),"aggregate"===b[d].type&&(h=b[d]);return new ij(a,e,g,f,h)};var jj=ij.prototype;function PH(a){return Xa(a)?a:null}function QH(a,b,c){var d,e=Lp(c.op,c.field);if(b.ops){for(var f=0,g=b.as.length;f<g;++f)if(b.as[f]===e)return}else b.ops=["count"],b.fields=[null],b.as=["count"];c.op&&(b.ops.push((d=c.op.signal)?a.signalRef(d):c.op),b.fields.push(a.fieldRef(c.field)),b.as.push(e))}function tm(a,b,c,d,e,f,g){var h,i,j=b[c]||(b[c]={}),k=function(n){return ka(n)?("descending"===n.order?"-":"+")+Lp(n.op,n.field):""}(f),l=PH(e);if(null!=l&&(a=b.scope,h=j[l+=k?"|"+k:""]),!h){var m=f?{field:nw,pulse:b.countsRef(a,e,f)}:{field:a.fieldRef(e),pulse:jb(b.output)};k&&(m.sort=a.sortRef(f)),i=a.add(Jp(d,void 0,m)),g&&(b.index[e]=i),h=jb(i),null!=l&&(j[l]=h)}return h}function RH(a,b,c){var d,e=a.remove,f=a.insert,g=a.toggle,h=a.modify,i=a.values,j=b.add(Kp());d=Og("if("+a.trigger+',modify("'+c+'",'+[f,e,g,h,i].map(function(k){return null==k?"null":k}).join(",")+"),0)",b),j.update=d.$expr,j.params=d.$params}function Rp(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=JH(a),s="group"===a.type,r=a.from&&a.from.facet,u=a.layout||"scope"===q||"frame"===q,t="mark"===q||u||r,w=a.overlap;e=function(x,z,A){var B,I,J,D,O;return x?(B=x.facet)&&(z||ja("Only group marks can be faceted."),null!=B.field?D=O=Qp(B,A):(x.data?O=jb(A.getData(x.data).aggregate):((J=vw(Mb({type:"aggregate",groupby:Ra(B.groupby)},B.aggregate),A)).params.key=A.keyRef(B.groupby),J.params.pulse=Qp(B,A),D=O=jb(A.add(J))),I=A.keyRef(B.groupby,!0))):D=jb(A.add(mg(null,[{}]))),D||(D=Qp(x,A)),{key:I,pulse:D,parent:O}}(a.from,s,b),l=jb(d=b.add(xT({key:e.key||(a.key?nm(a.key):void 0),pulse:e.pulse,clean:!s}))),d=f=b.add(mg({pulse:l})),d=b.add(ET({markdef:fU(a),interactive:gU(a.interactive,b),clip:eU(a.clip,b),context:{$context:!0},groups:b.lookup(),parent:b.signals.parent?b.signalRef("parent"):null,index:b.markpath(),pulse:jb(d)})),m=jb(d),(d=g=b.add(yH(oH(a.encode,a.type,q,a.style,b,{mod:!1,pulse:m})))).params.parent=b.encode(),a.transform&&a.transform.forEach(function(x){const z=vw(x,b),A=z.metadata;(A.generates||A.changes)&&ja("Mark transforms should not generate new data."),A.nomod||(g.params.mod=!0),z.params.pulse=jb(d),b.add(d=z)}),a.sort&&(d=b.add(NT({sort:b.compareRef(a.sort),pulse:jb(d)}))),n=jb(d),(r||u)&&(o=jb(u=b.add(BH({layout:b.objectProperty(a.layout),legends:b.legends,mark:m,pulse:n})))),p=jb(h=b.add(wH({mark:m,pulse:o||n}))),s&&(t&&((c=b.operators).pop(),u&&c.pop()),b.pushState(n,o||p,l),r?function(x,z,A){var B,I,J,D,O=x.from.facet,K=O.name,Q=Qp(O,z);O.name||ja("Facet must have a name: "+Ga(O)),O.data||ja("Facet must reference a data set: "+Ga(O)),O.field?D=z.add(zH({field:z.fieldRef(O.field),pulse:Q})):O.groupby?D=z.add(zT({key:z.keyRef(O.groupby),group:jb(z.proxy(A.parent)),pulse:Q})):ja("Facet must specify groupby or field: "+Ga(O)),I=(B=z.fork()).add(mg()),J=B.add(hj({pulse:jb(I)})),B.addData(K,new ij(B,I,I,J)),B.addSignal("parent",null),D.params.subflow={$subflow:B.parse(x).toRuntime()}}(a,b,e):t?function(x,z,A){var B=z.add(zH({pulse:A.pulse})),I=z.fork();I.add(hj()),I.addSignal("parent",null),B.params.subflow={$subflow:I.parse(x).toRuntime()}}(a,b,e):b.parse(a),b.popState(),t&&(u&&c.push(u),c.push(h))),w&&(p=function(x,z,A){var B,I=x.method,J=x.bound,D=x.separation,O={separation:Zd(D)?A.signalRef(D.signal):D,method:Zd(I)?A.signalRef(I.signal):I,pulse:z};return x.order&&(O.sort=A.compareRef({field:x.order})),J&&(B=J.tolerance,O.boundTolerance=Zd(B)?A.signalRef(B.signal):+B,O.boundScale=A.scaleRef(J.scale),O.boundOrient=J.orient),jb(A.add(HT(O)))}(w,p,b)),i=b.add(AH({pulse:p})),j=b.add(hj({pulse:jb(i)},void 0,b.parent())),null!=a.name&&(k=a.name,b.addData(k,new ij(b,f,i,j)),a.on&&a.on.forEach(function(x){(x.insert||x.remove||x.toggle)&&ja("Marks only support modify triggers."),RH(x,b,k)}))}function iU(a,b){var c,d,e,f,g,h,i,j,k=b.config.legend,l=a.encode||{},m=l.legend||{},n=m.name||void 0,o=m.interactive,p=m.style,q=mf(a,k),s={},r=0;return rw.forEach(u=>a[u]?(s[u]=a[u],r=r||a[u]):0),r||ja("Missing valid scale for legend."),g=function(u,t){var w=u.type||"symbol";return u.type||1!==function(x){return rw.reduce(function(z,A){return z+(x[A]?1:0)},0)}(u)||!u.fill&&!u.stroke||(w=Zt(t)?"gradient":_t(t)?"discrete":"symbol"),"gradient"!==w?w:_t(t)?"discrete":"gradient"}(a,b.scaleType(r)),h={title:null!=a.title,scales:s,type:g,vgrad:"symbol"!==g&&q.isVertical()},i=jb(b.add(mg(null,[h]))),m=tk(function(u,t,w){var x={enter:{},update:{}};return ke(x,{orient:u("orient"),offset:u("offset"),padding:u("padding"),titlePadding:u("titlePadding"),cornerRadius:u("cornerRadius"),fill:u("fillColor"),stroke:u("strokeColor"),strokeWidth:w.strokeWidth,strokeDash:w.strokeDash,x:u("legendX"),y:u("legendY"),format:t.format,formatType:t.formatType}),x}(q,a,k),m,rm),c={enter:{x:{value:0},y:{value:0}}},j=jb(b.add(CT(e={type:g,scale:b.scaleRef(r),count:b.objectProperty(q("tickCount")),limit:b.property(q("symbolLimit")),values:b.objectProperty(a.values),minstep:b.property(a.tickMinStep),formatType:b.property(a.formatType),formatSpecifier:b.property(a.format)}))),"gradient"===g?(f=[XT(a,r,k,l.gradient),HH(a,k,l.labels,j)],e.count=e.count||b.signalRef(`max(2,2*floor((${fj(q.gradientLength())})/100))`)):"discrete"===g?f=[YT(a,r,k,l.gradient,j),HH(a,k,l.labels,j)]:(d=function(u,t){const w=mf(u,t);return{align:w("gridAlign"),columns:w.entryColumns(),center:{row:!0,column:!1},padding:{row:w("rowPadding"),column:w("columnPadding")}}}(a,k),f=[ZT(a,k,l,j,fj(d.columns))],e.size=function(u,t,w){var x=fj(SH("size",u,w)),z=fj(SH("strokeWidth",u,w)),A=fj(function(B,I,J){return FH("fontSize",B)||function(D,O,K){var Q=O.config.style[K];return Q&&Q[D]}("fontSize",I,J)}(w[1].encode,t,"guide-label"));return Og(`max(ceil(sqrt(${x})+${z}),${A})`,t)}(a,b,f[0].marks)),f=[sm({role:"legend-entry",from:i,encode:c,marks:f,layout:d,interactive:o})],h.title&&f.push(function(u,t,w,x){var z,A=mf(u,t);return ke(z={enter:{opacity:pc},update:{opacity:Sf,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:pc}},{orient:A("titleOrient"),_anchor:A("titleAnchor"),anchor:{signal:bU},angle:{signal:cU},align:{signal:aU},baseline:{signal:dU},text:u.title,fill:A("titleColor"),fillOpacity:A("titleOpacity"),font:A("titleFont"),fontSize:A("titleFontSize"),fontStyle:A("titleFontStyle"),fontWeight:A("titleFontWeight"),limit:A("titleLimit"),lineHeight:A("titleLineHeight")},{align:A("titleAlign"),baseline:A("titleBaseline")}),Af({type:"text",role:"legend-title",style:"guide-title",from:x,encode:z},w)}(a,k,l.title,i)),Rp(sm({role:"legend",from:i,encode:m,marks:f,aria:q("aria"),description:q("description"),zindex:q("zindex"),name:n,interactive:o,style:p}),b)}function SH(a,b,c){return b[a]?`scale("${b[a]}",datum)`:FH(a,c[0].encode)}jj.countsRef=function(a,b,c){var d,e,f,g=this.counts||(this.counts={}),h=PH(b);return null!=h&&(a=this.scope,d=g[h]),d?c&&c.field&&QH(a,d.agg.params,c):(f={groupby:a.fieldRef(b,"key"),pulse:jb(this.output)},c&&c.field&&QH(a,f,c),e=a.add(vH(f)),d=a.add(mg({pulse:jb(e)})),d={agg:e,ref:jb(d)},null!=h&&(g[h]=d)),d.ref},jj.tuplesRef=function(){return jb(this.values)},jj.extentRef=function(a,b){return tm(a,this,"extent","extent",b,!1)},jj.domainRef=function(a,b){return tm(a,this,"domain","values",b,!1)},jj.valuesRef=function(a,b,c){return tm(a,this,"vals","values",b,c||!0)},jj.lookupRef=function(a,b){return tm(a,this,"lookup","tupleindex",b,!1)},jj.indataRef=function(a,b){return tm(a,this,"indata","tupleindex",b,!0,!0)};function jU(a,b){var c,d,e=mf(a=Xa(a)?{text:a}:a,b.config.title),f=a.encode||{},g=f.group||{},h=g.name||void 0,i=g.interactive,j=g.style,k=[];return c={},d=jb(b.add(mg(null,[c]))),k.push(function(l,m,n,o){var p={value:0},q=l.text,s={enter:{opacity:p},update:{opacity:{value:1}},exit:{opacity:p}};return ke(s,{text:q,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:m("dx"),dy:m("dy"),fill:m("color"),font:m("font"),fontSize:m("fontSize"),fontStyle:m("fontStyle"),fontWeight:m("fontWeight"),lineHeight:m("lineHeight")},{align:m("align"),angle:m("angle"),baseline:m("baseline")}),Af({type:"text",role:"title-text",style:"group-title",from:o,encode:s},n)}(a,e,function(l){const m=l.encode;return m&&m.title||Mb({name:l.name,interactive:l.interactive,style:l.style},m)}(a),d)),a.subtitle&&k.push(function(l,m,n,o){var p={value:0},q=l.subtitle,s={enter:{opacity:p},update:{opacity:{value:1}},exit:{opacity:p}};return ke(s,{text:q,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:m("dx"),dy:m("dy"),fill:m("subtitleColor"),font:m("subtitleFont"),fontSize:m("subtitleFontSize"),fontStyle:m("subtitleFontStyle"),fontWeight:m("subtitleFontWeight"),lineHeight:m("subtitleLineHeight")},{align:m("align"),angle:m("angle"),baseline:m("baseline")}),Af({type:"text",role:"title-subtitle",style:"group-subtitle",from:o,encode:s},n)}(a,e,f.subtitle,d)),Rp(sm({role:"title",from:d,encode:kU(e,g),marks:k,aria:e("aria"),description:e("description"),zindex:e("zindex"),name:h,interactive:i,style:j}),b)}function kU(a,b){var c={enter:{},update:{}};return ke(c,{orient:a("orient"),anchor:a("anchor"),align:{signal:sw},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:a("limit"),frame:a("frame"),offset:a("offset")||0,padding:a("subtitlePadding")}),tk(c,b,rm)}function lU(a,b){var c=[];a.transform&&a.transform.forEach(function(d){c.push(vw(d,b))}),a.on&&a.on.forEach(function(d){RH(d,b,a.name)}),b.addDataPipeline(a.name,function(d,e,f){var g,h,i,j,k,l=[],m=null,n=!1,o=!1;for(d.values?om(d.values)||om(d.format)?(l.push(TH(e,d)),l.push(m=kj())):l.push(m=kj({$ingest:d.values,$format:d.format})):d.url?om(d.url)||om(d.format)?(l.push(TH(e,d)),l.push(m=kj())):l.push(m=kj({$request:d.url,$format:d.format})):d.source&&(m=g=Ra(d.source).map(function(p){return jb(e.getData(p).output)}),l.push(null)),h=0,i=f.length;h<i;++h)j=f[h],k=j.metadata,m||k.source||l.push(m=kj()),l.push(j),k.generates&&(o=!0),k.modifies&&!o&&(n=!0),k.source?m=j:k.changes&&(m=null);return g&&(i=g.length-1,l[0]=LT({derive:n,pulse:i?g:g[0]}),(n||i)&&l.splice(1,0,kj())),m||l.push(kj()),l.push(hj({})),l}(a,b,c))}function kj(a){var b=mg({},a);return b.metadata={source:!0},b}function TH(a,b){return DT({url:b.url?a.property(b.url):void 0,async:b.async?a.property(b.async):void 0,values:b.values?a.property(b.values):void 0,format:a.objectProperty(b.format)})}const UH=a=>"bottom"===a||"top"===a,Sp=(a,b,c)=>Zd(a)?oU(a.signal,b,c):"left"===a||"top"===a?b:c,_d=(a,b,c)=>Zd(a)?mU(a.signal,b,c):UH(a)?b:c,ng=(a,b,c)=>Zd(a)?nU(a.signal,b,c):UH(a)?c:b,VH=(a,b,c)=>Zd(a)?pU(a.signal,b,c):"top"===a?{value:b}:{value:c},mU=(a,b,c)=>WH(`${a} === 'top' || ${a} === 'bottom'`,b,c),nU=(a,b,c)=>WH(`${a} !== 'top' && ${a} !== 'bottom'`,b,c),oU=(a,b,c)=>xw(`${a} === 'left' || ${a} === 'top'`,b,c),pU=(a,b,c)=>xw(a+" === 'top'",b,c),qU=(a,b,c)=>xw(a+" === 'right'",b,c),WH=(a,b,c)=>(b=null!=b?Yd(b):b,c=null!=c?Yd(c):c,XH(b)&&XH(c)?{signal:`${a} ? (${b=b?b.signal||Ga(b.value):null}) : (${c=c?c.signal||Ga(c.value):null})`}:[Mb({test:a},b)].concat(c||[])),XH=a=>null==a||1===Object.keys(a).length,xw=(a,b,c)=>({signal:`${a} ? (${vk(b)}) : (${vk(c)})`}),rU=(a,b,c,d,e)=>({signal:(null!=d?`${a} === 'left' ? (${vk(d)}) : `:"")+(null!=c?`${a} === 'bottom' ? (${vk(c)}) : `:"")+(null!=e?`${a} === 'right' ? (${vk(e)}) : `:"")+(null!=b?`${a} === 'top' ? (${vk(b)}) : `:"")+"(null)"}),vk=a=>Zd(a)?a.signal:null==a?null:Ga(a),wk=(a,b)=>{const c=a.signal;return c&&c.endsWith("(null)")?{signal:c.slice(0,-6)+b.signal}:a};function xk(a,b,c,d){let e;if(b&&db(b,a))return b[a];if(db(c,a))return c[a];if(a.startsWith("title")){switch(a){case"titleColor":e="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":e=a[5].toLowerCase()+a.slice(6)}return d["guide-title"][e]}if(a.startsWith("label")){switch(a){case"labelColor":e="fill";break;case"labelFont":case"labelFontSize":e=a[5].toLowerCase()+a.slice(6)}return d["guide-label"][e]}return null}function YH(a){const b={};for(const c of a)if(c)for(const d in c)b[d]=1;return Object.keys(b)}function ZH(a,b){return{scale:a.scale,range:b}}function sU(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=mf(a,b),o=a.orient,p=a.gridScale,q=Sp(o,1,-1),s=function(r,u){if(!(1===u))if(ka(r)){let t=r=Mb({},r);for(;null!=t.mult;){if(!ka(t.mult))return t.mult=Zd(u)?{signal:`(${t.mult}) * (${u.signal})`}:t.mult*u,r;t=t.mult=Mb({},t.mult)}t.mult=u}else r=Zd(u)?{signal:`(${u.signal}) * (${r||0})`}:u*(r||0);return r}(a.offset,q);return ke(f={enter:g={opacity:pc},update:i={opacity:Sf},exit:h={opacity:pc}},{stroke:n("gridColor"),strokeCap:n("gridCap"),strokeDash:n("gridDash"),strokeDashOffset:n("gridDashOffset"),strokeOpacity:n("gridOpacity"),strokeWidth:n("gridWidth")}),j={scale:a.scale,field:Rf,band:e.band,extra:e.extra,offset:e.offset,round:n("tickRound")},m=_d(o,{signal:"height"},{signal:"width"}),k=p?{scale:p,range:0,mult:q,offset:s}:{value:0,offset:s},l=p?{scale:p,range:1,mult:q,offset:s}:Mb(m,{mult:q,offset:s}),g.x=i.x=_d(o,j,k),g.y=i.y=ng(o,j,k),g.x2=i.x2=ng(o,l),g.y2=i.y2=_d(o,l),h.x=_d(o,j),h.y=ng(o,j),Af({type:"rule",role:"axis-grid",key:Rf,from:d,encode:f},c)}function yw(a,b,c,d,e){return{signal:'flush(range("'+a+'"), scale("'+a+'", datum.value), '+b+","+c+","+d+","+e+")"}}function tU(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=mf(a,b),s=a.orient,r=a.scale,u=Sp(s,-1,1),t=fj(q("labelFlush")),w=fj(q("labelFlushOffset")),x=0===t||!!t,z=q("labelAlign"),A=q("labelBaseline");return(j=Yd(e)).mult=u,j.offset=Yd(q("labelPadding")||0),j.offset.mult=u,k={scale:r,field:Rf,band:.5,offset:GH(f.offset,q("labelOffset"))},l=_d(s,x?yw(r,t,'"left"','"right"','"center"'):{value:"center"},((B,I,J)=>Zd(B)?qU(B.signal,I,J):"right"===B?{value:I}:{value:J})(s,"left","right")),m=_d(s,VH(s,"bottom","top"),x?yw(r,t,'"top"','"bottom"','"middle"'):{value:"middle"}),p=yw(r,t,`-(${w})`,w,0),x=x&&w,ke(g={enter:h={opacity:pc,x:_d(s,k,j),y:ng(s,k,j)},update:i={opacity:Sf,text:{field:"label"},x:h.x,y:h.y,align:l,baseline:m},exit:{opacity:pc,x:h.x,y:h.y}},{dx:!z&&x?_d(s,p):null,dy:!A&&x?ng(s,p):null}),ke(g,{angle:q("labelAngle"),fill:q("labelColor"),fillOpacity:q("labelOpacity"),font:q("labelFont"),fontSize:q("labelFontSize"),fontWeight:q("labelFontWeight"),fontStyle:q("labelFontStyle"),limit:q("labelLimit"),lineHeight:q("labelLineHeight")},{align:z,baseline:A}),n=q("labelBound"),o=(o=q("labelOverlap"))||n?{separation:q("labelSeparation"),method:o,order:"datum.index",bound:n?{scale:r,orient:s,tolerance:n}:null}:void 0,i.align!==l&&(i.align=wk(i.align,l)),i.baseline!==m&&(i.baseline=wk(i.baseline,m)),Af({type:"text",role:"axis-label",style:"guide-label",key:Rf,from:d,encode:g,overlap:o},c)}function uU(a,b,c,d){var e,f,g,h,i=mf(a,b),j=a.orient,k=Sp(j,-1,1);return e={enter:f={opacity:pc,anchor:Yd(i("titleAnchor",null)),align:{signal:sw}},update:g=Mb({},f,{opacity:Sf,text:Yd(a.title)}),exit:{opacity:pc}},h={signal:`lerp(range("${a.scale}"), ${Op(0,1,.5)})`},g.x=_d(j,h),g.y=ng(j,h),f.angle=_d(j,pc,((l,m)=>0===m?0:Zd(l)?{signal:`(${l.signal}) * ${m}`}:{value:l*m})(k,90)),f.baseline=_d(j,VH(j,"bottom","top"),{value:"bottom"}),g.angle=f.angle,g.baseline=f.baseline,ke(e,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(l,m,n,o){const p=(r,u)=>null!=r?(n.update[u]=wk(Yd(r),n.update[u]),!1):!uk(u,o),q=p(l("titleX"),"x"),s=p(l("titleY"),"y");n.enter.auto=s===q?Yd(s):_d(m,Yd(s),Yd(q))}(i,j,e,c),e.update.align=wk(e.update.align,f.align),e.update.angle=wk(e.update.angle,f.angle),e.update.baseline=wk(e.update.baseline,f.baseline),Af({type:"text",role:"axis-title",style:"guide-title",from:d,encode:e},c)}function vU(a,b){var c,d,e,f,g,h=function(p,q){var s,r,u,t=q.config,w=t.style,x=t.axis,z="band"===q.scaleType(p.scale)&&t.axisBand,A=p.orient;if(Zd(A)){const B=YH([t.axisX,t.axisY]),I=YH([t.axisTop,t.axisBottom,t.axisLeft,t.axisRight]);for(u of(s={},B))s[u]=_d(A,xk(u,t.axisX,x,w),xk(u,t.axisY,x,w));for(u of(r={},I))r[u]=rU(A.signal,xk(u,t.axisTop,x,w),xk(u,t.axisBottom,x,w),xk(u,t.axisLeft,x,w),xk(u,t.axisRight,x,w))}else s="top"===A||"bottom"===A?t.axisX:t.axisY,r=t["axis"+A[0].toUpperCase()+A.slice(1)];return s||r||z?Mb({},x,s,r,z):x}(a,b),i=a.encode||{},j=i.axis||{},k=j.name||void 0,l=j.interactive,m=j.style,n=mf(a,h),o=function(p){let q,s,r=p("tickBand"),u=p("tickOffset");return r?r.signal?(q={signal:`(${r.signal}) === 'extent' ? 1 : 0.5`},s={signal:`(${r.signal}) === 'extent'`},ka(u)||(u={signal:`(${r.signal}) === 'extent' ? 0 : ${u}`})):"extent"===r?(q=1,s=!0,u=0):(q=.5,s=!1):(q=p("bandPosition"),s=p("tickExtra")),{extra:s,band:q,offset:u}}(n);return c={scale:a.scale,ticks:!!n("ticks"),labels:!!n("labels"),grid:!!n("grid"),domain:!!n("domain"),title:null!=a.title},d=jb(b.add(mg({},[c]))),j=tk(function(p,q){var s={enter:{},update:{}};return ke(s,{orient:p("orient"),offset:p("offset")||0,position:lg(q.position,0),titlePadding:p("titlePadding"),minExtent:p("minExtent"),maxExtent:p("maxExtent"),range:{signal:`abs(span(range("${q.scale}")))`},translate:p("translate"),format:q.format,formatType:q.formatType}),s}(n,a),j,rm),e=jb(b.add(wT({scale:b.scaleRef(a.scale),extra:b.property(o.extra),count:b.objectProperty(a.tickCount),values:b.objectProperty(a.values),minstep:b.property(a.tickMinStep),formatType:b.property(a.formatType),formatSpecifier:b.property(a.format)}))),g=[],c.grid&&g.push(sU(a,h,i.grid,e,o)),c.ticks&&(f=n("tickSize"),g.push(function(p,q,s,r,u,t){var w,x,z,A,B,I,J=mf(p,q),D=p.orient,O=Sp(D,-1,1);return ke(w={enter:x={opacity:pc},update:A={opacity:Sf},exit:z={opacity:pc}},{stroke:J("tickColor"),strokeCap:J("tickCap"),strokeDash:J("tickDash"),strokeDashOffset:J("tickDashOffset"),strokeOpacity:J("tickOpacity"),strokeWidth:J("tickWidth")}),(B=Yd(u)).mult=O,I={scale:p.scale,field:Rf,band:t.band,extra:t.extra,offset:t.offset,round:J("tickRound")},A.y=x.y=_d(D,pc,I),A.y2=x.y2=_d(D,B),z.x=_d(D,I),A.x=x.x=ng(D,pc,I),A.x2=x.x2=ng(D,B),z.y=ng(D,I),Af({type:"rule",role:"axis-tick",key:Rf,from:r,encode:w},s)}(a,h,i.ticks,e,f,o))),c.labels&&(f=c.ticks?f:0,g.push(tU(a,h,i.labels,e,f,o))),c.domain&&g.push(function(p,q,s,r){var u,t,w,x=mf(p,q),z=p.orient;ke(u={enter:t={opacity:pc},update:w={opacity:Sf},exit:{opacity:pc}},{stroke:x("domainColor"),strokeCap:x("domainCap"),strokeDash:x("domainDash"),strokeDashOffset:x("domainDashOffset"),strokeWidth:x("domainWidth"),strokeOpacity:x("domainOpacity")});const A=ZH(p,0),B=ZH(p,1);return t.x=w.x=_d(z,A,pc),t.x2=w.x2=_d(z,B),t.y=w.y=ng(z,A,pc),t.y2=w.y2=ng(z,B),Af({type:"rule",role:"axis-domain",from:r,encode:u},s)}(a,h,i.domain,d)),c.title&&g.push(uU(a,h,i.title,d)),Rp(sm({role:"axis",from:d,encode:j,marks:g,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:k,interactive:l,style:m}),b)}function _H(a,b,c){var d=Ra(a.signals),e=Ra(a.scales);return c||d.forEach(f=>qH(f,b)),Ra(a.projections).forEach(f=>function(g,h){var i=h.config.projection||{},j={};for(var k in g)"name"!==k&&(j[k]=qw(g[k],k,h));for(k in i)null==j[k]&&(j[k]=qw(i[k],k,h));h.addProjection(g.name,j)}(f,b)),e.forEach(f=>function(g,h){var i=g.type||"linear";ZC(i)||ja("Unrecognized scale type: "+Ga(i)),h.addScale(g.name,{type:i,domain:void 0})}(f,b)),Ra(a.data).forEach(f=>lU(f,b)),e.forEach(f=>QT(f,b)),(c||d).forEach(f=>function(g,h){var i=h.getSignal(g.name),j=g.update;g.init&&(j?ja("Signals can not include both init and update expressions."):(j=g.init,i.initonly=!0)),j&&(j=Og(j,h),i.update=j.$expr,i.params=j.$params),g.on&&g.on.forEach(function(k){uT(k,h,i.id)})}(f,b)),Ra(a.axes).forEach(f=>vU(f,b)),Ra(a.marks).forEach(f=>Rp(f,b)),Ra(a.legends).forEach(f=>iU(f,b)),a.title&&jU(a.title,b),b.parseLambdas(),b}function wU(a,b){const c=b.config,d=jb(b.root=b.add(Kp())),e=function(j,k){const l=p=>lg(j[p],k[p]),m=[um("background",l("background")),um("autosize",iT(l("autosize"))),um("padding",jT(l("padding"))),um("width",l("width")||0),um("height",l("height")||0)],n=m.reduce((p,q)=>(p[q.name]=q,p),{}),o={};return Ra(j.signals).forEach(p=>{db(n,p.name)?p=Mb(n[p.name],p):m.push(p),o[p.name]=p}),Ra(k.signals).forEach(p=>{db(o,p.name)||db(n,p.name)||m.push(p)}),m}(a,c);e.forEach(j=>qH(j,b)),b.description=a.description||c.description,b.eventConfig=c.events,b.legends=b.objectProperty(c.legend&&c.legend.layout),b.locale=c.locale;const f=b.add(mg()),g=b.add(yH(oH((j=>tk({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},j))(a.encode),"group","frame",a.style,b,{pulse:jb(f)}))),h=b.add(BH({layout:b.objectProperty(a.layout),legends:b.legends,autosize:b.signalRef("autosize"),mark:d,pulse:jb(g)}));b.operators.pop(),b.pushState(jb(g),jb(h),null),_H(a,b,e),b.operators.push(h);let i=b.add(wH({mark:d,pulse:jb(h)}));return i=b.add(AH({pulse:jb(i)})),i=b.add(hj({pulse:jb(i)})),b.addData("root",new ij(b,f,f,i)),b}function um(a,b){return b&&b.signal?{name:a,update:b.signal}:{name:a,value:b}}function $H(a,b){this.config=a||{},this.options=b||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function aI(a){this.config=a.config,this.options=a.options,this.legends=a.legends,this.field=Object.create(a.field),this.signals=Object.create(a.signals),this.lambdas=Object.create(a.lambdas),this.scales=Object.create(a.scales),this.events=Object.create(a.events),this.data=Object.create(a.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++a._nextsub[0],this._nextsub=a._nextsub,this._parent=a._parent.slice(),this._encode=a._encode.slice(),this._lookup=a._lookup.slice(),this._markpath=a._markpath}var Vb=$H.prototype=aI.prototype;function zw(a){return(U(a)?xU:yU)(a)}function xU(a){for(var b,c="[",d=0,e=a.length;d<e;++d)c+=(d>0?",":"")+(ka(b=a[d])?b.signal||zw(b):Ga(b));return c+"]"}function yU(a){var b,c,d="{",e=0;for(b in a)c=a[b],d+=(++e>1?",":"")+Ga(b)+":"+(ka(c)?c.signal||zw(c):Ga(c));return d+"}"}Vb.parse=function(a){return _H(a,this)},Vb.fork=function(){return new aI(this)},Vb.isSubscope=function(){return this._subid>0},Vb.toRuntime=function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},Vb.id=function(){return(this._subid?this._subid+":":0)+this._id++},Vb.add=function(a){return this.operators.push(a),a.id=this.id(),a.refs&&(a.refs.forEach(function(b){b.$ref=a.id}),a.refs=null),a},Vb.proxy=function(a){var b=a instanceof mw?jb(a):a;return this.add(KT({value:b}))},Vb.addStream=function(a){return this.streams.push(a),a.id=this.id(),a},Vb.addUpdate=function(a){return this.updates.push(a),a},Vb.finish=function(){var a,b;for(a in(this.root&&(this.root.root=!0),this.signals))this.signals[a].signal=a;for(a in this.scales)this.scales[a].scale=a;function c(e,f,g){var h;e&&((h=e.data||(e.data={}))[f]||(h[f]=[])).push(g)}for(a in this.data)for(var d in(c((b=this.data[a]).input,a,"input"),c(b.output,a,"output"),c(b.values,a,"values"),b.index))c(b.index[d],a,"index:"+d);return this},Vb.pushState=function(a,b,c){this._encode.push(jb(this.add(hj({pulse:a})))),this._parent.push(b),this._lookup.push(c?jb(this.proxy(c)):null),this._markpath.push(-1)},Vb.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},Vb.parent=function(){return Ha(this._parent)},Vb.encode=function(){return Ha(this._encode)},Vb.lookup=function(){return Ha(this._lookup)},Vb.markpath=function(){var a=this._markpath;return++a[a.length-1]},Vb.fieldRef=function(a,b){if(Xa(a))return nm(a,b);a.signal||ja("Unsupported field reference: "+Ga(a));var c,d=a.signal,e=this.field[d];return e||(c={name:this.signalRef(d)},b&&(c.as=b),this.field[d]=e=jb(this.add(AT(c)))),e},Vb.compareRef=function(a){function b(g){return Zd(g)?(d=!0,c.signalRef(g.signal)):function(h){return h&&h.expr}(g)?(d=!0,c.exprRef(g.expr)):g}var c=this,d=!1,e=Ra(a.field).map(b),f=Ra(a.order).map(b);return d?jb(this.add(xH({fields:e,orders:f}))):rH(e,f)},Vb.keyRef=function(a,b){var c=this.signals,d=!1;return a=Ra(a).map(function(e){return Zd(e)?(d=!0,jb(c[e.signal])):e}),d?jb(this.add(BT({fields:a,flat:b}))):function(e,f){var g={$key:e};return f&&(g.$flat=!0),g}(a,b)},Vb.sortRef=function(a){if(!a)return a;var b=Lp(a.op,a.field),c=a.order||"ascending";return c.signal?jb(this.add(xH({fields:b,orders:this.signalRef(c.signal)}))):rH(b,c)},Vb.event=function(a,b){var c=a+":"+b;if(!this.events[c]){var d=this.id();this.streams.push({id:d,source:a,type:b}),this.events[c]=d}return this.events[c]},Vb.hasOwnSignal=function(a){return db(this.signals,a)},Vb.addSignal=function(a,b){this.hasOwnSignal(a)&&ja("Duplicate signal name: "+Ga(a));var c=b instanceof mw?b:this.add(Kp(b));return this.signals[a]=c},Vb.getSignal=function(a){return this.signals[a]||ja("Unrecognized signal name: "+Ga(a)),this.signals[a]},Vb.signalRef=function(a){return this.signals[a]?jb(this.signals[a]):(db(this.lambdas,a)||(this.lambdas[a]=this.add(Kp(null))),jb(this.lambdas[a]))},Vb.parseLambdas=function(){for(var a=Object.keys(this.lambdas),b=0,c=a.length;b<c;++b){var d=a[b],e=Og(d,this),f=this.lambdas[d];f.params=e.$params,f.update=e.$expr}},Vb.property=function(a){return a&&a.signal?this.signalRef(a.signal):a},Vb.objectProperty=function(a){return a&&ka(a)?this.signalRef(a.signal||zw(a)):a},Vb.exprRef=function(a,b){var c={expr:Og(a,this)};return b&&(c.expr.$name=b),jb(this.add(yT(c)))},Vb.addBinding=function(a,b){this.bindings||ja("Nested signals do not support binding: "+Ga(a)),this.bindings.push(Mb({signal:a},b))},Vb.addScaleProj=function(a,b){db(this.scales,a)&&ja("Duplicate scale or projection name: "+Ga(a)),this.scales[a]=this.add(b)},Vb.addScale=function(a,b){this.addScaleProj(a,MT(b))},Vb.addProjection=function(a,b){this.addScaleProj(a,JT(b))},Vb.getScale=function(a){return this.scales[a]||ja("Unrecognized scale name: "+Ga(a)),this.scales[a]},Vb.projectionRef=Vb.scaleRef=function(a){return jb(this.getScale(a))},Vb.projectionType=Vb.scaleType=function(a){return this.getScale(a).params.type},Vb.addData=function(a,b){return db(this.data,a)&&ja("Duplicate data set name: "+Ga(a)),this.data[a]=b},Vb.getData=function(a){return this.data[a]||ja("Undefined data set name: "+Ga(a)),this.data[a]},Vb.addDataPipeline=function(a,b){return db(this.data,a)&&ja("Duplicate data set name: "+Ga(a)),this.addData(a,ij.fromEntries(this,b))},Vc(Nj,pO,oQ,yQ,lR,DR,_R,$R,mS,uS,xS);var zU=Object.freeze({__proto__:null,version:"5.13.0",Dataflow:Mj,EventStream:gn,Parameters:fn,Pulse:Qh,MultiPulse:Kr,Operator:Zc,Transform:ia,changeset:Ei,ingest:Ac,isTuple:dn,definition:$z,transform:aA,transforms:Nj,tupleid:hb,scale:wc,scheme:au,interpolate:$t,interpolateColors:uo,interpolateRange:bD,quantizeInterpolator:cD,projection:cv,View:hH,formatLocale:pn,timeFormatLocale:dl,locale:Wz,defaultLocale:Ir,resetDefaultLocale:function(){return fz(),Uz(),Ir()},expressionFunction:Xd,parse:function(a,b,c){return ka(a)||ja("Input Vega specification must be an object."),wU(a,new $H(b=Wa({description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:"#4c78a8"},area:{fill:"#4c78a8"},image:null,line:{stroke:"#4c78a8",strokeWidth:2},path:{stroke:"#4c78a8"},rect:{fill:"#4c78a8"},rule:{stroke:"#000"},shape:{stroke:"#4c78a8"},symbol:{fill:"#4c78a8",size:64},text:{fill:"#000",font:"sans-serif",fontSize:11},trail:{fill:"#4c78a8",size:2},style:{"guide-label":{fill:"#000",font:"sans-serif",fontSize:10},"guide-title":{fill:"#000",font:"sans-serif",fontSize:11,fontWeight:"bold"},"group-title":{fill:"#000",font:"sans-serif",fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:"#000",font:"sans-serif",fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:"#888",titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},b,a.config),c)).toRuntime()},runtimeContext:$G,bandwidthNRD:Rr,bin:gA,bootstrapCI:hA,dotbin:iA,quantiles:Pr,quartiles:Qr,get random(){return If},setRandom:function(a){If=a},randomLCG:function(a){return function(){return(a=(1103515245*a+12345)%2147483647)/2147483647}},randomInteger:function(a,b){null==b&&(b=a,a=0);var c,d,e,f={};return f.min=function(g){return arguments.length?(e=d-(c=g||0),f):c},f.max=function(g){return arguments.length?(e=(d=g||0)-c,f):d},f.sample=function(){return c+Math.floor(e*If())},f.pdf=function(g){return g===Math.floor(g)&&g>=c&&g<d?1/e:0},f.cdf=function(g){var h=Math.floor(g);return h<c?0:h>=d?1:(h-c+1)/e},f.icdf=function(g){return g>=0&&g<=1?c-1+Math.floor(g*e):NaN},f.min(a).max(b)},randomKDE:Ur,randomLogNormal:kA,sampleLogNormal:Vr,densityLogNormal:Wr,cumulativeLogNormal:Xr,quantileLogNormal:Yr,randomMixture:lA,randomNormal:Tr,sampleNormal:wn,densityNormal:Sr,cumulativeNormal:xn,quantileNormal:yn,randomUniform:mA,sampleUniform:Zr,densityUniform:_r,cumulativeUniform:$r,quantileUniform:as,regressionLinear:bs,regressionLog:nA,regressionExp:oA,regressionPow:pA,regressionQuad:cs,regressionPoly:qA,regressionLoess:rA,sampleCurve:An,TIME_UNITS:mr,YEAR:Je,QUARTER:bf,MONTH:cf,WEEK:Od,DATE:tf,DAY:Ff,DAYOFYEAR:"dayofyear",HOURS:Gf,MINUTES:uf,SECONDS:Hf,MILLISECONDS:"milliseconds",timeUnitSpecifier:hz,timeUnits:or,dayofyear:mz,week:nz,utcdayofyear:pz,utcweek:qz,timeFloor:tz,utcFloor:uz,timeInterval:Jj,timeOffset:wz,timeSequence:zz,utcInterval:Kj,utcOffset:xz,utcSequence:Az,timeBin:Ez,accessor:Pb,accessorName:function(a){return null==a?null:a.fname},accessorFields:ec,id:bb,identity:$a,zero:Qb,one:Xb,truthy:wd,falsy:Lc,logger:function(a,b){var c=a||0;return{level:function(d){return arguments.length?(c=+d,this):c},error:function(){return c>=1&&qc(b||"error","ERROR",arguments),this},warn:function(){return c>=2&&qc(b||"warn","WARN",arguments),this},info:function(){return c>=3&&qc(b||"log","INFO",arguments),this},debug:function(){return c>=4&&qc(b||"log","DEBUG",arguments),this}}},None:0,Error:1,Warn:2,Info:3,Debug:4,mergeConfig:function(...a){return a.reduce((b,c)=>{for(var d in c)if("signals"===d)b.signals=dd(b.signals,c.signals);else{var e="legend"===d?{layout:1}:"style"===d||null;mc(b,d,c[d],e)}return b},{})},writeConfig:mc,panLinear:function(a,b){return ob(a,b,od,$a)},panLog:function(a,b){var c=Math.sign(a[0]);return ob(a,b,xd(c),vc(c))},panPow:function(a,b,c){return ob(a,b,oe(c),oe(1/c))},panSymlog:function(a,b,c){return ob(a,b,Kb(c),Fc(c))},zoomLinear:function(a,b,c){return hc(a,b,c,od,$a)},zoomLog:function(a,b,c){var d=Math.sign(a[0]);return hc(a,b,c,xd(d),vc(d))},zoomPow:function(a,b,c,d){return hc(a,b,c,oe(d),oe(1/d))},zoomSymlog:function(a,b,c,d){return hc(a,b,c,Kb(d),Fc(d))},quarter:function(a){return 1+~~(new Date(a).getMonth()/3)},utcquarter:function(a){return 1+~~(new Date(a).getUTCMonth()/3)},array:Oa,clampRange:function(a,b,c){var d,e=a[0],f=a[1];return f<e&&(d=f,f=e,e=d),(d=f-e)>=c-b?[b,c]:[e=Math.min(Math.max(e,b),c-d),e+d]},compare:function(a,b,c){c=c||{},b=Oa(b)||[];const d=[],e=[],f={},g=c.comparator||ua;return Oa(a).forEach((h,i)=>{null!=h&&(d.push("descending"===b[i]?-1:1),e.push(h=da(h)?h:pb(h,null,c)),(ec(h)||[]).forEach(j=>f[j]=1))}),0===e.length?null:Pb(g(e,d),Object.keys(f))},constant:function(a){return da(a)?a:function(){return a}},debounce:function(a,b){var c,d;function e(){b(d),c=d=null}return function(f){d=f,c&&clearTimeout(c),c=setTimeout(e,a)}},error:za,extend:Vc,extent:function(a,b){var c,d,e,f,g=0;if(a&&(c=a.length))if(null==b){for(d=a[g];g<c&&(null==d||d!=d);d=a[++g]);for(e=f=d;g<c;++g)null!=(d=a[g])&&(d<e&&(e=d),d>f&&(f=d))}else{for(d=b(a[g]);g<c&&(null==d||d!=d);d=b(a[++g]));for(e=f=d;g<c;++g)null!=(d=b(a[g]))&&(d<e&&(e=d),d>f&&(f=d))}return[e,f]},extentIndex:function(a,b){var c,d,e,f,g,h=-1,i=a.length;if(null==b){for(;++h<i;)if(null!=(d=a[h])&&d>=d){c=e=d;break}if(h===i)return[-1,-1];for(f=g=h;++h<i;)null!=(d=a[h])&&(c>d&&(c=d,f=h),e<d&&(e=d,g=h))}else{for(;++h<i;)if(null!=(d=b(a[h],h,a))&&d>=d){c=e=d;break}if(h===i)return[-1,-1];for(f=g=h;++h<i;)null!=(d=b(a[h],h,a))&&(c>d&&(c=d,f=h),e<d&&(e=d,g=h))}return[f,g]},fastmap:function(a){var b,c,d={};function e(f){return Bb(d,f)&&d[f]!==Mc}return b={size:0,empty:0,object:d,has:e,get:f=>e(f)?d[f]:void 0,set(f,g){return e(f)||(++b.size,d[f]===Mc&&--b.empty),d[f]=g,this},delete(f){return e(f)&&(--b.size,++b.empty,d[f]=Mc),this},clear(){b.size=b.empty=0,b.object=d={}},test(f){return arguments.length?(c=f,b):c},clean(){var f,g,h={},i=0;for(f in d)(g=d[f])===Mc||c&&c(g)||(h[f]=g,++i);b.size=i,b.empty=0,b.object=d=h}},a&&Object.keys(a).forEach(function(f){b.set(f,a[f])}),b},field:pb,flush:function(a,b,c,d,e,f){if(!c&&0!==c)return f;var g,h,i=a[0],j=Uc(a),k=+c;return j<i&&(g=i,i=j,j=g),(g=Math.abs(b-i))<(h=Math.abs(j-b))&&g<=k?d:h<=k?e:f},hasOwnProperty:Bb,inherits:function(a,b){var c=a.prototype=Object.create(b.prototype);return c.constructor=a,c},inrange:function(a,b,c,d){var e,f=b[0],g=b[b.length-1];return f>g&&(e=f,f=g,g=e),d=void 0===d||d,((c=void 0===c||c)?f<=a:f<a)&&(d?a<=g:a<g)},isArray:kb,isBoolean:function(a){return"boolean"==typeof a},isDate:Sb,isFunction:da,isNumber:Dd,isObject:gc,isRegExp:function(a){return"[object RegExp]"===Object.prototype.toString.call(a)},isString:ad,key:function(a,b,c){a&&(a=b?Oa(a).map(h=>h.replace(/\\(.)/g,"$1")):Oa(a));const d=a&&a.length,e=c&&c.get||M,f=h=>e(b?[h]:va(h));let g;if(d)if(1===d){const h=f(a[0]);g=function(i){return""+h(i)}}else{const h=a.map(f);g=function(i){let j=""+h[0](i),k=0;for(;++k<d;)j+="|"+h[k](i);return j}}else g=function(){return""};return Pb(g,a,"key")},lerp:function(a,b){const c=a[0],d=Uc(a),e=+b;return e?1===e?d:c+e*(d-c):c},lruCache:function(a){let b,c,d;a=+a||1e4;const e=()=>{b={},c={},d=0},f=(g,h)=>(++d>a&&(c=b,b={},d=1),b[g]=h);return e(),{clear:e,has:g=>Bb(b,g)||Bb(c,g),get:g=>Bb(b,g)?b[g]:Bb(c,g)?f(g,c[g]):void 0,set:(g,h)=>Bb(b,g)?b[g]=h:f(g,h)}},merge:function(a,b,c,d){var e=b.length,f=c.length;if(!f)return b;if(!e)return c;for(var g=d||new b.constructor(e+f),h=0,i=0,j=0;h<e&&i<f;++j)g[j]=a(b[h],c[i])>0?c[i++]:b[h++];for(;h<e;++h,++j)g[j]=b[h];for(;i<f;++i,++j)g[j]=c[i];return g},pad:function(a,b,c,d){var e=c||" ",f=a+"",g=b-f.length;return g<=0?f:"left"===d?Qc(e,g)+f:"center"===d?Qc(e,~~(g/2))+f+Qc(e,Math.ceil(g/2)):f+Qc(e,g)},peek:Uc,repeat:Qc,span:function(a){return a&&Uc(a)-a[0]||0},splitAccessPath:va,stringValue:function a(b){return kb(b)?"["+b.map(a)+"]":gc(b)||ad(b)?JSON.stringify(b).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):b},toBoolean:function(a){return null==a||""===a?null:!(!a||"false"===a||"0"===a)&&!!a},toDate:function(a,b){return b=b||pd,null==a||""===a?null:b(a)},toNumber:od,toString:function(a){return null==a||""===a?null:a+""},toSet:function(a){for(var b={},c=0,d=a.length;c<d;++c)b[a[c]]=!0;return b},truncate:function(a,b,c,d){var e=null!=d?d:"",f=a+"",g=f.length,h=Math.max(0,b-e.length);return g<=b?f:"left"===c?e+f.slice(g-h):"center"===c?f.slice(0,Math.ceil(h/2))+e+f.slice(g-~~(h/2)):f.slice(0,h)+e},visitArray:function(a,b,c){if(a)if(b)for(var d,e=0,f=a.length;e<f;++e)(d=b(a[e]))&&c(d,e,a);else a.forEach(c)},read:Xz,inferType:Iy,inferTypes:Jy,typeParsers:_q,format:jn,formats:cr,responseType:Sy,loader:tn,Bounds:Pd,Gradient:TA,GroupItem:On,ResourceLoader:Xs,Item:Nn,Scenegraph:nt,Handler:Yh,Renderer:gg,CanvasHandler:yl,CanvasRenderer:go,SVGHandler:st,SVGRenderer:fu,SVGStringRenderer:iu,RenderType:ci,renderModule:wo,intersect:CD,Marks:Lf,boundClip:GD,boundContext:df,boundStroke:hh,boundItem:mt,boundMark:YB,pathCurves:Rs,pathSymbols:tB,pathRectangle:uB,pathTrail:vB,pathParse:Tj,pathRender:ml,point:bo,domCreate:Xh,domFind:ot,domChild:vf,domClear:fg,openTag:rd,closeTag:yd,font:$n,fontFamily:ul,fontSize:Fg,lineHeight:Vh,multiLineOffset:jt,textMetrics:$j,sceneEqual:ku,pathEqual:HD,sceneToJSON:ZB,sceneFromJSON:_B,intersectPath:Zs,intersectPoint:_s,intersectRule:GB,intersectBoxLine:Wj,sceneZOrder:$s,sceneVisit:eg,scenePickVisit:Un,resetSVGClipId:xB,resetSVGDefIds:function(){xB(),RA=0}}),AU="4.13.1";Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function a(){var b=isNaN(arguments[0])?1:Number(arguments[0]);return b?Array.prototype.reduce.call(this,function(c,d){return Array.isArray(d)?c.push.apply(c,a.call(d,b-1)):c.push(d),c},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(a){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var BU=Object(v.a)(function(a){var b=function(){function c(j,k){return null!=k&&j instanceof k}var d,e,f;try{d=Map}catch(j){d=function(){}}try{e=Set}catch(j){e=function(){}}try{f=Promise}catch(j){f=function(){}}function g(j,k,l,m,n){"object"==typeof k&&(l=k.depth,m=k.prototype,n=k.includeNonEnumerable,k=k.circular);var o=[],p=[],q=void 0!==Ca;return void 0===k&&(k=!0),void 0===l&&(l=1/0),function s(r,u){if(null===r)return null;if(0===u)return r;var t,w;if("object"!=typeof r)return r;if(c(r,d))t=new d();else if(c(r,e))t=new e();else if(c(r,f))t=new f(function(K,Q){r.then(function(V){K(s(V,u-1))},function(V){Q(s(V,u-1))})});else if(g.__isArray(r))t=[];else if(g.__isRegExp(r))t=new RegExp(r.source,i(r)),r.lastIndex&&(t.lastIndex=r.lastIndex);else if(g.__isDate(r))t=new Date(r.getTime());else{if(q&&Ca.isBuffer(r))return t=Ca.allocUnsafe?Ca.allocUnsafe(r.length):new Ca(r.length),r.copy(t),t;c(r,Error)?t=Object.create(r):void 0===m?(w=Object.getPrototypeOf(r),t=Object.create(w)):(t=Object.create(m),w=m)}if(k){var x=o.indexOf(r);if(-1!=x)return p[x];o.push(r),p.push(t)}for(var z in(c(r,d)&&r.forEach(function(K,Q){var V=s(Q,u-1),$=s(K,u-1);t.set(V,$)}),c(r,e)&&r.forEach(function(K){var Q=s(K,u-1);t.add(Q)}),r)){var A;w&&(A=Object.getOwnPropertyDescriptor(w,z)),A&&null==A.set||(t[z]=s(r[z],u-1))}if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(r);for(z=0;z<B.length;z++){var I=B[z];(!(D=Object.getOwnPropertyDescriptor(r,I))||D.enumerable||n)&&(t[I]=s(r[I],u-1),D.enumerable||Object.defineProperty(t,I,{enumerable:!1}))}}if(n){var J=Object.getOwnPropertyNames(r);for(z=0;z<J.length;z++){var D,O=J[z];(D=Object.getOwnPropertyDescriptor(r,O))&&D.enumerable||(t[O]=s(r[O],u-1),Object.defineProperty(t,O,{enumerable:!1}))}}return t}(j,l)}function h(j){return Object.prototype.toString.call(j)}function i(j){var k="";return j.global&&(k+="g"),j.ignoreCase&&(k+="i"),j.multiline&&(k+="m"),k}return g.clonePrototype=function(j){if(null===j)return null;var k=function(){};return k.prototype=j,new k()},g.__objToStr=h,g.__isDate=function(j){return"object"==typeof j&&"[object Date]"===h(j)},g.__isArray=function(j){return"object"==typeof j&&"[object Array]"===h(j)},g.__isRegExp=function(j){return"object"==typeof j&&"[object RegExp]"===h(j)},g.__getRegExpFlags=i,g}();a.exports&&(a.exports=b)}),vm=function(a,b){b||(b={}),"function"==typeof b&&(b={cmp:b});var c,d="boolean"==typeof b.cycles&&b.cycles,e=b.cmp&&(c=b.cmp,function(g){return function(h,i){var j={key:h,value:g[h]},k={key:i,value:g[i]};return c(j,k)}}),f=[];return function g(h){if(h&&h.toJSON&&"function"==typeof h.toJSON&&(h=h.toJSON()),void 0!==h){if("number"==typeof h)return isFinite(h)?""+h:"null";if("object"!=typeof h)return JSON.stringify(h);var i,j;if(Array.isArray(h)){for(j="[",i=0;i<h.length;i++)i&&(j+=","),j+=g(h[i])||"null";return j+"]"}if(null===h)return"null";if(-1!==f.indexOf(h)){if(d)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var k=f.push(h)-1,l=Object.keys(h).sort(e&&e(h));for(j="",i=0;i<l.length;i++){var m=l[i],n=g(h[m]);n&&(j&&(j+=","),j+=JSON.stringify(m)+":"+n)}return f.splice(k,1),"{"+j+"}"}}(a)};function Aw(a){return!!a.or}function Bw(a){return!!a.and}function Cw(a){return!!a.not}function Tp(a,b){return Cw(a)?{not:Tp(a.not,b)}:Bw(a)?{and:a.and.map(c=>Tp(c,b))}:Aw(a)?{or:a.or.map(c=>Tp(c,b))}:b(a)}const wm=function a(b,c){if(b===c)return!0;if(b&&c&&"object"==typeof b&&"object"==typeof c){if(b.constructor!==c.constructor)return!1;var d,e,f;if(Array.isArray(b)){if((d=b.length)!=c.length)return!1;for(e=d;0!=e--;)if(!a(b[e],c[e]))return!1;return!0}if(b.constructor===RegExp)return b.source===c.source&&b.flags===c.flags;if(b.valueOf!==Object.prototype.valueOf)return b.valueOf()===c.valueOf();if(b.toString!==Object.prototype.toString)return b.toString()===c.toString();if((d=(f=Object.keys(b)).length)!==Object.keys(c).length)return!1;for(e=d;0!=e--;)if(!Object.prototype.hasOwnProperty.call(c,f[e]))return!1;for(e=d;0!=e--;){var g=f[e];if(!a(b[g],c[g]))return!1}return!0}return b!=b&&c!=c},ac=BU;function xm(a,b){const c={};for(const d of b)db(a,d)&&(c[d]=a[d]);return c}function uh(a,b){const c=Object.assign({},a);for(const d of b)delete c[d];return c}Set.prototype.toJSON=function(){return`Set(${[...this].map(a=>vm(a)).join(",")})`};const kd=vm;function sc(a){if(Yc(a))return a;const b=Xa(a)?a:vm(a);if(b.length<250)return b;let c=0;for(let d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d),c&=c;return c}function bI(a){return!1===a||null===a}function nb(a,b){return a.indexOf(b)>-1}function ym(a,b){let c=0;for(const[d,e]of a.entries())if(b(e,d,c++))return!0;return!1}function cI(a,b){let c=0;for(const[d,e]of a.entries())if(!b(e,d,c++))return!1;return!0}function CU(a,b){for(const c of Ea(b))Lb(a,c,b[c],!0)}function fi(a,b){const c=[],d={};let e;for(const f of a)e=b(f),e in d||(d[e]=1,c.push(f));return c}function dI(a,b){for(const c of a)if(b.has(c))return!0;return!1}function eI(a){const b=new Set();for(const c of a){const d=$e(c).map((f,g)=>0===g?f:`[${f}]`),e=d.map((f,g)=>d.slice(0,g+1).join(""));for(const f of e)b.add(f)}return b}function fI(a,b){return void 0===a||void 0===b||dI(eI(a),eI(b))}function _c(a){return 0===Ea(a).length}const Ea=Object.keys,gi=Object.values;function gI(a){const b=[];for(const c in a)db(a,c)&&b.push({key:c,value:a[c]});return b}function Up(a){return!0===a||!1===a}function ld(a){const b=a.replace(/\W/g,"_");return(a.match(/^\d+/)?"_":"")+b}function zm(a,b){return Cw(a)?"!("+zm(a.not,b)+")":Bw(a)?"("+a.and.map(c=>zm(c,b)).join(") && (")+")":Aw(a)?"("+a.or.map(c=>zm(c,b)).join(") || (")+")":b(a)}function Dw(a,b){if(0===b.length)return!0;const c=b.shift();return c in a&&Dw(a[c],b)&&delete a[c],_c(a)}function Vp(a){return a.charAt(0).toUpperCase()+a.substr(1)}function hI(a,b="datum"){const c=$e(a),d=[];for(let e=1;e<=c.length;e++){const f=`[${c.slice(0,e).map(Ga).join("][")}]`;d.push(`${b}${f}`)}return d.join(" && ")}function DU(a){return a.replace(/(\[|\]|\.|'|")/g,"\\$1")}function hi(a){return""+$e(a).map(DU).join("\\.")}function yk(a,b,c){return a.replace(new RegExp(b.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),c)}function iI(a){return""+$e(a).join(".")}function Am(a){return a?$e(a).length:0}function Kd(...a){for(const b of a)if(void 0!==b)return b}let EU=42;function Wp(a){if(void 0!==a)return(a%360+360)%360}function Ew(a){return!!Yc(a)||!isNaN(a)&&!isNaN(parseFloat(a))}const jI={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function Fw(a){return a&&a.condition}const kI=["domain","grid","labels","ticks","title"],FU={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},lI={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},GU=Object.assign(Object.assign({},lI),{style:1,labelExpr:1,encoding:1});function mI(a){return!!GU[a]}const Se={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},nI=Se.arc,Xp=Se.area,Yp=Se.bar,HU=Se.image,Zp=Se.line,_p=Se.point,IU=Se.rect,$p=Se.rule,oI=Se.text,Gw=Se.tick,JU=Se.trail,Hw=Se.circle,Iw=Se.square,pI=Se.geoshape;function lj(a){return nb(["line","area","trail"],a)}function qI(a){return nb(["rect","bar","image","arc"],a)}const rI=Ea(Se);function Pg(a){return a.type}ee(rI);const KU=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],sI=Ea({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),LU={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},MU={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},NU={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function vh(a){return"mark"in a}class aq{constructor(a,b){this.name=a,this.run=b}hasMatchingType(a){return!!vh(a)&&(Pg(b=a.mark)?b.type:b)===this.name;var b}}const OU={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},PU={count:1,min:1,max:1};function ii(a){return!!a&&!!a.argmin}function mj(a){return!!a&&!!a.argmax}function Jw(a){return Xa(a)&&!!OU[a]}const QU=["count","valid","missing","distinct"];function tI(a){return Xa(a)&&nb(QU,a)}const RU=["count","sum","distinct","valid","missing"],SU=ee(["mean","average","median","q1","q3","min","max"]),wh="row",xh="column",Qg="radius",og="theta",yh="theta2",nf="color",Rg="fill",Sg="stroke",of="shape",zh="size",uI={theta:1,theta2:1,radius:1,radius2:1};function vI(a){return a in uI}const Kw={longitude:1,longitude2:1,latitude:1,latitude2:1},TU=Ea(Kw),wI=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),uI),Kw),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function zk(a){return a===nf||a===Rg||a===Sg}const xI={row:1,column:1,facet:1},Tf=Ea(xI),Lw=Object.assign(Object.assign({},wI),xI),yI=Ea(Lw),UU=Fa(Lw,["order","detail","tooltip"]),VU=Fa(UU,["row","column","facet"]);function zI(a){return!!Lw[a]}const WU=["x2","y2","latitude2","longitude2",yh,"radius2"];function AI(a){return nj(a)!==a}function nj(a){switch(a){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude";case yh:return og;case"radius2":return Qg}return a}function ji(a){if(vI(a))switch(a){case og:return"startAngle";case yh:return"endAngle";case Qg:return"outerRadius";case"radius2":return"innerRadius"}return a}function Tg(a){switch(a){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2";case og:return yh;case Qg:return"radius2"}}function Ug(a){switch(a){case"x":case"x2":return"width";case"y":case"y2":return"height"}}const Mw=Fa(wI,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),XU=Ea(Mw),ki={x:1,y:1},Uf=Ea(ki);function Vg(a){return a in ki}const Nw={theta:1,radius:1},YU=Ea(Nw);function bq(a){return"width"===a?"x":"y"}const BI=Fa(Mw,["text","tooltip","href","url","description","detail","key","order"]),ZU=Ea(BI),CI=Object.assign(Object.assign(Object.assign({},ki),Nw),BI),cq=Ea(CI);function li(a){return!!CI[a]}function _U(a,b){return function(c){switch(c){case nf:case Rg:case Sg:case"description":case"detail":case"key":case"tooltip":case"href":case"order":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"facet":case wh:case xh:return DI;case"x":case"y":case"latitude":case"longitude":return $U;case"x2":case"y2":case"latitude2":case"longitude2":return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case zh:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case"strokeDash":return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case of:return{point:"always",geoshape:"always"};case"text":return{text:"always"};case"angle":return{point:"always",square:"always",text:"always"};case"url":return{image:"always"};case og:case Qg:return{text:"always",arc:"always"};case yh:case"radius2":return{arc:"always"}}}(a)[b]}const DI={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},$U=Fa(DI,["geoshape"]);function dq(a){switch(a){case"x":case"y":case og:case Qg:case zh:case"angle":case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"x2":case"y2":case yh:case"radius2":return;case"facet":case wh:case xh:case of:case"strokeDash":case"text":case"tooltip":case"href":case"url":case"description":return"discrete";case nf:case Rg:case Sg:return"flexible";case"latitude":case"longitude":case"latitude2":case"longitude2":case"detail":case"key":case"order":return}}function EI(a){return Bi(a)&&(a=rq(a,void 0)),"bin"+Ea(a).map(b=>eq(a[b])?ld(`_${b}_${Object.entries(a[b])}`):ld(`_${b}_${a[b]}`)).join("")}function bd(a){return!0===a||Bm(a)&&!a.binned}function Te(a){return"binned"===a||Bm(a)&&!0===a.binned}function Bm(a){return ka(a)}function eq(a){return null==a?void 0:a.selection}function FI(a){switch(a){case wh:case xh:case zh:case nf:case Rg:case Sg:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case of:return 6;case"strokeDash":return 4;default:return 10}}function Ow(a){return`Invalid specification ${JSON.stringify(a)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function GI(a){return("width"==a?"Width":"Height")+' "container" only works for single views and layered views.'}function HI(a){return`${"width"==a?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==a?"x":"y"}".`}function II(a){return a?`Dropping "fit-${a}" because spec has discrete ${Ug(a)}.`:'Dropping "fit" because spec has discrete size.'}function JI(a){return`Cannot project a selection on encoding channel "${a}", which has no field.`}function aV(a,b){return`Cannot project a selection on encoding channel "${a}" as it uses an aggregate function ("${b}").`}function KI(a){return`Selection not supported for ${a} yet.`}function LI(a){return`The "columns" property cannot be used when "${a}" has nested row/column.`}function MI(a,b,c){return`An ancestor parsed field "${a}" as ${c} but a child wants to parse the field as ${b}.`}function bV(a){return`Ignoring an invalid transform: ${kd(a)}.`}function NI(a){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${a} are dropped.`}function OI(a){return`Invalid field type "${a}".`}function PI(a,b){const{fill:c,stroke:d}=b;return`Dropping color ${a} as the plot also has ${c&&d?"fill and stroke":c?"fill":"stroke"}.`}function Pw(a,b){return`Dropping ${kd(a)} from channel "${b}" since it does not contain any data field, datum, value, or signal.`}function fq(a,b,c){return`${a} dropped as it is incompatible with "${b}"${c?" when "+c:""}.`}function cV(a){return a+" encoding should be discrete (ordinal / nominal / binned)."}function Qw(a,b){return`Using discrete channel "${a}" to encode "${b}" field can be misleading as it does not encode ${"ordinal"===b?"order":"magnitude"}.`}function dV(a){return`Using unaggregated domain with raw field has no effect (${kd(a)}).`}function eV(a){return`Unaggregated domain not applicable for "${a}" since it produces values outside the origin domain of the source data.`}function fV(a){return`Unaggregated domain is currently unsupported for log scale (${kd(a)}).`}function QI(a,b,c){return`${c}-scale's "${b}" is dropped as it does not work with ${a} scale.`}function RI(a){return`The step for "${a}" is dropped because the ${"width"===a?"x":"y"} is continuous.`}const SI="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function gq(a,b){return`Invalid ${a}: ${kd(b)}.`}function TI(a){return`1D error band does not support ${a}.`}function UI(a){return`Channel ${a} is required for "binned" bin.`}const VI=sa(2);let hq=VI;function Ba(...a){hq.warn(...a)}function Ak(a){if(a&&ka(a)){for(const b of Sw)if(b in a)return!0}return!1}const WI=["january","february","march","april","may","june","july","august","september","october","november","december"],gV=WI.map(a=>a.substr(0,3)),XI=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],hV=XI.map(a=>a.substr(0,3));function Rw(a,b){const c=[];if(b&&void 0!==a.day&&Ea(a).length>1&&(Ba(function(d){return`Dropping day from datetime ${kd(d)} as day cannot be combined with other units.`}(a)),delete(a=ac(a)).day),void 0!==a.year?c.push(a.year):c.push(2012),void 0!==a.month){const d=b?function(e){if(Ew(e)&&(e=+e),Yc(e))return e-1;{const f=e.toLowerCase(),g=WI.indexOf(f);if(-1!==g)return g;const h=f.substr(0,3),i=gV.indexOf(h);if(-1!==i)return i;throw new Error(gq("month",e))}}(a.month):a.month;c.push(d)}else if(void 0!==a.quarter){const d=b?function(e){if(Ew(e)&&(e=+e),Yc(e))return e>4&&Ba(gq("quarter",e)),e-1;throw new Error(gq("quarter",e))}(a.quarter):a.quarter;c.push(Yc(d)?3*d:d+"*3")}else c.push(0);if(void 0!==a.date)c.push(a.date);else if(void 0!==a.day){const d=b?function(e){if(Ew(e)&&(e=+e),Yc(e))return e%7;{const f=e.toLowerCase(),g=XI.indexOf(f);if(-1!==g)return g;const h=f.substr(0,3),i=hV.indexOf(h);if(-1!==i)return i;throw new Error(gq("day",e))}}(a.day):a.day;c.push(Yc(d)?d+1:d+"+1")}else c.push(1);for(const d of["hours","minutes","seconds","milliseconds"]){const e=a[d];c.push(void 0===e?0:e)}return c}function Cm(a){const b=Rw(a,!0).join(", ");return a.utc?`utc(${b})`:`datetime(${b})`}const YI={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Sw=Ea(YI);function Tw(a){return a.startsWith("utc")}const iV={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Uw(a){const b=[];for(const c of Sw)ZI(a,c)&&b.push(c);return b}function ZI(a,b){const c=a.indexOf(b);return!(c<0)&&(!(c>0&&"seconds"===b&&"i"===a.charAt(c-1))&&(!(a.length>c+3&&"day"===b&&"o"===a.charAt(c+3))&&!(c>0&&"year"===b&&"f"===a.charAt(c-1))))}function jV(a,b,{end:c}={end:!1}){const d=hI(b),e=Tw(a)?"utc":"";let f;const g={};for(const i of Sw)ZI(a,i)&&(g[i]="quarter"===(h=i)?`(${e}quarter(${d})-1)`:`${e}${h}(${d})`,f=i);var h;return c&&(g[f]+="+1"),function(i){const j=Rw(i,!1).join(", ");return i.utc?`utc(${j})`:`datetime(${j})`}(g)}function _I(a){if(!a)return;const b=Uw(a);return`timeUnitSpecifier(${vm(b)}, ${vm(iV)})`}function Ue(a){if(!a)return;let b;return Xa(a)?b={unit:a}:ka(a)&&(b=Object.assign(Object.assign({},a),a.unit?{unit:a.unit}:{})),Tw(b.unit)&&(b.utc=!0,b.unit=function(c){return c.substr(3)}(b.unit)),b}function tb(a){return a&&!!a.signal}function mi(a){return!!a.step}function ni(a){return!U(a)&&("field"in a&&"data"in a)}const kV=Ea({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),lV={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Vw=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Ww(a){return a&&!!a.field&&void 0!==a.equal}function $I(a){return a&&!!a.field&&void 0!==a.lt}function aJ(a){return a&&!!a.field&&void 0!==a.lte}function bJ(a){return a&&!!a.field&&void 0!==a.gt}function cJ(a){return a&&!!a.field&&void 0!==a.gte}function Xw(a){if(a&&a.field){if(U(a.range)&&2===a.range.length)return!0;if(tb(a.range))return!0}return!1}function Yw(a){return a&&!!a.field&&(U(a.oneOf)||U(a.in))}function dJ(a){return Yw(a)||Ww(a)||Xw(a)||$I(a)||bJ(a)||aJ(a)||cJ(a)}function Wg(a,b){return px(a,{timeUnit:b,wrapTime:!0})}function eJ(a,b=!0){var c;const{field:d}=a,e=null===(c=Ue(a.timeUnit))||void 0===c?void 0:c.unit,f=e?"time("+jV(e,d)+")":Ka(a,{expr:"datum"});if(Ww(a))return f+"==="+Wg(a.equal,e);if($I(a))return`${f}<${Wg(a.lt,e)}`;if(bJ(a))return`${f}>${Wg(a.gt,e)}`;if(aJ(a))return`${f}<=${Wg(a.lte,e)}`;if(cJ(a))return`${f}>=${Wg(a.gte,e)}`;if(Yw(a))return`indexof([${function(g,h){return g.map(i=>Wg(i,h))}(a.oneOf,e).join(",")}], ${f}) !== -1`;if(function(g){return g&&!!g.field&&void 0!==g.valid}(a))return Zw(f,a.valid);if(Xw(a)){const{range:g}=a,h=tb(g)?{signal:g.signal+"[0]"}:g[0],i=tb(g)?{signal:g.signal+"[1]"}:g[1];if(null!==h&&null!==i&&b)return"inrange("+f+", ["+Wg(h,e)+", "+Wg(i,e)+"])";const j=[];return null!==h&&j.push(`${f} >= ${Wg(h,e)}`),null!==i&&j.push(`${f} <= ${Wg(i,e)}`),j.length>0?j.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(a))}function Zw(a,b=!0){return b?`isValid(${a}) && isFinite(+${a})`:`!isValid(${a}) || !isFinite(+${a})`}function mV(a){var b;return dJ(a)&&a.timeUnit?Object.assign(Object.assign({},a),{timeUnit:null===(b=Ue(a.timeUnit))||void 0===b?void 0:b.unit}):a}const Bk={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},oj=Bk.quantitative,_w=Bk.ordinal,Ck=Bk.temporal,$w=Bk.nominal,Dk=Bk.geojson,nV=Ea(Bk),fJ="linear",gJ="log",oV="pow",pV="sqrt",qV="symlog",ax="time",iq="utc",rV="quantile",sV="quantize",tV="threshold",hJ="point",uV="band",bx={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},vV=Ea(bx);function wV(a,b){const c=bx[a],d=bx[b];return c===d||"ordinal-position"===c&&"time"===d||"ordinal-position"===d&&"time"===c}const xV={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function iJ(a){return xV[a]}const jJ=["linear","log","pow","sqrt","symlog","time","utc"],yV=ee(jJ),zV=ee(["linear","log","pow","sqrt","symlog"]),AV=ee(["quantile","quantize","threshold"]),BV=ee(jJ.concat(["quantile","quantize","threshold","sequential","identity"])),CV=ee(["ordinal","bin-ordinal","point","band"]);function pf(a){return a in CV}function Vf(a){return a in BV}function pg(a){return a in yV}function jq(a){return a in AV}function kJ(a){return null==a?void 0:a.selection}const DV=Fa({type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},["type","domain","range","scheme"]),EV=Ea(DV);!function(){var a;const b={};for(const c of yI)for(const d of nV)for(const e of vV){const f=FV(c,d);oJ(c,e)&&nJ(e,d)&&(b[f]=null!==(a=b[f])&&void 0!==a?a:[],b[f].push(e))}}();function lJ(a,b){switch(b){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!nb(["point","band","identity"],a);case"bins":return!nb(["point","band","identity","ordinal"],a);case"round":return pg(a)||"band"===a||"point"===a;case"padding":return pg(a)||nb(["point","band"],a);case"paddingOuter":case"align":return nb(["point","band"],a);case"paddingInner":return"band"===a;case"domainMid":case"clamp":return pg(a);case"nice":return pg(a)||"quantize"===a||"threshold"===a;case"exponent":return"pow"===a;case"base":return"log"===a;case"constant":return"symlog"===a;case"zero":return Vf(a)&&!nb(["log","time","utc","threshold","quantile"],a)}}function mJ(a,b){switch(b){case"interpolate":case"scheme":case"domainMid":return zk(a)?void 0:`Cannot use the scale property "${a}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function nJ(a,b){return nb([_w,$w],b)?void 0===a||pf(a):b===Ck?nb([ax,iq,void 0],a):b!==oj||nb([gJ,oV,pV,qV,rV,sV,tV,fJ,void 0],a)}function oJ(a,b){if(!li(a))return!1;switch(a){case"x":case"y":case og:case Qg:return pg(b)||nb(["band","point"],b);case zh:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"angle":return pg(b)||jq(b)||nb(["band","point","ordinal"],b);case nf:case Rg:case Sg:return"band"!==b;case"strokeDash":return"ordinal"===b||jq(b);case of:return"ordinal"===b}}function FV(a,b){return a+"_"+b}function cx(a){const{channel:b,channelDef:c,markDef:d,scale:e,config:f}=a,g=qJ(a);return Qa(c)&&!tI(c.aggregate)&&e&&pg(e.get("type"))&&!1===e.get("zero")?pJ({fieldDef:c,channel:b,markDef:d,ref:g,config:f}):g}function pJ({fieldDef:a,channel:b,markDef:c,ref:d,config:e}){return lj(c.type)?d:null===Hc("invalid",c,e)?d:[GV(a,b),d]}function GV(a,b){const c=dx(a,!0),d="y"===nj(b)?{field:{group:"height"}}:{value:0};return Object.assign({test:c},d)}function dx(a,b=!0){return Zw(Xa(a)?a:Ka(a,{expr:"datum"}),!b)}function pj(a,b,c,d){const e={};if(b&&(e.scale=b),pi(a)){const{datum:f}=a;Ak(f)?e.signal=Cm(f):tb(f)?e.signal=f.signal:e.value=f}else e.field=Ka(a,c);if(d){const{offset:f,band:g}=d;f&&(e.offset=f),g&&(e.band=g)}return e}function kq({scaleName:a,fieldOrDatumDef:b,fieldOrDatumDef2:c,offset:d,startSuffix:e,band:f=.5}){const g=0<f&&f<1?"datum":void 0,h=Ka(b,{expr:g,suffix:e}),i=void 0!==c?Ka(c,{expr:g}):Ka(b,{suffix:"end",expr:g}),j={};if(0===f||1===f){j.scale=a;const k=0===f?h:i;j.field=k}else{const k=`${f} * ${h} + ${1-f} * ${i}`;j.signal=`scale("${a}", ${k})`}return d&&(j.offset=d),j}function qJ({channel:a,channelDef:b,channel2Def:c,markDef:d,config:e,scaleName:f,scale:g,stack:h,offset:i,defaultRef:j,band:k}){var l;if(b){if(Cb(b)){if(Bf(b)){k=null!=k?k:Fm({channel:a,fieldDef:b,fieldDef2:c,markDef:d,stack:h,config:e,isMidPoint:!0});const{bin:n,timeUnit:o,type:p}=b;if(bd(n)||k&&o&&p===Ck)return h&&h.impute?pj(b,f,{binSuffix:"mid"},{offset:i}):k?kq({scaleName:f,fieldOrDatumDef:b,band:k,offset:i}):pj(b,f,Gm(b,a)?{binSuffix:"range"}:{},{offset:i});if(Te(n)){if(Qa(c))return kq({scaleName:f,fieldOrDatumDef:b,fieldOrDatumDef2:c,band:k,offset:i});Ba(UI("x"===a?"x2":"y2"))}}const m=null==g?void 0:g.get("type");return pj(b,f,pf(m)?{binSuffix:"range"}:{},{offset:i,band:"band"===m?null!==(l=null!=k?k:b.band)&&void 0!==l?l:.5:void 0})}if(Ah(b)){const m=b.value,n=i?{offset:i}:{};return Object.assign(Object.assign({},Dm(a,m)),n)}}return Ub(j)&&(j=j()),j?Object.assign(Object.assign({},j),i?{offset:i}:{}):j}function Dm(a,b){return nb(["x","x2"],a)&&"width"===b?{field:{group:"width"}}:nb(["y","y2"],a)&&"height"===b?{field:{group:"height"}}:Fd(b)}function qj(a){return a&&"number"!==a&&"time"!==a}function rJ(a,b,c){return`${a}(${b}${c?", "+JSON.stringify(c):""})`}function ex({fieldOrDatumDef:a,format:b,formatType:c,expr:d,normalizeStack:e,config:f}){var g,h;if(qj(c))return fx({fieldOrDatumDef:a,format:b,formatType:c,expr:d,config:f});const i=sJ(a,d,e);if(sq(a)){const j=function(k,l,m,n,o){return!l||m?(m=Xa(m)?m:n,`${o?"utc":"time"}Format(${k}, '${m}')`):function(p,q,s){if(!p)return;const r=_I(p);return`${s||Tw(p)?"utc":"time"}Format(${q}, ${r})`}(l,k,o)}(i,Qa(a)?null===(g=Ue(a.timeUnit))||void 0===g?void 0:g.unit:void 0,b,f.timeFormat,lx(a)&&(null===(h=a.scale)||void 0===h?void 0:h.type)===iq);return j?{signal:j}:void 0}return(b=vJ(oi(a),b,f),Qa(a)&&bd(a.bin))?{signal:lq(i,Ka(a,{expr:d,binSuffix:"end"}),b,c,f)}:b||"quantitative"===oi(a)?{signal:""+wJ(i,b)}:{signal:`isValid(${i}) ? ${i} : ""+${i}`}}function sJ(a,b,c){return Qa(a)?c?`${Ka(a,{expr:b,suffix:"end"})}-${Ka(a,{expr:b,suffix:"start"})}`:Ka(a,{expr:b}):function(d){const{datum:e}=d;return Ak(e)?Cm(e):""+JSON.stringify(e)}(a)}function fx({fieldOrDatumDef:a,format:b,formatType:c,expr:d,normalizeStack:e,config:f,field:g}){return(g=null!=g?g:sJ(a,d,e),Qa(a)&&bd(a.bin))?{signal:lq(g,Ka(a,{expr:d,binSuffix:"end"}),b,c,f)}:{signal:rJ(c,g,b)}}function tJ(a,b,c,d,e,f){var g;if(!qj(d))return sq(a)?function(h,i,j,k){return h?h:i?{signal:_I(i)}:k?void 0:j.timeFormat}(c,Qa(a)?null===(g=Ue(a.timeUnit))||void 0===g?void 0:g.unit:void 0,e,f):vJ(b,c,e)}function uJ(a,b,c){return a&&(tb(a)||"number"===a||"time"===a)?a:sq(b)&&"time"!==c&&"utc"!==c?"time":void 0}function vJ(a,b,c){return Xa(b)?b:a===oj?c.numberFormat:void 0}function wJ(a,b){return`format(${a}, "${b||""}")`}function xJ(a,b,c,d){var e;return qj(c)?rJ(c,a,b):wJ(a,null!==(e=Xa(b)?b:void 0)&&void 0!==e?e:d.numberFormat)}function lq(a,b,c,d,e){const f=xJ(a,c,d,e),g=xJ(b,c,d,e);return`${Zw(a,!1)} ? "null" : ${f} + "  " + ${g}`}const mq="min",HV={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function yJ(a){return a in HV}function zJ(a){return!!a&&!!a.encoding}function Xg(a){return!(!a||"count"!==a.op&&!a.field)}function AJ(a){return!!a&&U(a)}function Em(a){return"row"in a||"column"in a}function gx(a){return!!a&&"header"in a}function nq(a){return"facet"in a}function BJ(a){const{field:b,timeUnit:c,bin:d,aggregate:e}=a;return Object.assign(Object.assign(Object.assign(Object.assign({},c?{timeUnit:c}:{}),d?{bin:d}:{}),e?{aggregate:e}:{}),{field:b})}function CJ(a){return Bf(a)&&"sort"in a}function Fm({channel:a,fieldDef:b,fieldDef2:c,markDef:d,stack:e,config:f,isMidPoint:g}){if(Cb(b)&&void 0!==b.band)return b.band;if(Qa(b)){const{timeUnit:h,bin:i}=b;if(h&&!c)return g?tj("timeUnitBandPosition",d,f):qI(d.type)?tj("timeUnitBand",d,f):0;if(bd(i))return qI(d.type)&&!g?1:.5}return(null==e?void 0:e.fieldChannel)===a&&g?.5:void 0}function hx(a,b,c,d,e,f){return!!(bd(b.bin)||b.timeUnit&&Bf(b)&&"temporal"===b.type)&&!!Fm({channel:a,fieldDef:b,fieldDef2:c,stack:d,markDef:e,config:f})}function ix(a){return!!a&&"condition"in a}function oq(a){const b=a&&a.condition;return!!b&&!U(b)&&Qa(b)}function jx(a){const b=a&&a.condition;return!!b&&!U(b)&&Cb(b)}function Qa(a){return!(!a||!a.field&&"count"!==a.aggregate)}function oi(a){return a&&a.type}function pi(a){return!!a&&"datum"in a}function Yg(a){return Bf(a)&&GJ(a)||kx(a)}function kx(a){return pi(a)&&Yc(a.datum)}function Cb(a){return Qa(a)||pi(a)}function Bf(a){return!!a&&("field"in a&&"type"in a||"count"===a.aggregate)}function Ah(a){return a&&"value"in a&&"value"in a}function lx(a){return!!a&&("scale"in a||"sort"in a)}function mx(a){return a&&("axis"in a||"stack"in a||"impute"in a)}function DJ(a){return!!a&&"legend"in a}function EJ(a){return!!a&&("format"in a||"formatType"in a)}function Ka(a,b={}){var c,d,e;let f=a.field;const g=b.prefix;let h=b.suffix,i="";if(function(j){return"count"===j.aggregate}(a))f=function(j){return function(k){return 0===k.indexOf("__")}(j)?j:"__"+j}("count");else{let j;if(!b.nofn)if(function(k){return"op"in k}(a))j=a.op;else{const{bin:k,aggregate:l,timeUnit:m}=a;bd(k)?(j=EI(k),h=(null!==(c=b.binSuffix)&&void 0!==c?c:"")+(null!==(d=b.suffix)&&void 0!==d?d:"")):l?mj(l)?(i=`["${f}"]`,f="argmax_"+l.argmax):ii(l)?(i=`["${f}"]`,f="argmin_"+l.argmin):j=String(l):m&&(j=function(n){const o=Ue(n),{utc:p}=o,q=Fa(o,["utc"]);return q.unit?(p?"utc":"")+Ea(q).map(s=>ld(`${"unit"===s?"":`_${s}_`}${q[s]}`)).join(""):(p?"utc":"")+"timeunit"+Ea(q).map(s=>ld(`_${s}_${q[s]}`)).join("")}(m),h=(!nb(["range","mid"],b.binSuffix)&&b.binSuffix||"")+(null!==(e=b.suffix)&&void 0!==e?e:""))}j&&(f=f?`${j}_${f}`:j)}return h&&(f=`${f}_${h}`),g&&(f=`${g}_${f}`),b.forAs?iI(f):b.expr?function(j,k="datum"){return`${k}[${Ga($e(j).join("."))}]`}(f,b.expr)+i:hi(f)+i}function FJ(a){switch(a.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Qa(a)&&!!a.bin;case"temporal":return!1}throw new Error(OI(a.type))}function GJ(a){return!FJ(a)}const HJ=(a,b)=>{switch(b.fieldTitle){case"plain":return a.field;case"functional":return function(c){const{aggregate:d,bin:e,timeUnit:f,field:g}=c;if(mj(d))return`${g} for argmax(${d.argmax})`;if(ii(d))return`${g} for argmin(${d.argmin})`;const h=Ue(f),i=d||(null==h?void 0:h.unit)||(null==h?void 0:h.maxbins)&&"timeunit"||bd(e)&&"bin";return i?i.toUpperCase()+"("+g+")":g}(a);default:return function(c,d){var e;const{field:f,bin:g,timeUnit:h,aggregate:i}=c;if("count"===i)return d.countTitle;if(bd(g))return f+" (binned)";if(h){const j=null===(e=Ue(h))||void 0===e?void 0:e.unit;if(j)return`${f} (${Uw(j).join("-")})`}else if(i)return mj(i)?`${f} for max ${i.argmax}`:ii(i)?`${f} for min ${i.argmin}`:`${Vp(i)} of ${f}`;return f}(a,b)}};let IJ=HJ;function JJ(a){IJ=a}function rj(a,b,{allowDisabling:c,includeDefault:d=!0}){var e,f;const g=(null!==(e=nx(a))&&void 0!==e?e:{}).title;if(!Qa(a))return g;const h=a,i=d?KJ(h,b):void 0;return c?Kd(g,h.title,i):null!==(f=null!=g?g:h.title)&&void 0!==f?f:i}function nx(a){return mx(a)&&a.axis?a.axis:DJ(a)&&a.legend?a.legend:gx(a)&&a.header?a.header:void 0}function KJ(a,b){return IJ(a,b)}function pq(a){var b;if(EJ(a)){const{format:c,formatType:d}=a;return{format:c,formatType:d}}{const c=null!==(b=nx(a))&&void 0!==b?b:{},{format:d,formatType:e}=c;return{format:d,formatType:e}}}function Zg(a){return Qa(a)?a:oq(a)?a.condition:void 0}function Sd(a){return Cb(a)?a:jx(a)?a.condition:void 0}function ox(a,b,c){return Xa(a)||Yc(a)||Bi(a)?(Ba(function(d,e,f){return`Channel ${d} is a ${e}. Converted to {value: ${kd(f)}}.`}(b,Xa(a)?"string":Yc(a)?"number":"boolean",a)),{value:a}):Cb(a)?qq(a,b,c):jx(a)?Object.assign(Object.assign({},a),{condition:qq(a.condition,b,c)}):a}function qq(a,b,c){if(EJ(a)){const{format:d,formatType:e}=a,f=Fa(a,["format","formatType"]);if(qj(e)&&!c.customFormatTypes)return Ba(NI(b)),qq(f,b,c)}else{const d=mx(a)?"axis":DJ(a)?"legend":gx(a)?"header":null;if(d&&a[d]){const e=a[d],{format:f,formatType:g}=e,h=Fa(e,["format","formatType"]);if(qj(g)&&!c.customFormatTypes)return Ba(NI(b)),qq(Object.assign(Object.assign({},a),{[d]:h}),b,c)}}return Qa(a)?LJ(a,b):function(d){let e=d.type;if(e)return d;const{datum:f}=d;return e=Yc(f)?"quantitative":Xa(f)?"nominal":Ak(f)?"temporal":void 0,Object.assign(Object.assign({},d),{type:e})}(a)}function LJ(a,b){const{aggregate:c,timeUnit:d,bin:e,field:f}=a,g=Object.assign({},a);if(!c||Jw(c)||mj(c)||ii(c)||(Ba(function(h){return`Invalid aggregation operator "${h}".`}(c)),delete g.aggregate),d&&(g.timeUnit=Ue(d)),f&&(g.field=""+f),bd(e)&&(g.bin=rq(e,b)),Te(e)&&!Vg(b)&&Ba(`Channel ${b} should not be used with "binned" bin.`),Bf(g)){const{type:h}=g,i=function(j){if(j)switch(j=j.toLowerCase()){case"q":case oj:return"quantitative";case"t":case Ck:return"temporal";case"o":case _w:return"ordinal";case"n":case $w:return"nominal";case Dk:return"geojson"}}(h);h!==i&&(g.type=i),"quantitative"!==h&&tI(c)&&(Ba(function(j,k){return`Invalid field type "${j}" for aggregate: "${k}", using "quantitative" instead.`}(h,c)),g.type="quantitative")}else if(!AI(b)){const h=function(i,j){if(i.timeUnit)return"temporal";if(bd(i.bin))return"quantitative";switch(dq(j)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(g,b);Ba(function(i,j){return`Missing type for channel "${i}", using "${j}" instead.`}(b,h)),g.type=h}if(Bf(g)){const{compatible:h,warning:i}=function(j,k){const l=j.type;if("geojson"===l&&"shape"!==k)return{compatible:!1,warning:`Channel ${k} should not be used with a geojson data.`};switch(k){case wh:case xh:case"facet":return GJ(j)?{compatible:!1,warning:cV(k)}:sj;case"x":case"y":case nf:case Rg:case Sg:case"text":case"detail":case"key":case"tooltip":case"href":case"url":case"angle":case og:case Qg:case"description":return sj;case"longitude":case"longitude2":case"latitude":case"latitude2":return l!==oj?{compatible:!1,warning:`Channel ${k} should be used with a quantitative field only, not ${j.type} field.`}:sj;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case zh:case yh:case"radius2":case"x2":case"y2":return"nominal"!==l||j.sort?sj:{compatible:!1,warning:`Channel ${k} should not be used with an unsorted discrete field.`};case"strokeDash":return nb(["ordinal","nominal"],j.type)?sj:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case of:return nb(["ordinal","nominal","geojson"],j.type)?sj:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==j.type||"sort"in j?sj:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(g,b);h||Ba(i)}if(CJ(g)&&Xa(g.sort)){const{sort:h}=g;if(yJ(h))return Object.assign(Object.assign({},g),{sort:{encoding:h}});const i=h.substr(1);if("-"===h.charAt(0)&&yJ(i))return Object.assign(Object.assign({},g),{sort:{encoding:i,order:"descending"}})}if(gx(g)){const{header:h}=g,{orient:i}=h,j=Fa(h,["orient"]);if(i)return Object.assign(Object.assign({},g),{header:Object.assign(Object.assign({},j),{labelOrient:h.labelOrient||i,titleOrient:h.titleOrient||i})})}return g}function rq(a,b){return Bi(a)?{maxbins:FI(b)}:"binned"===a?{binned:!0}:a.maxbins||a.step?a:Object.assign(Object.assign({},a),{maxbins:FI(b)})}const sj={compatible:!0};function sq(a){const{formatType:b}=pq(a);return"time"===b||!b&&function(c){return c&&("temporal"===c.type||Qa(c)&&!!c.timeUnit)}(a)}function px(a,{timeUnit:b,type:c,wrapTime:d,undefinedIfExprNotRequired:e}){var f;const g=b&&(null===(f=Ue(b))||void 0===f?void 0:f.unit);let h,i=g||"temporal"===c;return tb(a)?h=a.signal:Ak(a)?(i=!0,h=Cm(a)):(Xa(a)||Yc(a))&&i&&(h=`datetime(${JSON.stringify(a)})`,function(j){return!!YI[j]}(g)&&(Yc(a)&&a<1e4||Xa(a)&&isNaN(Date.parse(a)))&&(h=Cm({[g]:a}))),h?d&&i?`time(${h})`:h:e?void 0:JSON.stringify(a)}function MJ(a,b){const{type:c}=a;return b.map(d=>{const e=px(d,{timeUnit:Qa(a)?a.timeUnit:void 0,type:c,undefinedIfExprNotRequired:!0});return void 0!==e?{signal:e}:d})}function Gm(a,b){return bd(a.bin)?li(b)&&nb(["ordinal","nominal"],a.type):(console.warn("Only call this method for binned field defs."),!1)}function NJ(a){const{anchor:b,frame:c,offset:d,orient:e,color:f,subtitleColor:g,subtitleFont:h,subtitleFontSize:i,subtitleFontStyle:j,subtitleFontWeight:k,subtitleLineHeight:l,subtitlePadding:m}=a,n=Fa(a,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),o=Object.assign(Object.assign({},n),f?{fill:f}:{}),p=Object.assign(Object.assign(Object.assign(Object.assign({},b?{anchor:b}:{}),c?{frame:c}:{}),d?{offset:d}:{}),e?{orient:e}:{}),q=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g?{subtitleColor:g}:{}),h?{subtitleFont:h}:{}),i?{subtitleFontSize:i}:{}),j?{subtitleFontStyle:j}:{}),k?{subtitleFontWeight:k}:{}),l?{subtitleLineHeight:l}:{}),m?{subtitlePadding:m}:{});return{titleMarkConfig:o,subtitleMarkConfig:xm(o,["align","baseline","dx","dy","limit"]),nonMark:p,subtitle:q}}function qi(a){return Xa(a)||U(a)&&Xa(a[0])}function Fd(a){return tb(a)?a:void 0!==a?{value:a}:void 0}function OJ(a){return tb(a)?a.signal:Ga(a.value)}function Hm(a){return tb(a)?a.signal:null==a?null:Ga(a)}function PJ(a){var b;return[].concat(a.type,null!==(b=a.style)&&void 0!==b?b:[])}function Hc(a,b,c,d={}){const{vgChannel:e,ignoreVgConfig:f}=d;return e&&void 0!==b[e]?b[e]:void 0!==b[a]?b[a]:!f||e&&e!==a?tj(a,b,c,d):void 0}function tj(a,b,c,{vgChannel:d}={}){return Kd(d?tq(a,b,c.style):void 0,tq(a,b,c.style),d?c[b.type][d]:void 0,c[b.type][a],d?c.mark[d]:c.mark[a])}function tq(a,b,c){return QJ(a,PJ(b),c)}function QJ(a,b,c){let d;b=Ra(b);for(const e of b){const f=c[e];f&&void 0!==f[a]&&(d=f[a])}return d}function RJ(a,b){return Ra(a).reduce((c,d)=>{var e;return c.field.push(Ka(d,b)),c.order.push(null!==(e=d.sort)&&void 0!==e?e:"ascending"),c},{field:[],order:[]})}function SJ(a,b){const c=[...a];return b.forEach(d=>{for(const e of c)if(wm(e,d))return;c.push(d)}),c}function TJ(a,b){return wm(a,b)||!b?a:a?[...Ra(a),...Ra(b)].join(", "):b}function UJ(a,b){const c=a.value,d=b.value;if(null==c||null===d)return{explicit:a.explicit,value:null};if((qi(c)||tb(c))&&(qi(d)||tb(d)))return{explicit:a.explicit,value:TJ(c,d)};if(qi(c)||tb(c))return{explicit:a.explicit,value:c};if(qi(d)||tb(d))return{explicit:a.explicit,value:d};if(!(qi(c)||tb(c)||qi(d)||tb(d)))return{explicit:a.explicit,value:SJ(c,d)};throw new Error("It should never reach here")}function uj(a,b){const c=a&&a[b];return!!c&&(U(c)?ym(c,d=>!!d.field):Qa(c)||oq(c))}function qx(a){return ym(yI,b=>{if(uj(a,b)){const c=a[b];if(U(c))return ym(c,d=>!!d.aggregate);{const d=Zg(c);return d&&!!d.aggregate}}return!1})}function rx(a,b){const c=[],d=[],e=[],f=[],g={};return sx(a,(h,i)=>{if(Qa(h)){const{field:j,aggregate:k,bin:l,timeUnit:m}=h,n=Fa(h,["field","aggregate","bin","timeUnit"]);if(k||m||l){const o=nx(h),p=o&&o.title;let q=Ka(h,{forAs:!0});const s=Object.assign(Object.assign(Object.assign({},p?[]:{title:rj(h,b,{allowDisabling:!0})}),n),{field:q});if(k){let r;if(mj(k)?(r="argmax",q=Ka({op:"argmax",field:k.argmax},{forAs:!0}),s.field=`${q}.${j}`):ii(k)?(r="argmin",q=Ka({op:"argmin",field:k.argmin},{forAs:!0}),s.field=`${q}.${j}`):"boxplot"!==k&&"errorbar"!==k&&"errorband"!==k&&(r=k),r){const u={op:r,as:q};j&&(u.field=j),f.push(u)}}else if(c.push(q),Bf(h)&&bd(l)){if(d.push({bin:l,field:j,as:q}),c.push(Ka(h,{binSuffix:"end"})),Gm(h,i)&&c.push(Ka(h,{binSuffix:"range"})),Vg(i)){const r={field:q+"_end"};g[i+"2"]=r}s.bin="binned",AI(i)||(s.type=oj)}else if(m){e.push({timeUnit:m,field:j,as:q});const r=Bf(h)&&h.type!==Ck&&"time";r&&("text"===i||"tooltip"===i?s.formatType=r:function(u){return!!Mw[u]}(i)?s.legend=Object.assign({formatType:r},s.legend):Vg(i)&&(s.axis=Object.assign({formatType:r},s.axis)))}g[i]=s}else c.push(j),g[i]=a[i]}else g[i]=a[i]}),{bins:d,timeUnits:e,aggregate:f,groupby:c,encoding:g}}function IV(a,b,c){const d=b.type;return Ea(a).reduce((e,f)=>{if(!zI(f))return Ba(function(h){return`${h}-encoding is dropped as ${h} is not a valid encoding channel.`}(f)),e;const g=a[f];if("angle"!==f||"arc"!==d||a.theta||(Ba("Arc marks uses theta channel rather than angle, replacing angle with theta."),f=og),!function(h,i,j){const k=_U(i,j);if(!k)return!1;if("binned"===k){const l=h["x2"===i?"x":"y"];return!!(Qa(l)&&Qa(h[i])&&Te(l.bin))}return!0}(a,f,d))return Ba(fq(f,d)),e;if(f===zh&&"line"===d){const h=Zg(a[f]);if(null==h?void 0:h.aggregate)return Ba("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),e}if(f===nf&&(b.filled?"fill"in a:"stroke"in a))return Ba(PI("encoding",{fill:"fill"in a,stroke:"stroke"in a})),e;if("detail"===f||"order"===f&&!U(g)&&!Ah(g)||"tooltip"===f&&U(g))g&&(e[f]=Ra(g).reduce((h,i)=>(Qa(i)?h.push(LJ(i,f)):Ba(Pw(i,f)),h),[]));else{if("tooltip"===f&&null===g)e[f]=null;else if(!(Qa(g)||pi(g)||Ah(g)||ix(g)||tb(g)))return Ba(Pw(g,f)),e;e[f]=ox(g,f,c)}return e},{})}function JV(a){const b=[];for(const c of Ea(a))if(uj(a,c)){const d=Ra(a[c]);for(const e of d)Qa(e)?b.push(e):oq(e)&&b.push(e.condition)}return b}function sx(a,b,c){if(a)for(const d of Ea(a)){const e=a[d];if(U(e))for(const f of e)b.call(c,f,d);else b.call(c,e,d)}}function VJ(a,b,c,d){return a?Ea(a).reduce((e,f)=>{const g=a[f];return U(g)?g.reduce((h,i)=>b.call(d,h,i,f),e):b.call(d,e,g,f)},c):c}function WJ(a,b){return Ea(b).reduce((c,d)=>{switch(d){case"x":case"y":case"href":case"description":case"url":case"x2":case"y2":case og:case yh:case Qg:case"radius2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case of:case"angle":case"tooltip":return c;case"order":if("line"===a||"trail"===a)return c;case"detail":case"key":{const e=b[d];if(U(e)||Qa(e))for(const f of Ra(e))f.aggregate||c.push(Ka(f,{}));return c}case zh:if("trail"===a)return c;case nf:case Rg:case Sg:case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{const e=Zg(b[d]);return e&&!e.aggregate&&c.push(Ka(e,{})),c}}},[])}function tx(a,b,c,d=!0){return"tooltip"in c?{tooltip:c.tooltip}:{tooltip:[...a.map(({fieldPrefix:e,titlePrefix:f})=>{const g=d?" of "+b.field:"";return{field:e+b.field,type:b.type,title:tb(f)?{signal:f+`"${escape(g)}"`}:f+g}}),...JV(c)]}}function XJ(a){const{axis:b,title:c,field:d}=a;return b&&void 0!==b.title?void 0:Kd(c,d)}function ux(a,b,c,d,e){const{scale:f,axis:g}=c;return({partName:h,mark:i,positionPrefix:j,endPositionPrefix:k,aria:l,extraEncoding:m={}})=>{const n=XJ(c);return YJ(a,h,e,l,{mark:i,encoding:Object.assign(Object.assign(Object.assign({[b]:Object.assign(Object.assign(Object.assign({field:j+"_"+c.field,type:c.type},void 0!==n?{title:n}:{}),void 0!==f?{scale:f}:{}),void 0!==g?{axis:g}:{})},Xa(k)?{[b+"2"]:{field:k+"_"+c.field}}:{}),d),m)})}}function YJ(a,b,c,d,e){const{clip:f,color:g,opacity:h}=a,i=a.type;return a[b]||void 0===a[b]&&c[b]?[Object.assign(Object.assign({},e),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c[b]),f?{clip:f}:{}),g?{color:g}:{}),h?{opacity:h}:{}),Pg(e.mark)?e.mark:{type:e.mark}),{style:`${i}-${b}`}),Bi(a[b])?{}:a[b]),!1===d?{aria:d}:{})})]:[]}function ZJ(a,b,c){const{encoding:d}=a,e="vertical"===b?"y":"x",f=d[e],g=d[e+"2"],h=d[e+"Error"],i=d[e+"Error2"];return{continuousAxisChannelDef:uq(f,c),continuousAxisChannelDef2:uq(g,c),continuousAxisChannelDefError:uq(h,c),continuousAxisChannelDefError2:uq(i,c),continuousAxis:e}}function uq(a,b){if(a&&a.aggregate){const{aggregate:c}=a,d=Fa(a,["aggregate"]);return c!==b&&Ba(function(e,f){return`Continuous axis should not have customized aggregation function ${e}; ${f} already agregates the axis.`}(c,b)),d}return a}function _J(a,b){const{mark:c,encoding:d}=a,{x:e,y:f}=d;if(Yg(e)){if(Yg(f)){const g=Qa(e)&&e.aggregate,h=Qa(f)&&f.aggregate;if(g||h!==b){if(h||g!==b){if(g===b&&h===b)throw new Error("Both x and y cannot have aggregate");return Pg(c)&&c.orient?c.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(Yg(f))return"vertical";throw new Error("Need a valid continuous axis for "+b+"s")}const KV=new aq("boxplot",aK);function $J(a){return Yc(a)?"tukey":a}function aK(a,{config:b}){var c,d;const{mark:e,encoding:f,selection:g,projection:h}=a,i=Fa(a,["mark","encoding","selection","projection"]),j=Pg(e)?e:{type:e};g&&Ba(KI("boxplot"));const k=null!==(c=j.extent)&&void 0!==c?c:b.boxplot.extent,l=Hc("size",j,b),m=$J(k),{transform:n,continuousAxisChannelDef:o,continuousAxis:p,groupby:q,aggregate:s,encodingWithoutContinuousAxis:r,ticksOrient:u,boxOrient:t,customTooltipWithoutAggregatedField:w}=function(wa,xa,oa){const Ma=_J(wa,"boxplot"),{continuousAxisChannelDef:Za,continuousAxis:Pa}=ZJ(wa,Ma,"boxplot"),La=Za.field,wb=$J(xa),tc=[...bK(La),{op:"median",field:La,as:"mid_box_"+La},{op:"min",field:La,as:("min-max"===wb?"lower_whisker_":"min_")+La},{op:"max",field:La,as:("min-max"===wb?"upper_whisker_":"max_")+La}],Oc="min-max"===wb||"tukey"===wb?[]:[{calculate:`datum["upper_box_${La}"] - datum["lower_box_${La}"]`,as:"iqr_"+La},{calculate:`min(datum["upper_box_${La}"] + datum["iqr_${La}"] * ${xa}, datum["max_${La}"])`,as:"upper_whisker_"+La},{calculate:`max(datum["lower_box_${La}"] - datum["iqr_${La}"] * ${xa}, datum["min_${La}"])`,as:"lower_whisker_"+La}],xb=wa.encoding,hd=Pa,Ae=(xb[hd],Fa(xb,["symbol"==typeof hd?hd:hd+""])),{customTooltipWithoutAggregatedField:Gd,filteredEncoding:Td}=function(wy){const{tooltip:Mk}=wy,xy=Fa(wy,["tooltip"]);if(!Mk)return{filteredEncoding:wy};let Wm,Hh;if(U(Mk)){for(const yy of Mk)yy.aggregate?(Wm||(Wm=[]),Wm.push(yy)):(Hh||(Hh=[]),Hh.push(yy));Wm&&(xy.tooltip=Wm)}else Mk.aggregate?xy.tooltip=Mk:Hh=Mk;return U(Hh)&&1===Hh.length&&(Hh=Hh[0]),{customTooltipWithoutAggregatedField:Hh,filteredEncoding:xy}}(Ae),{bins:tg,timeUnits:ug,aggregate:Gh,groupby:Wq,encoding:vy}=rx(Td,oa),oY="vertical"===Ma?"horizontal":"vertical",pY=Ma;return{transform:[...tg,...ug,{aggregate:[...Gh,...tc],groupby:Wq},...Oc],groupby:Wq,aggregate:Gh,continuousAxisChannelDef:Za,continuousAxis:Pa,encodingWithoutContinuousAxis:vy,ticksOrient:oY,boxOrient:pY,customTooltipWithoutAggregatedField:Gd}}(a,k,b),{color:x,size:z}=r,A=Fa(r,["color","size"]),B=wa=>ux(j,p,o,wa,b.boxplot),I=B(A),J=B(r),D=B(Object.assign(Object.assign({},A),z?{size:z}:{})),O=tx([{fieldPrefix:"min-max"===m?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===m?"lower_whisker_":"min_",titlePrefix:"Min"}],o,r),K={type:"tick",color:"black",opacity:1,orient:u,invalid:null},Q="min-max"===m?O:tx([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],o,r),V=[...I({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:Q}),...I({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:Q}),...I({partName:"ticks",mark:K,positionPrefix:"lower_whisker",aria:!1,extraEncoding:Q}),...I({partName:"ticks",mark:K,positionPrefix:"upper_whisker",aria:!1,extraEncoding:Q})],$=[..."tukey"!==m?V:[],...J({partName:"box",mark:Object.assign(Object.assign({type:"bar"},l?{size:l}:{}),{orient:t,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:O}),...D({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ka(b.boxplot.median)&&b.boxplot.median.color?{color:b.boxplot.median.color}:{}),l?{size:l}:{}),{orient:u,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:O})];let Ia;if("min-max"!==m){const wa=`datum["lower_box_${o.field}"]`,xa=`datum["upper_box_${o.field}"]`,oa=`(${xa} - ${wa})`,Ma=`${wa} - ${k} * ${oa}`,Za=`${xa} + ${k} * ${oa}`,Pa=`datum["${o.field}"]`,La={joinaggregate:bK(o.field),groupby:q};let wb;"tukey"===m&&(wb={transform:[{filter:`(${Ma} <= ${Pa}) && (${Pa} <= ${Za})`},{aggregate:[{op:"min",field:o.field,as:"lower_whisker_"+o.field},{op:"max",field:o.field,as:"upper_whisker_"+o.field},{op:"min",field:"lower_box_"+o.field,as:"lower_box_"+o.field},{op:"max",field:"upper_box_"+o.field,as:"upper_box_"+o.field},...s],groupby:q}],layer:V});const tc=Fa(A,["tooltip"]),{scale:Oc,axis:xb}=o,hd=XJ(o),Ae=YJ(j,"outliers",b.boxplot,!0,{transform:[{filter:`(${Pa} < ${Ma}) || (${Pa} > ${Za})`}],mark:"point",encoding:Object.assign(Object.assign({[p]:Object.assign(Object.assign(Object.assign({field:o.field,type:o.type},void 0!==hd?{title:hd}:{}),void 0!==Oc?{scale:Oc}:{}),void 0!==xb?{axis:xb}:{})},tc),w?{tooltip:w}:{})})[0];Ae&&wb?Ia={transform:[La],layer:[Ae,wb]}:Ae?(Ia=Ae,Ia.transform.unshift(La)):wb&&(Ia=wb,Ia.transform.unshift(La))}return Ia?Object.assign(Object.assign({},i),{layer:[Ia,{transform:n,layer:$}]}):Object.assign(Object.assign({},i),{transform:(null!==(d=i.transform)&&void 0!==d?d:[]).concat(n),layer:$})}function bK(a){return[{op:"q1",field:a,as:"lower_box_"+a},{op:"q3",field:a,as:"upper_box_"+a}]}const LV=new aq("errorbar",cK);function cK(a,{config:b}){const{transform:c,continuousAxisChannelDef:d,continuousAxis:e,encodingWithoutContinuousAxis:f,ticksOrient:g,markDef:h,outerSpec:i,tooltipEncoding:j}=dK(a,"errorbar",b),k=ux(h,e,d,f,b.errorbar),l={type:"tick",orient:g},m=[...k({partName:"ticks",mark:l,positionPrefix:"lower",aria:!1,extraEncoding:j}),...k({partName:"ticks",mark:l,positionPrefix:"upper",aria:!1,extraEncoding:j}),...k({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:j})];return Object.assign(Object.assign(Object.assign({},i),{transform:c}),m.length>1?{layer:m}:Object.assign({},m[0]))}function MV(a,b){const{encoding:c}=a;if(function(h){return(Cb(h.x)||Cb(h.y))&&!Cb(h.x2)&&!Cb(h.y2)&&!Cb(h.xError)&&!Cb(h.xError2)&&!Cb(h.yError)&&!Cb(h.yError2)}(c))return{orient:_J(a,b),inputType:"raw"};const d=function(h){return Cb(h.x2)||Cb(h.y2)}(c),e=function(h){return Cb(h.xError)||Cb(h.xError2)||Cb(h.yError)||Cb(h.yError2)}(c),f=c.x,g=c.y;if(d){if(e)throw new Error(b+" cannot be both type aggregated-upper-lower and aggregated-error");const h=c.x2,i=c.y2;if(Cb(h)&&Cb(i))throw new Error(b+" cannot have both x2 and y2");if(Cb(h)){if(Yg(f))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+b)}if(Cb(i)){if(Yg(g))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+b)}throw new Error("No ranged axis")}{const h=c.xError,i=c.xError2,j=c.yError,k=c.yError2;if(Cb(i)&&!Cb(h))throw new Error(b+" cannot have xError2 without xError");if(Cb(k)&&!Cb(j))throw new Error(b+" cannot have yError2 without yError");if(Cb(h)&&Cb(j))throw new Error(b+" cannot have both xError and yError with both are quantiative");if(Cb(h)){if(Yg(f))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Cb(j)){if(Yg(g))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function dK(a,b,c){var d;const{mark:e,encoding:f,selection:g,projection:h}=a,i=Fa(a,["mark","encoding","selection","projection"]),j=Pg(e)?e:{type:e};g&&Ba(KI(b));const{orient:k,inputType:l}=MV(a,b),{continuousAxisChannelDef:m,continuousAxisChannelDef2:n,continuousAxisChannelDefError:o,continuousAxisChannelDefError2:p,continuousAxis:q}=ZJ(a,k,b),{errorBarSpecificAggregate:s,postAggregateCalculates:r,tooltipSummary:u,tooltipTitleWithFieldName:t}=function(wa,xa,oa,Ma,Za,Pa,La,wb){let tc=[],Oc=[];const xb=xa.field;let hd,Ae=!1;if("raw"===Pa){const Gd=wa.center?wa.center:wa.extent?"iqr"===wa.extent?"median":"mean":wb.errorbar.center,Td=wa.extent?wa.extent:"mean"===Gd?"stderr":"iqr";if("median"===Gd!=("iqr"===Td)&&Ba(function(tg,ug,Gh){return`${tg} is not usually used with ${ug} for ${Gh}.`}(Gd,Td,La)),"stderr"===Td||"stdev"===Td)tc=[{op:Td,field:xb,as:"extent_"+xb},{op:Gd,field:xb,as:"center_"+xb}],Oc=[{calculate:`datum["center_${xb}"] + datum["extent_${xb}"]`,as:"upper_"+xb},{calculate:`datum["center_${xb}"] - datum["extent_${xb}"]`,as:"lower_"+xb}],hd=[{fieldPrefix:"center_",titlePrefix:Vp(Gd)},{fieldPrefix:"upper_",titlePrefix:eK(Gd,Td,"+")},{fieldPrefix:"lower_",titlePrefix:eK(Gd,Td,"-")}],Ae=!0;else{let tg,ug,Gh;wa.center&&wa.extent&&Ba(function(Wq,vy){return`Center is not needed to be specified in ${vy} when extent is ${Wq}.`}(wa.extent,La)),"ci"===Td?(tg="mean",ug="ci0",Gh="ci1"):(tg="median",ug="q1",Gh="q3"),tc=[{op:ug,field:xb,as:"lower_"+xb},{op:Gh,field:xb,as:"upper_"+xb},{op:tg,field:xb,as:"center_"+xb}],hd=[{fieldPrefix:"upper_",titlePrefix:rj({field:xb,aggregate:Gh,type:"quantitative"},wb,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:rj({field:xb,aggregate:ug,type:"quantitative"},wb,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:rj({field:xb,aggregate:tg,type:"quantitative"},wb,{allowDisabling:!1})}]}}else{(wa.center||wa.extent)&&Ba(function(Gd,Td){return`${Td?"extent ":""}${Td&&Gd?"and ":""}${Gd?"center ":""}${Td&&Gd?"are ":"is "}not needed when data are aggregated.`}(wa.center,wa.extent)),"aggregated-upper-lower"===Pa?(hd=[],Oc=[{calculate:`datum["${oa.field}"]`,as:"upper_"+xb},{calculate:`datum["${xb}"]`,as:"lower_"+xb}]):"aggregated-error"===Pa&&(hd=[{fieldPrefix:"",titlePrefix:xb}],Oc=[{calculate:`datum["${xb}"] + datum["${Ma.field}"]`,as:"upper_"+xb}],Za?Oc.push({calculate:`datum["${xb}"] + datum["${Za.field}"]`,as:"lower_"+xb}):Oc.push({calculate:`datum["${xb}"] - datum["${Ma.field}"]`,as:"lower_"+xb}));for(const Gd of Oc)hd.push({fieldPrefix:Gd.as.substring(0,6),titlePrefix:yk(yk(Gd.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:Oc,errorBarSpecificAggregate:tc,tooltipSummary:hd,tooltipTitleWithFieldName:Ae}}(j,m,n,o,p,l,b,c),w=f,x=q,z=(w[x],"x"===q?"x2":"y2"),A=(w[z],"x"===q?"xError":"yError"),B=(w[A],"x"===q?"xError2":"yError2"),I=(w[B],Fa(w,["symbol"==typeof x?x:x+"","symbol"==typeof z?z:z+"","symbol"==typeof A?A:A+"","symbol"==typeof B?B:B+""])),{bins:J,timeUnits:D,aggregate:O,groupby:K,encoding:Q}=rx(I,c),V=[...O,...s],$="raw"!==l?[]:K,Ia=tx(u,m,Q,t);return{transform:[...null!==(d=i.transform)&&void 0!==d?d:[],...J,...D,...0===V.length?[]:[{aggregate:V,groupby:$}],...r],groupby:$,continuousAxisChannelDef:m,continuousAxis:q,encodingWithoutContinuousAxis:Q,ticksOrient:"vertical"===k?"horizontal":"vertical",markDef:j,outerSpec:i,tooltipEncoding:Ia}}function eK(a,b,c){return Vp(a)+" "+c+" "+b}const NV=new aq("errorband",fK);function fK(a,{config:b}){const{transform:c,continuousAxisChannelDef:d,continuousAxis:e,encodingWithoutContinuousAxis:f,markDef:g,outerSpec:h,tooltipEncoding:i}=dK(a,"errorband",b),j=g,k=ux(j,e,d,f,b.errorband),l=void 0!==a.encoding.x&&void 0!==a.encoding.y;let m={type:l?"area":"rect"},n={type:l?"line":"rule"};const o=Object.assign(Object.assign({},j.interpolate?{interpolate:j.interpolate}:{}),j.tension&&j.interpolate?{tension:j.tension}:{});return l?(m=Object.assign(Object.assign(Object.assign({},m),o),{ariaRoleDescription:"errorband"}),n=Object.assign(Object.assign({},n),o)):j.interpolate?Ba(TI("interpolate")):j.tension&&Ba(TI("tension")),Object.assign(Object.assign({},h),{transform:c,layer:[...k({partName:"band",mark:m,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:i}),...k({partName:"borders",mark:n,positionPrefix:"lower",aria:!1,extraEncoding:i}),...k({partName:"borders",mark:n,positionPrefix:"upper",aria:!1,extraEncoding:i})]})}const gK={};function vx(a,b,c){const d=new aq(a,b);gK[a]={normalizer:d,parts:c}}vx("boxplot",aK,["box","median","outliers","rule","ticks"]),vx("errorbar",cK,["ticks","rule"]),vx("errorband",fK,["band","borders"]);const OV=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],hK=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],PV={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},QV={single:{on:"click",fields:["_vgsid_"],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:["_vgsid_"],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function wx(a){return!(!a||"legend"!==a&&!a.legend)}function xx(a){return wx(a)&&ka(a)}function yx(a){return"concat"in a}function vq(a){return"vconcat"in a}function zx(a){return"hconcat"in a}function _g(a){return ka(a)&&void 0!==a.step}function iK(a){return a.view||a.width||a.height}const RV=Ea({align:1,bounds:1,center:1,columns:1,spacing:1});function Ax(a,b){var c;return null!==(c=a[b])&&void 0!==c?c:a["width"===b?"continuousWidth":"continuousHeight"]}function wq(a,b){const c=Im(a,b);return _g(c)?c.step:Bx}function Im(a,b){var c;return Kd(null!==(c=a[b])&&void 0!==c?c:a["width"===b?"discreteWidth":"discreteHeight"],{step:a.step})}const Bx=20,SV={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:Bx},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:MU,circle:{},geoshape:{},image:{},line:{},point:{},rect:NU,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:QV,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},Bh=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],jK={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},kK={blue:Bh[0],orange:Bh[1],red:Bh[2],teal:Bh[3],green:Bh[4],yellow:Bh[5],purple:Bh[6],pink:Bh[7],brown:Bh[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function lK(a={}){const{color:b,font:c,fontSize:d}=a,e=Fa(a,["color","font","fontSize"]);return Wa({},SV,c?function(f){return{text:{font:f},style:{"guide-label":{font:f},"guide-title":{font:f},"group-title":{font:f},"group-subtitle":{font:f}}}}(c):{},b?function(f={}){return{signals:[{name:"color",value:ka(f)?Object.assign(Object.assign({},kK),f):kK}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(b):{},d?function(f){return{signals:[{name:"fontSize",value:ka(f)?Object.assign(Object.assign({},jK),f):jK}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(d):{},e||{})}const TV=["view",...rI],UV=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],VV=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function WV(a){a=ac(a);for(const b of UV)delete a[b];if(a.axis)for(const b in a.axis)Fw(a.axis[b])&&delete a.axis[b];if(a.legend)for(const b of OV)delete a.legend[b];if(a.mark){for(const b of sI)delete a.mark[b];a.mark.tooltip&&ka(a.mark.tooltip)&&delete a.mark.tooltip}for(const b of TV){for(const d of sI)delete a[b][d];const c=VV[b];if(c)for(const d of c)delete a[b][d];XV(a,b)}for(const b of Ea(gK))delete a[b];!function(b){const{titleMarkConfig:c,subtitleMarkConfig:d,subtitle:e}=NJ(b.title);_c(c)||(b.style["group-title"]=Object.assign(Object.assign({},b.style["group-title"]),c)),_c(d)||(b.style["group-subtitle"]=Object.assign(Object.assign({},b.style["group-subtitle"]),d)),_c(e)?delete b.title:b.title=e}(a);for(const b in a)ka(a[b])&&_c(a[b])&&delete a[b];return _c(a)?void 0:a}function XV(a,b,c,d){const e=d?a[b][d]:a[b];"view"===b&&(c="cell");const f=Object.assign(Object.assign({},e),a.style[null!=c?c:b]);_c(f)||(a.style[null!=c?c:b]=f),d||delete a[b]}function xq(a){return"layer"in a}class mK{map(a,b){return nq(a)?this.mapFacet(a,b):function(c){return"repeat"in c}(a)?this.mapRepeat(a,b):zx(a)?this.mapHConcat(a,b):vq(a)?this.mapVConcat(a,b):yx(a)?this.mapConcat(a,b):this.mapLayerOrUnit(a,b)}mapLayerOrUnit(a,b){if(xq(a))return this.mapLayer(a,b);if(vh(a))return this.mapUnit(a,b);throw new Error(Ow(a))}mapLayer(a,b){return Object.assign(Object.assign({},a),{layer:a.layer.map(c=>this.mapLayerOrUnit(c,b))})}mapHConcat(a,b){return Object.assign(Object.assign({},a),{hconcat:a.hconcat.map(c=>this.map(c,b))})}mapVConcat(a,b){return Object.assign(Object.assign({},a),{vconcat:a.vconcat.map(c=>this.map(c,b))})}mapConcat(a,b){const{concat:c}=a,d=Fa(a,["concat"]);return Object.assign(Object.assign({},d),{concat:c.map(e=>this.map(e,b))})}mapFacet(a,b){return Object.assign(Object.assign({},a),{spec:this.map(a.spec,b)})}mapRepeat(a,b){return Object.assign(Object.assign({},a),{spec:this.map(a.spec,b)})}}const YV={zero:1,center:1,normalize:1},ZV=new Set([nI,Yp,Xp,$p,_p,Hw,Iw,Zp,oI,Gw]),_V=new Set([Yp,Xp,nI]);function nK(a,b){var c,d;const e="x"===b?"y":"radius",f=a[b],g=a[e];if(Qa(f)&&Qa(g))if("quantitative"===oi(f)&&"quantitative"===oi(g)){if(f.stack)return b;if(g.stack)return e;const h=Qa(f)&&!!f.aggregate;if(h!==(Qa(g)&&!!g.aggregate))return h?b:e;{const i=null===(c=f.scale)||void 0===c?void 0:c.type,j=null===(d=g.scale)||void 0===d?void 0:d.type;if(i&&"linear"!==i)return e;if(j&&"linear"!==j)return b}}else{if("quantitative"===oi(f))return b;if("quantitative"===oi(g))return e}else{if("quantitative"===oi(f))return b;if("quantitative"===oi(g))return e}}function oK(a,b,c={}){const d=Pg(a)?a.type:a;if(!ZV.has(d))return null;const e=nK(b,"x")||nK(b,"theta");if(!e)return null;const f=b[e],g=Qa(f)?Ka(f,{}):void 0;let h=function(n){switch(n){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(e),i=b[h],j=Qa(i)?Ka(i,{}):void 0;j===g&&(j=void 0,i=void 0,h=void 0);const k=XU.reduce((n,o)=>{if("tooltip"!==o&&uj(b,o)){const p=b[o];for(const q of Ra(p)){const s=Zg(q);if(s.aggregate)continue;const r=Ka(s,{});r&&r===j||n.push({channel:o,fieldDef:s})}}return n},[]);let l;if(void 0!==f.stack?l=Bi(f.stack)?f.stack?"zero":null:f.stack:k.length>0&&_V.has(d)&&(l="zero"),!l||!(l in YV))return null;var m;if(qx(b)&&0===k.length)return null;if(f.scale&&f.scale.type&&f.scale.type!==fJ){if(c.disallowNonLinearStack)return null;Ba(function(n){return`Cannot stack non-linear scale (${n}).`}(f.scale.type))}return Cb(b[Tg(e)])?(void 0!==f.stack&&Ba(`Cannot stack "${m=e}" if there is already "${m}2".`),null):(Qa(f)&&f.aggregate&&!nb(RU,f.aggregate)&&Ba(`Stacking is applied even though the aggregate function is non-summative ("${f.aggregate}").`),{groupbyChannel:i?h:void 0,groupbyField:j,fieldChannel:e,impute:null!==f.impute&&lj(d),stackBy:k,offset:l})}function $V(a){const b=Fa(a,["point","line"]);return Ea(b).length>1?b:b.type}function aW(a){for(const b of["line","area","rule","trail"])a[b]&&(a=Object.assign(Object.assign({},a),{[b]:uh(a[b],["point","line"])}));return a}function Cx(a,b={},c){return"transparent"===a.point?{opacity:0}:a.point?ka(a.point)?a.point:{}:void 0!==a.point?null:b.point||c.shape?ka(b.point)?b.point:{}:void 0}function pK(a,b={}){return a.line?!0===a.line?{}:a.line:void 0!==a.line?null:b.line?!0===b.line?{}:b.line:void 0}class bW{constructor(){this.name="path-overlay"}hasMatchingType(a,b){if(vh(a)){const{mark:c,encoding:d}=a,e=Pg(c)?c:{type:c};switch(e.type){case"line":case"rule":case"trail":return!!Cx(e,b[e.type],d);case"area":return!!Cx(e,b[e.type],d)||!!pK(e,b[e.type])}}return!1}run(a,b,c){const{config:d}=b,{selection:e,projection:f,encoding:g,mark:h}=a,i=Fa(a,["selection","projection","encoding","mark"]),j=Pg(h)?h:{type:h},k=Cx(j,d[j.type],g),l="area"===j.type&&pK(j,d[j.type]),m=[Object.assign(Object.assign({},e?{selection:e}:{}),{mark:$V(Object.assign(Object.assign({},"area"===j.type&&void 0===j.opacity&&void 0===j.fillOpacity?{opacity:.7}:{}),j)),encoding:uh(g,["shape"])})],n=oK(j,g);let o=g;if(n){const{fieldChannel:p,offset:q}=n;o=Object.assign(Object.assign({},g),{[p]:Object.assign(Object.assign({},g[p]),q?{stack:q}:{})})}return l&&m.push(Object.assign(Object.assign({},f?{projection:f}:{}),{mark:Object.assign(Object.assign({type:"line"},xm(j,["clip","interpolate","tension","tooltip"])),l),encoding:o})),k&&m.push(Object.assign(Object.assign({},f?{projection:f}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},xm(j,["clip","tooltip"])),k),encoding:o})),c(Object.assign(Object.assign({},i),{layer:m}),Object.assign(Object.assign({},b),{config:aW(d)}))}}class cW{constructor(){this.name="RangeStep"}hasMatchingType(a){var b;if(vh(a)&&a.encoding)for(const c of Uf){const d=a.encoding[c];if(d&&Cb(d)&&(null===(b=null==d?void 0:d.scale)||void 0===b?void 0:b.rangeStep))return!0}return!1}run(a){var b;const c={};let d=Object.assign({},a.encoding);for(const e of Uf){const f=Ug(e),g=d[e];if(g&&Cb(g)&&(null===(b=null==g?void 0:g.scale)||void 0===b?void 0:b.rangeStep)){const{scale:h}=g,i=Fa(g,["scale"]),j=Fa(h,["rangeStep"]);c[f]={step:h.rangeStep},Ba(`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`),d=Object.assign(Object.assign({},d),{[e]:Object.assign(Object.assign({},i),_c(j)?{}:{scale:j})})}}return Object.assign(Object.assign(Object.assign({},c),a),{encoding:d})}}function dW(a,b){return b?Em(a)?tK(a,b):qK(a,b):a}function Dx(a,b){return b?tK(a,b):a}function Ex(a,b,c){const d=b[a];return function(e){return e&&!Xa(e)&&"repeat"in e}(d)?d.repeat in c?Object.assign(Object.assign({},b),{[a]:c[d.repeat]}):void Ba(function(e){return`Unknown repeated value "${e}".`}(d.repeat)):b}function qK(a,b){if(void 0!==(a=Ex("field",a,b))){if(null===a)return null;if(CJ(a)&&Xg(a.sort)){const c=Ex("field",a.sort,b);a=Object.assign(Object.assign({},a),c?{sort:c}:{})}return a}}function rK(a,b){if(Qa(a))return qK(a,b);{const c=Ex("datum",a,b);return c===a||c.type||(c.type="nominal"),c}}function sK(a,b){if(!Cb(a)){if(jx(a)){const c=rK(a.condition,b);return c?Object.assign(Object.assign({},a),{condition:c}):Fa(a,["condition"])}return a}{const c=rK(a,b);if(c)return c;if(ix(a))return{condition:a.condition}}}function tK(a,b){const c={};for(const d in a)if(db(a,d)){const e=a[d];if(U(e))c[d]=e.map(f=>sK(f,b)).filter(f=>f);else{const f=sK(e,b);void 0!==f&&(c[d]=f)}}return c}class eW{constructor(){this.name="RuleForRangedLine"}hasMatchingType(a){if(vh(a)){const{encoding:b,mark:c}=a;if("line"===c)for(const d of WU){const e=b[nj(d)];if(b[d]&&(Qa(e)&&!Te(e.bin)||pi(e)))return!0}}return!1}run(a,b,c){const{encoding:d}=a;var e,f;return Ba((e=!!d.x2,f=!!d.y2,`Line mark is for continuous lines and thus cannot be used with ${e&&f?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),c(Object.assign(Object.assign({},a),{mark:"rule"}),b)}}function uK(a){const{parentEncoding:b,encoding:c}=a;if(b&&c){const f=Ea(b).reduce((g,h)=>(c[h]&&g.push(h),g),[]);f.length>0&&Ba(`Layer's shared ${(d=f).join(",")} channel ${1===d.length?"is":"are"} overriden.`)}var d;const e=Object.assign(Object.assign({},null!=b?b:{}),null!=c?c:{});return _c(e)?void 0:e}function vK(a){const{parentProjection:b,projection:c}=a;return b&&c&&Ba(function(d){const{parentProjection:e,projection:f}=d;return`Layer's shared projection ${kd(e)} is overridden by a child projection ${kd(f)}.`}({parentProjection:b,projection:c})),null!=c?c:b}function wK(a,b){void 0===b&&(b=lK(a.config));const c=function(g,h={}){return fW.map(g,{config:h})}(a,b),{width:d,height:e}=a,f=function(g,h,i){let{width:j,height:k}=h;const l=vh(g)||xq(g),m={};l?"container"==j&&"container"==k?(m.type="fit",m.contains="padding"):"container"==j?(m.type="fit-x",m.contains="padding"):"container"==k&&(m.type="fit-y",m.contains="padding"):("container"==j&&(Ba(GI("width")),j=void 0),"container"==k&&(Ba(GI("height")),k=void 0));const n=Object.assign(Object.assign(Object.assign({type:"pad"},m),i?xK(i.autosize):{}),xK(g.autosize));return"fit"!==n.type||l||(Ba('Autosize "fit" only works for single views and layered views.'),n.type="pad"),"container"==j&&"fit"!=n.type&&"fit-x"!=n.type&&Ba(HI("width")),"container"==k&&"fit"!=n.type&&"fit-y"!=n.type&&Ba(HI("height")),wm(n,{type:"pad"})?void 0:n}(c,{width:d,height:e,autosize:a.autosize},b);return Object.assign(Object.assign({},c),f?{autosize:f}:{})}const fW=new class extends mK{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[KV,LV,NV,new bW(),new eW(),new cW()]}map(a,b){if(vh(a)){const c=uj(a.encoding,wh),d=uj(a.encoding,xh),e=uj(a.encoding,"facet");if(c||d||e)return this.mapFacetedUnit(a,b)}return super.map(a,b)}mapUnit(a,b){const{parentEncoding:c,parentProjection:d}=b,e=Object.assign(Object.assign({},a),{encoding:Dx(a.encoding,b.repeater)});if(c||d)return this.mapUnitWithParentEncodingOrProjection(e,b);const f=this.mapLayerOrUnit.bind(this);for(const g of this.nonFacetUnitNormalizers)if(g.hasMatchingType(e,b.config))return g.run(e,b,f);return e}mapRepeat(a,b){return function(c){return!U(c.repeat)&&c.repeat.layer}(a)?this.mapLayerRepeat(a,b):this.mapNonLayerRepeat(a,b)}mapLayerRepeat(a,b){const{repeat:c,spec:d}=a,e=Fa(a,["repeat","spec"]),{row:f,column:g,layer:h}=c,{repeater:i={},repeaterPrefix:j=""}=b;return f||g?this.mapRepeat(Object.assign(Object.assign({},a),{repeat:Object.assign(Object.assign({},f?{row:f}:{}),g?{column:g}:{}),spec:{repeat:{layer:h},spec:d}}),b):Object.assign(Object.assign({},e),{layer:h.map(k=>{const l=Object.assign(Object.assign({},i),{layer:k}),m=(d.name||"")+j+"child__layer_"+ld(k),n=this.mapLayerOrUnit(d,Object.assign(Object.assign({},b),{repeater:l,repeaterPrefix:m}));return n.name=m,n})})}mapNonLayerRepeat(a,b){var c;const{repeat:d,spec:e,data:f}=a,g=Fa(a,["repeat","spec","data"]);!U(d)&&a.columns&&(a=uh(a,["columns"]),Ba(LI("repeat")));const h=[],{repeater:i={},repeaterPrefix:j=""}=b,k=!U(d)&&d.row||[i?i.row:null],l=!U(d)&&d.column||[i?i.column:null],m=U(d)&&d||[i?i.repeat:null];for(const o of m)for(const p of k)for(const q of l){const s={repeat:o,row:p,column:q,layer:i.layer},r=(e.name||"")+j+"child__"+(U(d)?""+ld(o):(d.row?"row_"+ld(p):"")+(d.column?"column_"+ld(q):"")),u=this.map(e,Object.assign(Object.assign({},b),{repeater:s,repeaterPrefix:r}));u.name=r,h.push(uh(u,["data"]))}const n=U(d)?a.columns:d.column?d.column.length:1;return Object.assign(Object.assign({data:null!==(c=e.data)&&void 0!==c?c:f,align:"all"},g),{columns:n,concat:h})}mapFacet(a,b){const{facet:c}=a;return Em(c)&&a.columns&&(a=uh(a,["columns"]),Ba(LI("facet"))),super.mapFacet(a,b)}mapUnitWithParentEncodingOrProjection(a,b){const{encoding:c,projection:d}=a,{parentEncoding:e,parentProjection:f,config:g}=b,h=vK({parentProjection:f,projection:d}),i=uK({parentEncoding:e,encoding:Dx(c,b.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},a),h?{projection:h}:{}),i?{encoding:i}:{}),{config:g})}mapFacetedUnit(a,b){const c=a.encoding,{row:d,column:e,facet:f}=c,g=Fa(c,["row","column","facet"]),{mark:h,width:i,projection:j,height:k,view:l,selection:m,encoding:n}=a,o=Fa(a,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:p,layout:q}=this.getFacetMappingAndLayout({row:d,column:e,facet:f},b),s=Dx(g,b.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},o),q),{facet:p,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i?{width:i}:{}),k?{height:k}:{}),l?{view:l}:{}),j?{projection:j}:{}),{mark:h,encoding:s}),m?{selection:m}:{})}),b)}getFacetMappingAndLayout(a,b){var c;const{row:d,column:e,facet:f}=a;if(d||e){f&&Ba(`Facet encoding dropped as ${(g=[...d?[wh]:[],...e?[xh]:[]]).join(" and ")} ${g.length>1?"are":"is"} also specified.`);const h={},i={};for(const j of[wh,xh]){const k=a[j];if(k){const l=Fa(k,["align","center","spacing","columns"]);h[j]=l;for(const m of["align","center","spacing"])void 0!==k[m]&&(i[m]=null!==(c=i[m])&&void 0!==c?c:{},i[m][j]=k[m])}}return{facetMapping:h,layout:i}}{const{align:h,center:i,spacing:j,columns:k}=f;return{facetMapping:dW(Fa(f,["align","center","spacing","columns"]),b.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},h?{align:h}:{}),i?{center:i}:{}),j?{spacing:j}:{}),k?{columns:k}:{})}}var g}mapLayer(a,b){var{parentEncoding:c,parentProjection:d}=b,e=Fa(b,["parentEncoding","parentProjection"]);const{encoding:f,projection:g}=a,h=Fa(a,["encoding","projection"]),i=Object.assign(Object.assign({},e),{parentEncoding:uK({parentEncoding:c,encoding:f}),parentProjection:vK({parentProjection:d,projection:g})});return super.mapLayer(h,i)}}();function xK(a){return Xa(a)?{type:a}:null!=a?a:{}}const gW=["background","padding"];function yK(a){return gW.reduce((b,c)=>(a&&void 0!==a[c]&&(b[c]=a[c]),b),{})}class ri{constructor(a={},b={}){this.explicit=a,this.implicit=b}clone(){return new ri(ac(this.explicit),ac(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(a){return Kd(this.explicit[a],this.implicit[a])}getWithExplicit(a){return void 0!==this.explicit[a]?{explicit:!0,value:this.explicit[a]}:void 0!==this.implicit[a]?{explicit:!1,value:this.implicit[a]}:{explicit:!1,value:void 0}}setWithExplicit(a,b){void 0!==b.value&&this.set(a,b.value,b.explicit)}set(a,b,c){return delete this[c?"implicit":"explicit"][a],this[c?"explicit":"implicit"][a]=b,this}copyKeyFromSplit(a,b){void 0!==b.explicit[a]?this.set(a,b.explicit[a],!0):void 0!==b.implicit[a]&&this.set(a,b.implicit[a],!1)}copyKeyFromObject(a,b){void 0!==b[a]&&this.set(a,b[a],!0)}copyAll(a){for(const b of Ea(a.combine())){const c=a.getWithExplicit(b);this.setWithExplicit(b,c)}}}function vj(a){return{explicit:!0,value:a}}function qg(a){return{explicit:!1,value:a}}function zK(a){return(b,c,d,e)=>{const f=a(b.value,c.value);return f>0?b:f<0?c:yq(b,c,d,e)}}function yq(a,b,c,d){return a.explicit&&b.explicit&&Ba(function(e,f,g,h){return`Conflicting ${f.toString()} property "${e.toString()}" (${kd(g)} and ${kd(h)}). Using ${kd(g)}.`}(c,d,a.value,b.value)),a}function si(a,b,c,d,e=yq){return void 0===a||void 0===a.value?b:a.explicit&&!b.explicit?a:b.explicit&&!a.explicit?b:wm(a.value,b.value)?a:e(a,b,c,d)}class hW extends ri{constructor(a={},b={},c=!1){super(a,b),this.explicit=a,this.implicit=b,this.parseNothing=c}clone(){const a=super.clone();return a.parseNothing=this.parseNothing,a}}function Jm(a){return"url"in a}function zq(a){return"values"in a}function AK(a){return"name"in a&&!Jm(a)&&!zq(a)&&!wj(a)}function wj(a){return a&&(BK(a)||CK(a)||Fx(a))}function BK(a){return"sequence"in a}function CK(a){return"sphere"in a}function Fx(a){return"graticule"in a}const ye="main";function DK(a){return"filter"in a}function iW(a){return void 0!==(null==a?void 0:a.stop)}function jW(a){return"lookup"in a}function kW(a){return"pivot"in a}function lW(a){return"density"in a}function mW(a){return"quantile"in a}function nW(a){return"regression"in a}function oW(a){return"loess"in a}function pW(a){return"sample"in a}function qW(a){return"window"in a}function rW(a){return"joinaggregate"in a}function sW(a){return"flatten"in a}function tW(a){return"calculate"in a}function uW(a){return"bin"in a}function vW(a){return"impute"in a}function wW(a){return"timeUnit"in a}function xW(a){return"aggregate"in a}function yW(a){return"stack"in a}function zW(a){return"fold"in a}function Km(a,b,c,d){const e=ix(b)&&b.condition,f=d(b);return e?{[c]:[...Ra(e).map(g=>{const h=d(g),i=function(j){return j.selection}(g)?ZK(a,g.selection):Fq(a,g.test);return Object.assign({test:i},h)}),...void 0!==f?[f]:[]]}:void 0!==f?{[c]:f}:{}}function Gx(a,b="text"){const c=a.encoding[b];return Km(a,c,b,d=>Aq(d,a.config))}function Aq(a,b,c="datum"){if(a){if(Ah(a))return Fd(a.value);if(Cb(a)){const{format:d,formatType:e}=pq(a);return ex({fieldOrDatumDef:a,format:d,formatType:e,expr:c,config:b})}}}function EK(a,b={}){const{encoding:c,markDef:d,config:e,stack:f}=a,g=c.tooltip;if(U(g))return{tooltip:GK({tooltip:g},f,e,b)};{const h=b.reactiveGeom?"datum.datum":"datum";return Km(a,g,"tooltip",i=>{const j=Aq(i,e,h);if(j)return j;if(null===i)return;let k=Hc("tooltip",d,e);return!0===k&&(k={content:"encoding"}),Xa(k)?{value:k}:ka(k)?"encoding"===k.content?GK(c,f,e,b):{signal:h}:void 0})}}function FK(a,b,c,{reactiveGeom:d}={}){const e={},f=d?"datum.datum":"datum",g=[];function h(j,k){const l=nj(k),m=Bf(j)?j:Object.assign(Object.assign({},j),{type:a[l].type}),n=Ra(rj(m,c,{allowDisabling:!1})).join(", ");let o;if(Vg(k)){const p="x"===k?"x2":"y2",q=Zg(a[p]);if(Te(m.bin)&&q){const s=Ka(m,{expr:f}),r=Ka(q,{expr:f}),{format:u,formatType:t}=pq(m);o=lq(s,r,u,t,c),e[p]=!0}else if(b&&b.fieldChannel===k&&"normalize"===b.offset){const{format:s,formatType:r}=pq(m);o=ex({fieldOrDatumDef:m,format:s,formatType:r,expr:f,config:c,normalizeStack:!0}).signal}}o=null!=o?o:Aq(m,c,f).signal,g.push({channel:k,key:n,value:o})}sx(a,(j,k)=>{Qa(j)?h(j,k):oq(j)&&h(j.condition,k)});const i={};for(const{channel:j,key:k,value:l}of g)e[j]||i[k]||(i[Ga(k)]=l);return i}function GK(a,b,c,{reactiveGeom:d}={}){const e=gI(FK(a,b,c,{reactiveGeom:d})).map(({key:f,value:g})=>`${f}: ${g}`);return e.length>0?{signal:`{${e.join(", ")}}`}:void 0}function AW(a){const{markDef:b,config:c}=a,d=Hc("aria",b,c);return!1===d?{}:Object.assign(Object.assign(Object.assign({},d?{aria:d}:{}),function(e){const{mark:f,markDef:g,config:h}=e;if(!1===h.aria)return{};const i=Hc("ariaRoleDescription",g,h);return null!=i?{ariaRoleDescription:{value:i}}:f in lV?{}:{ariaRoleDescription:{value:f}}}(a)),function(e){const{encoding:f,markDef:g,config:h,stack:i}=e,j=f.description;if(j)return Km(e,j,"description",m=>Aq(m,e.config));const k=Hc("description",g,h);if(null!=k)return{description:Fd(k)};if(!1===h.aria)return{};const l=FK(f,i,h);return _c(l)?void 0:{description:{signal:gI(l).map(({key:m,value:n})=>`${m} + ": " + (${n})`).join(' + "; " + ')}}}(a))}function $d(a,b,c={}){const{markDef:d,encoding:e,config:f}=b,{vgChannel:g}=c;let{defaultRef:h,defaultValue:i}=c;void 0===h&&(i=null!=i?i:Hc(a,d,f,{vgChannel:g,ignoreVgConfig:!0}),void 0!==i&&(h=Fd(i)));const j=e[a];return Km(b,j,null!=g?g:a,k=>qJ({channel:a,channelDef:k,markDef:d,config:f,scaleName:b.scaleName(a),scale:b.getScaleComponent(a),stack:null,defaultRef:h}))}function HK(a,b={filled:void 0}){var c,d,e,f;const{markDef:g,encoding:h,config:i}=a,{type:j}=g,k=null!==(c=b.filled)&&void 0!==c?c:Hc("filled",g,i),l=nb(["bar","point","circle","square","geoshape"],j)?"transparent":void 0,m=null!==(e=null!==(d=Hc(!0===k?"color":void 0,g,i,{vgChannel:"fill"}))&&void 0!==d?d:i.mark[!0===k&&"color"])&&void 0!==e?e:l,n=null!==(f=Hc(!1===k?"color":void 0,g,i,{vgChannel:"stroke"}))&&void 0!==f?f:i.mark[!1===k&&"color"],o=k?"fill":"stroke",p=Object.assign(Object.assign({},m?{fill:Fd(m)}:{}),n?{stroke:Fd(n)}:{});return g.color&&(k?g.fill:g.stroke)&&Ba(PI("property",{fill:"fill"in g,stroke:"stroke"in g})),Object.assign(Object.assign(Object.assign(Object.assign({},p),$d("color",a,{vgChannel:o,defaultValue:k?m:n})),$d("fill",a,{defaultValue:h.fill?m:void 0})),$d("stroke",a,{defaultValue:h.stroke?n:void 0}))}function Bq(a,b){const c=b[function(d){switch(d){case"x":return"xOffset";case"y":return"yOffset";case"x2":return"x2Offset";case"y2":return"y2Offset";case og:return"thetaOffset";case Qg:return"radiusOffset";case yh:return"theta2Offset";case"radius2":return"radius2Offset"}}(a)];if(c)return c}function ze(a,b,{defaultPos:c,vgChannel:d,isMidPoint:e}){const{encoding:f,markDef:g,config:h,stack:i}=b,j=f[a],k=f[Tg(a)],l=b.scaleName(a),m=b.getScaleComponent(a),n=Bq(a,g),o=Hx({model:b,defaultPos:c,channel:a,scaleName:l,scale:m}),p=!j&&Vg(a)&&(f.latitude||f.longitude)?{field:b.getName(a)}:function(q){const{channel:s,channelDef:r,isMidPoint:u,scaleName:t,stack:w,offset:x,markDef:z,config:A}=q;if(Cb(r)&&w&&s===w.fieldChannel){if(Qa(r)){const B=Fm({channel:s,fieldDef:r,isMidPoint:u,markDef:z,stack:w,config:A});if(void 0!==B)return kq({scaleName:t,fieldOrDatumDef:r,startSuffix:"start",band:B,offset:x})}return pj(r,t,{suffix:"end"},{offset:x})}return cx(q)}({channel:a,channelDef:j,channel2Def:k,markDef:g,config:h,isMidPoint:e,scaleName:l,scale:m,stack:i,offset:n,defaultRef:o});return p?{[d||a]:p}:void 0}function Hx({model:a,defaultPos:b,channel:c,scaleName:d,scale:e}){const{markDef:f,config:g}=a;return()=>{const h=nj(c),i=ji(c),j=Hc(c,f,g,{vgChannel:i});if(void 0!==j)return Dm(c,j);switch(b){case"zeroOrMin":case"zeroOrMax":if(d){const k=e.get("type");if(!nb([gJ,ax,iq],k)){if(e.domainDefinitelyIncludesZero())return{scale:d,value:0}}}if("zeroOrMin"===b)return"y"===h?{field:{group:"height"}}:{value:0};switch(h){case"radius":return{signal:`min(${a.width.signal},${a.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const k=a[Ug(c)];return Object.assign(Object.assign({},k),{mult:.5})}}}}const BW={left:"x",center:"xc",right:"x2"},CW={top:"y",middle:"yc",bottom:"y2"};function IK(a,b,c,d="middle"){if("radius"===a||"theta"===a)return ji(a);const e=Hc("x"===a?"align":"baseline",b,c);return"x"===a?BW[e||("top"===d?"left":"center")]:CW[e||d]}function Cq(a,b,{defaultPos:c,defaultPos2:d,range:e}){return e?JK(a,b,{defaultPos:c,defaultPos2:d}):ze(a,b,{defaultPos:c})}function JK(a,b,{defaultPos:c,defaultPos2:d}){const{markDef:e,config:f}=b,g=Tg(a),h=Ug(a),i=function(k,l,m){const{encoding:n,mark:o,markDef:p,stack:q,config:s}=k,r=nj(m),u=Ug(m),t=ji(m),w=n[r],x=k.scaleName(r),z=k.getScaleComponent(r),A=Bq(m in n||m in p?m:r,k.markDef);if(!w&&("x2"===m||"y2"===m)&&(n.latitude||n.longitude))return{[t]:{field:k.getName(m)}};const B=function({channel:I,channelDef:J,channel2Def:D,markDef:O,config:K,scaleName:Q,scale:V,stack:$,offset:Ia,defaultRef:wa}){return Cb(J)&&$&&I.charAt(0)===$.fieldChannel.charAt(0)?pj(J,Q,{suffix:"start"},{offset:Ia}):cx({channel:I,channelDef:D,scaleName:Q,scale:V,stack:$,markDef:O,config:K,offset:Ia,defaultRef:wa})}({channel:m,channelDef:w,channel2Def:n[m],markDef:p,config:s,scaleName:x,scale:z,stack:q,offset:A,defaultRef:void 0});return void 0!==B?{[t]:B}:Dq(m,p)||Dq(m,{[m]:tq(m,p,s.style),[u]:tq(u,p,s.style)})||Dq(m,s[o])||Dq(m,s.mark)||{[t]:Hx({model:k,defaultPos:l,channel:m,scaleName:x,scale:z})()}}(b,d,g),j=i[h]?IK(a,e,f):ji(a);return Object.assign(Object.assign({},ze(a,b,{defaultPos:c,vgChannel:j})),i)}function Dq(a,b){const c=Ug(a),d=ji(a);return void 0!==b[d]?{[d]:Dm(a,b[d])}:void 0!==b[a]?{[d]:Dm(a,b[a])}:b[c]?{[c]:Dm(a,b[c])}:void 0}function ti(a,b,c){var d,e,f,g;const{config:h,encoding:i,markDef:j,stack:k}=a,l=Tg(b),m=Ug(b),n=i[b],o=i[l],p=a.getScaleComponent(b),q=p?p.get("type"):void 0,s=a.scaleName(b),r=j.orient,u=null!==(e=null!==(d=i[m])&&void 0!==d?d:i.size)&&void 0!==e?e:Hc("size",j,h,{vgChannel:m}),t="bar"===c&&("x"===b?"vertical"===r:"horizontal"===r);if(Qa(n)&&(bd(n.bin)||Te(n.bin)||n.timeUnit&&!o)&&!u&&!pf(q)){const w=Fm({channel:b,fieldDef:n,stack:k,markDef:j,config:h}),x=null===(f=a.component.axes[b])||void 0===f?void 0:f[0];return function({fieldDef:z,fieldDef2:A,channel:B,band:I,scaleName:J,markDef:D,spacing:O=0,axisTranslate:K,reverse:Q,config:V}){const $=Tg(B),Ia=ji(B),wa=ji($),xa=Bq(B,D);if(bd(z.bin)||z.timeUnit)return{[wa]:KK({channel:B,fieldDef:z,scaleName:J,markDef:D,band:(1-I)/2,offset:Lm($,O,Q,K,xa),config:V}),[Ia]:KK({channel:B,fieldDef:z,scaleName:J,markDef:D,band:1-(1-I)/2,offset:Lm(B,O,Q,K,xa),config:V})};if(Te(z.bin)){const oa=pj(z,J,{},{offset:Lm($,O,Q,K,xa)});if(Qa(A))return{[wa]:oa,[Ia]:pj(A,J,{},{offset:Lm(B,O,Q,K,xa)})};if(Bm(z.bin)&&z.bin.step)return{[wa]:oa,[Ia]:{signal:`scale("${J}", ${Ka(z,{expr:"datum"})} + ${z.bin.step})`,offset:Lm(B,O,Q,K,xa)}}}return void Ba(UI($))}({fieldDef:n,fieldDef2:o,channel:b,markDef:j,scaleName:s,band:w,axisTranslate:null!==(g=null==x?void 0:x.get("translate"))&&void 0!==g?g:.5,spacing:Vg(b)?Hc("binSpacing",j,h):void 0,reverse:p.get("reverse"),config:h})}return(Cb(n)&&pf(q)||t)&&!o?function(w,x,z,A){var B;const{markDef:I,encoding:J,config:D,stack:O}=A,K=I.orient,Q=A.scaleName(z),V=A.getScaleComponent(z),$=Ug(z),Ia=Tg(z),wa="horizontal"===K&&"y"===z||"vertical"===K&&"x"===z,xa=Hc(wa?"size":$,I,D,{vgChannel:$});let oa;(J.size||void 0!==xa)&&(wa?oa=$d("size",A,{vgChannel:$,defaultValue:xa}):Ba(function(tc){return`Cannot apply size to non-oriented mark "${tc}".`}(I.type)));const Ma=null!==(B=Cb(x)?Fm({channel:z,fieldDef:x,markDef:I,stack:O,config:D}):void 0)&&void 0!==B?B:1;oa=oa||{[$]:DW(w,$,Q,V,D,Ma)};const Za="band"!==(null==V?void 0:V.get("type"))||!("band"in oa[$]),Pa=IK(z,I,D,Za?"middle":"top"),La=Bq(z,I),wb=cx({channel:z,channelDef:x,markDef:I,config:D,scaleName:Q,scale:V,stack:O,offset:La,defaultRef:Hx({model:A,defaultPos:"mid",channel:z,scaleName:Q,scale:V}),band:Za?.5:(1-Ma)/2});if($)return Object.assign({[Pa]:wb},oa);{const tc=ji(Ia),Oc=oa[$],xb=La?Object.assign(Object.assign({},Oc),{offset:La}):Oc;return{[Pa]:wb,[tc]:U(wb)?[wb[0],Object.assign(Object.assign({},wb[1]),{offset:xb})]:Object.assign(Object.assign({},wb),{offset:xb})}}}(c,n,b,a):JK(b,a,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function DW(a,b,c,d,e,f){if(d){const i=d.get("type");if("point"===i||"band"===i){if(void 0!==e[a].discreteBandSize)return{value:e[a].discreteBandSize};if(i===hJ){const j=d.get("range");return mi(j)&&Yc(j.step)?{value:j.step-2}:{value:Bx-2}}return{scale:c,band:f}}return{value:e[a].continuousBandSize}}const g=wq(e.view,b),h=Kd(e[a].discreteBandSize,g-2);return void 0!==h?{value:h}:void 0}function Lm(a,b,c,d,e){if(vI(a))return 0;const f="x"===a||"y2"===a?-b/2:b/2;if(tb(c)){const g=Hm(e);return{signal:`${c.signal} ? ${d-f}${g?"-"+g:""} : ${d+f}${g?"+"+g:""}`}}if(tb(e)){const g=d+(c?-f:f);return{signal:`${g||""}${c?" - ":g?" + ":""}${e.signal}`}}return e=e||0,d+(c?-e-f:+e+f)}function KK({channel:a,fieldDef:b,scaleName:c,markDef:d,band:e,offset:f,config:g}){return pJ({fieldDef:b,channel:a,markDef:d,ref:kq({scaleName:c,fieldOrDatumDef:b,band:e,offset:f}),config:g})}const EW=new Set(["aria"]);function Wf(a,b){const{fill:c,stroke:d}="include"===b.color?HK(a):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,f){return kV.reduce((g,h)=>(EW.has(h)||void 0===e[h]||"ignore"===f[h]||(g[h]=Fd(e[h])),g),{})}(a.markDef,b)),LK(a,"fill",c)),LK(a,"stroke",d)),$d("opacity",a)),$d("fillOpacity",a)),$d("strokeOpacity",a)),$d("strokeWidth",a)),$d("strokeDash",a)),EK(a)),Gx(a,"href")),AW(a))}function LK(a,b,c){const{config:d,mark:e,markDef:f}=a;if("hide"===Hc("invalid",f,d)&&c&&!lj(e)){const g=function(h,{invalid:i=!1,channels:j}){const k=j.reduce((m,n)=>{const o=h.getScaleComponent(n);if(o){const p=o.get("type"),q=h.vgField(n,{expr:"datum"});q&&Vf(p)&&(m[q]=!0)}return m},{}),l=Ea(k);if(l.length>0){const m=i?"||":"&&";return l.map(n=>dx(n,i)).join(` ${m} `)}return}(a,{invalid:!0,channels:cq});if(g)return{[b]:[{test:g,value:null},...Ra(c)]}}return c?{[b]:c}:{}}function Ix(a){const{config:b,markDef:c}=a;if(Hc("invalid",c,b)){const d=function(e,{invalid:f=!1,channels:g}){const h=g.reduce((j,k)=>{const l=e.getScaleComponent(k);if(l){const m=l.get("type"),n=e.vgField(k,{expr:"datum"});n&&Vf(m)&&(j[n]=!0)}return j},{}),i=Ea(h);if(i.length>0){const j=f?"||":"&&";return i.map(k=>dx(k,f)).join(` ${j} `)}return}(a,{channels:Uf});if(d)return{defined:{signal:d}}}return{}}function MK(a,b){if(void 0!==b)return{[a]:Fd(b)}}const NK={has:a=>"interval"!==a.type&&a.nearest,parse:(a,b)=>{if(b.events)for(const c of b.events)c.markname=a.getName("voronoi")},marks:(a,b,c)=>{const{x:d,y:e}=b.project.hasChannel,f=a.mark;if(lj(f))return Ba(`The "nearest" transform is not supported for ${f} marks.`),c;const g={name:a.getName("voronoi"),type:"path",interactive:!0,from:{data:a.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},EK(a,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:d||!e?"datum.datum.x || 0":"0"},y:{expr:e||!d?"datum.datum.y || 0":"0"},size:[a.getSizeSignalRef("width"),a.getSizeSignalRef("height")]}]};let h=0,i=!1;return c.forEach((j,k)=>{var l;const m=null!==(l=j.name)&&void 0!==l?l:"";m===a.component.mark[0].name?h=k:m.indexOf("voronoi")>=0&&(i=!0)}),i||c.splice(h+1,0,g),c}};class Tc{constructor(a,b){this.debugName=b,this._children=[],this._parent=null,a&&(this.parent=a)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(a){this._parent=a,a&&a.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(a,b){this._children.indexOf(a)>-1?console.warn("Attempt to add the same child twice."):void 0!==b?this._children.splice(b,0,a):this._children.push(a)}removeChild(a){const b=this._children.indexOf(a);return this._children.splice(b,1),b}remove(){let a=this._parent.removeChild(this);for(const b of this._children)b._parent=this._parent,this._parent.addChild(b,a++)}insertAsParentOf(a){const b=a.parent;b.removeChild(this),this.parent=b,a.parent=this}swapWithParent(){const a=this._parent,b=a.parent;for(const c of this._children)c.parent=a;this._children=[],a.removeChild(this),a.parent.removeChild(a),this.parent=b,a.parent=this}}class Ve extends Tc{constructor(a,b,c,d){super(a,b),this.type=c,this.refCounts=d,this._source=this._name=b,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const a=new this.constructor();return a.debugName="clone_"+this.debugName,a._source=this._source,a._name="clone_"+this._name,a.type=this.type,a.refCounts=this.refCounts,a.refCounts[a._name]=0,a}dependentFields(){return new Set()}producedFields(){return new Set()}hash(){return void 0===this._hash&&(this._hash="Output "+function(a){const b=++EU;return a?String(a)+b:b}()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(a){this._source=a}}class Ch extends Tc{constructor(a,b){super(a),this.formula=b}clone(){return new Ch(null,ac(this.formula))}static makeFromEncoding(a,b){const c=b.reduceFieldDef((d,e,f)=>{const{field:g,timeUnit:h}=e,i=Bd(b)?b.encoding[Tg(f)]:void 0,j=Bd(b)&&hx(f,e,i,b.stack,b.markDef,b.config);if(h){const k=Ka(e,{forAs:!0});d[sc({as:k,field:g,timeUnit:h})]=Object.assign({as:k,field:g,timeUnit:h},j?{band:!0}:{})}return d},{});return _c(c)?null:new Ch(a,c)}static makeFromTransform(a,b){const c=Object.assign({},b),{timeUnit:d}=c,e=Fa(c,["timeUnit"]),f=Ue(d),g=Object.assign(Object.assign({},e),{timeUnit:f});return new Ch(a,{[sc(g)]:g})}merge(a){this.formula=Object.assign({},this.formula);for(const b in a.formula)this.formula[b]&&!a.formula[b].band||(this.formula[b]=a.formula[b]);for(const b of a.children)a.removeChild(b),b.parent=this;a.remove()}producedFields(){return new Set(gi(this.formula).map(a=>a.as))}dependentFields(){return new Set(gi(this.formula).map(a=>a.field))}hash(){return"TimeUnit "+sc(this.formula)}assemble(){const a=[];for(const b of gi(this.formula)){const{field:c,as:d,timeUnit:e}=b,f=Ue(e),{unit:g,utc:h}=f,i=Fa(f,["unit","utc"]);a.push(Object.assign(Object.assign(Object.assign(Object.assign({field:hi(c),type:"timeunit"},g?{units:Uw(g)}:{}),h?{timezone:"utc"}:{}),i),{as:[d,d+"_end"]}))}return a}}class FW{constructor(...a){this.items=a,this.hasChannel={},this.hasField={}}}const OK={has:a=>"single"===a.type&&"global"===a.resolve&&a.bind&&"scales"!==a.bind&&!wx(a.bind),parse:(a,b,c,d)=>{d.on||delete b.events,d.clear||delete b.clear},topLevelSignals:(a,b,c)=>{const d=b.name,e=b.project,f=b.bind,g=b.init&&b.init[0],h=NK.has(b)?"(item().isVoronoi ? datum.datum : datum)":"datum";return e.items.forEach((i,j)=>{var k,l;const m=ld(`${d}_${i.field}`);c.filter(n=>n.name===m).length||c.unshift(Object.assign(Object.assign({name:m},g?{init:Ek(g[j])}:{value:null}),{on:b.events?[{events:b.events,update:`datum && item().mark.marktype !== 'group' ? ${h}[${Ga(i.field)}] : null`}]:[],bind:null!==(l=null!==(k=f[i.field])&&void 0!==k?k:f[i.channel])&&void 0!==l?l:f}))}),c},signals:(a,b,c)=>{const d=b.name,e=b.project,f=c.filter(j=>j.name===d+$g)[0],g=d+"_tuple_fields",h=e.items.map(j=>ld(`${d}_${j.field}`)),i=h.map(j=>j+" !== null").join(" && ");return h.length&&(f.update=`${i} ? {fields: ${g}, values: [${h.join(", ")}]} : null`),delete f.value,delete f.on,c}},PK={has:a=>"multi"===a.type&&!!a.toggle,signals:(a,b,c)=>c.concat({name:b.name+"_toggle",value:!1,on:[{events:b.events,update:b.toggle}]}),modifyExpr:(a,b)=>{const c=b.name+$g,d=b.name+"_toggle";return`${d} ? null : ${c}, `+("global"===b.resolve?d+" ? null : true, ":`${d} ? null : {unit: ${Dh(a)}}, `)+`${d} ? ${c} : null`}},GW={has:a=>void 0!==a.clear&&!1!==a.clear,parse:(a,b,c)=>{c.clear&&(b.clear=Xa(c.clear)?gj(c.clear,"scope"):c.clear)},topLevelSignals:(a,b,c)=>{if(OK.has(b))for(const d of b.project.items){const e=c.findIndex(f=>f.name===ld(`${b.name}_${d.field}`));-1!==e&&c[e].on.push({events:b.clear,update:"null"})}return c},signals:(a,b,c)=>{function d(e,f){-1!==e&&c[e].on&&c[e].on.push({events:b.clear,update:f})}if("interval"===b.type)for(const e of b.project.items){const f=c.findIndex(g=>g.name===e.signals.visual);(d(f,"[0, 0]"),-1===f)&&d(c.findIndex(g=>g.name===e.signals.data),"null")}else{let e=c.findIndex(f=>f.name===b.name+$g);d(e,"null"),PK.has(b)&&(e=c.findIndex(f=>f.name===b.name+"_toggle"),d(e,"false"))}return c}},ui={has:a=>"interval"===a.type&&"global"===a.resolve&&a.bind&&"scales"===a.bind,parse:(a,b)=>{const c=b.scales=[];for(const d of b.project.items){const e=d.channel;if(!li(e))continue;const f=a.getScaleComponent(e),g=f?f.get("type"):void 0;if(!f||!Vf(g)){Ba("Scale bindings are currently only supported for scales with unbinned, continuous domains.");continue}const h={selection:b.name,field:d.field};f.set("selectionExtent",h,!0),c.push(d)}},topLevelSignals:(a,b,c)=>{const d=b.scales.filter(g=>0===c.filter(h=>h.name===g.signals.data).length);if(!a.parent||Kx(a)||0===d.length)return c;const e=c.filter(g=>g.name===b.name)[0];let f=e.update;if(f.indexOf(XK)>=0)e.update=`{${d.map(g=>`${Ga(g.field)}: ${g.signals.data}`).join(", ")}}`;else{for(const g of d){const h=`${Ga(g.field)}: ${g.signals.data}`;f.indexOf(h)<0&&(f=`${f.substring(0,f.length-1)}, ${h}}`)}e.update=f}return c.concat(d.map(g=>({name:g.signals.data})))},signals:(a,b,c)=>{if(a.parent&&!Kx(a))for(const d of b.scales){const e=c.filter(f=>f.name===d.signals.data)[0];e.push="outer",delete e.value,delete e.update}return c}};function Jx(a,b){return`domain(${Ga(a.scaleName(b))})`}function Kx(a){var b;return a.parent&&Kk(a.parent)&&(null!==(b=!a.parent.parent)&&void 0!==b?b:Kx(a.parent.parent))}const QK={has:a=>{const b="global"===a.resolve&&a.bind&&wx(a.bind),c=1===a.project.items.length&&"_vgsid_"!==a.project.items[0].field;return b&&!c&&Ba("Legend bindings are only supported for selections over an individual field or encoding channel."),b&&c},parse:(a,b,c,d)=>{var e;if(d.on||delete b.events,d.clear||delete b.clear,d.on||d.clear){const h='event.item && indexof(event.item.mark.role, "legend") < 0';for(const i of b.events)i.filter=Ra(null!==(e=i.filter)&&void 0!==e?e:[]),i.filter.indexOf(h)<0&&i.filter.push(h)}const f=xx(b.bind)?b.bind.legend:"click",g=Xa(f)?gj(f,"view"):Ra(f);b.bind={legend:{merge:g}}},topLevelSignals:(a,b,c)=>{const d=b.name,e=xx(b.bind)&&b.bind.legend,f=g=>h=>{const i=ac(h);return i.markname=g,i};for(const g of b.project.items){if(!g.hasLegend)continue;const h=ld(g.field)+"_legend",i=`${d}_${h}`;if(0===c.filter(j=>j.name===i).length){const j=e.merge.map(f(h+"_symbols")).concat(e.merge.map(f(h+"_labels"))).concat(e.merge.map(f(h+"_entries")));c.unshift(Object.assign(Object.assign({name:i},b.init?{}:{value:null}),{on:[{events:j,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:e.merge,update:"!event.item || !datum ? null : "+i,force:!0}]}))}}return c},signals:(a,b,c)=>{const d=b.name,e=b.project,f=c.find(l=>l.name===d+$g),g=d+"_tuple_fields",h=e.items.filter(l=>l.hasLegend).map(l=>ld(`${d}_${ld(l.field)}_legend`)),i=`${h.map(l=>l+" !== null").join(" && ")} ? {fields: ${g}, values: [${h.join(", ")}]} : null`;b.events&&h.length>0?f.on.push({events:h.map(l=>({signal:l})),update:i}):h.length>0&&(f.update=i,delete f.value,delete f.on);const j=c.find(l=>l.name===d+"_toggle"),k=xx(b.bind)&&b.bind.legend;return j&&(b.events?j.on.push(Object.assign(Object.assign({},j.on[0]),{events:k})):j.on[0].events=k),c}},RK="_translate_delta",HW={has:a=>"interval"===a.type&&a.translate,signals:(a,b,c)=>{const d=b.name,e=ui.has(b),f=d+"_translate_anchor",{x:g,y:h}=b.project.hasChannel;let i=gj(b.translate,"scope");return e||(i=i.map(j=>(j.between[0].markname=d+Mm,j))),c.push({name:f,value:{},on:[{events:i.map(j=>j.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==g?", extent_x: "+(e?Jx(a,"x"):`slice(${g.signals.visual})`):"")+(void 0!==h?", extent_y: "+(e?Jx(a,"y"):`slice(${h.signals.visual})`):"")+"}"}]},{name:d+RK,value:{},on:[{events:i,update:`{x: ${f}.x - x(unit), y: ${f}.y - y(unit)}`}]}),void 0!==g&&SK(a,b,g,"width",c),void 0!==h&&SK(a,b,h,"height",c),c}};function SK(a,b,c,d,e){var f;const g=b.name,h=g+"_translate_anchor",i=g+RK,j=c.channel,k=ui.has(b),l=e.filter(s=>s.name===c.signals[k?"data":"visual"])[0],m=a.getSizeSignalRef(d).signal,n=a.getScaleComponent(j),o=n.get("type"),p=`${h}.extent_${j}`,q=`${k?"log"===o?"panLog":"pow"===o?"panPow":"panLinear":"panLinear"}(${p}, ${`${k&&"x"===j?"-":""}${i}.${j} / `+(k?""+m:`span(${p})`)}`+(k&&"pow"===o?", "+(null!==(f=n.get("exponent"))&&void 0!==f?f:1):"")+")";l.on.push({events:{signal:i},update:k?q:`clampRange(${q}, 0, ${m})`})}const IW={has:a=>"interval"===a.type&&a.zoom,signals:(a,b,c)=>{const d=b.name,e=ui.has(b),f=d+"_zoom_delta",{x:g,y:h}=b.project.hasChannel,i=Ga(a.scaleName("x")),j=Ga(a.scaleName("y"));let k=gj(b.zoom,"scope");return e||(k=k.map(l=>(l.markname=d+Mm,l))),c.push({name:d+"_zoom_anchor",on:[{events:k,update:e?"{"+[i?`x: invert(${i}, x(unit))`:"",j?`y: invert(${j}, y(unit))`:""].filter(l=>!!l).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:f,on:[{events:k,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==g&&TK(a,b,g,"width",c),void 0!==h&&TK(a,b,h,"height",c),c}};function TK(a,b,c,d,e){var f;const g=b.name,h=c.channel,i=ui.has(b),j=e.filter(q=>q.name===c.signals[i?"data":"visual"])[0],k=a.getSizeSignalRef(d).signal,l=a.getScaleComponent(h),m=l.get("type"),n=i?Jx(a,h):j.name,o=g+"_zoom_delta",p=`${i?"log"===m?"zoomLog":"pow"===m?"zoomPow":"zoomLinear":"zoomLinear"}(${n}, ${`${g}_zoom_anchor.${h}`}, ${o}`+(i&&"pow"===m?", "+(null!==(f=l.get("exponent"))&&void 0!==f?f:1):"")+")";j.on.push({events:{signal:o},update:i?p:`clampRange(${p}, 0, ${k})`})}const JW=[{has:()=>!0,parse:(a,b,c)=>{var d,e,f;const g=b.name,h=null!==(d=b.project)&&void 0!==d?d:b.project=new FW(),i={},j={},k=new Set(),l=(m,n)=>{const o="visual"===n?m.channel:m.field;let p=ld(`${g}_${o}`);for(let q=1;k.has(p);q++)p=ld(`${g}_${o}_${q}`);return k.add(p),{[n]:p}};if(!c.fields&&!c.encodings){const m=a.config.selection[c.type];if(c.init)for(const n of Ra(c.init))for(const o of Ea(n))VU[o]?(c.encodings||(c.encodings=[])).push(o):"interval"===c.type?(Ba('Interval selections should be initialized using "x" and/or "y" keys.'),c.encodings=m.encodings):(c.fields||(c.fields=[])).push(o);else c.encodings=m.encodings,c.fields=m.fields}for(const m of null!==(e=c.fields)&&void 0!==e?e:[]){const n={type:"E",field:m};n.signals=Object.assign({},l(n,"data")),h.items.push(n),h.hasField[m]=n}for(const m of null!==(f=c.encodings)&&void 0!==f?f:[]){const n=a.fieldDef(m);if(n){let o=n.field;if(n.aggregate){Ba(aV(m,n.aggregate));continue}if(!o){Ba(JI(m));continue}if(n.timeUnit){o=a.vgField(m);const p={timeUnit:n.timeUnit,as:o,field:n.field};j[sc(p)]=p}if(!i[o]){let p="E";"interval"===b.type?Vf(a.getScaleComponent(m).get("type"))&&(p="R"):n.bin&&(p="R-RE");const q={field:o,channel:m,type:p};q.signals=Object.assign(Object.assign({},l(q,"data")),l(q,"visual")),h.items.push(i[o]=q),h.hasField[o]=h.hasChannel[m]=i[o]}}else Ba(JI(m))}if(c.init){const m=n=>h.items.map(o=>void 0!==n[o.channel]?n[o.channel]:n[o.field]);if("interval"===c.type)b.init=m(c.init);else{const n=Ra(c.init);b.init=n.map(m)}}_c(j)||(h.timeUnit=new Ch(null,j))},signals:(a,b,c)=>{const d=b.name+"_tuple_fields";return c.filter(e=>e.name===d).length>0?c:c.concat({name:d,value:b.project.items.map(e=>{const f=Fa(e,["signals","hasLegend"]);return f.field=hi(f.field),f})})}},PK,ui,QK,HW,IW,OK,NK,GW];function Eq(a,b){for(const c of JW)c.has(a)&&b(c)}function Ek(a,b=!0,c=fc){if(U(a)){const d=a.map(e=>Ek(e,b,c));return b?`[${d.join(", ")}]`:d}return Ak(a)?c(b?Cm(a):function(d){const e=Rw(d,!0);return d.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(a)):b?c(JSON.stringify(a)):a}function UK(a,b){return yj(a,(c,d)=>{b=d.marks?d.marks(a,c,b):b,Eq(c,e=>{e.marks&&(b=e.marks(a,c,b))})}),b}function Lx(a){return a.map(b=>(b.on&&!b.on.length&&delete b.on,b))}const Mm="_brush",KW={signals:(a,b)=>{const c=b.name,d=c+"_tuple_fields",e=ui.has(b),f=[],g=[],h=[];if(b.translate&&!e){const k="!event.item || event.item.mark.name !== "+Ga(c+Mm);VK(b,(l,m)=>{var n;const o=Ra(null!==(n=m.between[0].filter)&&void 0!==n?n:m.between[0].filter=[]);return o.indexOf(k)<0&&o.push(k),l})}b.project.items.forEach((k,l)=>{const m=k.channel;if("x"!==m&&"y"!==m)return void Ba("Interval selections only support x and y encoding channels.");const n=b.init?b.init[l]:null,o=function(u,t,w,x){const z=w.channel,A=w.signals.visual,B=w.signals.data,I=ui.has(t),J=Ga(u.scaleName(z)),D=u.getScaleComponent(z),O=D?D.get("type"):void 0,K=Ia=>`scale(${J}, ${Ia})`,Q=u.getSizeSignalRef("x"===z?"width":"height").signal,V=z+"(unit)",$=VK(t,(Ia,wa)=>[...Ia,{events:wa.between[0],update:`[${V}, ${V}]`},{events:wa,update:`[${A}[0], clamp(${V}, 0, ${Q})]`}]);return $.push({events:{signal:t.name+"_scale_trigger"},update:Vf(O)?`[${K(B+"[0]")}, ${K(B+"[1]")}]`:"[0, 0]"}),I?[{name:B,on:[]}]:[Object.assign(Object.assign({name:A},x?{init:Ek(x,!0,K)}:{value:[]}),{on:$}),Object.assign(Object.assign({name:B},x?{init:Ek(x)}:{}),{on:[{events:{signal:A},update:`${A}[0] === ${A}[1] ? null : invert(${J}, ${A})`}]})]}(a,b,k,n),p=k.signals.data,q=k.signals.visual,s=Ga(a.scaleName(m)),r=Vf(a.getScaleComponent(m).get("type"))?"+":"";f.push(...o),g.push(p),h.push({scaleName:a.scaleName(m),expr:`(!isArray(${p}) || (${r}invert(${s}, ${q})[0] === ${r}${p}[0] && ${r}invert(${s}, ${q})[1] === ${r}${p}[1]))`})}),e||f.push({name:c+"_scale_trigger",value:{},on:[{events:h.map(k=>({scale:k.scaleName})),update:h.map(k=>k.expr).join(" && ")+` ? ${c+"_scale_trigger"} : {}`}]});const i=b.init,j=`unit: ${Dh(a)}, fields: ${d}, values`;return f.concat(Object.assign(Object.assign({name:c+$g},i?{init:`{${j}: ${Ek(i)}}`}:{}),{on:[{events:[{signal:g.join(" || ")}],update:g.join(" && ")+` ? {${j}: [${g}]} : null`}]}))},modifyExpr:(a,b)=>b.name+$g+", "+("global"===b.resolve?"true":`{unit: ${Dh(a)}}`),marks:(a,b,c)=>{const d=b.name,{x:e,y:f}=b.project.hasChannel,g=e&&e.signals.visual,h=f&&f.signals.visual,i=`data(${Ga(b.name+xj)})`;if(ui.has(b))return c;const j={x:void 0!==e?{signal:g+"[0]"}:{value:0},y:void 0!==f?{signal:h+"[0]"}:{value:0},x2:void 0!==e?{signal:g+"[1]"}:{field:{group:"width"}},y2:void 0!==f?{signal:h+"[1]"}:{field:{group:"height"}}};if("global"===b.resolve)for(const q of Ea(j))j[q]=[Object.assign({test:`${i}.length && ${i}[0].unit === ${Dh(a)}`},j[q]),{value:0}];const k=b.mark,{fill:l,fillOpacity:m,cursor:n}=k,o=Fa(k,["fill","fillOpacity","cursor"]),p=Ea(o).reduce((q,s)=>(q[s]=[{test:[void 0!==e&&`${g}[0] !== ${g}[1]`,void 0!==f&&`${h}[0] !== ${h}[1]`].filter(r=>r).join(" && "),value:o[s]},{value:null}],q),{});return[{name:d+Mm+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:l},fillOpacity:{value:m}},update:j}},...c,{name:d+Mm,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},n?{cursor:{value:n}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},j),p)}}]}};function VK(a,b){return a.events.reduce((c,d)=>d.between?b(c,d):(Ba(d+" is not an ordered event stream for interval selections."),c),[])}function WK(a,b){const c=b.name,d=c+"_tuple_fields",e=b.project,f="(item().isVoronoi ? datum.datum : datum)",g=e.items.map(j=>{const k=a.fieldDef(j.channel);return k&&k.bin?`[${f}[${Ga(a.vgField(j.channel,{}))}], ${f}[${Ga(a.vgField(j.channel,{binSuffix:"end"}))}]]`:`${f}[${Ga(j.field)}]`}).join(", "),h=`unit: ${Dh(a)}, fields: ${d}, values`,i=b.events;return[{name:c+$g,on:i?[{events:i,update:`datum && item().mark.marktype !== 'group' ? {${h}: [${g}]} : null`,force:!0}]:[]}]}const LW={signals:WK,modifyExpr:(a,b)=>b.name+$g+", "+("global"===b.resolve?"null":`{unit: ${Dh(a)}}`)},MW={signals:WK,modifyExpr:(a,b)=>b.name+$g+", "+("global"===b.resolve?"true":`{unit: ${Dh(a)}}`)},xj="_store",$g="_tuple",NW="_modify",XK="vlSelectionResolve",OW={single:MW,multi:LW,interval:KW};function yj(a,b){const c=a.component.selection;if(c){for(const d of gi(c))if(!0===b(d,OW[d.type]))break}}function Dh(a,{escape:b}={escape:!0}){let c=b?Ga(a.name):a.name;const d=function(e){let f=e.parent;for(;f&&!sg(f);)f=f.parent;return f}(a);if(d){const{facet:e}=d;for(const f of Tf)e[f]&&(c+=` + '__facet_${f}_' + (facet[${Ga(d.vgField(f))}])`)}return c}function Mx(a){let b=!1;return yj(a,c=>{b=b||c.project.items.some(d=>"_vgsid_"===d.field)}),b}function YK(a){const b=KG(a),c=new Set();return b.visit(d=>{"MemberExpression"===d.type&&function e(f){return"MemberExpression"===f.object.type?e(f.object):"datum"===f.object.name}(d)&&c.add(function e(f){const g=[];return"Identifier"===f.type?[f.name]:"Literal"===f.type?[f.value]:("MemberExpression"===f.type&&(g.push(...e(f.object)),g.push(...e(f.property))),g)}(d).slice(1).join("."))}),c}class Nm extends Tc{constructor(a,b,c){super(a),this.model=b,this.filter=c,this.expr=Fq(this.model,this.filter,this),this._dependentFields=YK(this.expr)}clone(){return new Nm(null,this.model,ac(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set()}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter "+this.expr}}function ZK(a,b,c,d="datum"){const e=[],f=zm(b,function(g){const h=ld(g),i=a.getSelectionComponent(h,g),j=Ga(h+xj);if(i.project.timeUnit){const k=null!=c?c:a.component.data.raw,l=i.project.timeUnit.clone();k.parent?l.insertAsParentOf(k):k.parent=l}return"none"!==i.empty&&e.push(j),`vlSelectionTest(${j}, ${d}`+("global"===i.resolve?")":`, ${Ga(i.resolve)})`)});return(e.length?"!("+e.map(g=>`length(data(${g}))`).join(" || ")+") || ":"")+`(${f})`}function _K(a,b){const c=b.encoding;let d=b.field;if(c||d){if(c&&!d){const e=a.project.items.filter(f=>f.channel===c);!e.length||e.length>1?(d=a.project.items[0].field,Ba((e.length?"Multiple ":"No ")+`matching ${Ga(c)} encoding found for selection ${Ga(b.selection)}. Using "field": ${Ga(d)}.`)):d=e[0].field}}else d=a.project.items[0].field,a.project.items.length>1&&Ba(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Ga(d)}.`);return`${a.name}[${Ga(d)}]`}function Fq(a,b,c){return zm(b,d=>Xa(d)?d:function(e){return null==e?void 0:e.selection}(d)?ZK(a,d.selection,c):eJ(d))}function Nx(a,b,c,d){var e,f,g;a.encode=null!==(e=a.encode)&&void 0!==e?e:{},a.encode[b]=null!==(f=a.encode[b])&&void 0!==f?f:{},a.encode[b].update=null!==(g=a.encode[b].update)&&void 0!==g?g:{},a.encode[b].update[c]=d}function Om(a,b,c,d={header:!1}){var e,f;const g=a.combine(),{disable:h,orient:i,scale:j,labelExpr:k,title:l,zindex:m}=g,n=Fa(g,["disable","orient","scale","labelExpr","title","zindex"]);if(!h){for(const o in n){const p=FU[o],q=n[o];if(p&&p!==b&&"both"!==p)delete n[o];else if(Fw(q)){const{condition:s}=q,r=Fa(q,["condition"]),u=Ra(s),t=jI[o];if(t){const{vgProp:w,part:x}=t;Nx(n,x,w,[...u.map(z=>{const{test:A}=z,B=Fa(z,["test"]);return Object.assign({test:Fq(null,A)},B)}),r]),delete n[o]}else if(null===t){const w={signal:u.map(x=>{const{test:z}=x,A=Fa(x,["test"]);return`${Fq(null,z)} ? ${OJ(A)} : `}).join("")+OJ(r)};n[o]=w}}else if(tb(q)){const s=jI[o];if(s){const{vgProp:r,part:u}=s;Nx(n,u,r,q),delete n[o]}}}if("grid"===b){if(!n.grid)return;if(n.encode){const{grid:o}=n.encode;n.encode=Object.assign({},o?{grid:o}:{}),_c(n.encode)&&delete n.encode}return Object.assign(Object.assign({scale:j,orient:i},n),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Kd(m,0)})}{if(!d.header&&a.mainExtracted)return;if(void 0!==k){let p=k;(null===(f=null===(e=n.encode)||void 0===e?void 0:e.labels)||void 0===f?void 0:f.update)&&tb(n.encode.labels.update.text)&&(p=yk(k,"datum.label",n.encode.labels.update.text.signal)),Nx(n,"labels","text",{signal:p})}if(null===n.labelAlign&&delete n.labelAlign,n.encode){for(const p of kI)a.hasAxisPart(p)||delete n.encode[p];_c(n.encode)&&delete n.encode}const o=function(p,q){if(p)return U(p)&&!qi(p)?p.map(s=>KJ(s,q)).join(", "):p}(l,c);return Object.assign(Object.assign(Object.assign(Object.assign({scale:j,orient:i,grid:!1},o?{title:o}:{}),n),!1===c.aria?{aria:!1}:{}),{zindex:Kd(m,0)})}}}function $K(a){const{axes:b}=a.component,c=[];for(const d of Uf)if(b[d]){for(const e of b[d])if(!e.get("disable")&&!e.get("gridScale")){const f="x"===d?"height":"width",g=a.getSizeSignalRef(f).signal;f!==g&&c.push({name:f,update:g})}}return c}const aL={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},bL={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},PW=Ea(aL),QW=Ea(bL);function cL(a,b,c,d){return Object.assign.apply(null,[{},...a.map(e=>{if("axisOrient"===e){const f="x"===c?"bottom":"left",g=b["x"===c?"axisBottom":"axisLeft"]||{},h=b["x"===c?"axisTop":"axisRight"]||{},i=new Set([...Ea(g),...Ea(h)]),j={};for(const k of i.values())j[k]={signal:`${d.signal} === "${f}" ? ${Hm(g[k])} : ${Hm(h[k])}`};return j}return b[e]})])}function RW(a,b,c,d){const e="band"===b?["axisDiscrete","axisBand"]:"point"===b?["axisDiscrete","axisPoint"]:function(j){return j in zV}(b)?["axisQuantitative"]:"time"===b||"utc"===b?["axisTemporal"]:[],f="x"===a?"axisX":"axisY",g=tb(c)?"axisOrient":"axis"+Vp(c),h=[...e,...e.map(j=>f+j.substr(4))],i=["axis",g,f];return{vlOnlyAxisConfig:cL(h,d,a,c),vgAxisConfig:cL(i,d,a,c),axisConfigStyle:SW([...i,...h],d)}}function SW(a,b){var c;const d=[{}];for(const e of a){let f=null===(c=b[e])||void 0===c?void 0:c.style;if(f){f=Ra(f);for(const g of f)d.push(b.style[g])}}return Object.assign.apply(null,d)}function Ox(a,b,c,d={}){var e;const f=QJ(a,c,b.style);if(void 0!==f)return{configFrom:"style",configValue:f};for(const g of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(e=d[g])||void 0===e?void 0:e[a]))return{configFrom:g,configValue:d[g][a]};return{}}const dL={scale:({model:a,channel:b})=>a.scaleName(b),format:({fieldOrDatumDef:a,config:b,axis:c})=>{const{format:d,formatType:e}=c;return tJ(a,a.type,d,e,b,!0)},formatType:({axis:a,fieldOrDatumDef:b,scaleType:c})=>{const{formatType:d}=a;return uJ(d,b,c)},grid:({fieldOrDatumDef:a,axis:b,scaleType:c})=>{var d;return(!Qa(a)||!Te(a.bin))&&(null!==(d=b.grid)&&void 0!==d?d:function(e,f){return!pf(e)&&Qa(f)&&!bd(null==f?void 0:f.bin)}(c,a))},gridScale:({model:a,channel:b})=>function(c,d){const e="x"===d?"y":"x";return c.getScaleComponent(e)?c.scaleName(e):void 0}(a,b),labelAlign:({axis:a,labelAngle:b,orient:c,channel:d})=>a.labelAlign||fL(b,c,d),labelAngle:({labelAngle:a})=>a,labelBaseline:({axis:a,labelAngle:b,orient:c,channel:d})=>a.labelBaseline||eL(b,c,d),labelFlush:({axis:a,fieldOrDatumDef:b,channel:c})=>{var d;return null!==(d=a.labelFlush)&&void 0!==d?d:function(e,f){return"x"===f&&nb(["quantitative","temporal"],e)?!0:void 0}(b.type,c)},labelOverlap:({axis:a,fieldOrDatumDef:b,scaleType:c})=>{var d;return null!==(d=a.labelOverlap)&&void 0!==d?d:function(e,f){return"nominal"!==e?"log"!==f||"greedy":void 0}(b.type,c)},orient:({orient:a})=>a,tickCount:({channel:a,model:b,axis:c,fieldOrDatumDef:d,scaleType:e})=>{var f;const g="x"===a?"width":"y"===a?"height":void 0,h=g?b.getSizeSignalRef(g):void 0;return null!==(f=c.tickCount)&&void 0!==f?f:function({fieldOrDatumDef:i,scaleType:j,size:k,values:l}){var m;if(!l&&!pf(j)&&"log"!==j){if(Qa(i)){if(bd(i.bin))return{signal:`ceil(${k.signal}/10)`};if(i.timeUnit&&nb(["month","hours","day","quarter"],null===(m=Ue(i.timeUnit))||void 0===m?void 0:m.unit))return}return{signal:`ceil(${k.signal}/40)`}}return}({fieldOrDatumDef:d,scaleType:e,size:h,values:c.values})},title:({axis:a,model:b,channel:c})=>{if(void 0!==a.title)return a.title;const d=gL(b,c);if(void 0!==d)return d;const e=b.typedFieldDef(c),f="x"===c?"x2":"y2",g=b.fieldDef(f);return SJ(e?[BJ(e)]:[],Qa(g)?[BJ(g)]:[])},values:({axis:a,fieldOrDatumDef:b})=>function(c,d){const e=c.values;return U(e)?MJ(d,e):tb(e)?e:void 0}(a,b),zindex:({axis:a,fieldOrDatumDef:b,mark:c})=>{var d;return null!==(d=a.zindex)&&void 0!==d?d:function(e,f){return"rect"===e&&FJ(f)?1:0}(c,b)}};function Px(a){return`(((${a.signal} % 360) + 360) % 360)`}function eL(a,b,c,d){if(void 0!==a){if("x"===c){if(tb(a)){const e=Px(a);return{signal:`(45 < ${e} && ${e} < 135) || (225 < ${e} && ${e} < 315) ? "middle" :(${e} <= 45 || 315 <= ${e}) === ${tb(b)?`(${b.signal} === "top")`:"top"===b} ? "bottom" : "top"`}}if(45<a&&a<135||225<a&&a<315)return"middle";if(tb(b)){const e=a<=45||315<=a?"===":"!==";return{signal:`${b.signal} ${e} "top" ? "bottom" : "top"`}}return(a<=45||315<=a)==("top"===b)?"bottom":"top"}if(tb(a)){const e=Px(a);return{signal:`${e} <= 45 || 315 <= ${e} || (135 <= ${e} && ${e} <= 225) ? ${d?'"middle"':"null"} : (45 <= ${e} && ${e} <= 135) === ${tb(b)?`(${b.signal} === "left")`:"left"===b} ? "top" : "bottom"`}}if(a<=45||315<=a||135<=a&&a<=225)return d?"middle":null;if(tb(b)){const e=45<=a&&a<=135?"===":"!==";return{signal:`${b.signal} ${e} "left" ? "top" : "bottom"`}}return(45<=a&&a<=135)==("left"===b)?"top":"bottom"}}function fL(a,b,c){if(void 0===a)return;const d="x"===c,e=d?0:90,f=d?"bottom":"left";if(tb(a)){const g=Px(a);return{signal:`(${e?"("+g+" + 90)":g} % 180 === 0) ? ${d?null:'"center"'} :(${e} < ${g} && ${g} < ${180+e}) === ${tb(b)?`(${b.signal} === "${f}")`:b===f} ? "left" : "right"`}}if((a+e)%180==0)return d?null:"center";if(tb(b)){const g=e<a&&a<180+e?"===":"!==";return{signal:`${b.signal} ${g} "${f}" ? "left" : "right"`}}return(e<a&&a<180+e)==(b===f)?"left":"right"}function gL(a,b){const c="x"===b?"x2":"y2",d=a.fieldDef(b),e=a.fieldDef(c),f=d?d.title:void 0,g=e?e.title:void 0;return f&&g?TJ(f,g):f||(g||(void 0!==f?f:void 0!==g?g:void 0))}class Pm extends Tc{constructor(a,b){super(a),this.transform=b,this._dependentFields=YK(this.transform.calculate)}clone(){return new Pm(null,ac(this.transform))}static parseAllForSortIndex(a,b){return b.forEachFieldDef((c,d)=>{if(lx(c)&&AJ(c.sort)){const{field:e,timeUnit:f}=c,g=c.sort,h=g.map((i,j)=>`${eJ({field:e,timeUnit:f,equal:i})} ? ${j} : `).join("")+g.length;a=new Pm(a,{calculate:h,as:Fk(c,d,{forAs:!0})})}}),a}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate "+sc(this.transform)}}function Fk(a,b,c){return Ka(a,Object.assign({prefix:b,suffix:"sort_index"},null!=c?c:{}))}function Gq(a,b){return nb(["top","bottom"],b)?"column":nb(["left","right"],b)||"row"===a?"row":"column"}function Gk(a,b,c,d){const e="row"===d?c.headerRow:"column"===d?c.headerColumn:c.headerFacet;return Kd(((null==b?void 0:b.header)||{})[a],e[a],c.header[a])}function Hq(a,b,c,d){const e={};for(const f of a){const g=Gk(f,b,c,d);void 0!==g&&(e[f]=g)}return e}const Qx=["row","column"],Rx=["header","footer"];function TW(a,b){const c=a.component.layoutHeaders[b].title,d=a.config?a.config:void 0,e=a.component.layoutHeaders[b].facetFieldDef?a.component.layoutHeaders[b].facetFieldDef:void 0,{titleAnchor:f,titleAngle:g,titleOrient:h}=Hq(["titleAnchor","titleAngle","titleOrient"],e,d,b),i=Gq(b,h),j=Wp(g);return{name:b+"-title",type:"group",role:i+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:c},"row"===b?{orient:"left"}:{}),{style:"guide-title"}),iL(j,i)),hL(i,j,f)),jL(d,e,b,PW,aL))}}function hL(a,b,c="middle"){switch(c){case"start":return{align:"left"};case"end":return{align:"right"}}const d=fL(b,"row"===a?"left":"top","row"===a?"y":"x");return d?{align:d}:{}}function iL(a,b){const c=eL(a,"row"===b?"left":"top","row"===b?"y":"x",!0);return c?{baseline:c}:{}}function UW(a,b){const c=a.component.layoutHeaders[b],d=[];for(const e of Rx)if(c[e])for(const f of c[e]){const g=WW(a,b,e,c,f);null!=g&&d.push(g)}return d}function VW(a,b){var c;const{sort:d}=a;return Xg(d)?{field:Ka(d,{expr:"datum"}),order:null!==(c=d.order)&&void 0!==c?c:"ascending"}:U(d)?{field:Fk(a,b,{expr:"datum"}),order:"ascending"}:{field:Ka(a,{expr:"datum"}),order:null!=d?d:"ascending"}}function Sx(a,b,c){const{format:d,formatType:e,labelAngle:f,labelAnchor:g,labelOrient:h,labelExpr:i}=Hq(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],a,c,b),j=ex({fieldOrDatumDef:a,format:d,formatType:e,expr:"parent",config:c}).signal,k=Gq(b,h);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:i?yk(yk(i,"datum.label",j),"datum.value",Ka(a,{expr:"parent"})):j}},"row"===b?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),iL(f,k)),hL(k,f,g)),jL(c,a,b,QW,bL))}function WW(a,b,c,d,e){if(e){let f=null;const{facetFieldDef:g}=d,h=a.config?a.config:void 0;if(g&&e.labels){const{labelOrient:l}=Hq(["labelOrient"],g,h,b);("row"===b&&!nb(["top","bottom"],l)||"column"===b&&!nb(["left","right"],l))&&(f=Sx(g,b,h))}const i=sg(a)&&!Em(a.facet),j=e.axes,k=(null==j?void 0:j.length)>0;if(f||k){const l="row"===b?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a.getName(`${b}_${c}`),type:"group",role:`${b}-${c}`},d.facetFieldDef?{from:{data:a.getName(b+"_domain")},sort:VW(g,b)}:{}),k&&i?{from:{data:a.getName("facet_domain_"+b)}}:{}),f?{title:f}:{}),e.sizeSignal?{encode:{update:{[l]:e.sizeSignal}}}:{}),k?{axes:j}:{})}}return null}const XW={column:{start:0,end:1},row:{start:1,end:0}};function YW(a,b){return XW[b][a]}function jL(a,b,c,d,e){const f={};for(const g of d){if(!e[g])continue;const h=Gk(g,b,a,c);void 0!==h&&(f[e[g]]=h)}return f}function Tx(a){return[...Iq(a,"width"),...Iq(a,"height"),...Iq(a,"childWidth"),...Iq(a,"childHeight")]}function Iq(a,b){const c="width"===b?"x":"y",d=a.component.layoutSize.get(b);if(!d||"merged"===d)return[];const e=a.getSizeSignalRef(b).signal;if("step"===d){const f=a.getScaleComponent(c);if(f){const g=f.get("type"),h=f.get("range");if(pf(g)&&mi(h)){const i=a.scaleName(c);if(sg(a.parent)){if("independent"===a.parent.component.resolve.scale[c])return[kL(i,h)]}return[kL(i,h),{name:e,update:lL(i,f,`domain('${i}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==d){const f=e.endsWith("width"),g=f?"containerSize()[0]":"containerSize()[1]",h=`isFinite(${g}) ? ${g} : ${Ax(a.config.view,f?"width":"height")}`;return[{name:e,init:h,on:[{update:h,events:"window:resize"}]}]}return[{name:e,value:d}]}function kL(a,b){return{name:a+"_step",value:b.step}}function lL(a,b,c){const d=b.get("type"),e=b.get("padding"),f=Kd(b.get("paddingOuter"),e);let g=b.get("paddingInner");return g="band"===d?void 0!==g?g:e:1,`bandspace(${c}, ${g}, ${f}) * ${a}_step`}function mL(a){return"childWidth"===a?"width":"childHeight"===a?"height":a}function nL(a,b){return Ea(a).reduce((c,d)=>{const e=a[d];return Object.assign(Object.assign({},c),Km(b,e,d,f=>tb(f)?f:{value:f.value}))},{})}function ZW(a,b){if(Kk(b)||sg(b))return"shared";if(ey(b))return Vg(a)?"independent":"shared";throw new Error("invalid model type for resolve")}function Ux(a,b){const c=a.scale[b],d=Vg(b)?"axis":"legend";return"independent"===c?("shared"===a[d][b]&&Ba(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(b)),"independent"):a[d][b]||"shared"}const _W=Object.assign(Object.assign({},{aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1}),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),oL=Ea(_W);class $W extends ri{}const pL={symbols:function(a,{fieldOrDatumDef:b,model:c,channel:d,legendCmpt:e,legendType:f}){var g,h,i,j,k;if("symbol"!==f)return;const{markDef:l,encoding:m,config:n,mark:o}=c,p=l.filled&&"trail"!==o;let q=Object.assign(Object.assign({},function(r,u,t){for(const w of t){const x=tj(w,u.markDef,u.config);void 0!==x&&(r[w]=Fd(x))}return r}({},c,KU)),HK(c,{filled:p}));const s=null!==(g=qL(m.opacity))&&void 0!==g?g:l.opacity;if(q.fill){if("fill"===d||p&&d===nf)delete q.fill;else if(q.fill.field)e.get("symbolFillColor")?delete q.fill:(q.fill=Fd(null!==(h=n.legend.symbolBaseFillColor)&&void 0!==h?h:"black"),q.fillOpacity=Fd(null!=s?s:1));else if(U(q.fill)){const r=null!==(k=null!==(j=Vx(null!==(i=m.fill)&&void 0!==i?i:m.color))&&void 0!==j?j:l.fill)&&void 0!==k?k:p&&l.color;r&&(q.fill=Fd(r))}}if(q.stroke){if("stroke"===d||!p&&d===nf)delete q.stroke;else if(q.stroke.field)delete q.stroke;else if(U(q.stroke)){const r=Kd(Vx(m.stroke||m.color),l.stroke,p?l.color:void 0);r&&(q.stroke={value:r})}}if("opacity"!==d){const r=Qa(b)&&sL(c,e,b);r?q.opacity=[Object.assign({test:r},Fd(null!=s?s:1)),Fd(n.legend.unselectedOpacity)]:s&&(q.opacity=Fd(s))}return q=Object.assign(Object.assign({},q),a),_c(q)?void 0:q},gradient:function(a,{model:b,legendType:c}){if("gradient"!==c)return;let d={};const e=qL(b.encoding.opacity)||b.markDef.opacity;return e&&(d.opacity=Fd(e)),d=Object.assign(Object.assign({},d),a),_c(d)?void 0:d},labels:function(a,{fieldOrDatumDef:b,model:c,channel:d,legendCmpt:e}){const f=c.legend(d)||{},g=c.config,h=Qa(b)?sL(c,e,b):void 0,i=h?[{test:h,value:1},{value:g.legend.unselectedOpacity}]:void 0,{format:j,formatType:k}=f,l=qj(k)?fx({fieldOrDatumDef:b,field:"datum.value",format:j,formatType:k,config:g}):void 0,m=Object.assign(Object.assign(Object.assign({},i?{opacity:i}:{}),l?{text:l}:{}),a);return _c(m)?void 0:m},entries:function(a,{legendCmpt:b}){const c=b.get("selections");return(null==c?void 0:c.length)?Object.assign(Object.assign({},a),{fill:{value:"transparent"}}):a}};function qL(a){return rL(a,(b,c)=>Math.max(b,c.value))}function Vx(a){return rL(a,(b,c)=>Kd(b,c.value))}function rL(a,b){return function(c){const d=c&&c.condition;return!!d&&(U(d)||Ah(d))}(a)?Ra(a.condition).reduce(b,a.value):Ah(a)?a.value:void 0}function sL(a,b,c){const d=b.get("selections");if(!(null==d?void 0:d.length))return;const e=Ga(c.field);return d.map(f=>`(!length(data(${Ga(ld(f)+xj)})) || (${f}[${e}] && indexof(${f}[${e}], datum.value) >= 0))`).join(" || ")}const tL={direction:({direction:a})=>a,format:({fieldOrDatumDef:a,legend:b,config:c})=>{const{format:d,formatType:e}=b;return tJ(a,a.type,d,e,c,!1)},formatType:({legend:a,fieldOrDatumDef:b,scaleType:c})=>{const{formatType:d}=a;return uJ(d,b,c)},gradientLength:a=>{var b,c;const{legend:d,legendConfig:e}=a;return null!==(c=null!==(b=d.gradientLength)&&void 0!==b?b:e.gradientLength)&&void 0!==c?c:function({legendConfig:f,model:g,direction:h,orient:i,scaleType:j}){const{gradientHorizontalMaxLength:k,gradientHorizontalMinLength:l,gradientVerticalMaxLength:m,gradientVerticalMinLength:n}=f;return pg(j)?"horizontal"===h?"top"===i||"bottom"===i?uL(g,"width",l,k):l:uL(g,"height",n,m):void 0}(a)},labelOverlap:({legend:a,legendConfig:b,scaleType:c})=>{var d,e;return null!==(e=null!==(d=a.labelOverlap)&&void 0!==d?d:b.labelOverlap)&&void 0!==e?e:function(f){return nb(["quantile","threshold","log"],f)?"greedy":void 0}(c)},symbolType:({legend:a,markDef:b,channel:c,encoding:d})=>{var e;return null!==(e=a.symbolType)&&void 0!==e?e:function(f,g,h,i){var j;if("shape"!==g){const k=null!==(j=Vx(h))&&void 0!==j?j:i;if(k)return k}switch(f){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(b.type,c,d.shape,b.shape)},title:({fieldOrDatumDef:a,config:b})=>rj(a,b,{allowDisabling:!0}),type:({legendType:a,scaleType:b,channel:c})=>{if(zk(c)&&pg(b)){if("gradient"===a)return}else if("symbol"===a)return;return a},values:({fieldOrDatumDef:a,legend:b})=>function(c,d){const e=c.values;return U(e)?MJ(d,e):tb(e)?e:void 0}(b,a)};function aX(a){const{legend:b}=a;return Kd(b.type,function({channel:c,timeUnit:d,scaleType:e}){if(zk(c)){if(nb(["quarter","month","day"],d))return"symbol";if(pg(e))return"gradient"}return"symbol"}(a))}function bX({legendConfig:a,legendType:b,orient:c,legend:d}){var e,f;return null!==(f=null!==(e=d.direction)&&void 0!==e?e:a[b?"gradientDirection":"symbolDirection"])&&void 0!==f?f:function(g,h){switch(g){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===h?"horizontal":void 0}}(c,b)}function uL(a,b,c,d){return{signal:`clamp(${a.getSizeSignalRef(b).signal}, ${c}, ${d})`}}function vL(a){const b=Bd(a)?function(c){const{encoding:d}=c,e={};for(const f of[nf,...hK]){const g=Sd(d[f]);g&&c.getScaleComponent(f)&&(f===of&&Qa(g)&&g.type===Dk||(e[f]=dX(c,f)))}return e}(a):function(c){const{legends:d,resolve:e}=c.component;for(const f of c.children){vL(f);for(const g of Ea(f.component.legends))e.legend[g]=Ux(c.component.resolve,g),"shared"===e.legend[g]&&(d[g]=wL(d[g],f.component.legends[g]),d[g]||(e.legend[g]="independent",delete d[g]))}for(const f of Ea(d))for(const g of c.children)g.component.legends[f]&&"shared"===e.legend[f]&&delete g.component.legends[f];return d}(a);return a.component.legends=b,b}function cX(a,b,c,d){switch(b){case"disable":return void 0!==c;case"values":return!!(null==c?void 0:c.values);case"title":if("title"===b&&a===(null==d?void 0:d.title))return!0}return a===(c||{})[b]}function dX(a,b){var c,d,e;let f=a.legend(b);const{markDef:g,encoding:h,config:i}=a,j=i.legend,k=new $W({},function(x,z){const A=x.scaleName(z);if("trail"===x.mark){if("color"===z)return{stroke:A};if("size"===z)return{strokeWidth:A}}return"color"===z?x.markDef.filled?{fill:A}:{stroke:A}:{[z]:A}}(a,b));!function(x,z,A){var B;const I=null===(B=x.fieldDef(z))||void 0===B?void 0:B.field;yj(x,J=>{var D,O;const K=null!==(D=J.project.hasField[I])&&void 0!==D?D:J.project.hasChannel[z];if(K&&QK.has(J)){const Q=null!==(O=A.get("selections"))&&void 0!==O?O:[];Q.push(J.name),A.set("selections",Q,!1),K.hasLegend=!0}})}(a,b,k);const l=void 0!==f?!f:j.disable;if(k.set("disable",l,void 0!==f),l)return k;f=f||{};const m=a.getScaleComponent(b).get("type"),n=Sd(h[b]),o=Qa(n)?null===(c=Ue(n.timeUnit))||void 0===c?void 0:c.unit:void 0,p=f.orient||i.legend.orient||"right",q=aX({legend:f,channel:b,timeUnit:o,scaleType:m}),s={legend:f,channel:b,model:a,markDef:g,encoding:h,fieldOrDatumDef:n,legendConfig:j,config:i,scaleType:m,orient:p,legendType:q,direction:bX({legend:f,legendType:q,orient:p,legendConfig:j})};for(const x of oL){const z=x in tL?tL[x](s):f[x];if(void 0!==z){const A=cX(z,x,f,a.fieldDef(b));(A||void 0===i.legend[x])&&k.set(x,z,A)}}const r=null!==(d=null==f?void 0:f.encoding)&&void 0!==d?d:{},u=k.get("selections"),t={},w={fieldOrDatumDef:n,model:a,channel:b,legendCmpt:k,legendType:q};for(const x of["labels","legend","title","symbols","gradient","entries"]){const z=nL(null!==(e=r[x])&&void 0!==e?e:{},a),A=x in pL?pL[x](z,w):z;void 0===A||_c(A)||(t[x]=Object.assign(Object.assign(Object.assign({},(null==u?void 0:u.length)&&Qa(n)?{name:`${ld(n.field)}_legend_${x}`}:{}),(null==u?void 0:u.length)?{interactive:!!u}:{}),{update:A}))}return _c(t)||k.set("encode",t,!!(null==f?void 0:f.encoding)),k}function wL(a,b){var c,d,e,f;if(!a)return b.clone();const g=a.getWithExplicit("orient"),h=b.getWithExplicit("orient");if(g.explicit&&h.explicit&&g.value!==h.value)return;let i=!1;for(const j of oL){const k=si(a.getWithExplicit(j),b.getWithExplicit(j),j,"legend",(l,m)=>{switch(j){case"symbolType":return eX(l,m);case"title":return UJ(l,m);case"type":return i=!0,qg("symbol")}return yq(l,m,j,"legend")});a.setWithExplicit(j,k)}return i&&((null===(d=null===(c=a.implicit)||void 0===c?void 0:c.encode)||void 0===d?void 0:d.gradient)&&Dw(a.implicit,["encode","gradient"]),(null===(f=null===(e=a.explicit)||void 0===e?void 0:e.encode)||void 0===f?void 0:f.gradient)&&Dw(a.explicit,["encode","gradient"])),a}function eX(a,b){return"circle"===b.value?b:a}function xL(a,b,c,d){var e,f,g;a.encode=null!==(e=a.encode)&&void 0!==e?e:{},a.encode[b]=null!==(f=a.encode[b])&&void 0!==f?f:{},a.encode[b].update=null!==(g=a.encode[b].update)&&void 0!==g?g:{},a.encode[b].update[c]=d}function yL(a){const b=a.component.legends,c={};for(const d of Ea(b)){const e=a.getScaleComponent(d),f=kd(e.get("domains"));if(c[f])for(const g of c[f])wL(g,b[d])||c[f].push(b[d]);else c[f]=[b[d].clone()]}return gi(c).flat().map(d=>function(e,f){var g,h,i;const j=e.combine(),{disable:k,labelExpr:l,selections:m}=j,n=Fa(j,["disable","labelExpr","selections"]);if(k)return;!1===f.aria&&null==n.aria&&(n.aria=!1);if(null===(g=n.encode)||void 0===g?void 0:g.symbols){const o=n.encode.symbols.update;!o.fill||"transparent"===o.fill.value||o.stroke||n.stroke||(o.stroke={value:"transparent"});for(const p of hK)n[p]&&delete o[p]}n.title||delete n.title;if(void 0!==l){let o=l;(null===(i=null===(h=n.encode)||void 0===h?void 0:h.labels)||void 0===i?void 0:i.update)&&tb(n.encode.labels.update.text)&&(o=yk(l,"datum.label",n.encode.labels.update.text.signal)),xL(n,"labels","text",{signal:o})}for(const o in n){const p=n[o];if(tb(p)){const q=PV[o];if(q){const{vgProp:s,part:r}=q;xL(n,r,s,p),delete n[o]}}}return n}(d,a.config)).filter(d=>void 0!==d)}function fX(a){return Kk(a)||ey(a)?function(b){return b.children.reduce((c,d)=>c.concat(d.assembleProjections()),zL(b))}(a):zL(a)}function zL(a){const b=a.component.projection;if(!b||b.merged)return[];const c=b.combine(),{name:d}=c;if(b.data){const e={signal:`[${b.size.map(g=>g.signal).join(", ")}]`},f=b.data.reduce((g,h)=>{const i=tb(h)?h.signal:`data('${a.lookupDataSource(h)}')`;return nb(g,i)||g.push(i),g},[]);if(f.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:d,size:e,fit:{signal:f.length>1?`[${f.join(", ")}]`:f[0]}},c)]}return[Object.assign(Object.assign({name:d},{translate:{signal:"[width / 2, height / 2]"}}),c)]}const gX=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class AL extends ri{constructor(a,b,c,d){super(Object.assign({},b),{name:a}),this.specifiedProjection=b,this.size=c,this.data=d,this.merged=!1}get isFit(){return!!this.data}}function BL(a){a.component.projection=Bd(a)?function(b){var c;if(b.hasProjection){const d=b.specifiedProjection,e=!(d&&(null!=d.scale||null!=d.translate)),f=e?[b.getSizeSignalRef("width"),b.getSizeSignalRef("height")]:void 0,g=e?function(h){const i=[],{encoding:j}=h;for(const k of[["longitude","latitude"],["longitude2","latitude2"]])(Sd(j[k[0]])||Sd(j[k[1]]))&&i.push({signal:h.getName("geojson_"+i.length)});return h.channelHasField(of)&&h.typedFieldDef(of).type===Dk&&i.push({signal:h.getName("geojson_"+i.length)}),0===i.length&&i.push(h.requestDataName(ye)),i}(b):void 0;return new AL(b.projectionName(!0),Object.assign(Object.assign({},null!==(c=b.config.projection)&&void 0!==c?c:{}),null!=d?d:{}),f,g)}return}(a):function(b){if(0===b.children.length)return;let c;for(const e of b.children)BL(e);const d=cI(b.children,e=>{const f=e.component.projection;if(f){if(c){const g=function(h,i){const j=cI(gX,k=>!db(h.explicit,k)&&!db(i.explicit,k)||!(!db(h.explicit,k)||!db(i.explicit,k)||kd(h.get(k))!==kd(i.get(k))));if(kd(h.size)===kd(i.size)){if(j)return h;if(kd(h.explicit)===kd({}))return i;if(kd(i.explicit)===kd({}))return h}return null}(c,f);return g&&(c=g),!!g}return c=f,!0}return!0});if(c&&d){const e=b.projectionName(!0),f=new AL(e,c.specifiedProjection,c.size,ac(c.data));for(const g of b.children){const h=g.component.projection;h&&(h.isFit&&f.data.push(...g.component.projection.data),g.renameProjection(h.get("name"),e),h.merged=!0)}return f}return}(a)}function CL(a,b){return`${EI(a)}_${b}`}function Wx(a,b,c){var d;const e=CL(null!==(d=rq(c,void 0))&&void 0!==d?d:{},b);return a.getName(e+"_bins")}function DL(a,b,c){let d,e;d=function(j){return"as"in j}(a)?Xa(a.as)?[a.as,a.as+"_end"]:[a.as[0],a.as[1]]:[Ka(a,{forAs:!0}),Ka(a,{binSuffix:"end",forAs:!0})];const f=Object.assign({},rq(b,void 0)),g=CL(f,a.field),{signal:h,extentSignal:i}=function(j,k){return{signal:j.getName(k+"_bins"),extentSignal:j.getName(k+"_extent")}}(c,g);if(eq(f.extent)){const j=f.extent,k=j.selection;e=_K(c.getSelectionComponent(ld(k),k),j),delete f.extent}return{key:g,binComponent:Object.assign(Object.assign(Object.assign({bin:f,field:a.field,as:[d]},h?{signal:h}:{}),i?{extentSignal:i}:{}),e?{span:e}:{})}}class Eh extends Tc{constructor(a,b){super(a),this.bins=b}clone(){return new Eh(null,ac(this.bins))}static makeFromEncoding(a,b){const c=b.reduceFieldDef((d,e,f)=>{if(Bf(e)&&bd(e.bin)){const{key:g,binComponent:h}=DL(e,e.bin,b);d[g]=Object.assign(Object.assign(Object.assign({},h),d[g]),function(i,j,k,l){var m,n;if(Gm(j,k)){const o=Bd(i)&&null!==(n=null!==(m=i.axis(k))&&void 0!==m?m:i.legend(k))&&void 0!==n?n:{},p=Ka(j,{expr:"datum"}),q=Ka(j,{expr:"datum",binSuffix:"end"});return{formulaAs:Ka(j,{binSuffix:"range",forAs:!0}),formula:lq(p,q,o.format,o.formatType,l)}}return{}}(b,e,f,b.config))}return d},{});return _c(c)?null:new Eh(a,c)}static makeFromTransform(a,b,c){const{key:d,binComponent:e}=DL(b,b.bin,c);return new Eh(a,{[d]:e})}merge(a,b){for(const c of Ea(a.bins))c in this.bins?(b(a.bins[c].signal,this.bins[c].signal),this.bins[c].as=fi([...this.bins[c].as,...a.bins[c].as],sc)):this.bins[c]=a.bins[c];for(const c of a.children)a.removeChild(c),c.parent=this;a.remove()}producedFields(){return new Set(gi(this.bins).map(a=>a.as).flat(2))}dependentFields(){return new Set(gi(this.bins).map(a=>a.field))}hash(){return"Bin "+sc(this.bins)}assemble(){return gi(this.bins).flatMap(a=>{const b=[],[c,...d]=a.as,e=a.bin,{extent:f}=e,g=Fa(e,["extent"]),h=Object.assign(Object.assign(Object.assign({type:"bin",field:hi(a.field),as:c,signal:a.signal},eq(f)?{extent:null}:{extent:f}),a.span?{span:{signal:`span(${a.span})`}}:{}),g);!f&&a.extentSignal&&(b.push({type:"extent",field:hi(a.field),signal:a.extentSignal}),h.extent={signal:a.extentSignal}),b.push(h);for(const i of d)for(let j=0;j<2;j++)b.push({type:"formula",expr:Ka({field:c[j]},{expr:"datum"}),as:i[j]});return a.formula&&b.push({type:"formula",expr:a.formula,as:a.formulaAs}),b})}}class Hk extends Tc{constructor(a){let b;if(super(null),wj(a=null!=a?a:{name:"source"})||(b=a.format?Object.assign({},uh(a.format,["parse"])):{}),zq(a))this._data={values:a.values};else if(Jm(a)){if(this._data={url:a.url},!b.type){let c=/(?:\.([^.]+))?$/.exec(a.url)[1];nb(["json","csv","tsv","dsv","topojson"],c)||(c="json"),b.type=c}}else CK(a)?this._data={values:[{type:"Sphere"}]}:(AK(a)||wj(a))&&(this._data={});this._generator=wj(a),a.name&&(this._name=a.name),b&&!_c(b)&&(this._data.format=b)}dependentFields(){return new Set()}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(a){this._name=a}set parent(a){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function Xx(a){for(const b of a){for(const c of b.children)if(c.parent!==b)return console.error("Dataflow graph is inconsistent.",b,c),!1;if(!Xx(b.children))return!1}return!0}class Jq extends Tc{constructor(a,b){super(a),this.params=b}clone(){return new Jq(null,this.params)}dependentFields(){return new Set()}producedFields(){}hash(){return"Graticule "+sc(this.params)}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class Kq extends Tc{constructor(a,b){super(a),this.params=b}clone(){return new Kq(null,this.params)}dependentFields(){return new Set()}producedFields(){var a;return new Set([null!==(a=this.params.as)&&void 0!==a?a:"data"])}hash(){return"Hash "+sc(this.params)}assemble(){return Object.assign({type:"sequence"},this.params)}}function Lq(a){return a instanceof Hk||a instanceof Jq||a instanceof Kq}class EL{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Fh extends EL{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:a,mutatedFlag:b}){a&&this.setContinue(),b&&this.setMutated()}reset(){}optimizeNextFromLeaves(a){if(Lq(a))return!1;const b=a.parent,{continueFlag:c}=this.run(a);return c&&this.optimizeNextFromLeaves(b),this.mutatedFlag}}class Yx extends EL{}function hX(a,b,c,d){const e=Bd(d)?d.encoding[Tg(b)]:void 0;if(Bf(c)&&Bd(d)&&hx(b,c,e,d.stack,d.markDef,d.config))a.add(Ka(c,{})),a.add(Ka(c,{suffix:"end"})),c.bin&&Gm(c,b)&&a.add(Ka(c,{binSuffix:"range"}));else if(b in Kw){const f=function(g){switch(g){case"latitude":return"y";case"latitude2":return"y2";case"longitude":return"x";case"longitude2":return"x2"}}(b);a.add(d.getName(f))}else a.add(Ka(c));return a}class ah extends Tc{constructor(a,b,c){super(a),this.dimensions=b,this.measures=c}clone(){return new ah(null,new Set(this.dimensions),ac(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(a,b){let c=!1;b.forEachFieldDef(f=>{f.aggregate&&(c=!0)});const d={},e=new Set();return c?(b.forEachFieldDef((f,g)=>{var h,i,j,k;const{aggregate:l,field:m}=f;if(l)if("count"===l)d["*"]=null!==(h=d["*"])&&void 0!==h?h:{},d["*"].count=new Set([Ka(f,{forAs:!0})]);else{if(ii(l)||mj(l)){const n=ii(l)?"argmin":"argmax",o=l[n];d[o]=null!==(i=d[o])&&void 0!==i?i:{},d[o][n]=new Set([Ka({op:n,field:o},{forAs:!0})])}else d[m]=null!==(j=d[m])&&void 0!==j?j:{},d[m][l]=new Set([Ka(f,{forAs:!0})]);li(g)&&"unaggregated"===b.scaleDomain(g)&&(d[m]=null!==(k=d[m])&&void 0!==k?k:{},d[m].min=new Set([Ka({field:m,aggregate:"min"},{forAs:!0})]),d[m].max=new Set([Ka({field:m,aggregate:"max"},{forAs:!0})]))}else hX(e,g,f,b)}),e.size+Ea(d).length===0?null:new ah(a,e,d)):null}static makeFromTransform(a,b){var c,d,e;const f=new Set(),g={};for(const h of b.aggregate){const{op:i,field:j,as:k}=h;i&&("count"===i?(g["*"]=null!==(c=g["*"])&&void 0!==c?c:{},g["*"].count=new Set([k||Ka(h,{forAs:!0})])):(g[j]=null!==(d=g[j])&&void 0!==d?d:{},g[j][i]=new Set([k||Ka(h,{forAs:!0})])))}for(const h of null!==(e=b.groupby)&&void 0!==e?e:[])f.add(h);return f.size+Ea(g).length===0?null:new ah(a,f,g)}merge(a){return function(b,c){if(b.size!==c.size)return!1;for(const d of b)if(!c.has(d))return!1;return!0}(this.dimensions,a.dimensions)?(function(b,c){var d;for(const e of Ea(c)){const f=c[e];for(const g of Ea(f))e in b?b[e][g]=new Set([...null!==(d=b[e][g])&&void 0!==d?d:[],...f[g]]):b[e]={[g]:f[g]}}}(this.measures,a.measures),!0):(function(...b){hq.debug(...b)}("different dimensions, cannot merge"),!1)}addDimensions(a){a.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Ea(this.measures)])}producedFields(){const a=new Set();for(const b of Ea(this.measures))for(const c of Ea(this.measures[b])){const d=this.measures[b][c];0===d.size?a.add(`${c}_${b}`):d.forEach(a.add,a)}return a}hash(){return"Aggregate "+sc({dimensions:this.dimensions,measures:this.measures})}assemble(){const a=[],b=[],c=[];for(const d of Ea(this.measures))for(const e of Ea(this.measures[d]))for(const f of this.measures[d][e])c.push(f),a.push(e),b.push("*"===d?null:hi(d));return{type:"aggregate",groupby:[...this.dimensions].map(hi),ops:a,fields:b,as:c}}}class Ik extends Tc{constructor(a,b,c,d){super(a),this.model=b,this.name=c,this.data=d;for(const e of Tf){const f=b.facet[e];if(f){const{bin:g,sort:h}=f;this[e]=Object.assign({name:b.getName(e+"_domain"),fields:[Ka(f),...bd(g)?[Ka(f,{binSuffix:"end"})]:[]]},Xg(h)?{sortField:h}:U(h)?{sortIndexField:Fk(f,e)}:{})}}this.childModel=b.child}hash(){let a="Facet";for(const b of Tf)this[b]&&(a+=` ${b.charAt(0)}:${sc(this[b])}`);return a}get fields(){var a;const b=[];for(const c of Tf)(null===(a=this[c])||void 0===a?void 0:a.fields)&&b.push(...this[c].fields);return b}dependentFields(){const a=new Set(this.fields);for(const b of Tf)this[b]&&(this[b].sortField&&a.add(this[b].sortField.field),this[b].sortIndexField&&a.add(this[b].sortIndexField));return a}producedFields(){return new Set()}getSource(){return this.name}getChildIndependentFieldsWithStep(){const a={};for(const b of Uf){const c=this.childModel.component.scales[b];if(c&&!c.merged){const d=c.get("type"),e=c.get("range");if(pf(d)&&mi(e)){const f=cy(Mq(this.childModel,b));f?a[b]=f:Ba(`Unknown field for ${b}. Cannot calculate view size.`)}}}return a}assembleRowColumnHeaderData(a,b,c){const d={row:"y",column:"x"}[a],e=[],f=[],g=[];c&&c[d]&&(b?(e.push("distinct_"+c[d]),f.push("max")):(e.push(c[d]),f.push("distinct")),g.push("distinct_"+c[d]));const{sortField:h,sortIndexField:i}=this[a];if(h){const{op:j=mq,field:k}=h;e.push(k),f.push(j),g.push(Ka(h,{forAs:!0}))}else i&&(e.push(i),f.push("max"),g.push(i));return{name:this[a].name,source:null!=b?b:this.data,transform:[Object.assign({type:"aggregate",groupby:this[a].fields},e.length?{fields:e,ops:f,as:g}:{})]}}assembleFacetHeaderData(a){var b,c;const{columns:d}=this.model.layout,{layoutHeaders:e}=this.model.component,f=[],g={};for(const j of Qx){for(const k of Rx){const l=null!==(b=e[j]&&e[j][k])&&void 0!==b?b:[];for(const m of l)if((null===(c=m.axes)||void 0===c?void 0:c.length)>0){g[j]=!0;break}}if(g[j]){const k=`length(data("${this.facet.name}"))`,l="row"===j?d?{signal:`ceil(${k} / ${d})`}:1:d?{signal:`min(${k}, ${d})`}:{signal:k};f.push({name:`${this.facet.name}_${j}`,transform:[{type:"sequence",start:0,stop:l}]})}}const{row:h,column:i}=g;return(h||i)&&f.unshift(this.assembleRowColumnHeaderData("facet",null,a)),f}assemble(){var a,b;const c=[];let d=null;const e=this.getChildIndependentFieldsWithStep(),{column:f,row:g,facet:h}=this;if(f&&g&&(e.x||e.y)){d=`cross_${this.column.name}_${this.row.name}`;const i=[].concat(null!==(a=e.x)&&void 0!==a?a:[],null!==(b=e.y)&&void 0!==b?b:[]),j=i.map(()=>"distinct");c.push({name:d,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:i,ops:j}]})}for(const i of[xh,wh])this[i]&&c.push(this.assembleRowColumnHeaderData(i,d,e));if(h){const i=this.assembleFacetHeaderData(e);i&&c.push(...i)}return c}}function FL(a){return"'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1]?a.slice(1,-1):a}function iX(a){const b={};return function c(d,e){if(Cw(d))c(d.not,e);else if(Bw(d))for(const f of d.and)c(f,e);else if(Aw(d))for(const f of d.or)c(f,e);else e(d)}(a.filter,c=>{var d;if(dJ(c)){let e=null;Ww(c)?e=c.equal:Xw(c)?e=c.range[0]:Yw(c)&&(e=(null!==(d=c.oneOf)&&void 0!==d?d:c.in)[0]),e&&(Ak(e)?b[c.field]="date":Yc(e)?b[c.field]="number":Xa(e)&&(b[c.field]="string")),c.timeUnit&&(b[c.field]="date")}}),b}function jX(a){const b={};function c(d){var e;sq(d)?b[d.field]="date":"quantitative"===d.type&&(Xa(e=d.aggregate)&&nb(["min","max"],e))?b[d.field]="number":Am(d.field)>1?d.field in b||(b[d.field]="flatten"):lx(d)&&Xg(d.sort)&&Am(d.sort.field)>1&&(d.sort.field in b||(b[d.sort.field]="flatten"))}if((Bd(a)||sg(a))&&a.forEachFieldDef((d,e)=>{if(Bf(d))c(d);else{const f=nj(e),g=a.fieldDef(f);c(Object.assign(Object.assign({},d),{type:g.type}))}}),Bd(a)){const{mark:d,markDef:e,encoding:f}=a;if(lj(d)&&!a.encoding.order){const g=f["horizontal"===e.orient?"y":"x"];Qa(g)&&"quantitative"===g.type&&!(g.field in b)&&(b[g.field]="number")}}return b}class We extends Tc{constructor(a,b){super(a),this._parse=b}clone(){return new We(null,ac(this._parse))}hash(){return"Parse "+sc(this._parse)}static makeExplicit(a,b,c){let d={};const e=b.data;return!wj(e)&&e&&e.format&&e.format.parse&&(d=e.format.parse),this.makeWithAncestors(a,d,{},c)}static makeWithAncestors(a,b,c,d){for(const g of Ea(c)){const h=d.getWithExplicit(g);void 0!==h.value&&(h.explicit||h.value===c[g]||"derived"===h.value||"flatten"===c[g]?delete c[g]:Ba(MI(g,c[g],h.value)))}for(const g of Ea(b)){const h=d.get(g);void 0!==h&&(h===b[g]?delete b[g]:Ba(MI(g,b[g],h)))}const e=new ri(b,c);d.copyAll(e);const f={};for(const g of Ea(e.combine())){const h=e.get(g);null!==h&&(f[g]=h)}return 0===Ea(f).length||d.parseNothing?null:new We(a,f)}get parse(){return this._parse}merge(a){this._parse=Object.assign(Object.assign({},this._parse),a.parse),a.remove()}assembleFormatParse(){const a={};for(const b of Ea(this._parse)){const c=this._parse[b];1===Am(b)&&(a[b]=c)}return a}producedFields(){return new Set(Ea(this._parse))}dependentFields(){return new Set(Ea(this._parse))}assembleTransforms(a=!1){return Ea(this._parse).filter(b=>!a||Am(b)>1).map(b=>{const c=function(d,e){const f=hI(d);return"number"===e?`toNumber(${f})`:"boolean"===e?`toBoolean(${f})`:"string"===e?`toString(${f})`:"date"===e?`toDate(${f})`:"flatten"===e?f:0===e.indexOf("date:")?`timeParse(${f},'${FL(e.slice(5,e.length))}')`:0===e.indexOf("utc:")?`utcParse(${f},'${FL(e.slice(4,e.length))}')`:(Ba(`Unrecognized parse "${e}".`),null)}(b,this._parse[b]);return c?{type:"formula",expr:c,as:iI(b)}:null}).filter(b=>null!==b)}}class zj extends Tc{clone(){return new zj(null)}constructor(a){super(a)}dependentFields(){return new Set()}producedFields(){return new Set(["_vgsid_"])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:"_vgsid_"}}}class Jk extends Tc{constructor(a,b){super(a),this.transform=b}clone(){return new Jk(null,ac(this.transform))}addDimensions(a){this.transform.groupby=fi(this.transform.groupby.concat(a),b=>b)}dependentFields(){const a=new Set();return this.transform.groupby&&this.transform.groupby.forEach(a.add,a),this.transform.joinaggregate.map(b=>b.field).filter(b=>void 0!==b).forEach(a.add,a),a}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(a){var b;return null!==(b=a.as)&&void 0!==b?b:Ka(a)}hash(){return"JoinAggregateTransform "+sc(this.transform)}assemble(){const a=[],b=[],c=[];for(const e of this.transform.joinaggregate)b.push(e.op),c.push(this.getDefaultName(e)),a.push(void 0===e.field?null:e.field);const d=this.transform.groupby;return Object.assign({type:"joinaggregate",as:c,ops:b,fields:a},void 0!==d?{groupby:d}:{})}}class vi extends Tc{constructor(a,b){super(a),this._stack=b}clone(){return new vi(null,ac(this._stack))}static makeFromTransform(a,b){const{stack:c,groupby:d,as:e,offset:f="zero"}=b,g=[],h=[];if(void 0!==b.sort)for(const k of b.sort)g.push(k.field),h.push(Kd(k.order,"ascending"));const i={field:g,order:h};let j;return j=function(k){return U(k)&&k.every(l=>Xa(l))&&k.length>1}(e)?e:Xa(e)?[e,e+"_end"]:[b.stack+"_start",b.stack+"_end"],new vi(a,{stackField:c,groupby:d,offset:f,sort:i,facetby:[],as:j})}static makeFromEncoding(a,b){const c=b.stack,{encoding:d}=b;if(!c)return null;const{groupbyChannel:e,fieldChannel:f,offset:g,impute:h}=c;let i;e&&(i=Zg(d[e]));const j=function(m){return m.stack.stackBy.reduce((n,o)=>{const p=Ka(o.fieldDef);return p&&n.push(p),n},[])}(b),k=b.encoding.order;let l;return l=U(k)||Qa(k)?RJ(k):j.reduce((m,n)=>(m.field.push(n),m.order.push("y"===f?"descending":"ascending"),m),{field:[],order:[]}),new vi(a,{dimensionFieldDef:i,stackField:b.vgField(f),facetby:[],stackby:j,sort:l,offset:g,impute:h,as:[b.vgField(f,{suffix:"start",forAs:!0}),b.vgField(f,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(a){this._stack.facetby.push(...a)}dependentFields(){const a=new Set();return a.add(this._stack.stackField),this.getGroupbyFields().forEach(a.add,a),this._stack.facetby.forEach(a.add,a),this._stack.sort.field.forEach(a.add,a),a}producedFields(){return new Set(this._stack.as)}hash(){return"Stack "+sc(this._stack)}getGroupbyFields(){const{dimensionFieldDef:a,impute:b,groupby:c}=this._stack;return a?a.bin?b?[Ka(a,{binSuffix:"mid"})]:[Ka(a,{}),Ka(a,{binSuffix:"end"})]:[Ka(a)]:null!=c?c:[]}assemble(){const a=[],{facetby:b,dimensionFieldDef:c,stackField:d,stackby:e,sort:f,offset:g,impute:h,as:i}=this._stack;if(h&&c){const{band:j=.5,bin:k}=c;k&&a.push({type:"formula",expr:j+"*"+Ka(c,{expr:"datum"})+`+${1-j}*`+Ka(c,{expr:"datum",binSuffix:"end"}),as:Ka(c,{binSuffix:"mid",forAs:!0})}),a.push({type:"impute",field:d,groupby:[...e,...b],key:Ka(c,{binSuffix:"mid"}),method:"value",value:0})}return a.push({type:"stack",groupby:[...this.getGroupbyFields(),...b],field:d,sort:f,as:i,offset:g}),a}}class Qm extends Tc{constructor(a,b){super(a),this.transform=b}clone(){return new Qm(null,ac(this.transform))}addDimensions(a){this.transform.groupby=fi(this.transform.groupby.concat(a),b=>b)}dependentFields(){var a,b;const c=new Set();return(null!==(a=this.transform.groupby)&&void 0!==a?a:[]).forEach(c.add,c),(null!==(b=this.transform.sort)&&void 0!==b?b:[]).forEach(d=>c.add(d.field)),this.transform.window.map(d=>d.field).filter(d=>void 0!==d).forEach(c.add,c),c}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(a){var b;return null!==(b=a.as)&&void 0!==b?b:Ka(a)}hash(){return"WindowTransform "+sc(this.transform)}assemble(){var a;const b=[],c=[],d=[],e=[];for(const l of this.transform.window)c.push(l.op),d.push(this.getDefaultName(l)),e.push(void 0===l.param?null:l.param),b.push(void 0===l.field?null:l.field);const f=this.transform.frame,g=this.transform.groupby;if(f&&null===f[0]&&null===f[1]&&c.every(l=>Jw(l)))return Object.assign({type:"joinaggregate",as:d,ops:c,fields:b},void 0!==g?{groupby:g}:{});const h=[],i=[];if(void 0!==this.transform.sort)for(const l of this.transform.sort)h.push(l.field),i.push(null!==(a=l.order)&&void 0!==a?a:"ascending");const j={field:h,order:i},k=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:e,as:d,ops:c,fields:b,sort:j},void 0!==k?{ignorePeers:k}:{}),void 0!==g?{groupby:g}:{}),void 0!==f?{frame:f}:{})}}class kX extends Fh{run(a){const b=a.parent;if(a instanceof We){if(Lq(b))return this.flags;if(b.numChildren()>1)return this.setContinue(),this.flags;if(b instanceof We)this.setMutated(),b.merge(a);else{if(fI(b.producedFields(),a.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),a.swapWithParent()}}return this.setContinue(),this.flags}}class lX extends Yx{mergeNodes(a,b){const c=b.shift();for(const d of b)a.removeChild(d),d.parent=c,d.remove()}run(a){const b=a.children.map(d=>d.hash()),c={};for(let d=0;d<b.length;d++)void 0===c[b[d]]?c[b[d]]=[a.children[d]]:c[b[d]].push(a.children[d]);for(const d of Ea(c))c[d].length>1&&(this.setMutated(),this.mergeNodes(a,c[d]));for(const d of a.children)this.run(d);return this.mutatedFlag}}class mX extends Fh{run(a){return a instanceof Ve||a.numChildren()>0||a instanceof Ik||(this.setMutated(),a.remove()),this.flags}}class nX extends Fh{constructor(){super(...arguments),this.fields=new Set(),this.prev=null}run(a){if(this.setContinue(),a instanceof Ch){const b=a.producedFields();dI(b,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...b]),this.prev=a}return this.flags}reset(){this.fields.clear()}}class oX extends Fh{run(a){this.setContinue();const b=a.parent.children.filter(d=>d instanceof Ch),c=b.pop();for(const d of b)this.setMutated(),c.merge(d);return this.flags}}function Zx(a){if(a instanceof Ik)if(1!==a.numChildren()||a.children[0]instanceof Ve){const c=a.model.component.data.main;!function f(g){if(g instanceof Ve&&g.type===ye&&1===g.numChildren()){const h=g.children[0];h instanceof Ik||(h.swapWithParent(),f(g))}}(c);const d=(b=a,function f(g){if(!(g instanceof Ik)){const h=g.clone();if(h instanceof Ve){const i=_x+h.getSource();h.setSource(i),b.model.component.data.outputNodes[i]=h}else(h instanceof ah||h instanceof vi||h instanceof Qm||h instanceof Jk)&&h.addDimensions(b.fields);for(const i of g.children.flatMap(f))i.parent=h;return[h]}return g.children.flatMap(f)}),e=a.children.map(d).flat();for(const f of e)f.parent=c}else{const c=a.children[0];(c instanceof ah||c instanceof vi||c instanceof Qm||c instanceof Jk)&&c.addDimensions(a.fields),c.swapWithParent(),Zx(a)}else a.children.map(Zx);var b}class pX extends Yx{constructor(){super()}run(a){a instanceof Ve&&!a.isRequired()&&(this.setMutated(),a.remove());for(const b of a.children)this.run(b);return this.mutatedFlag}}class qX extends Yx{constructor(a){super(),this.requiresSelectionId=a&&Mx(a)}run(a){a instanceof zj&&(this.requiresSelectionId&&(Lq(a.parent)||a.parent instanceof ah||a.parent instanceof We)||(this.setMutated(),a.remove()));for(const b of a.children)this.run(b);return this.mutatedFlag}}class rX extends Fh{run(a){const b=a.parent,c=[...b.children],d=b.children.filter(e=>e instanceof We);if(b.numChildren()>1&&d.length>=1){const e={},f=new Set();for(const g of d){const h=g.parse;for(const i of Ea(h))i in e?e[i]!==h[i]&&f.add(i):e[i]=h[i]}for(const g of f)delete e[g];if(!_c(e)){this.setMutated();const g=new We(b,e);for(const h of c){if(h instanceof We)for(const i of Ea(e))delete h.parse[i];b.removeChild(h),h.parent=g,h instanceof We&&0===Ea(h.parse).length&&h.remove()}}}return this.setContinue(),this.flags}}class sX extends Fh{run(a){const b=a.parent,c=b.children.filter(e=>e instanceof ah),d={};for(const e of c){const f=sc(e.groupBy);f in d||(d[f]=[]),d[f].push(e)}for(const e of Ea(d)){const f=d[e];if(f.length>1){const g=f.pop();for(const h of f)g.merge(h)&&(b.removeChild(h),h.parent=g,h.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class tX extends Fh{constructor(a){super(),this.model=a}run(a){const b=a.parent,c=!(Lq(b)||b instanceof Nm||b instanceof We||b instanceof zj),d=[],e=[];for(const f of b.children)f instanceof Eh&&(c&&!fI(b.producedFields(),f.dependentFields())?d.push(f):e.push(f));if(d.length>0){const f=d.pop();for(const g of d)f.merge(g,this.model.renameSignal.bind(this.model));this.setMutated(),b instanceof Eh?b.merge(f,this.model.renameSignal.bind(this.model)):f.swapWithParent()}if(e.length>1){const f=e.pop();for(const g of e)f.merge(g,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class uX extends Fh{run(a){const b=a.parent,c=[...b.children];if(!ym(c,f=>f instanceof Ve)||b.numChildren()<=1)return this.setContinue(),this.flags;const d=[];let e;for(const f of c)if(f instanceof Ve){let g=f;for(;1===g.numChildren();){const h=g.children[0];if(!(h instanceof Ve))break;g=h}d.push(...g.children),e?(b.removeChild(f),f.parent=e.parent,e.parent.removeChild(e),e.parent=g,this.setMutated()):e=g}else d.push(f);if(d.length){this.setMutated();for(const f of d)f.parent.removeChild(f),f.parent=e}return this.setContinue(),this.flags}}const _x="scale_";function wi(a){const b=[];function c(d){if(0===d.numChildren())b.push(d);else for(const e of d.children)c(e)}for(const d of a)c(d);return b}function vX(a){return a}function rg(a,b){return b.map(c=>{if(a instanceof Fh){const d=a.optimizeNextFromLeaves(c);return a.reset(),d}return a.run(c)}).some(vX)}function GL(a,b){let c=a.sources;const d=new Set();return d.add(rg(new pX(),c)),d.add(rg(new qX(b),c)),c=c.filter(e=>e.numChildren()>0),d.add(rg(new mX(),wi(c))),c=c.filter(e=>e.numChildren()>0),d.add(rg(new kX(),wi(c))),d.add(rg(new tX(b),wi(c))),d.add(rg(new nX(),wi(c))),d.add(rg(new rX(),wi(c))),d.add(rg(new sX(),wi(c))),d.add(rg(new oX(),wi(c))),d.add(rg(new lX(),c)),d.add(rg(new uX(),wi(c))),a.sources=c,d.has(!0)}class Xf{constructor(a){Object.defineProperty(this,"signal",{enumerable:!0,get:a})}static fromName(a,b){return new Xf(()=>a(b))}}function HL(a){Bd(a)?function(b){const c=b.component.scales;for(const d of Ea(c)){const e=wX(b,d);if(c[d].setWithExplicit("domains",e),xX(b,d),b.component.data.isFaceted){let f=b;for(;!sg(f)&&f.parent;)f=f.parent;if("shared"===f.component.resolve.scale[d])for(const g of e.value)ni(g)&&(g.data=_x+g.data.replace(_x,""))}}}(a):function(b){for(const d of b.children)HL(d);const c=b.component.scales;for(const d of Ea(c)){let e,f=null;for(const g of b.children){const h=g.component.scales[d];if(h){e=void 0===e?h.getWithExplicit("domains"):si(e,h.getWithExplicit("domains"),"domains","scale",by);const i=h.get("selectionExtent");f&&i&&f.selection!==i.selection&&Ba("The same selection must be used to override scale domains in a layered view."),f=i}}c[d].setWithExplicit("domains",e),f&&c[d].set("selectionExtent",f,!0)}}(a)}function wX(a,b){const c=a.getScaleComponent(b).get("type"),{encoding:d}=a,e=function(f,g,h,i){if("unaggregated"===f){const{valid:j,reason:k}=IL(g,h);if(!j)return void Ba(k)}else if(void 0===f&&i.useUnaggregatedDomain){const{valid:j}=IL(g,h);if(j)return"unaggregated"}return f}(a.scaleDomain(b),a.typedFieldDef(b),c,a.config.scale);return e!==a.scaleDomain(b)&&(a.specifiedScales[b]=Object.assign(Object.assign({},a.specifiedScales[b]),{domain:e})),"x"===b&&Sd(d.x2)?Sd(d.x)?si(xi(c,e,a,"x"),xi(c,e,a,"x2"),"domain","scale",by):xi(c,e,a,"x2"):"y"===b&&Sd(d.y2)?Sd(d.y)?si(xi(c,e,a,"y"),xi(c,e,a,"y2"),"domain","scale",by):xi(c,e,a,"y2"):xi(c,e,a,b)}function $x(a,b,c){var d;const e=null===(d=Ue(c))||void 0===d?void 0:d.unit;return"temporal"===b||e?function(f,g,h){return f.map(i=>({signal:`{data: ${px(i,{timeUnit:h,type:g})}}`}))}(a,b,e):[a]}function xi(a,b,c,d){const{encoding:e}=c,f=Sd(e[d]),{type:g}=f,h=f.timeUnit;if(function(l){return l&&l.unionWith}(b)){const l=xi(a,void 0,c,d),m=$x(b.unionWith,g,h);return vj([...l.value,...m])}if(tb(b))return vj([b]);if(b&&"unaggregated"!==b&&!kJ(b))return vj($x(b,g,h));const i=c.stack;if(i&&d===i.fieldChannel){if("normalize"===i.offset)return qg([[0,1]]);const l=c.requestDataName(ye);return qg([{data:l,field:c.vgField(d,{suffix:"start"})},{data:l,field:c.vgField(d,{suffix:"end"})}])}const j=li(d)&&Qa(f)?function(l,m,n){if(!pf(n))return;const o=l.fieldDef(m),p=o.sort;if(AJ(p))return{op:"min",field:Fk(o,m),order:"ascending"};const{stack:q}=l,s=q?[...q.groupbyField?[q.groupbyField]:[],...q.stackBy.map(r=>r.fieldDef.field)]:void 0;if(Xg(p)){const r=q&&!nb(s,p.field);return ay(p,r)}if(zJ(p)){const{encoding:r,order:u}=p,t=l.fieldDef(r),{aggregate:w,field:x}=t,z=q&&!nb(s,x);if(ii(w)||mj(w))return ay({field:Ka(t),order:u},z);if(Jw(w)||!w)return ay({op:w,field:x,order:u},z)}else{if("descending"===p)return{op:"min",field:l.vgField(m),order:"descending"};if(nb(["ascending",void 0],p))return!0}return}(c,d,a):void 0;if(pi(f))return qg($x([f.datum],g,h));const k=f;if("unaggregated"===b){const l=c.requestDataName(ye),{field:m}=f;return qg([{data:l,field:Ka({field:m,aggregate:"min"})},{data:l,field:Ka({field:m,aggregate:"max"})}])}if(bd(k.bin)){if(pf(a))return qg("bin-ordinal"===a?[]:[{data:Up(j)?c.requestDataName(ye):c.requestDataName("raw"),field:c.vgField(d,Gm(k,d)?{binSuffix:"range"}:{}),sort:!0!==j&&ka(j)?j:{field:c.vgField(d,{}),op:"min"}}]);{const{bin:l}=k;if(bd(l)){const m=Wx(c,k.field,l);return qg([new Xf(()=>{const n=c.getSignalName(m);return`[${n}.start, ${n}.stop]`})])}return qg([{data:c.requestDataName(ye),field:c.vgField(d,{})}])}}if(k.timeUnit&&nb(["time","utc"],a)&&hx(d,k,Bd(c)?c.encoding[Tg(d)]:void 0,c.stack,c.markDef,c.config)){const l=c.requestDataName(ye);return qg([{data:l,field:c.vgField(d)},{data:l,field:c.vgField(d,{suffix:"end"})}])}return qg(j?[{data:Up(j)?c.requestDataName(ye):c.requestDataName("raw"),field:c.vgField(d),sort:j}]:[{data:c.requestDataName(ye),field:c.vgField(d)}])}function ay(a,b){const{op:c,field:d,order:e}=a;return Object.assign(Object.assign({op:null!=c?c:b?"sum":mq},d?{field:hi(d)}:{}),e?{order:e}:{})}function xX(a,b){var c;const d=a.component.scales[b],e=a.specifiedScales[b].domain,f=null===(c=a.fieldDef(b))||void 0===c?void 0:c.bin,g=kJ(e)&&e,h=Bm(f)&&eq(f.extent)&&f.extent;(g||h)&&d.set("selectionExtent",null!=g?g:h,!0)}function IL(a,b){const{aggregate:c,type:d}=a;return c?Xa(c)&&!SU[c]?{valid:!1,reason:eV(c)}:"quantitative"===d&&"log"===b?{valid:!1,reason:fV(a)}:{valid:!0}:{valid:!1,reason:dV(a)}}function by(a,b,c,d){return a.explicit&&b.explicit&&Ba(function(e,f,g,h){return`Conflicting ${f.toString()} property "${e.toString()}" (${kd(g)} and ${kd(h)}). Using the union of the two domains.`}(c,d,a.value,b.value)),{explicit:a.explicit,value:[...a.value,...b.value]}}function yX(a){const b=fi(a.map(g=>ni(g)?Fa(g,["sort"]):g),sc),c=fi(a.map(g=>{if(ni(g)){const h=g.sort;return void 0===h||Up(h)||("op"in h&&"count"===h.op&&delete h.field,"ascending"===h.order&&delete h.order),h}}).filter(g=>void 0!==g),sc);if(0===b.length)return;if(1===b.length){const g=a[0];if(ni(g)&&c.length>0){let h=c[0];if(c.length>1)Ba(SI),h=!0;else if(ka(h)&&"field"in h){const i=h.field;g.field===i&&(h=!h.order||{order:h.order})}return Object.assign(Object.assign({},g),{sort:h})}return g}const d=fi(c.map(g=>Up(g)||!("op"in g)||g.op in PU?g:(Ba(function(h){return`Dropping sort property ${kd(h)} as unioned domains only support boolean or op "count", "min", and "max".`}(g)),!0)),sc);let e;1===d.length?e=d[0]:d.length>1&&(Ba(SI),e=!0);const f=fi(a.map(g=>ni(g)?g.data:null),g=>g);return 1===f.length&&null!==f[0]?Object.assign({data:f[0],fields:b.map(g=>g.field)},e?{sort:e}:{}):Object.assign({fields:b},e?{sort:e}:{})}function cy(a){if(ni(a)&&Xa(a.field))return a.field;if(function(b){return!U(b)&&("fields"in b&&!("data"in b))}(a)){let b;for(const c of a.fields)if(ni(c)&&Xa(c.field))if(b){if(b!==c.field)return Ba("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),b}else b=c.field;return Ba("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),b}if(function(b){return!U(b)&&("fields"in b&&"data"in b)}(a)){Ba("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const b=a.fields[0];return Xa(b)?b:void 0}}function Mq(a,b){return yX(a.component.scales[b].get("domains").map(c=>(ni(c)&&(c.data=a.lookupDataSource(c.data)),c)))}function JL(a){return Ea(a.component.scales).reduce((b,c)=>{const d=a.component.scales[c];if(d.merged)return b;const e=d.combine(),{name:f,type:g,selectionExtent:h,domains:i,range:j,reverse:k}=e,l=Fa(e,["name","type","selectionExtent","domains","range","reverse"]),m=function(p,q,s){return Vg(s)&&mi(p)?{step:{signal:q+"_step"}}:p}(e.range,f,c);let n;h&&(n=function(p,q){const s=q.selection;return{signal:_K(p.getSelectionComponent(s,ld(s)),q)}}(a,h));const o=Mq(a,c);return b.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:f,type:g},o?{domain:o}:{}),n?{domainRaw:n}:{}),{range:m}),void 0!==k?{reverse:k}:{}),l)),b},[])}class KL extends ri{constructor(a,b){super({},{name:a}),this.merged=!1,this.setWithExplicit("type",b)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||ym(this.get("domains"),a=>U(a)&&2===a.length&&a[0]<=0&&a[1]>=0)}}const zX=["range","scheme"];function LL(a){return"x"===a?"width":"y"===a?"height":void 0}function ML(a,b){const c=a.fieldDef(b);if(c&&c.bin&&bd(c.bin)){const d=Wx(a,c.field,c.bin),e=LL(b),f=a.getName(e);return new Xf(()=>{const g=a.getSignalName(d),h=`(${g}.stop - ${g}.start) / ${g}.step`;return`${a.getSignalName(f)} / (${h})`})}}function AX(a,b){const c=b.specifiedScales[a],{size:d}=b,e=b.getScaleComponent(a).get("type");for(const f of zX)if(void 0!==c[f]){const g=lJ(e,f),h=mJ(a,f);if(g)if(h)Ba(h);else switch(f){case"range":return U(c.range)&&Vg(a)?vj(c.range.map(i=>{if("width"===i||"height"===i){const j=b.getName(i),k=b.getSignalName.bind(b);return Xf.fromName(k,j)}return i})):vj(c.range);case"scheme":return vj(BX(c[f]))}else Ba(QI(e,f,a))}if("x"===a||"y"===a){const f="x"===a?"width":"height",g=d[f];if(_g(g)){if(pf(e))return vj({step:g.step});Ba(RI(f))}}return qg(function(f,g){const{size:h,config:i,mark:j,encoding:k}=g,l=g.getSignalName.bind(g),{type:m}=Sd(k[f]),n=g.getScaleComponent(f).get("type"),{domain:o,domainMid:p}=g.specifiedScales[f];switch(f){case"x":case"y":{if(nb(["point","band"],n))if("x"!==f||h.width){if("y"===f&&!h.height){const r=Im(i.view,"height");if(_g(r))return r}}else{const r=Im(i.view,"width");if(_g(r))return r}const q=LL(f),s=g.getName(q);return"y"===f&&Vf(n)?[Xf.fromName(l,s),0]:[0,Xf.fromName(l,s)]}case zh:{const q=g.component.scales[f].get("zero"),s=function u(t,w,x){if(w)return tb(w)?{signal:`${w.signal} ? 0 : ${u(t,!1,x)}`}:0;switch(t){case"bar":case"tick":return x.scale.minBandSize;case"line":case"trail":case"rule":return x.scale.minStrokeWidth;case"text":return x.scale.minFontSize;case"point":case"square":case"circle":return x.scale.minSize}throw new Error(fq("size",t))}(j,q,i),r=function(u,t,w,x){const z={x:ML(w,"x"),y:ML(w,"y")};switch(u){case"bar":case"tick":{if(void 0!==x.scale.maxBandSize)return x.scale.maxBandSize;const A=NL(t,z,x.view);return Yc(A)?A-1:new Xf(()=>A.signal+" - 1")}case"line":case"trail":case"rule":return x.scale.maxStrokeWidth;case"text":return x.scale.maxFontSize;case"point":case"square":case"circle":{if(x.scale.maxSize)return x.scale.maxSize;const A=NL(t,z,x.view);return Yc(A)?Math.pow(.95*A,2):new Xf(()=>`pow(0.95 * ${A.signal}, 2)`)}}throw new Error(fq("size",u))}(j,h,g,i);return jq(n)?function(u,t,w){const x=()=>{const z=Hm(t),A=Hm(u),B=`(${z} - ${A}) / (${w} - 1)`;return`sequence(${A}, ${z} + ${B}, ${B})`};return tb(t)?new Xf(x):{signal:x()}}(s,r,function(u,t,w,x){switch(u){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==w&&U(w)?w.length+1:(Ba(function(z){return`Domain for ${z} is required for threshold scale.`}(x)),3)}}(n,i,o,f)):[s,r]}case og:return[0,2*Math.PI];case"angle":return[0,360];case Qg:return[0,new Xf(()=>`min(${g.getSignalName("width")},${g.getSignalName("height")})/2`)];case"strokeWidth":return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case"strokeDash":return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case of:return"symbol";case nf:case Rg:case Sg:return"ordinal"===n?"nominal"===m?"category":"ordinal":void 0!==p?"diverging":"rect"===j||"geoshape"===j?"heatmap":"ramp";case"opacity":case"fillOpacity":case"strokeOpacity":return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+f)}(a,b))}function BX(a){return function(b){return!Xa(b)&&!!b.name}(a)?Object.assign({scheme:a.name},uh(a,["name"])):{scheme:a}}function NL(a,b,c){const d=_g(a.width)?a.width.step:wq(c,"width"),e=_g(a.height)?a.height.step:wq(c,"height");return b.x||b.y?new Xf(()=>`min(${[b.x?b.x.signal:d,b.y?b.y.signal:e].join(", ")})`):Math.min(d,e)}function OL(a,b){Bd(a)?function(c,d){const e=c.component.scales,{config:f,encoding:g,markDef:h,specifiedScales:i}=c;for(const j of Ea(e)){const k=i[j],l=e[j],m=c.getScaleComponent(j),n=Sd(g[j]),o=k[d],p=m.get("type"),q=m.get("padding"),s=m.get("paddingInner"),r=lJ(p,d),u=mJ(j,d);if(void 0!==o&&(r?u&&Ba(u):Ba(QI(p,d,j))),r&&void 0===u)if(void 0!==o)l.copyKeyFromObject(d,k);else{const t=d in PL?PL[d]({model:c,channel:j,fieldOrDatumDef:n,scaleType:p,scalePadding:q,scalePaddingInner:s,domain:k.domain,markDef:h,config:f}):f.scale[d];void 0!==t&&l.set(d,t,!1)}}}(a,b):RL(a,b)}const PL={bins:({model:a,fieldOrDatumDef:b})=>Qa(b)?function(c,d){const e=d.bin;if(bd(e)){const f=Wx(c,d.field,e);return new Xf(()=>c.getSignalName(f))}return Te(e)&&Bm(e)&&void 0!==e.step?{step:e.step}:void 0}(a,b):void 0,interpolate:({channel:a,fieldOrDatumDef:b})=>function(c,d){return nb([nf,Rg,Sg],c)&&"nominal"!==d?"hcl":void 0}(a,b.type),nice:({scaleType:a,channel:b,fieldOrDatumDef:c})=>function(d,e,f){var g;return(null===(g=Zg(f))||void 0===g?void 0:g.bin)||nb([ax,iq],d)?void 0:e in ki||void 0}(a,b,c),padding:({channel:a,scaleType:b,fieldOrDatumDef:c,markDef:d,config:e})=>function(f,g,h,i,j,k){if(f in ki){if(pg(g)){if(void 0!==h.continuousPadding)return h.continuousPadding;const{type:l,orient:m}=j;if("bar"===l&&(!Qa(i)||!i.bin&&!i.timeUnit)&&("vertical"===m&&"x"===f||"horizontal"===m&&"y"===f))return k.continuousBandSize}if(g===hJ)return h.pointPadding}return}(a,b,e.scale,c,d,e.bar),paddingInner:({scalePadding:a,channel:b,markDef:c,config:d})=>function(e,f,g,h){if(void 0!==e)return;if(f in ki){const{bandPaddingInner:i,barBandPaddingInner:j,rectBandPaddingInner:k}=h;return Kd(i,"bar"===g?j:k)}return}(a,b,c.type,d.scale),paddingOuter:({scalePadding:a,channel:b,scaleType:c,markDef:d,scalePaddingInner:e,config:f})=>function(g,h,i,j,k,l){if(void 0!==g)return;if(h in ki&&i===uV){const{bandPaddingOuter:m}=l;return Kd(m,tb(k)?{signal:k.signal+"/2"}:k/2)}return}(a,b,c,d.type,e,f.scale),reverse:({fieldOrDatumDef:a,scaleType:b,channel:c,config:d})=>function(e,f,g,h){return"x"===g&&void 0!==h.xReverse?Vf(e)&&"descending"===f?tb(h.xReverse)?{signal:"!"+h.xReverse.signal}:!h.xReverse:h.xReverse:Vf(e)&&"descending"===f?!0:void 0}(b,Qa(a)?a.sort:void 0,c,d.scale),zero:({channel:a,fieldOrDatumDef:b,domain:c,markDef:d,scaleType:e})=>function(f,g,h,i,j){if(h&&"unaggregated"!==h&&Vf(j)){if(U(h)){const k=h[0],l=h[h.length-1];if(k<=0&&l>=0)return!0}return!1}if("size"===f&&"quantitative"===g.type&&!jq(j))return!0;if((!Qa(g)||!g.bin)&&nb([...Uf,...YU],f)){const{orient:k,type:l}=i;return!nb(["bar","area","line","trail"],l)||!("horizontal"===k&&"y"===f||"vertical"===k&&"x"===f)}return!1}(a,b,c,d,e)};function QL(a){Bd(a)?function(b){const c=b.component.scales;for(const d of cq){const e=c[d];if(!e)continue;const f=AX(d,b);e.setWithExplicit("range",f)}}(a):RL(a,"range")}function RL(a,b){const c=a.component.scales;for(const d of a.children)"range"===b?QL(d):OL(d,b);for(const d of Ea(c)){let e;for(const f of a.children){const g=f.component.scales[d];g&&(e=si(e,g.getWithExplicit(b),b,"scale",zK((h,i)=>{switch(b){case"range":return h.step&&i.step?h.step-i.step:0}return 0})))}c[d].setWithExplicit(b,e)}}function CX(a,b,c,d){const e=function(g,h,i){var j;switch(h.type){case"nominal":case"ordinal":if(zk(g)||"discrete"===dq(g))return"shape"===g&&"ordinal"===h.type&&Ba(Qw(g,"ordinal")),"ordinal";if(g in ki){if(nb(["rect","bar","image","rule"],i))return"band"}else if("arc"===i&&g in Nw)return"band";return void 0!==h.band||mx(h)&&(null===(j=h.axis)||void 0===j?void 0:j.tickBand)?"band":"point";case"temporal":return zk(g)?"time":"discrete"===dq(g)?(Ba(Qw(g,"temporal")),"ordinal"):Qa(h)&&h.timeUnit&&Ue(h.timeUnit).utc?"utc":"time";case"quantitative":return zk(g)?Qa(h)&&bd(h.bin)?"bin-ordinal":"linear":"discrete"===dq(g)?(Ba(Qw(g,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(OI(h.type))}(b,c,d),{type:f}=a;return li(b)?void 0!==f?oJ(b,f)?Qa(c)&&!nJ(f,c.type)?(Ba(function(g,h){return`FieldDef does not work with "${g}" scale. We are using "${h}" scale instead.`}(f,e)),e):f:(Ba(function(g,h,i){return`Channel "${g}" does not work with "${h}" scale. We are using "${i}" scale instead.`}(b,f,e)),e):e:null}function SL(a){Bd(a)?a.component.scales=function(b){const{encoding:c,mark:d}=b;return cq.reduce((e,f)=>{const g=Sd(c[f]);if(g&&d===pI&&f===of&&g.type===Dk)return e;let h=g&&g.scale;if(g&&null!==h&&!1!==h){h=null!=h?h:{};const i=CX(h,f,g,d);e[f]=new KL(b.scaleName(f+"",!0),{value:i,explicit:h.type===i})}return e},{})}(a):a.component.scales=function(b){var c;const d=b.component.scales={},e={},f=b.component.resolve;for(const g of b.children){SL(g);for(const h of Ea(g.component.scales))if(f.scale[h]=null!==(c=f.scale[h])&&void 0!==c?c:ZW(h,b),"shared"===f.scale[h]){const i=e[h],j=g.component.scales[h].getWithExplicit("type");i?wV(i.value,j.value)?e[h]=si(i,j,"type","scale",DX):(f.scale[h]="independent",delete e[h]):e[h]=j}}for(const g of Ea(e)){const h=b.scaleName(g,!0),i=e[g];d[g]=new KL(h,i);for(const j of b.children){const k=j.component.scales[g];k&&(j.renameScale(k.get("name"),h),k.merged=!0)}}return d}(a)}const DX=zK((a,b)=>iJ(a)-iJ(b));class dy{constructor(){this.nameMap={}}rename(a,b){this.nameMap[a]=b}has(a){return void 0!==this.nameMap[a]}get(a){for(;this.nameMap[a]&&a!==this.nameMap[a];)a=this.nameMap[a];return a}}function Bd(a){return"unit"===(null==a?void 0:a.type)}function sg(a){return"facet"===(null==a?void 0:a.type)}function ey(a){return"concat"===(null==a?void 0:a.type)}function Kk(a){return"layer"===(null==a?void 0:a.type)}class fy{constructor(a,b,c,d,e,f,g){var h,i;this.type=b,this.parent=c,this.config=e,this.view=g,this.children=[],this.correctDataNames=j=>(j.from&&j.from.data&&(j.from.data=this.lookupDataSource(j.from.data)),j.from&&j.from.facet&&j.from.facet.data&&(j.from.facet.data=this.lookupDataSource(j.from.facet.data)),j),this.parent=c,this.config=e,this.name=null!==(h=a.name)&&void 0!==h?h:d,this.title=qi(a.title)?{text:a.title}:a.title,this.scaleNameMap=c?c.scaleNameMap:new dy(),this.projectionNameMap=c?c.projectionNameMap:new dy(),this.signalNameMap=c?c.signalNameMap:new dy(),this.data=a.data,this.description=a.description,this.transforms=function(j){return j.map(k=>DK(k)?{filter:Tp(k.filter,mV)}:k)}(null!==(i=a.transform)&&void 0!==i?i:[]),this.layout="layer"===b||"unit"===b?{}:function(j,k,l){var m,n;const o=l[k],p={},{spacing:q,columns:s}=o;void 0!==q&&(p.spacing=q),void 0!==s&&(nq(j)&&!Em(j.facet)||yx(j))&&(p.columns=s),vq(j)&&(p.columns=1);for(const r of RV)if(void 0!==j[r])if("spacing"===r){const u=j[r];p[r]=Yc(u)?u:{row:null!==(m=u.row)&&void 0!==m?m:q,column:null!==(n=u.column)&&void 0!==n?n:q}}else p[r]=j[r];return p}(a,b,e),this.component={data:{sources:c?c.component.data.sources:[],outputNodes:c?c.component.data.outputNodes:{},outputNodeRefCounts:c?c.component.data.outputNodeRefCounts:{},isFaceted:nq(a)||c&&c.component.data.isFaceted&&void 0===a.data},layoutSize:new ri(),layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},f?ac(f):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(a,{ignoreRange:b}={}){SL(a),HL(a);for(const c of EV)OL(a,c);b||QL(a)}(this)}parseProjection(){BL(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){vL(this)}assembleGroupStyle(){var a,b;if("unit"===this.type||"layer"===this.type)return null!==(b=null===(a=this.view)||void 0===a?void 0:a.style)&&void 0!==b?b:"cell"}assembleEncodeFromView(a){const b=Fa(a,["style"]),c={};for(const d of Ea(b)){const e=b[d];void 0!==e&&(c[d]=Fd(e))}return c}assembleGroupEncodeEntry(a){let b={};return this.view&&(b=this.assembleEncodeFromView(this.view)),a||(this.description&&(b.description=Fd(this.description)),"unit"!==this.type&&"layer"!==this.type)?_c(b)?void 0:b:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=b?b:{})}assembleLayout(){if(!this.layout)return;const a=this.layout,{spacing:b}=a,c=Fa(a,["spacing"]),{component:d,config:e}=this,f=function(g,h){const i={};for(const j of Tf){const k=g[j];if(null==k?void 0:k.facetFieldDef){const{titleAnchor:l,titleOrient:m}=Hq(["titleAnchor","titleOrient"],k.facetFieldDef,h,j),n=Gq(j,m),o=YW(l,n);void 0!==o&&(i[n]=o)}}return _c(i)?void 0:i}(d.layoutHeaders,e);return Object.assign(Object.assign(Object.assign({padding:b},this.assembleDefaultLayout()),c),f?{titleBand:f}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:a}=this.component;let b=[];for(const c of Tf)a[c].title&&b.push(TW(this,c));for(const c of Qx)b=b.concat(UW(this,c));return b}assembleAxes(){return function(a,b){const{x:c=[],y:d=[]}=a;return[...c.map(e=>Om(e,"grid",b)),...d.map(e=>Om(e,"grid",b)),...c.map(e=>Om(e,"main",b)),...d.map(e=>Om(e,"main",b))].filter(e=>e)}(this.component.axes,this.config)}assembleLegends(){return yL(this)}assembleProjections(){return fX(this)}assembleTitle(){var a,b,c;const d=null!==(a=this.title)&&void 0!==a?a:{},{encoding:e}=d,f=Fa(d,["encoding"]),g=Object.assign(Object.assign(Object.assign({},NJ(this.config.title).nonMark),f),e?{encode:{update:e}}:{});if(g.text)return nb(["unit","layer"],this.type)?nb(["middle",void 0],g.anchor)&&(g.frame=null!==(b=g.frame)&&void 0!==b?b:"group"):g.anchor=null!==(c=g.anchor)&&void 0!==c?c:"start",_c(g)?void 0:g}assembleGroup(a=[]){const b={};(a=a.concat(this.assembleSignals())).length>0&&(b.signals=a);const c=this.assembleLayout();c&&(b.layout=c),b.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const d=!this.parent||sg(this.parent)?function g(h){return Kk(h)||ey(h)?h.children.reduce((i,j)=>i.concat(g(j)),JL(h)):JL(h)}(this):[];d.length>0&&(b.scales=d);const e=this.assembleAxes();e.length>0&&(b.axes=e);const f=this.assembleLegends();return f.length>0&&(b.legends=f),b}getName(a){return ld((this.name?this.name+"_":"")+a)}requestDataName(a){var b;const c=this.getName(a),d=this.component.data.outputNodeRefCounts;return d[c]=(null!==(b=d[c])&&void 0!==b?b:0)+1,c}getSizeSignalRef(a){if(sg(this.parent)){const b=bq(mL(a)),c=this.component.scales[b];if(c&&!c.merged){const d=c.get("type"),e=c.get("range");if(pf(d)&&mi(e)){const f=c.get("name"),g=cy(Mq(this,b));return g?{signal:lL(f,c,Ka({aggregate:"distinct",field:g},{expr:"datum"}))}:(Ba(`Unknown field for ${b}. Cannot calculate view size.`),null)}}}return{signal:this.signalNameMap.get(this.getName(a))}}lookupDataSource(a){const b=this.component.data.outputNodes[a];return b?b.getSource():a}getSignalName(a){return this.signalNameMap.get(a)}renameSignal(a,b){this.signalNameMap.rename(a,b)}renameScale(a,b){this.scaleNameMap.rename(a,b)}renameProjection(a,b){this.projectionNameMap.rename(a,b)}scaleName(a,b){return b?this.getName(a):zI(a)&&li(a)&&this.component.scales[a]||this.scaleNameMap.has(this.getName(a))?this.scaleNameMap.get(this.getName(a)):void 0}projectionName(a){return a?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(a){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const b=this.component.scales[a];return b&&!b.merged?b:this.parent?this.parent.getScaleComponent(a):void 0}getSelectionComponent(a,b){let c=this.component.selection[a];if(!c&&this.parent&&(c=this.parent.getSelectionComponent(a,b)),!c)throw new Error(function(d){return`Cannot find a selection named "${d}".`}(b));return c}hasAxisOrientSignalRef(){var a,b;return(null===(a=this.component.axes.x)||void 0===a?void 0:a.some(c=>c.hasOrientSignalRef()))||(null===(b=this.component.axes.y)||void 0===b?void 0:b.some(c=>c.hasOrientSignalRef()))}}class TL extends fy{vgField(a,b={}){const c=this.fieldDef(a);if(c)return Ka(c,b)}reduceFieldDef(a,b){return VJ(this.getMapping(),(c,d,e)=>{const f=Zg(d);return f?a(c,f,e):c},b)}forEachFieldDef(a,b){sx(this.getMapping(),(c,d)=>{const e=Zg(c);e&&a(e,d)},b)}}class gy extends Tc{constructor(a,b){var c,d,e;super(a),this.transform=b,this.transform=ac(b);const f=null!==(c=this.transform.as)&&void 0!==c?c:[void 0,void 0];this.transform.as=[null!==(d=f[0])&&void 0!==d?d:"value",null!==(e=f[1])&&void 0!==e?e:"density"]}clone(){return new gy(null,ac(this.transform))}dependentFields(){var a;return new Set([this.transform.density,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform "+sc(this.transform)}assemble(){const a=this.transform,{density:b}=a,c=Fa(a,["density"]);return Object.assign({type:"kde",field:b},c)}}class Nq extends Tc{constructor(a,b){super(a),this.filter=b}clone(){return new Nq(null,Object.assign({},this.filter))}static make(a,b){const{config:c,mark:d,markDef:e}=b;if("filter"!==Hc("invalid",e,c))return null;const f=b.reduceFieldDef((g,h,i)=>{const j=li(i)&&b.getScaleComponent(i);return j&&(Vf(j.get("type"))&&"count"!==h.aggregate&&!lj(d)&&(g[h.field]=h)),g},{});return Ea(f).length?new Nq(a,f):null}dependentFields(){return new Set(Ea(this.filter))}producedFields(){return new Set()}hash(){return"FilterInvalid "+sc(this.filter)}assemble(){const a=Ea(this.filter).reduce((b,c)=>{const d=this.filter[c],e=Ka(d,{expr:"datum"});return null!==d&&("temporal"===d.type?b.push(`(isDate(${e}) || (isValid(${e}) && isFinite(+${e})))`):"quantitative"===d.type&&(b.push(`isValid(${e})`),b.push(`isFinite(+${e})`))),b},[]);return a.length>0?{type:"filter",expr:a.join(" && ")}:null}}class hy extends Tc{constructor(a,b){super(a),this.transform=b,this.transform=ac(b);const{flatten:c,as:d=[]}=this.transform;this.transform.as=c.map((e,f)=>{var g;return null!==(g=d[f])&&void 0!==g?g:e})}clone(){return new hy(this.parent,ac(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform "+sc(this.transform)}assemble(){const{flatten:a,as:b}=this.transform;return{type:"flatten",fields:a,as:b}}}class iy extends Tc{constructor(a,b){var c,d,e;super(a),this.transform=b,this.transform=ac(b);const f=null!==(c=this.transform.as)&&void 0!==c?c:[void 0,void 0];this.transform.as=[null!==(d=f[0])&&void 0!==d?d:"key",null!==(e=f[1])&&void 0!==e?e:"value"]}clone(){return new iy(null,ac(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform "+sc(this.transform)}assemble(){const{fold:a,as:b}=this.transform;return{type:"fold",fields:a,as:b}}}class Rm extends Tc{constructor(a,b,c,d){super(a),this.fields=b,this.geojson=c,this.signal=d}clone(){return new Rm(null,ac(this.fields),this.geojson,this.signal)}static parseAll(a,b){if(b.component.projection&&!b.component.projection.isFit)return a;let c=0;for(const d of[["longitude","latitude"],["longitude2","latitude2"]]){const e=d.map(f=>{const g=Sd(b.encoding[f]);return Qa(g)?g.field:pi(g)?{expr:""+g.datum}:Ah(g)?{expr:""+g.value}:void 0});(e[0]||e[1])&&(a=new Rm(a,e,null,b.getName("geojson_"+c++)))}if(b.channelHasField(of)){const d=b.typedFieldDef(of);d.type===Dk&&(a=new Rm(a,null,d.field,b.getName("geojson_"+c++)))}return a}dependentFields(){var a;const b=(null!==(a=this.fields)&&void 0!==a?a:[]).filter(Xa);return new Set([...this.geojson?[this.geojson]:[],...b])}producedFields(){return new Set()}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${sc(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class Oq extends Tc{constructor(a,b,c,d){super(a),this.projection=b,this.fields=c,this.as=d}clone(){return new Oq(null,this.projection,ac(this.fields),ac(this.as))}static parseAll(a,b){if(!b.projectionName())return a;for(const c of[["longitude","latitude"],["longitude2","latitude2"]]){const d=c.map(f=>{const g=Sd(b.encoding[f]);return Qa(g)?g.field:pi(g)?{expr:""+g.datum}:Ah(g)?{expr:""+g.value}:void 0}),e="longitude2"===c[0]?"2":"";(d[0]||d[1])&&(a=new Oq(a,b.projectionName(),d,[b.getName("x"+e),b.getName("y"+e)]))}return a}dependentFields(){return new Set(this.fields.filter(Xa))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${sc(this.fields)} ${sc(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Lk extends Tc{constructor(a,b){super(a),this.transform=b}clone(){return new Lk(null,ac(this.transform))}dependentFields(){var a;return new Set([this.transform.impute,this.transform.key,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(a){const{start:b=0,stop:c,step:d}=a;return{signal:`sequence(${[b,c,...d?[d]:[]].join(",")})`}}static makeFromTransform(a,b){return new Lk(a,b)}static makeFromEncoding(a,b){const c=b.encoding,d=c.x,e=c.y;if(Qa(d)&&Qa(e)){const f=d.impute?d:e.impute?e:void 0;if(void 0===f)return;const g=d.impute?e:e.impute?d:void 0,{method:h,value:i,frame:j,keyvals:k}=f.impute,l=WJ(b.mark,c);return new Lk(a,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:f.field,key:g.field},h?{method:h}:{}),void 0!==i?{value:i}:{}),j?{frame:j}:{}),void 0!==k?{keyvals:k}:{}),l.length?{groupby:l}:{}))}return null}hash(){return"Impute "+sc(this.transform)}assemble(){const{impute:a,key:b,keyvals:c,method:d,groupby:e,value:f,frame:g=[null,null]}=this.transform,h=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:a,key:b},c?{keyvals:iW(c)?this.processSequence(c):c}:{}),{method:"value"}),e?{groupby:e}:{}),{value:d&&"value"!==d?null:f});return d&&"value"!==d?[h,Object.assign({type:"window",as:[`imputed_${a}_value`],ops:[d],fields:[a],frame:g,ignorePeers:!1},e?{groupby:e}:{}),{type:"formula",expr:`datum.${a} === null ? datum.imputed_${a}_value : datum.${a}`,as:a}]:[h]}}class jy extends Tc{constructor(a,b){var c,d,e;super(a),this.transform=b,this.transform=ac(b);const f=null!==(c=this.transform.as)&&void 0!==c?c:[void 0,void 0];this.transform.as=[null!==(d=f[0])&&void 0!==d?d:b.on,null!==(e=f[1])&&void 0!==e?e:b.loess]}clone(){return new jy(null,ac(this.transform))}dependentFields(){var a;return new Set([this.transform.loess,this.transform.on,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform "+sc(this.transform)}assemble(){const a=this.transform,{loess:b,on:c}=a,d=Fa(a,["loess","on"]);return Object.assign({type:"loess",x:c,y:b},d)}}class Pq extends Tc{constructor(a,b,c){super(a),this.transform=b,this.secondary=c}clone(){return new Pq(null,ac(this.transform),this.secondary)}static make(a,b,c,d){const e=b.component.data.sources,{from:f}=c;let g=null;if(function(h){return"data"in h}(f)){let h=XL(f.data,e);h||(h=new Hk(f.data),e.push(h));const i=b.getName("lookup_"+d);g=new Ve(h,i,"lookup",b.component.data.outputNodeRefCounts),b.component.data.outputNodes[i]=g}else if(function(h){return"selection"in h}(f)){const h=f.selection;if(c=Object.assign({as:h},c),g=b.getSelectionComponent(ld(h),h).materialized,!g)throw new Error(function(i){return`Cannot define and lookup the "${i}" selection in the same view. Try moving the lookup into a second, layered view?`}(h))}return new Pq(a,c,g.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Ra(this.transform.as):this.transform.from.fields)}hash(){return"Lookup "+sc({transform:this.transform,secondary:this.secondary})}assemble(){let a;if(this.transform.from.fields)a=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Ra(this.transform.as)}:{});else{let b=this.transform.as;Xa(b)||(Ba('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),b="_lookup"),a={as:[b]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},a),this.transform.default?{default:this.transform.default}:{})}}class ky extends Tc{constructor(a,b){var c,d,e;super(a),this.transform=b,this.transform=ac(b);const f=null!==(c=this.transform.as)&&void 0!==c?c:[void 0,void 0];this.transform.as=[null!==(d=f[0])&&void 0!==d?d:"prob",null!==(e=f[1])&&void 0!==e?e:"value"]}clone(){return new ky(null,ac(this.transform))}dependentFields(){var a;return new Set([this.transform.quantile,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform "+sc(this.transform)}assemble(){const a=this.transform,{quantile:b}=a,c=Fa(a,["quantile"]);return Object.assign({type:"quantile",field:b},c)}}class ly extends Tc{constructor(a,b){var c,d,e;super(a),this.transform=b,this.transform=ac(b);const f=null!==(c=this.transform.as)&&void 0!==c?c:[void 0,void 0];this.transform.as=[null!==(d=f[0])&&void 0!==d?d:b.on,null!==(e=f[1])&&void 0!==e?e:b.regression]}clone(){return new ly(null,ac(this.transform))}dependentFields(){var a;return new Set([this.transform.regression,this.transform.on,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform "+sc(this.transform)}assemble(){const a=this.transform,{regression:b,on:c}=a,d=Fa(a,["regression","on"]);return Object.assign({type:"regression",x:c,y:b},d)}}class my extends Tc{constructor(a,b){super(a),this.transform=b}clone(){return new my(null,ac(this.transform))}addDimensions(a){var b;this.transform.groupby=fi((null!==(b=this.transform.groupby)&&void 0!==b?b:[]).concat(a),c=>c)}producedFields(){}dependentFields(){var a;return new Set([this.transform.pivot,this.transform.value,...null!==(a=this.transform.groupby)&&void 0!==a?a:[]])}hash(){return"PivotTransform "+sc(this.transform)}assemble(){const{pivot:a,value:b,groupby:c,limit:d,op:e}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:a,value:b},void 0!==d?{limit:d}:{}),void 0!==e?{op:e}:{}),void 0!==c?{groupby:c}:{})}}class ny extends Tc{constructor(a,b){super(a),this.transform=b}clone(){return new ny(null,ac(this.transform))}dependentFields(){return new Set()}producedFields(){return new Set()}hash(){return"SampleTransform "+sc(this.transform)}assemble(){return{type:"sample",size:this.transform.sample}}}function UL(a){let b=0;return function c(d,e){var f;d instanceof Hk&&!d.isGenerator&&!Jm(d.data)&&(a.push(e),e={name:null,source:e.name,transform:[]});if(d instanceof We&&(d.parent instanceof Hk&&!e.source?(e.format=Object.assign(Object.assign({},null!==(f=e.format)&&void 0!==f?f:{}),{parse:d.assembleFormatParse()}),e.transform.push(...d.assembleTransforms(!0))):e.transform.push(...d.assembleTransforms())),d instanceof Ik){e.name||(e.name="data_"+b++),!e.source||e.transform.length>0?(a.push(e),d.data=e.name):d.data=e.source;for(const g of d.assemble())a.push(g)}else{((d instanceof Jq||d instanceof Kq||d instanceof Nq||d instanceof Nm||d instanceof Pm||d instanceof Oq||d instanceof Rm||d instanceof ah||d instanceof Pq||d instanceof Qm||d instanceof Jk||d instanceof iy||d instanceof hy||d instanceof gy||d instanceof jy||d instanceof ky||d instanceof ly||d instanceof zj||d instanceof ny||d instanceof my)&&e.transform.push(d.assemble()),(d instanceof Eh||d instanceof Ch||d instanceof Lk||d instanceof vi)&&e.transform.push(...d.assemble()),d instanceof Ve)&&(e.source&&0===e.transform.length?d.setSource(e.source):d.parent instanceof Ve?d.setSource(e.name):(e.name||(e.name="data_"+b++),d.setSource(e.name),1===d.numChildren())&&(a.push(e),e={name:null,source:e.name,transform:[]}));switch(d.numChildren()){case 0:d instanceof Ve&&(!e.source||e.transform.length>0)&&a.push(e);break;case 1:c(d.children[0],e);break;default:{e.name||(e.name="data_"+b++);let g=e.name;!e.source||e.transform.length>0?a.push(e):g=e.source;for(const h of d.children)c(h,{name:null,source:g,transform:[]});break}}}}}function EX(a){return"top"===a||"left"===a||tb(a)?"header":"footer"}function FX(a,b){var c;const{facet:d,config:e,child:f,component:g}=a;if(a.channelHasField(b)){const h=d[b],i=Gk("title",null,e,b);let j=rj(h,e,{allowDisabling:!0,includeDefault:void 0===i||!!i});f.component.layoutHeaders[b].title&&(j=U(j)?j.join(", "):j,j+=" / "+f.component.layoutHeaders[b].title,f.component.layoutHeaders[b].title=null);const k=Gk("labelOrient",h,e,b),l=Kd((null!==(c=h.header)&&void 0!==c?c:{}).labels,e.header.labels,!0),m=nb(["bottom","right"],k)?"footer":"header";g.layoutHeaders[b]={title:j,facetFieldDef:h,[m]:"facet"===b?[]:[VL(a,b,l)]}}}function VL(a,b,c){const d="row"===b?"height":"width";return{labels:c,sizeSignal:a.child.component.layoutSize.get(d)?a.child.getSizeSignalRef(d):void 0,axes:[]}}function WL(a,b){var c;const{child:d}=a;if(d.component.axes[b]){const{layoutHeaders:e,resolve:f}=a.component;if(f.axis[b]=Ux(f,b),"shared"===f.axis[b]){const g="x"===b?"column":"row",h=e[g];for(const i of d.component.axes[b]){const j=EX(i.get("orient"));h[j]=null!==(c=h[j])&&void 0!==c?c:[VL(a,g,!1)];const k=Om(i,"main",a.config,{header:!0});k&&h[j][0].axes.push(k),i.mainExtracted=!0}}}}function oy(a){for(const b of a.children)b.parseLayoutSize()}function Qq(a,b){const c=mL(b),d=bq(c),e=a.component.resolve,f=a.component.layoutSize;let g;for(const h of a.children){const i=h.component.layoutSize.getWithExplicit(c),j=e.scale[d];if("independent"===j&&"step"===i.value){g=void 0;break}if(g){if("independent"===j&&g.value!==i.value){g=void 0;break}g=si(g,i,c,"")}else g=i}if(g){for(const h of a.children)a.renameSignal(h.getName(c),a.getName(b)),h.component.layoutSize.set(c,"merged",!1);f.setWithExplicit(b,g)}else f.setWithExplicit(b,{explicit:!1,value:void 0})}function GX(a,b){const c="width"===b?"x":"y",d=a.config,e=a.getScaleComponent(c);if(e){const f=e.get("type"),g=e.get("range");if(pf(f)){const h=Im(d.view,b);return mi(g)||_g(h)?"step":h}return Ax(d.view,b)}if(a.hasProjection||"arc"===a.mark)return Ax(d.view,b);{const f=Im(d.view,b);return _g(f)?f.step:f}}function py(a,b,c){return Ka(b,Object.assign({suffix:"by_"+Ka(a)},null!=c?c:{}))}class Rq extends TL{constructor(a,b,c,d){super(a,"facet",b,c,d,a.resolve),this.child=ry(a.spec,this,this.getName("child"),void 0,d),this.children=[this.child],this.facet=this.initFacet(a.facet,d)}initFacet(a,b){return Em(a)?VJ(a,(c,d,e)=>nb([wh,xh],e)?void 0===d.field?(Ba(Pw(d,e)),c):(c[e]=ox(d,e,b),c):(Ba(fq(e,"facet")),c),{}):{facet:ox(a,"facet",b)}}channelHasField(a){return!!this.facet[a]}fieldDef(a){return this.facet[a]}parseData(){this.component.data=Sq(this),this.child.parseData()}parseLayoutSize(){oy(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(a){for(const b of Tf)FX(a,b);WL(a,"x"),WL(a,"y")}(this)}assembleSelectionTopLevelSignals(a){return this.child.assembleSelectionTopLevelSignals(a)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(a){return this.child.assembleSelectionData(a)}getHeaderLayoutMixins(){var a,b,c;const d={};for(const e of Tf)for(const f of Rx){const g=this.component.layoutHeaders[e],h=g[f],{facetFieldDef:i}=g;if(i){const j=Gk("titleOrient",i,this.config,e);if(nb(["right","bottom"],j)){const k=Gq(e,j);d.titleAnchor=null!==(a=d.titleAnchor)&&void 0!==a?a:{},d.titleAnchor[k]="end"}}if(null==h?void 0:h[0]){const j="row"===e?"height":"width",k="header"===f?"headerBand":"footerBand";"facet"===e||this.child.component.layoutSize.get(j)||(d[k]=null!==(b=d[k])&&void 0!==b?b:{},d[k][e]=.5),g.title&&(d.offset=null!==(c=d.offset)&&void 0!==c?c:{},d.offset["row"===e?"rowTitle":"columnTitle"]=10)}}return d}assembleDefaultLayout(){const{column:a,row:b}=this.facet,c=a?this.columnDistinctSignal():b?1:void 0;let d="all";return(b||"independent"!==this.component.resolve.scale.x)&&(a||"independent"!==this.component.resolve.scale.y)||(d="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),c?{columns:c}:{}),{bounds:"full",align:d})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Rq))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(a){return this.parent&&this.parent instanceof Rq?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ka(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(a)):super.assembleGroup(a)}getCardinalityAggregateForChild(){const a=[],b=[],c=[];if(this.child instanceof Rq){if(this.child.channelHasField("column")){const d=Ka(this.child.facet.column);a.push(d),b.push("distinct"),c.push("distinct_"+d)}}else for(const d of Uf){const e=this.child.component.scales[d];if(e&&!e.merged){const f=e.get("type"),g=e.get("range");if(pf(f)&&mi(g)){const h=cy(Mq(this.child,d));h?(a.push(h),b.push("distinct"),c.push("distinct_"+h)):Ba(`Unknown field for ${d}. Cannot calculate view size.`)}}}return{fields:a,ops:b,as:c}}assembleFacet(){const{name:a,data:b}=this.component.data.facetRoot,{row:c,column:d}=this.facet,{fields:e,ops:f,as:g}=this.getCardinalityAggregateForChild(),h=[];for(const j of Tf){const k=this.facet[j];if(k){h.push(Ka(k));const{bin:l,sort:m}=k;if(bd(l)&&h.push(Ka(k,{binSuffix:"end"})),Xg(m)){const{field:n,op:o=mq}=m,p=py(k,m);c&&d?(e.push(p),f.push("max"),g.push(p)):(e.push(n),f.push(o),g.push(p))}else if(U(m)){const n=Fk(k,j);e.push(n),f.push("max"),g.push(n)}}}const i=!!c&&!!d;return Object.assign({name:a,data:b,groupby:h},i||e.length>0?{aggregate:Object.assign(Object.assign({},i?{cross:i}:{}),e.length?{fields:e,ops:f,as:g}:{})}:{})}facetSortFields(a){const{facet:b}=this,c=b[a];return c?Xg(c.sort)?[py(c,c.sort,{expr:"datum"})]:U(c.sort)?[Fk(c,a,{expr:"datum"})]:[Ka(c,{expr:"datum"})]:[]}facetSortOrder(a){const{facet:b}=this,c=b[a];if(c){const{sort:d}=c;return[(Xg(d)?d.order:!U(d)&&d)||"ascending"]}return[]}assembleLabelTitle(){const{facet:a,config:b}=this;if(a.facet)return Sx(a.facet,"facet",b);const c={row:["top","bottom"],column:["left","right"]};for(const d of Qx)if(a[d]){const e=Gk("labelOrient",a[d],b,d);if(nb(c[d],e))return Sx(a[d],d,b)}}assembleMarks(){const{child:a}=this,b=function(f){const g=[],h=UL(g);for(const i of f.children)h(i,{source:f.name,name:null,transform:[]});return g}(this.component.data.facetRoot),c=a.assembleGroupEncodeEntry(!1),d=this.assembleLabelTitle()||a.assembleTitle(),e=a.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},d?{title:d}:{}),e?{style:e}:{}),{from:{facet:this.assembleFacet()},sort:{field:Tf.map(f=>this.facetSortFields(f)).flat(),order:Tf.map(f=>this.facetSortOrder(f)).flat()}}),b.length>0?{data:b}:{}),c?{encode:{update:c}}:{}),a.assembleGroup(function(f,g){if(f.component.selection&&Ea(f.component.selection).length){const h=Ga(f.getName("cell"));g.unshift({name:"facet",value:{},on:[{events:gj("mousemove","scope"),update:`isTuple(facet) ? facet : group(${h}).datum`}]})}return Lx(g)}(this,[])))]}getMapping(){return this.facet}}function XL(a,b){var c,d,e,f,g,h,i,j,k,l;for(const m of b){const n=m.data;if((!a.name||!m.hasName()||a.name===m.dataName)&&!((null===(c=a.format)||void 0===c?void 0:c.mesh)&&(null===(d=n.format)||void 0===d?void 0:d.feature)||((null===(e=a.format)||void 0===e?void 0:e.feature)||(null===(f=n.format)||void 0===f?void 0:f.feature))&&(null===(g=a.format)||void 0===g?void 0:g.feature)!==(null===(h=n.format)||void 0===h?void 0:h.feature)||((null===(i=a.format)||void 0===i?void 0:i.mesh)||(null===(j=n.format)||void 0===j?void 0:j.mesh))&&(null===(k=a.format)||void 0===k?void 0:k.mesh)!==(null===(l=n.format)||void 0===l?void 0:l.mesh))){if(zq(a)&&zq(n)){if(wm(a.values,n.values))return m}else if(Jm(a)&&Jm(n)){if(a.url===n.url)return m}else if(AK(a)&&a.name===m.dataName)return m}}return null}function HX(a,b){if(a.data||!a.parent){if(null===a.data){const d=new Hk({values:[]});return b.push(d),d}const c=XL(a.data,b);if(c)return wj(a.data)||(c.data.format=function(d,...e){for(const f of e)CU(d,null!=f?f:{});return d}({},a.data.format,c.data.format)),!c.hasName()&&a.data.name&&(c.dataName=a.data.name),c;{const d=new Hk(a.data);return b.push(d),d}}return a.parent.component.data.facetRoot?a.parent.component.data.facetRoot:a.parent.component.data.main}function Sq(a){var b,c,d,e,f,g,h,i,j,k;let l=HX(a,a.component.data.sources);const{outputNodes:m,outputNodeRefCounts:n}=a.component.data,o=a.parent?a.parent.component.data.ancestorParse.clone():new hW(),p=a.data;wj(p)?(BK(p)?l=new Kq(l,p.sequence):Fx(p)&&(l=new Jq(l,p.graticule)),o.parseNothing=!0):null===(null===(b=null==p?void 0:p.format)||void 0===b?void 0:b.parse)&&(o.parseNothing=!0),l=null!==(c=We.makeExplicit(l,a,o))&&void 0!==c?c:l,l=new zj(l);const q=a.parent&&Kk(a.parent);(Bd(a)||sg(a))&&q&&(l=null!==(d=Eh.makeFromEncoding(l,a))&&void 0!==d?d:l),a.transforms.length>0&&(l=function(A,B,I){var J,D;let O=0;for(const K of B.transforms){let Q,V;if(tW(K))Q=A=new Pm(A,K),V="derived";else if(DK(K)){const $=iX(K);Q=A=null!==(J=We.makeWithAncestors(A,{},$,I))&&void 0!==J?J:A,A=new Nm(A,B,K.filter)}else if(uW(K))Q=A=Eh.makeFromTransform(A,K,B),V="number";else if(wW(K))V="date",void 0===I.getWithExplicit(K.field).value&&(A=new We(A,{[K.field]:V}),I.set(K.field,V,!1)),Q=A=Ch.makeFromTransform(A,K);else if(xW(K))Q=A=ah.makeFromTransform(A,K),V="number",Mx(B)&&(A=new zj(A));else if(jW(K))Q=A=Pq.make(A,B,K,O++),V="derived";else if(qW(K))Q=A=new Qm(A,K),V="number";else if(rW(K))Q=A=new Jk(A,K),V="number";else if(yW(K))Q=A=vi.makeFromTransform(A,K),V="derived";else if(zW(K))Q=A=new iy(A,K),V="derived";else if(sW(K))Q=A=new hy(A,K),V="derived";else if(kW(K))Q=A=new my(A,K),V="derived";else if(pW(K))A=new ny(A,K);else if(vW(K))Q=A=Lk.makeFromTransform(A,K),V="derived";else if(lW(K))Q=A=new gy(A,K),V="derived";else if(mW(K))Q=A=new ky(A,K),V="derived";else if(nW(K))Q=A=new ly(A,K),V="derived";else{if(!oW(K)){Ba(bV(K));continue}Q=A=new jy(A,K),V="derived"}if(Q&&void 0!==V)for(const $ of null!==(D=Q.producedFields())&&void 0!==D?D:[])I.set($,V,!1)}return A}(l,a,o));const s=function(A){const B={};if(Bd(A)&&A.component.selection)for(const I of Ea(A.component.selection)){const J=A.component.selection[I];for(const D of J.project.items)!D.channel&&Am(D.field)>1&&(B[D.field]="flatten")}return B}(a),r=jX(a);l=null!==(e=We.makeWithAncestors(l,{},Object.assign(Object.assign({},s),r),o))&&void 0!==e?e:l,Bd(a)&&(l=Rm.parseAll(l,a),l=Oq.parseAll(l,a)),(Bd(a)||sg(a))&&(q||(l=null!==(f=Eh.makeFromEncoding(l,a))&&void 0!==f?f:l),l=null!==(g=Ch.makeFromEncoding(l,a))&&void 0!==g?g:l,l=Pm.parseAllForSortIndex(l,a));const u=a.getName("raw"),t=new Ve(l,u,"raw",n);if(m[u]=t,l=t,Bd(a)){const A=ah.makeFromEncoding(l,a);A&&(l=A,Mx(a)&&(l=new zj(l))),l=null!==(h=Lk.makeFromEncoding(l,a))&&void 0!==h?h:l,l=null!==(i=vi.makeFromEncoding(l,a))&&void 0!==i?i:l}Bd(a)&&(l=null!==(j=Nq.make(l,a))&&void 0!==j?j:l);const w=a.getName(ye),x=new Ve(l,w,ye,n);m[w]=x,l=x,Bd(a)&&function(A,B){yj(A,I=>{const J=I.name,D=A.getName("lookup_"+J);A.component.data.outputNodes[D]=I.materialized=new Ve(new Nm(B,A,{selection:J}),D,"lookup",A.component.data.outputNodeRefCounts)})}(a,x);let z=null;if(sg(a)){const A=a.getName("facet");l=null!==(k=function(B,I){const{row:J,column:D}=I;if(J&&D){let O=null;for(const K of[J,D])if(Xg(K.sort)){const{field:Q,op:V=mq}=K.sort;B=O=new Jk(B,{joinaggregate:[{op:V,field:Q,as:py(K,K.sort,{forAs:!0})}],groupby:[Ka(K)]})}return O}return null}(l,a.facet))&&void 0!==k?k:l,z=new Ik(l,a,A,x.getSource()),m[A]=z}return Object.assign(Object.assign({},a.component.data),{outputNodes:m,outputNodeRefCounts:n,raw:t,main:x,facetRoot:z,ancestorParse:o})}class IX extends fy{constructor(a,b,c,d){var e,f,g,h;super(a,"concat",b,c,d,a.resolve),"shared"!==(null===(f=null===(e=a.resolve)||void 0===e?void 0:e.axis)||void 0===f?void 0:f.x)&&"shared"!==(null===(h=null===(g=a.resolve)||void 0===g?void 0:g.axis)||void 0===h?void 0:h.y)||Ba("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(a).map((i,j)=>ry(i,this,this.getName("concat_"+j),void 0,d))}parseData(){this.component.data=Sq(this);for(const a of this.children)a.parseData()}parseSelections(){this.component.selection={};for(const a of this.children){a.parseSelections();for(const b of Ea(a.component.selection))this.component.selection[b]=a.component.selection[b]}}parseMarkGroup(){for(const a of this.children)a.parseMarkGroup()}parseAxesAndHeaders(){for(const a of this.children)a.parseAxesAndHeaders()}getChildren(a){return vq(a)?a.vconcat:zx(a)?a.hconcat:a.concat}parseLayoutSize(){!function(a){oy(a);const b=1===a.layout.columns?"width":"childWidth",c=void 0===a.layout.columns?"height":"childHeight";Qq(a,b),Qq(a,c)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(a){return this.children.reduce((b,c)=>c.assembleSelectionTopLevelSignals(b),a)}assembleSignals(){return this.children.forEach(a=>a.assembleSignals()),[]}assembleLayoutSignals(){const a=Tx(this);for(const b of this.children)a.push(...b.assembleLayoutSignals());return a}assembleSelectionData(a){return this.children.reduce((b,c)=>c.assembleSelectionData(b),a)}assembleMarks(){return this.children.map(a=>{const b=a.assembleTitle(),c=a.assembleGroupStyle(),d=a.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:a.getName("group")},b?{title:b}:{}),c?{style:c}:{}),d?{encode:{update:d}}:{}),a.assembleGroup())})}assembleDefaultLayout(){const a=this.layout.columns;return Object.assign(Object.assign({},null!=a?{columns:a}:{}),{bounds:"full",align:"each"})}}const JX=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},lI),{labelExpr:1,encode:1}),YL=Ea(JX);class ZL extends ri{constructor(a={},b={},c=!1){super(),this.explicit=a,this.implicit=b,this.mainExtracted=c}clone(){return new ZL(ac(this.explicit),ac(this.implicit),this.mainExtracted)}hasAxisPart(a){return"axis"===a||("grid"===a||"title"===a?!!this.get(a):!(!1===(b=this.get(a))||null===b));var b}hasOrientSignalRef(){return tb(this.explicit.orient)}}const KX={bottom:"top",top:"bottom",left:"right",right:"left"};function LX(a,b){if(!a)return b.map(c=>c.clone());{if(a.length!==b.length)return;const c=a.length;for(let d=0;d<c;d++){const e=a[d],f=b[d];if(!!e!=!!f)return;if(e&&f){const g=e.getWithExplicit("orient"),h=f.getWithExplicit("orient");if(g.explicit&&h.explicit&&g.value!==h.value)return;a[d]=MX(e,f)}}}return a}function MX(a,b){for(const c of YL){const d=si(a.getWithExplicit(c),b.getWithExplicit(c),c,"axis",(e,f)=>{switch(c){case"title":return UJ(e,f);case"gridScale":return{explicit:e.explicit,value:Kd(e.value,f.value)}}return yq(e,f,c,"axis")});a.setWithExplicit(c,d)}return a}function NX(a,b,c,d,e){if("disable"===b)return void 0!==c;switch(c=c||{},b){case"titleAngle":case"labelAngle":return a===(tb(c.labelAngle)?c.labelAngle:Wp(c.labelAngle));case"values":return!!c.values;case"encode":return!!c.encoding||!!c.labelAngle;case"title":if(a===gL(d,e))return!0}return a===c[b]}const OX=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function PX(a,b){var c,d,e;let f=b.axis(a);const g=new ZL(),h=Sd(b.encoding[a]),{mark:i,config:j}=b,k=(null==f?void 0:f.orient)||(null===(c=j["x"===a?"axisX":"axisY"])||void 0===c?void 0:c.orient)||(null===(d=j.axis)||void 0===d?void 0:d.orient)||function(r){return"x"===r?"bottom":"left"}(a),l=b.getScaleComponent(a).get("type"),m=RW(a,l,k,b.config),n=void 0!==f?!f:Ox("disable",j,null==f?void 0:f.style,m).configValue;if(g.set("disable",n,void 0!==f),n)return g;f=f||{};const o=function(r,u,t,w,x){const z=null==u?void 0:u.labelAngle;if(void 0!==z)return tb(z)?z:Wp(z);{const{configValue:A}=Ox("labelAngle",r.config,null==u?void 0:u.style,x);return void 0!==A?Wp(A):"x"===t&&nb([$w,_w],w.type)?270:void 0}}(b,f,a,h,m),p={fieldOrDatumDef:h,axis:f,channel:a,model:b,scaleType:l,orient:k,labelAngle:o,mark:i,config:j};for(const r of YL){const u=r in dL?dL[r](p):mI(r)?f[r]:void 0,t=void 0!==u,w=NX(u,r,f,b,a);if(t&&w)g.set(r,u,w);else{const{configValue:x,configFrom:z}=mI(r)&&"values"!==r?Ox(r,b.config,f.style,m):{},A=void 0!==x;t&&!A?g.set(r,u,w):("vgAxisConfig"!==z||OX.has(r)&&A||Fw(x)||tb(x))&&g.set(r,x,!1)}}const q=null!==(e=f.encoding)&&void 0!==e?e:{},s=kI.reduce((r,u)=>{var t;if(!g.hasAxisPart(u))return r;const w=nL(null!==(t=q[u])&&void 0!==t?t:{},b),x="labels"===u?function(z,A,B){var I;const{encoding:J,config:D}=z,O=null!==(I=Sd(J[A]))&&void 0!==I?I:Sd(J[Tg(A)]),K=z.axis(A)||{},{format:Q,formatType:V}=K;return qj(V)?Object.assign({text:fx({fieldOrDatumDef:O,field:"datum.value",format:Q,formatType:V,config:D})},B):B}(b,a,w):w;return void 0===x||_c(x)||(r[u]={update:x}),r},{});return _c(s)||g.set("encode",s,!!f.encoding||void 0!==f.labelAngle),g}function QX(a,b,c,{graticule:d}){const e=Pg(a)?Object.assign({},a):{type:a},f=Hc("orient",e,c);if(e.orient=function(g,h,i){switch(g){case _p:case Hw:case Iw:case oI:case IU:case HU:return}const{x:j,y:k,x2:l,y2:m}=h;switch(g){case Yp:if(Qa(j)&&(Te(j.bin)||Qa(k)&&k.aggregate&&!j.aggregate))return"vertical";if(Qa(k)&&(Te(k.bin)||Qa(j)&&j.aggregate&&!k.aggregate))return"horizontal";if(m||l){if(i)return i;if(!l&&(Qa(j)&&j.type===oj&&!bd(j.bin)||kx(j)))return"horizontal";if(!m&&(Qa(k)&&k.type===oj&&!bd(k.bin)||kx(k)))return"vertical"}case $p:if(l&&(!Qa(j)||!Te(j.bin))&&m&&(!Qa(k)||!Te(k.bin)))return;case Xp:if(m)return Qa(k)&&Te(k.bin)?"horizontal":"vertical";if(l)return Qa(j)&&Te(j.bin)?"vertical":"horizontal";if(g===$p){if(j&&!k)return"vertical";if(k&&!j)return"horizontal"}case Zp:case Gw:{const n=Yg(j),o=Yg(k);if(n&&!o)return"tick"!==g?"horizontal":"vertical";if(!n&&o)return"tick"!==g?"vertical":"horizontal";if(n&&o){const p=j,q=k,s=p.type===Ck,r=q.type===Ck;return s&&!r?"tick"!==g?"vertical":"horizontal":!s&&r?"tick"!==g?"horizontal":"vertical":!p.aggregate&&q.aggregate?"tick"!==g?"vertical":"horizontal":p.aggregate&&!q.aggregate?"tick"!==g?"horizontal":"vertical":i||"vertical"}return i||void 0}}return"vertical"}(e.type,b,f),void 0!==f&&f!==e.orient&&Ba(`Specified orient "${e.orient}" overridden with "${f}".`),"bar"===e.type&&e.orient){const g=Hc("cornerRadiusEnd",e,c);if(void 0!==g){const h="horizontal"===e.orient&&b.x2||"vertical"===e.orient&&b.y2?["cornerRadius"]:LU[e.orient];for(const i of h)e[i]=g;void 0!==e.cornerRadiusEnd&&delete e.cornerRadiusEnd}}return void 0===Hc("opacity",e,c)&&(e.opacity=function(g,h){return nb([_p,Gw,Hw,Iw],g)&&!qx(h)?.7:void 0}(e.type,b)),void 0===e.filled&&(e.filled=!d&&function(g,h){const i=tj("filled",g,h),j=g.type;return Kd(i,j!==_p&&j!==Zp&&j!==$p)}(e,c)),void 0===Hc("cursor",e,c)&&(e.cursor=function(g,h,i){return h.href||g.href||Hc("href",g,i)?"pointer":g.cursor}(e,b,c)),e}function qy(a,b){const{config:c}=a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ze("x",a,{defaultPos:"mid"})),ze("y",a,{defaultPos:"mid"})),$d("size",a)),$d("angle",a)),function(d,e,f){return f?{shape:{value:f}}:$d("shape",d)}(a,0,b))}function RX(a){var b;const{config:c,markDef:d}=a,{orient:e}=d,f="horizontal"===e?"width":"height",g=a.getScaleComponent("horizontal"===e?"x":"y"),h=null!==(b=Hc("size",d,c,{vgChannel:f}))&&void 0!==b?b:c.tick.bandSize;if(void 0!==h)return h;{const i=g?g.get("range"):void 0;return i&&mi(i)&&Yc(i.step)?3*i.step/4:3*wq(c.view,f)/4}}const Tq={arc:{vgMark:"arc",encodeEntry:a=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ze("x",a,{defaultPos:"mid"})),ze("y",a,{defaultPos:"mid"})),ti(a,"radius","arc")),ti(a,"theta","arc"))},area:{vgMark:"area",encodeEntry:a=>Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Cq("x",a,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===a.markDef.orient})),Cq("y",a,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===a.markDef.orient})),Ix(a))},bar:{vgMark:"rect",encodeEntry:a=>Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ti(a,"x","bar")),ti(a,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:a=>qy(a,"circle")},geoshape:{vgMark:"shape",encodeEntry:a=>Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:a=>{const{encoding:b}=a,c=b.shape;return[Object.assign({type:"geoshape",projection:a.projectionName()},c&&Qa(c)&&c.type===Dk?{field:Ka(c,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:a=>Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),ti(a,"x","image")),ti(a,"y","image")),Gx(a,"url"))},line:{vgMark:"line",encodeEntry:a=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ze("x",a,{defaultPos:"mid"})),ze("y",a,{defaultPos:"mid"})),$d("size",a,{vgChannel:"strokeWidth"})),Ix(a))},point:{vgMark:"symbol",encodeEntry:a=>qy(a)},rect:{vgMark:"rect",encodeEntry:a=>Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ti(a,"x","rect")),ti(a,"y","rect"))},rule:{vgMark:"rule",encodeEntry:a=>{const{markDef:b}=a,c=b.orient;return a.encoding.x||a.encoding.y||a.encoding.latitude||a.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Cq("x",a,{defaultPos:"horizontal"===c?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==c})),Cq("y",a,{defaultPos:"vertical"===c?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==c})),$d("size",a,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:a=>qy(a,"square")},text:{vgMark:"text",encodeEntry:a=>{const{config:b,encoding:c}=a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ze("x",a,{defaultPos:"mid"})),ze("y",a,{defaultPos:"mid"})),Gx(a)),$d("size",a,{vgChannel:"fontSize"})),$d("angle",a)),MK("align",function(d,e,f){return void 0===Hc("align",d,f)?"center":void 0}(a.markDef,0,b))),MK("baseline",function(d,e,f){return void 0===Hc("baseline",d,f)?"middle":void 0}(a.markDef,0,b))),ze("radius",a,{defaultPos:null,isMidPoint:!0})),ze("theta",a,{defaultPos:null,isMidPoint:!0}))}},tick:{vgMark:"rect",encodeEntry:a=>{const{config:b,markDef:c}=a,d=c.orient,e="horizontal"===d?"width":"height",f="horizontal"===d?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ze("x",a,{defaultPos:"mid",vgChannel:"xc"})),ze("y",a,{defaultPos:"mid",vgChannel:"yc"})),$d("size",a,{defaultValue:RX(a),vgChannel:e})),{[f]:Fd(Hc("thickness",c,b))})}},trail:{vgMark:"trail",encodeEntry:a=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wf(a,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ze("x",a,{defaultPos:"mid"})),ze("y",a,{defaultPos:"mid"})),$d("size",a)),Ix(a))}};function SX(a){return nb([Zp,Xp,JU],a.mark)?function(b){const c=WJ(b.mark,b.encoding),d=Uq(b,{fromPrefix:c.length>0?"faceted_path_":""});return c.length>0?[{name:b.getName("pathgroup"),type:"group",from:{facet:{name:"faceted_path_"+b.requestDataName(ye),data:b.requestDataName(ye),groupby:c}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:d}]:d}(a):nb([Yp],a.mark)?function(b){const c=Vw.some(d=>Hc(d,b.markDef,b.config));if(b.stack&&!b.fieldDef("size")&&c){const[d]=Uq(b,{fromPrefix:"stack_group_"}),e=b.scaleName(b.stack.fieldChannel),f=(l={})=>b.vgField(b.stack.fieldChannel,l),g=(l,m)=>`${l}(${[f({prefix:"min",suffix:"start",expr:m}),f({prefix:"max",suffix:"start",expr:m}),f({prefix:"min",suffix:"end",expr:m}),f({prefix:"max",suffix:"end",expr:m})].map(n=>`scale('${e}',${n})`).join(",")})`;let h,i;"x"===b.stack.fieldChannel?(h=Object.assign(Object.assign({},xm(d.encode.update,["y","yc","y2","height",...Vw])),{x:{signal:g("min","datum")},x2:{signal:g("max","datum")},clip:{value:!0}}),i={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},d.encode.update=Object.assign(Object.assign({},uh(d.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(h=Object.assign(Object.assign({},xm(d.encode.update,["x","xc","x2","width"])),{y:{signal:g("min","datum")},y2:{signal:g("max","datum")},clip:{value:!0}}),i={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},d.encode.update=Object.assign(Object.assign({},uh(d.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of Vw){const m=tj(l,b.markDef,b.config);d.encode.update[l]?(h[l]=d.encode.update[l],delete d.encode.update[l]):m&&(h[l]=Fd(m)),m&&(d.encode.update[l]={value:0})}const j=b.fieldDef(b.stack.groupbyChannel),k=Ka(j)?[Ka(j)]:[];return((null==j?void 0:j.bin)||(null==j?void 0:j.timeUnit))&&k.push(Ka(j,{binSuffix:"end"})),h=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,m)=>{if(d.encode.update[m])return Object.assign(Object.assign({},l),{[m]:d.encode.update[m]});{const n=tj(m,b.markDef,b.config);return void 0!==n?Object.assign(Object.assign({},l),{[m]:Fd(n)}):l}},h),h.stroke&&(h.strokeForeground={value:!0},h.strokeOffset={value:0}),[{type:"group",from:{facet:{data:b.requestDataName(ye),name:"stack_group_"+b.requestDataName(ye),groupby:k,aggregate:{fields:[f({suffix:"start"}),f({suffix:"start"}),f({suffix:"end"}),f({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:h},marks:[{type:"group",encode:{update:i},marks:[d]}]}]}return Uq(b)}(a):Uq(a)}function Uq(a,b={fromPrefix:""}){const{mark:c,markDef:d,config:e}=a,f=Kd(d.clip,function(m){const n=m.getScaleComponent("x"),o=m.getScaleComponent("y");return!!(n&&n.get("selectionExtent")||o&&o.get("selectionExtent"))||void 0}(a),function(m){const n=m.component.projection;return!(!n||n.isFit)||void 0}(a)),g=PJ(d),h=a.encoding.key,i=function(m){const{encoding:n,stack:o,mark:p,markDef:q,config:s}=m,r=n.order;if(!(!U(r)&&Ah(r)&&bI(r.value)||!r&&bI(Hc("order",q,s)))){if((U(r)||Qa(r))&&!o)return RJ(r,{expr:"datum"});if(lj(p)){const u="horizontal"===q.orient?"y":"x",t=n[u];if(Qa(t)){const w=t.sort;return U(w)?{field:Ka(t,{prefix:u,suffix:"sort_index",expr:"datum"})}:Xg(w)?{field:Ka({aggregate:qx(m.encoding)?w.op:void 0,field:w.field},{expr:"datum"})}:zJ(w)?{field:Ka(m.fieldDef(w.encoding),{expr:"datum"}),order:w.order}:null===w?void 0:{field:Ka(t,{binSuffix:m.stack&&m.stack.impute?"mid":void 0,expr:"datum"})}}}}}(a),j=function(m){if(!m.component.selection)return null;const n=Ea(m.component.selection).length;let o=n,p=m.parent;for(;p&&0===o;)o=Ea(p.component.selection).length,p=p.parent;return o?{interactive:n>0}:null}(a),k=Hc("aria",d,e),l=Tq[c].postEncodingTransform?Tq[c].postEncodingTransform(a):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a.getName("marks"),type:Tq[c].vgMark},f?{clip:!0}:{}),g?{style:g}:{}),h?{key:h.field}:{}),i?{sort:i}:{}),j||{}),!1===k?{aria:k}:{}),{from:{data:b.fromPrefix+a.requestDataName(ye)},encode:{update:Tq[c].encodeEntry(a)}}),l?{transform:l}:{})]}class _L extends TL{constructor(a,b,c,d={},e){var f,g;super(a,"unit",b,c,e,void 0,iK(a)?a.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const h=Pg(a.mark)?a.mark.type:a.mark;this.markDef=QX(a.mark,null!==(f=a.encoding)&&void 0!==f?f:{},e,{graticule:a.data&&Fx(a.data)});const i=this.encoding=IV(null!==(g=a.encoding)&&void 0!==g?g:{},this.markDef,e);this.size=function({encoding:j,size:k}){for(const l of Uf){const m=Ug(l);_g(k[m])&&Yg(j[l])&&(delete k[m],Ba(RI(m)))}return k}({encoding:i,size:iK(a)?Object.assign(Object.assign(Object.assign({},d),a.width?{width:a.width}:{}),a.height?{height:a.height}:{}):d}),this.stack=oK(h,i),this.specifiedScales=this.initScales(h,i),this.specifiedAxes=this.initAxes(i),this.specifiedLegends=this.initLegend(i),this.specifiedProjection=a.projection,this.selection=a.selection}get hasProjection(){const{encoding:a}=this,b=this.mark===pI,c=a&&TU.some(d=>Cb(a[d]));return b||c}scaleDomain(a){const b=this.specifiedScales[a];return b?b.domain:void 0}axis(a){return this.specifiedAxes[a]}legend(a){return this.specifiedLegends[a]}initScales(a,b){return cq.reduce((c,d)=>{var e;const f=Sd(b[d]);return f&&(c[d]=null!==(e=f.scale)&&void 0!==e?e:{}),c},{})}initAxes(a){return Uf.reduce((b,c)=>{const d=a[c];if(Cb(d)||"x"===c&&Cb(a.x2)||"y"===c&&Cb(a.y2)){const e=Cb(d)?d.axis:void 0;b[c]=e?Object.assign({},e):e}return b},{})}initLegend(a){return ZU.reduce((b,c)=>{const d=Sd(a[c]);if(d&&function(e){switch(e){case nf:case Rg:case Sg:case zh:case of:case"opacity":case"strokeWidth":case"strokeDash":return!0;case"fillOpacity":case"strokeOpacity":case"angle":return!1}}(c)){const e=d.legend;b[c]=e?Object.assign({},e):e}return b},{})}parseData(){this.component.data=Sq(this)}parseLayoutSize(){!function(a){const{size:b,component:c}=a;for(const d of Uf){const e=Ug(d);if(b[e]){const f=b[e];c.layoutSize.set(e,_g(f)?"step":f,!0)}else{const f=GX(a,e);c.layoutSize.set(e,f,!1)}}}(this)}parseSelections(){this.component.selection=function(a,b){var c;const d={},e=a.config.selection;for(const f of Ea(null!=b?b:{})){const g=ac(b[f]),h=Fa(e[g.type],["fields","encodings"]);for(const k in h)"encodings"===k&&g.fields||"fields"===k&&g.encodings||("mark"===k&&(g[k]=Object.assign(Object.assign({},h[k]),g[k])),void 0!==g[k]&&!0!==g[k]||(g[k]=null!==(c=h[k])&&void 0!==c?c:g[k]));const i=ld(f),j=d[i]=Object.assign(Object.assign({},g),{name:i,events:Xa(g.on)?gj(g.on,"scope"):ac(g.on)});Eq(j,k=>{k.has(j)&&k.parse&&k.parse(a,j,g,b[f])})}return d}(this,this.selection)}parseMarkGroup(){this.component.mark=SX(this)}parseAxesAndHeaders(){var a;this.component.axes=(a=this,Uf.reduce((b,c)=>(a.component.scales[c]&&(b[c]=[PX(c,a)]),b),{}))}assembleSelectionTopLevelSignals(a){return function(b,c){let d=!1;return(yj(b,(e,f)=>{const g=e.name,h=Ga(g+xj);if(0===c.filter(i=>i.name===g).length){const i="global"===e.resolve?"union":e.resolve,j="multi"===e.type?", true)":")";c.push({name:e.name,update:`${XK}(${h}, ${Ga(i)}${j}`})}d=!0,f.topLevelSignals&&(c=f.topLevelSignals(b,e,c)),Eq(e,i=>{i.topLevelSignals&&(c=i.topLevelSignals(b,e,c))})}),d)&&(0===c.filter(e=>"unit"===e.name).length&&c.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),Lx(c)}(this,a)}assembleSignals(){return[...$K(this),...(a=this,b=[],yj(a,(c,d)=>{const e=c.name;let f=d.modifyExpr(a,c);b.push(...d.signals(a,c)),Eq(c,g=>{g.signals&&(b=g.signals(a,c,b)),g.modifyExpr&&(f=g.modifyExpr(a,c,f))}),b.push({name:e+NW,on:[{events:{signal:c.name+$g},update:`modify(${Ga(c.name+xj)}, ${f})`}]})}),Lx(b))];var a,b}assembleSelectionData(a){return function(b,c){const d=[...c];return yj(b,e=>{const f={name:e.name+xj};if(e.init){const g=e.project.items.map(i=>Fa(i,["signals"])),h=e.init.map(i=>Ek(i,!1));f.values="interval"===e.type?[{unit:Dh(b,{escape:!1}),fields:g,values:h}]:h.map(i=>({unit:Dh(b,{escape:!1}),fields:g,values:i}))}d.filter(g=>g.name===e.name+xj).length||d.push(f)}),d}(this,a)}assembleLayout(){return null}assembleLayoutSignals(){return Tx(this)}assembleMarks(){var a;let b=null!==(a=this.component.mark)&&void 0!==a?a:[];return this.parent&&Kk(this.parent)||(b=UK(this,b)),b.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(a){return uj(this.encoding,a)}fieldDef(a){return Zg(this.encoding[a])}typedFieldDef(a){const b=this.fieldDef(a);return Bf(b)?b:null}}class $L extends fy{constructor(a,b,c,d,e){super(a,"layer",b,c,e,a.resolve,a.view);const f=Object.assign(Object.assign(Object.assign({},d),a.width?{width:a.width}:{}),a.height?{height:a.height}:{});this.children=a.layer.map((g,h)=>{if(xq(g))return new $L(g,this,this.getName("layer_"+h),f,e);if(vh(g))return new _L(g,this,this.getName("layer_"+h),f,e);throw new Error(Ow(g))})}parseData(){this.component.data=Sq(this);for(const a of this.children)a.parseData()}parseLayoutSize(){var a;oy(a=this),Qq(a,"width"),Qq(a,"height")}parseSelections(){this.component.selection={};for(const a of this.children){a.parseSelections();for(const b of Ea(a.component.selection))this.component.selection[b]=a.component.selection[b]}}parseMarkGroup(){for(const a of this.children)a.parseMarkGroup()}parseAxesAndHeaders(){!function(a){var b;const{axes:c,resolve:d}=a.component,e={top:0,bottom:0,right:0,left:0};for(const f of a.children){f.parseAxesAndHeaders();for(const g of Ea(f.component.axes))d.axis[g]=Ux(a.component.resolve,g),"shared"===d.axis[g]&&(c[g]=LX(c[g],f.component.axes[g]),c[g]||(d.axis[g]="independent",delete c[g]))}for(const f of Uf){for(const g of a.children)if(g.component.axes[f]){if("independent"===d.axis[f]){c[f]=(null!==(b=c[f])&&void 0!==b?b:[]).concat(g.component.axes[f]);for(const h of g.component.axes[f]){const{value:i,explicit:j}=h.getWithExplicit("orient");if(!tb(i)){if(e[i]>0&&!j){const k=KX[i];e[i]>e[k]&&h.set("orient",k,!1)}e[i]++}}}delete g.component.axes[f]}if("independent"===d.axis[f]&&c[f]&&c[f].length>1)for(const g of c[f])g.get("grid")&&!g.explicit.grid&&(g.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(a){return this.children.reduce((b,c)=>c.assembleSelectionTopLevelSignals(b),a)}assembleSignals(){return this.children.reduce((a,b)=>a.concat(b.assembleSignals()),$K(this))}assembleLayoutSignals(){return this.children.reduce((a,b)=>a.concat(b.assembleLayoutSignals()),Tx(this))}assembleSelectionData(a){return this.children.reduce((b,c)=>c.assembleSelectionData(b),a)}assembleTitle(){let a=super.assembleTitle();if(a)return a;for(const b of this.children)if(a=b.assembleTitle(),a)return a}assembleLayout(){return null}assembleMarks(){return function(a,b){for(const c of a.children)Bd(c)&&(b=UK(c,b));return b}(this,this.children.flatMap(a=>a.assembleMarks()))}assembleLegends(){return this.children.reduce((a,b)=>a.concat(b.assembleLegends()),yL(this))}}function ry(a,b,c,d,e){if(nq(a))return new Rq(a,b,c,e);if(xq(a))return new $L(a,b,c,d,e);if(vh(a))return new _L(a,b,c,d,e);if(function(f){return vq(f)||zx(f)||yx(f)}(a))return new IX(a,b,c,e);throw new Error(Ow(a))}const TX=new class extends mK{mapUnit(a,{config:b}){if(a.encoding){const{encoding:c,transform:d}=a,{bins:e,timeUnits:f,aggregate:g,groupby:h,encoding:i}=rx(c,b),j=[...d||[],...e,...f,...0===g.length?[]:[{aggregate:g,groupby:h}]];return Object.assign(Object.assign(Object.assign({},a),j.length>0?{transform:j}:{}),{encoding:i})}return a}}(),UX=AU;var VX=Object.freeze({__proto__:null,normalize:wK,version:UX,compile:function(a,b={}){var c;b.logger&&(c=b.logger,hq=c),b.fieldTitle&&JJ(b.fieldTitle);try{const d=lK(Wa(b.config,a.config)),e=wK(a,d),f=ry(e,null,"",void 0,d);return f.parse(),function(g,h){Xx(g.sources);let i=0,j=0;for(let k=0;k<5&&GL(g,h);k++)i++;g.sources.map(Zx);for(let k=0;k<5&&GL(g,h);k++)j++;Xx(g.sources),5===Math.max(i,j)&&Ba("Maximum optimization runs(5) reached.")}(f.component.data,f),{spec:function(g,h,i={},j){const k=g.config?WV(g.config):void 0,l=[].concat(g.assembleSelectionData([]),function(s,r){var u,t;const w=[],x=UL(w);let z=0;for(const B of s.sources){B.hasName()||(B.dataName="source_"+z++);const I=B.assemble();x(B,I)}for(const B of w)0===B.transform.length&&delete B.transform;let A=0;for(const[B,I]of w.entries())0!==(null!==(u=I.transform)&&void 0!==u?u:[]).length||I.source||w.splice(A++,0,w.splice(B,1)[0]);for(const B of w)for(const I of null!==(t=B.transform)&&void 0!==t?t:[])"lookup"===I.type&&(I.from=s.outputNodes[I.from].getSource());for(const B of w)B.name in r&&(B.values=r[B.name]);return w}(g.component.data,i)),m=g.assembleProjections(),n=g.assembleTitle(),o=g.assembleGroupStyle(),p=g.assembleGroupEncodeEntry(!0);let q=g.assembleLayoutSignals();return q=q.filter(s=>"width"!==s.name&&"height"!==s.name||void 0===s.value||(h[s.name]=+s.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},g.description?{description:g.description}:{}),h),n?{title:n}:{}),o?{style:o}:{}),p?{encode:{update:p}}:{}),{data:l}),m.length>0?{projections:m}:{}),g.assembleGroup([...q,...g.assembleSelectionTopLevelSignals([])])),k?{config:k}:{}),j?{usermeta:j}:{})}(f,function(g,h,i,j){const k=j.component.layoutSize.get("width"),l=j.component.layoutSize.get("height");void 0===h?(h={type:"pad"},j.hasAxisOrientSignalRef()&&(h.resize=!0)):Xa(h)&&(h={type:h});if(k&&l&&(m=h.type,"fit"===m||"fit-x"===m||"fit-y"===m)){if("step"===k&&"step"===l)Ba(II()),h.type="pad";else if("step"===k||"step"===l){const n="step"===k?"width":"height";Ba(II(bq(n)));const o="width"===n?"height":"width";h.type=function(p){return p?"fit-"+bq(p):"fit"}(o)}}var m;return Object.assign(Object.assign(Object.assign({},1===Ea(h).length&&h.type?"pad"===h.type?{}:{autosize:h.type}:{autosize:h}),yK(i)),yK(g))}(a,e.autosize,d,f),a.datasets,a.usermeta),normalized:e}}finally{b.logger&&(hq=VI),b.fieldTitle&&JJ(HJ)}},extractTransforms:function(a,b){return TX.map(a,{config:b})}}),aM=Object(v.a)(function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(c){var d=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(c).slice(1,3);return{library:d[0],version:d[1]}}});const WX={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},XX={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},YX={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},bar:{binSpacing:2,fill:"#30a2da",stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ZX={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},sy="Benton Gothic Bold, sans-serif",Sm={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},_X={background:"#ffffff",title:{anchor:"start",color:"#000000",font:sy,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:sy,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:sy,titleFontSize:13,titleFontWeight:"normal"},range:{category:Sm["category-6"],diverging:Sm["fireandice-6"],heatmap:Sm["fire-7"],ordinal:Sm["fire-7"],ramp:Sm["fire-7"]}},$X={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},aY={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Tm={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},bY={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Tm["six-groups-cat-1"],diverging:Tm["diverging-colors"],heatmap:Tm["diverging-colors"],ordinal:Tm["six-groups-seq"],ramp:Tm["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:null}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}},cY={arc:{fill:"#3366CC"},area:{fill:"#3366CC"},path:{stroke:"#3366CC"},rect:{fill:"#3366CC"},shape:{stroke:"#3366CC"},symbol:{stroke:"#3366CC"},circle:{fill:"#3366CC"},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:"Arial, sans-serif",fontSize:12},"guide-title":{font:"Arial, sans-serif",fontSize:12},"group-title":{font:"Arial, sans-serif",fontSize:12}},title:{font:"Arial, sans-serif",fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},dY="2.8.3";var eY=Object.freeze({__proto__:null,version:dY,dark:WX,excel:XX,fivethirtyeight:YX,ggplot2:ZX,latimes:_X,quartz:$X,vox:aY,urbaninstitute:bY,googlecharts:cY}),fY=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const bM="vg-tooltip-element",gY={offsetX:10,offsetY:10,id:bM,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};var hY=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(d=Object.getOwnPropertySymbols(a);e<d.length;e++)b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]])}return c};function cM(a,b){return JSON.stringify(a,function(c){const d=[];return function(e,f){if("object"!=typeof f||null===f)return f;const g=d.indexOf(this)+1;return d.length=g,d.length>c?"[Object]":d.indexOf(f)>=0?"[Circular]":(d.push(f),f)}}(b))}class iY{constructor(a){this.options=Object.assign(Object.assign({},gY),a);const b=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const c=document.createElement("style");c.setAttribute("id",this.options.styleId),c.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return fY.toString().replace(bM,e)}(b);const d=document.head;d.childNodes.length>0?d.insertBefore(c,d.childNodes[0]):d.appendChild(c)}this.el=document.getElementById(b),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",b),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(a,b,c,d){if(null==d||""===d)return void this.el.classList.remove("visible",this.options.theme+"-theme");this.el.innerHTML=function(g,h,i){if(U(g))return`[${g.map(j=>h(Xa(j)?j:cM(j,i))).join(", ")}]`;if(ka(g)){let j="";const k=g,{title:l,image:m}=k,n=hY(k,["title","image"]);l&&(j+=`<h2>${h(l)}</h2>`),m&&(j+=`<img src="${h(m)}">`);const o=Object.keys(n);if(o.length>0){j+="<table>";for(const p of o){let q=n[p];void 0!==q&&(ka(q)&&(q=cM(q,i)),j+=`<tr><td class="key">${h(p)}:</td><td class="value">${h(q)}</td></tr>`)}j+="</table>"}return j||"{}"}return h(g)}(d,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",this.options.theme+"-theme");const{x:e,y:f}=function(g,h,i,j){let k=g.clientX+i;k+h.width>window.innerWidth&&(k=+g.clientX-i-h.width);let l=g.clientY+j;return l+h.height>window.innerHeight&&(l=+g.clientY-j-h.height),{x:k,y:l}}(b,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${f}px; left: ${e}px`)}}var ty,jY=`.vega-embed {
  position: relative;
  display: inline-block; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: scroll;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;function dM(a,...b){for(const c of b)kY(a,c);return a}function kY(a,b){for(const c of Object.keys(b))mc(a,c,b[c],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(!b||b<0?0:+b,a.length)===a});const Aj=zU;let Um=VX;const uy="undefined"!=typeof window?window:void 0;void 0===Um&&(null===(ty=null==uy?void 0:uy.vl)||void 0===ty?void 0:ty.compile)&&(Um=uy.vl);const lY={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},mY={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Vm={vega:"Vega","vega-lite":"Vega-Lite"},Vq={vega:Aj.version,"vega-lite":Um?Um.version:"not available"},nY={vega:a=>a,"vega-lite":(a,b)=>Um.compile(a,{config:b}).spec};function eM(a,b,c,d){const e=`<html><head>${b}</head><body><pre><code class="json">`,f=`</code></pre>${c}</body></html>`,g=window.open("");g.document.write(e+a+f),g.document.title=Vm[d]+" JSON Source"}function fM(a,b){var c;return bc(this,void 0,void 0,function*(){const d=Xa(a.config)?JSON.parse(yield b.load(a.config)):null!==(c=a.config)&&void 0!==c?c:{},e=Xa(a.patch)?JSON.parse(yield b.load(a.patch)):a.patch;return Object.assign(Object.assign(Object.assign({},a),e?{patch:e}:{}),d?{config:d}:{})})}_a.a=function(a,b,c={}){var d,e,f;return bc(this,void 0,void 0,function*(){const g=(h=c.loader)&&"load"in h?c.loader:Aj.loader(c.loader);var h;const i=Xa(b)?JSON.parse(yield g.load(b)):b,j=yield fM(null!==(d=i.usermeta&&i.usermeta.embedOptions)&&void 0!==d?d:{},g),k=yield fM(c,g),l=Object.assign(Object.assign({},dM(k,j)),{config:Wa(null!==(e=k.config)&&void 0!==e?e:{},null!==(f=j.config)&&void 0!==f?f:{})});return yield function(m,n,o={},p){var q,s,r,u,t,w;return bc(this,void 0,void 0,function*(){const x=o.theme?Wa(eY[o.theme],null!==(q=o.config)&&void 0!==q?q:{}):o.config,z=Bi(o.actions)?o.actions:dM({},lY,null!==(s=o.actions)&&void 0!==s?s:{}),A=Object.assign(Object.assign({},mY),o.i18n),B=null!==(r=o.renderer)&&void 0!==r?r:"canvas",I=null!==(u=o.logLevel)&&void 0!==u?u:Aj.Warn,J=null!==(t=o.downloadFileName)&&void 0!==t?t:"visualization";if(!1!==o.defaultStyle){const xa="vega-embed-style";if(!document.getElementById(xa)){const oa=document.createElement("style");oa.id=xa,oa.innerText=void 0===o.defaultStyle||!0===o.defaultStyle?jY.toString():o.defaultStyle,document.head.appendChild(oa)}}const D=function(xa,oa){var Ma;if(xa.$schema){const Za=aM(xa.$schema);oa&&oa!==Za.library&&console.warn(`The given visualization spec is written in ${Vm[Za.library]}, but mode argument sets ${null!==(Ma=Vm[oa])&&void 0!==Ma?Ma:oa}.`);const Pa=Za.library;return Ya.satisfies(Vq[Pa],"^"+Za.version.slice(1))||console.warn(`The input spec uses ${Vm[Pa]} ${Za.version}, but the current version of ${Vm[Pa]} is v${Vq[Pa]}.`),Pa}return"mark"in xa||"encoding"in xa||"layer"in xa||"hconcat"in xa||"vconcat"in xa||"facet"in xa||"repeat"in xa?"vega-lite":"marks"in xa||"signals"in xa||"scales"in xa||"axes"in xa?"vega":null!=oa?oa:"vega"}(n,o.mode);let O=nY[D](n,x);if("vega-lite"===D&&O.$schema){const xa=aM(O.$schema);Ya.satisfies(Vq.vega,"^"+xa.version.slice(1))||console.warn(`The compiled spec uses Vega ${xa.version}, but current version is v${Vq.vega}.`)}const K="string"==typeof m?document.querySelector(m):m;if(!K)throw Error(m+" does not exist");K.classList.add("vega-embed"),z&&K.classList.add("has-actions"),K.innerHTML="";const Q=o.patch;Q&&(O=Q instanceof Function?Q(O):Zf(O,Q,!0,!1).newDocument),o.formatLocale&&Aj.formatLocale(o.formatLocale),o.timeFormatLocale&&Aj.timeFormatLocale(o.timeFormatLocale);const V=Aj.parse(O,"vega-lite"===D?{}:x),$=new Aj.View(V,{loader:p,logLevel:I,renderer:B});if(!1!==o.tooltip){let xa;xa=function(oa){return"function"==typeof oa}(o.tooltip)?o.tooltip:new iY(!0===o.tooltip?{}:o.tooltip).call,$.tooltip(xa)}let Ia,{hover:wa}=o;if(void 0===wa&&(wa="vega"===D),wa){const{hoverSet:xa,updateSet:oa}="boolean"==typeof wa?{}:wa;$.hover(xa,oa)}if(o&&(null!=o.width&&$.width(o.width),null!=o.height&&$.height(o.height),null!=o.padding&&$.padding(o.padding)),yield $.initialize(m).runAsync(),!1!==z){let xa=K;if(!1!==o.defaultStyle){const Ma=document.createElement("details");Ma.title=A.CLICK_TO_VIEW_ACTIONS,K.append(Ma),xa=Ma;const Za=document.createElement("summary");Za.innerHTML=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Ma.append(Za),Ia=Pa=>{Ma.contains(Pa.target)||Ma.removeAttribute("open")},document.addEventListener("click",Ia)}const oa=document.createElement("div");if(xa.append(oa),oa.classList.add("vega-actions"),!0===z||!1!==z.export){for(const Ma of["svg","png"])if(!0===z||!0===z.export||z.export[Ma]){const Za=A[Ma.toUpperCase()+"_ACTION"],Pa=document.createElement("a");Pa.text=Za,Pa.href="#",Pa.target="_blank",Pa.download=`${J}.${Ma}`,Pa.addEventListener("mousedown",function(La){return bc(this,void 0,void 0,function*(){La.preventDefault();const wb=yield $.toImageURL(Ma,o.scaleFactor);this.href=wb})}),oa.append(Pa)}}if(!0===z||!1!==z.source){const Ma=document.createElement("a");Ma.text=A.SOURCE_ACTION,Ma.href="#",Ma.addEventListener("click",function(Za){var Pa,La;eM(uc(n),null!==(Pa=o.sourceHeader)&&void 0!==Pa?Pa:"",null!==(La=o.sourceFooter)&&void 0!==La?La:"",D),Za.preventDefault()}),oa.append(Ma)}if("vega-lite"===D&&(!0===z||!1!==z.compiled)){const Ma=document.createElement("a");Ma.text=A.COMPILED_ACTION,Ma.href="#",Ma.addEventListener("click",function(Za){var Pa,La;eM(uc(O),null!==(Pa=o.sourceHeader)&&void 0!==Pa?Pa:"",null!==(La=o.sourceFooter)&&void 0!==La?La:"","vega"),Za.preventDefault()}),oa.append(Ma)}if(!0===z||!1!==z.editor){const Ma=null!==(w=o.editorUrl)&&void 0!==w?w:"https://vega.github.io/editor/",Za=document.createElement("a");Za.text=A.EDITOR_ACTION,Za.href="#",Za.addEventListener("click",function(Pa){!function(La,wb,tc){const Oc=La.open(wb),{origin:xb}=new URL(wb);let hd=40;La.addEventListener("message",function Ae(Gd){Gd.source===Oc&&(hd=0,La.removeEventListener("message",Ae,!1))},!1),setTimeout(function Ae(){hd<=0||(Oc.postMessage(tc,xb),setTimeout(Ae,250),hd-=1)},250)}(window,Ma,{config:x,mode:D,renderer:B,spec:uc(n)}),Pa.preventDefault()}),oa.append(Za)}}return{view:$,spec:n,vgSpec:O,finalize:function(){Ia&&document.removeEventListener("click",Ia),$.finalize()}}})}(a,i,l,g)})}}).call(this,ya(7).Buffer)},function(le,_a){const ya=document.createElement("style"),Ca=document.createTextNode(`div.svelte-jt39wy.svelte-jt39wy,label.svelte-jt39wy.svelte-jt39wy,button.svelte-jt39wy.svelte-jt39wy,input.svelte-jt39wy.svelte-jt39wy{line-height:1rem}.covid-simulator.svelte-jt39wy.svelte-jt39wy{position:relative}.title.svelte-jt39wy.svelte-jt39wy{margin-bottom:0;font-size:40px;margin-left:2rem}.subtitle.svelte-jt39wy.svelte-jt39wy{margin-top:0;margin-left:2rem;color:#807F8B;font-size:15px}.compartment-tabs.svelte-jt39wy.svelte-jt39wy{padding-left:2rem}.compartment-tabs.svelte-jt39wy button.svelte-jt39wy{margin:0;padding:8px 0;width:8rem;background-color:transparent;border:none;font-size:15px;color:#D35C08}.compartment-tabs.svelte-jt39wy button.active.svelte-jt39wy{color:#4A495B;border-top:2px solid #4A495B;font-weight:bold;background-color:#F7F7F8}button.svelte-jt39wy.svelte-jt39wy:focus{outline:0}.control.svelte-jt39wy.svelte-jt39wy{position:relative;padding:1.75rem 2.5rem}.control-group.svelte-jt39wy.svelte-jt39wy{position:relative}.control-name.svelte-jt39wy.svelte-jt39wy{font-weight:bold}.control-name.svelte-jt39wy input[type='checkbox'].svelte-jt39wy{display:none}.control-name.svelte-jt39wy label.svelte-jt39wy{position:relative}.control-name.svelte-jt39wy label.svelte-jt39wy:before{content:" ";display:inline-block;position:relative;top:2px;margin:0 3px 0 0;width:12px;height:12px;border:1px solid #70708F;background-color:transparent}.control-name.enabled.svelte-jt39wy label.svelte-jt39wy:after{position:absolute;content:" ";display:block;width:14px;height:14px;top:2px;left:0;background:url("data:image/svg+xml,%3Csvg width='14' height='14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23D35C08' d='M0 0h14v14H0z'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M12.23 3.36l-6.17 8.228-3.77-3.769 1.117-1.116 2.481 2.481 5.08-6.772 1.262.948z' fill='%23fff'/%3E%3C/svg%3E") no-repeat}.control-note.svelte-jt39wy.svelte-jt39wy{font-size:13px;margin-top:-5px;margin-bottom:5px}.control-label.svelte-jt39wy.svelte-jt39wy{display:inline-block}.simple.svelte-jt39wy .control-label.svelte-jt39wy{margin-top:25px;width:auto;text-align:left}.simple.svelte-jt39wy .slider-container.svelte-jt39wy{position:absolute;top:33px;right:0;width:90%}.stacked.svelte-jt39wy.svelte-jt39wy{display:flex;flex-flow:column nowrap}.stacked.svelte-jt39wy .controls.svelte-jt39wy{width:100%;display:flex;flex-flow:column nowrap;font-size:15px;justify-content:center;position:relative}.stacked.svelte-jt39wy .explain.svelte-jt39wy{position:absolute;background:#FFFFFF;z-index:10;display:flex;flex-flow:column nowrap;justify-content:center;top:0;height:100%;padding:0 15%}@media only screen and (min-width : 768px){.stacked.svelte-jt39wy.svelte-jt39wy{flex-flow:row nowrap}.stacked.svelte-jt39wy .compartments.svelte-jt39wy{width:70%}.stacked.svelte-jt39wy .controls.svelte-jt39wy{width:30%;order:-1}}.stacked.svelte-jt39wy .control.svelte-jt39wy{padding:10px}.stacked.svelte-jt39wy .control-name.svelte-jt39wy{margin:0 15px 10px 0}.stacked.svelte-jt39wy .slider.svelte-jt39wy{margin:30px 10px 10px}.radio.svelte-jt39wy.svelte-jt39wy{display:inline-block;position:relative;padding:0;margin:0 0 0 10px}.radio.svelte-jt39wy .control-label.svelte-jt39wy{margin:0 10px 10px 0}.radio.svelte-jt39wy input[type='radio'].svelte-jt39wy{display:none}.radio.svelte-jt39wy label.svelte-jt39wy{display:block;color:#464653}.radio.svelte-jt39wy label.svelte-jt39wy:before{content:" ";display:inline-block;position:relative;top:2px;margin:0 3px 0 0;width:12px;height:12px;border-radius:10px;border:1px solid #464653;background-color:transparent}label.tracing.svelte-jt39wy.svelte-jt39wy:after{border-radius:11px;width:8px;height:8px;position:absolute;top:5px;left:3px;content:" ";display:block;background:#D35C08}label.tracing.svelte-jt39wy.svelte-jt39wy:before{border-color:#464653}.control-tooltip.svelte-jt39wy.svelte-jt39wy:after{position:absolute;top:12px;right:14px;text-align:center;font-size:18px;font-weight:bold;color:#AAA8B8;width:16px;height:16px;content:"";background-image:url("data:image/svg+xml,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='8.042' cy='8.042' r='7.458' fill='%23fff' stroke='%2370708F'/%3E%3Cpath fill='%2370708F' d='M7.25 6.498h1.5v6.5h-1.5z'/%3E%3Ccircle cx='8' cy='4' r='1' fill='%2370708F'/%3E%3C/svg%3E")}.explain.svelte-jt39wy .control-name.svelte-jt39wy{margin-bottom:20px}.control-explanation.svelte-jt39wy.svelte-jt39wy{display:none}.explain.svelte-jt39wy .control-explanation.svelte-jt39wy{display:block;color:#807F8B;font-size:13px;line-height:150%}.explain .control-explanation.svelte-jt39wy a.svelte-jt39wy{color:#D35C08}.explain.svelte-jt39wy button.svelte-jt39wy{width:auto;margin:1.5em auto;padding:1em 1.5em;border-radius:25px;border:0;color:#FFFFFF;background-color:#D35C08;font-size:15px}`);ya.type="text/css",ya.appendChild(Ca),document.head.appendChild(ya)},function(le,_a){const ya=document.createElement("style"),Ca=document.createTextNode(".noUi-target,.noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box}.noUi-target{position:relative}.noUi-base,.noUi-connects{width:100%;height:100%;position:relative;z-index:1}.noUi-connects{overflow:hidden;z-index:0}.noUi-connect,.noUi-origin{will-change:transform;position:absolute;z-index:1;top:0;right:0;-ms-transform-origin:0 0;-webkit-transform-origin:0 0;-webkit-transform-style:preserve-3d;transform-origin:0 0;transform-style:flat}.noUi-connect{height:100%;width:100%}.noUi-origin{height:10%;width:10%}.noUi-horizontal .noUi-origin{height:0}.noUi-handle{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.noUi-touch-area{height:100%;width:100%}.noUi-state-tap .noUi-connect,.noUi-state-tap .noUi-origin{-webkit-transition:transform 0.3s;transition:transform 0.3s}.noUi-state-drag *{cursor:inherit !important}.noUi-horizontal{height:5px}.noUi-horizontal .noUi-handle{width:19px;height:19px;right:-8px;top:-8px;border-radius:50px}.noUi-txt-dir-rtl.noUi-horizontal .noUi-handle{left:-17px;right:auto}.noUi-target{background:#D5D5DE;border-radius:4px}.noUi-connect{background:#F79636}.noUi-target[disabled] .noUi-connect{background:#D5D5DE}.noUi-draggable{cursor:ew-resize}.noUi-handle{border-radius:3px;background:#D35C08;cursor:default;outline:0}.noUi-target[disabled] .noUi-handle{background:#D5D5DE}.noUi-active{background:#F79636}.noUi-active:focus{outline:0}.noUi-handle:after{left:17px}.noUi-tooltip{display:block;position:absolute;color:#D35C08;padding:0;text-align:center;white-space:nowrap}.noUi-target[disabled] .noUi-tooltip{color:#D5D5DE}.noUi-horizontal .noUi-tooltip{-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);left:50%;bottom:100%}.noUi-horizontal .noUi-origin > .noUi-tooltip{-webkit-transform:translate(50%, 0);transform:translate(50%, 0);left:auto;bottom:10px}");ya.type="text/css",ya.appendChild(Ca),document.head.appendChild(ya)},function(le,_a){const ya=document.createElement("style"),Ca=document.createTextNode(".covid-graph-container.svelte-1okghyu.svelte-1okghyu{position:relative;background-color:#F7F7F8;padding:2rem 2rem 1rem 2rem;display:flex;flex-wrap:wrap;justify-content:flex-end}.covid-graph-vega.svelte-1okghyu.svelte-1okghyu{width:92%}.numbers.svelte-1okghyu.svelte-1okghyu{clear:both;display:flex;flex-wrap:wrap;justify-content:flex-end;max-width:45rem}.numbers.svelte-1okghyu p.svelte-1okghyu{padding:0.5rem 1.2rem;text-align:center;font-size:13px;color:#807F8B;flex-grow:1}.numbers.svelte-1okghyu p .big.svelte-1okghyu{display:block;font-size:20px;color:#4A495B}.numbers.svelte-1okghyu .total.svelte-1okghyu{background-color:#FFFFFF}.footnote.svelte-1okghyu.svelte-1okghyu{font-size:12px;margin-top:-10px;z-index:10;line-height:1em}");ya.type="text/css",ya.appendChild(Ca),document.head.appendChild(ya)},function(le,_a,ya){"use strict";(function(Ca){var v=ya(8),Fa=ya(9),bc=ya(10);function cc(){return ha.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function qb(y,C){if(cc()<C)throw new RangeError("Invalid typed array length");return ha.TYPED_ARRAY_SUPPORT?(y=new Uint8Array(C)).__proto__=ha.prototype:(null===y&&(y=new ha(C)),y.length=C),y}function ha(y,C,H){if(!(ha.TYPED_ARRAY_SUPPORT||this instanceof ha))return new ha(y,C,H);if("number"==typeof y){if("string"==typeof C)throw new Error("If encoding is specified then the first argument must be a string");return Ua(this,y)}return td(this,y,C,H)}function td(y,C,H,X){if("number"==typeof C)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&C instanceof ArrayBuffer?function(W,T,Sa,rb){if(T.byteLength,Sa<0||T.byteLength<Sa)throw new RangeError("'offset' is out of bounds");if(T.byteLength<Sa+(rb||0))throw new RangeError("'length' is out of bounds");return T=void 0===Sa&&void 0===rb?new Uint8Array(T):void 0===rb?new Uint8Array(T,Sa):new Uint8Array(T,Sa,rb),ha.TYPED_ARRAY_SUPPORT?(W=T).__proto__=ha.prototype:W=eb(W,T),W}(y,C,H,X):"string"==typeof C?function(W,T,Sa){"string"==typeof Sa&&""!==Sa||(Sa="utf8");if(!ha.isEncoding(Sa))throw new TypeError('"encoding" must be a valid string encoding');var rb=0|ic(T,Sa),xc=(W=qb(W,rb)).write(T,Sa);return xc!==rb&&(W=W.slice(0,xc)),W}(y,C,H):function(W,T){if(ha.isBuffer(T)){var Sa=0|Wb(T.length);return 0===(W=qb(W,Sa)).length||T.copy(W,0,0,Sa),W}if(T){if("undefined"!=typeof ArrayBuffer&&T.buffer instanceof ArrayBuffer||"length"in T)return"number"!=typeof T.length||(rb=T.length)!=rb?qb(W,0):eb(W,T);if("Buffer"===T.type&&bc(T.data))return eb(W,T.data)}var rb;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(y,C)}function zb(y){if("number"!=typeof y)throw new TypeError('"size" argument must be a number');if(y<0)throw new RangeError('"size" argument must not be negative')}function Ua(y,C){if(zb(C),y=qb(y,C<0?0:0|Wb(C)),!ha.TYPED_ARRAY_SUPPORT)for(var H=0;H<C;++H)y[H]=0;return y}function eb(y,C){var H=C.length<0?0:0|Wb(C.length);y=qb(y,H);for(var X=0;X<H;X+=1)y[X]=255&C[X];return y}function Wb(y){if(y>=cc())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+cc().toString(16)+" bytes");return 0|y}function ic(y,C){if(ha.isBuffer(y))return y.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(y)||y instanceof ArrayBuffer))return y.byteLength;"string"!=typeof y&&(y=""+y);var H=y.length;if(0===H)return 0;for(var X=!1;;)switch(C){case"ascii":case"latin1":case"binary":return H;case"utf8":case"utf-8":case void 0:return Ze(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*H;case"hex":return H>>>1;case"base64":return $f(y).length;default:if(X)return Ze(y).length;C=(""+C).toLowerCase(),X=!0}}function $c(y,C,H){var X=!1;if((void 0===C||C<0)&&(C=0),C>this.length)return"";if((void 0===H||H>this.length)&&(H=this.length),H<=0)return"";if((H>>>=0)<=(C>>>=0))return"";for(y||(y="utf8");;)switch(y){case"hex":return xg(this,C,H);case"utf8":case"utf-8":return Ye(this,C,H);case"ascii":return yi(this,C,H);case"latin1":case"binary":return _f(this,C,H);case"base64":return bh(this,C,H);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yg(this,C,H);default:if(X)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),X=!0}}function jc(y,C,H){var X=y[C];y[C]=y[H],y[H]=X}function kc(y,C,H,X,W){if(0===y.length)return-1;if("string"==typeof H?(X=H,H=0):H>2147483647?H=2147483647:H<-2147483648&&(H=-2147483648),H=+H,isNaN(H)&&(H=W?0:y.length-1),H<0&&(H=y.length+H),H>=y.length){if(W)return-1;H=y.length-1}else if(H<0){if(!W)return-1;H=0}if("string"==typeof C&&(C=ha.from(C,X)),ha.isBuffer(C))return 0===C.length?-1:Yf(y,C,H,X,W);if("number"==typeof C)return C&=255,ha.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?W?Uint8Array.prototype.indexOf.call(y,C,H):Uint8Array.prototype.lastIndexOf.call(y,C,H):Yf(y,[C],H,X,W);throw new TypeError("val must be string, number or Buffer")}function Yf(y,C,H,X,W){var T,Sa=1,rb=y.length,xc=C.length;if(void 0!==X&&("ucs2"===(X=String(X).toLowerCase())||"ucs-2"===X||"utf16le"===X||"utf-16le"===X)){if(y.length<2||C.length<2)return-1;Sa=2,rb/=2,xc/=2,H/=2}function Yb(Cc,De){return 1===Sa?Cc[De]:Cc.readUInt16BE(De*Sa)}if(W){var Hb=-1;for(T=H;T<rb;T++)if(Yb(y,T)===Yb(C,-1===Hb?0:T-Hb)){if(-1===Hb&&(Hb=T),T-Hb+1===xc)return Hb*Sa}else-1!==Hb&&(T-=T-Hb),Hb=-1}else for(H+xc>rb&&(H=rb-xc),T=H;T>=0;T--){for(var ud=!0,_e=0;_e<xc;_e++)if(Yb(y,T+_e)!==Yb(C,_e)){ud=!1;break}if(ud)return T}return-1}function Xe(y,C,H,X){H=Number(H)||0;var W=y.length-H;X?(X=Number(X))>W&&(X=W):X=W;var T=C.length;if(T%2!=0)throw new TypeError("Invalid hex string");X>T/2&&(X=T/2);for(var Sa=0;Sa<X;++Sa){var rb=parseInt(C.substr(2*Sa,2),16);if(isNaN(rb))return Sa;y[H+Sa]=rb}return Sa}function vg(y,C,H,X){return Ce(Ze(C,y.length-H),y,H,X)}function ae(y,C,H,X){return Ce(function(W){for(var T=[],Sa=0;Sa<W.length;++Sa)T.push(255&W.charCodeAt(Sa));return T}(C),y,H,X)}function me(y,C,H,X){return ae(y,C,H,X)}function Zf(y,C,H,X){return Ce($f(C),y,H,X)}function wg(y,C,H,X){return Ce(function(W,T){for(var Sa,rb,xc,Yb=[],Hb=0;Hb<W.length&&!((T-=2)<0);++Hb)Sa=W.charCodeAt(Hb),rb=Sa>>8,xc=Sa%256,Yb.push(xc),Yb.push(rb);return Yb}(C,y.length-H),y,H,X)}function bh(y,C,H){return 0===C&&H===y.length?v.fromByteArray(y):v.fromByteArray(y.slice(C,H))}function Ye(y,C,H){H=Math.min(y.length,H);for(var X=[],W=C;W<H;){var T,Sa,rb,xc,Yb=y[W],Hb=null,ud=Yb>239?4:Yb>223?3:Yb>191?2:1;if(W+ud<=H)switch(ud){case 1:Yb<128&&(Hb=Yb);break;case 2:128==(192&(T=y[W+1]))&&(xc=(31&Yb)<<6|63&T)>127&&(Hb=xc);break;case 3:T=y[W+1],Sa=y[W+2],128==(192&T)&&128==(192&Sa)&&(xc=(15&Yb)<<12|(63&T)<<6|63&Sa)>2047&&(xc<55296||xc>57343)&&(Hb=xc);break;case 4:T=y[W+1],Sa=y[W+2],rb=y[W+3],128==(192&T)&&128==(192&Sa)&&128==(192&rb)&&(xc=(15&Yb)<<18|(63&T)<<12|(63&Sa)<<6|63&rb)>65535&&xc<1114112&&(Hb=xc)}null===Hb?(Hb=65533,ud=1):Hb>65535&&(Hb-=65536,X.push(Hb>>>10&1023|55296),Hb=56320|1023&Hb),X.push(Hb),W+=ud}return function(_e){var Cc=_e.length;if(Cc<=4096)return String.fromCharCode.apply(String,_e);for(var De="",zg=0;zg<Cc;)De+=String.fromCharCode.apply(String,_e.slice(zg,zg+=4096));return De}(X)}_a.Buffer=ha,_a.SlowBuffer=function(y){return+y!=y&&(y=0),ha.alloc(+y)},_a.INSPECT_MAX_BYTES=50,ha.TYPED_ARRAY_SUPPORT=void 0!==Ca.TYPED_ARRAY_SUPPORT?Ca.TYPED_ARRAY_SUPPORT:function(){try{var y=new Uint8Array(1);return y.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===y.foo()&&"function"==typeof y.subarray&&0===y.subarray(1,1).byteLength}catch(C){return!1}}(),_a.kMaxLength=cc(),ha.poolSize=8192,ha._augment=function(y){return y.__proto__=ha.prototype,y},ha.from=function(y,C,H){return td(null,y,C,H)},ha.TYPED_ARRAY_SUPPORT&&(ha.prototype.__proto__=Uint8Array.prototype,ha.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&ha[Symbol.species]===ha&&Object.defineProperty(ha,Symbol.species,{value:null,configurable:!0})),ha.alloc=function(y,C,H){return function(X,W,T,Sa){return zb(W),W<=0?qb(X,W):void 0!==T?"string"==typeof Sa?qb(X,W).fill(T,Sa):qb(X,W).fill(T):qb(X,W)}(null,y,C,H)},ha.allocUnsafe=function(y){return Ua(null,y)},ha.allocUnsafeSlow=function(y){return Ua(null,y)},ha.isBuffer=function(y){return!(null==y||!y._isBuffer)},ha.compare=function(y,C){if(!ha.isBuffer(y)||!ha.isBuffer(C))throw new TypeError("Arguments must be Buffers");if(y===C)return 0;for(var H=y.length,X=C.length,W=0,T=Math.min(H,X);W<T;++W)if(y[W]!==C[W]){H=y[W],X=C[W];break}return H<X?-1:X<H?1:0},ha.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ha.concat=function(y,C){if(!bc(y))throw new TypeError('"list" argument must be an Array of Buffers');if(0===y.length)return ha.alloc(0);var H;if(void 0===C)for(C=0,H=0;H<y.length;++H)C+=y[H].length;var X=ha.allocUnsafe(C),W=0;for(H=0;H<y.length;++H){var T=y[H];if(!ha.isBuffer(T))throw new TypeError('"list" argument must be an Array of Buffers');T.copy(X,W),W+=T.length}return X},ha.byteLength=ic,ha.prototype._isBuffer=!0,ha.prototype.swap16=function(){var y=this.length;if(y%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var C=0;C<y;C+=2)jc(this,C,C+1);return this},ha.prototype.swap32=function(){var y=this.length;if(y%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var C=0;C<y;C+=4)jc(this,C,C+3),jc(this,C+1,C+2);return this},ha.prototype.swap64=function(){var y=this.length;if(y%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var C=0;C<y;C+=8)jc(this,C,C+7),jc(this,C+1,C+6),jc(this,C+2,C+5),jc(this,C+3,C+4);return this},ha.prototype.toString=function(){var y=0|this.length;return 0===y?"":0===arguments.length?Ye(this,0,y):$c.apply(this,arguments)},ha.prototype.equals=function(y){if(!ha.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y||0===ha.compare(this,y)},ha.prototype.inspect=function(){var y="",C=_a.INSPECT_MAX_BYTES;return this.length>0&&(y=this.toString("hex",0,C).match(/.{2}/g).join(" "),this.length>C&&(y+=" ... ")),"<Buffer "+y+">"},ha.prototype.compare=function(y,C,H,X,W){if(!ha.isBuffer(y))throw new TypeError("Argument must be a Buffer");if(void 0===C&&(C=0),void 0===H&&(H=y?y.length:0),void 0===X&&(X=0),void 0===W&&(W=this.length),C<0||H>y.length||X<0||W>this.length)throw new RangeError("out of range index");if(X>=W&&C>=H)return 0;if(X>=W)return-1;if(C>=H)return 1;if(this===y)return 0;for(var T=(W>>>=0)-(X>>>=0),Sa=(H>>>=0)-(C>>>=0),rb=Math.min(T,Sa),xc=this.slice(X,W),Yb=y.slice(C,H),Hb=0;Hb<rb;++Hb)if(xc[Hb]!==Yb[Hb]){T=xc[Hb],Sa=Yb[Hb];break}return T<Sa?-1:Sa<T?1:0},ha.prototype.includes=function(y,C,H){return-1!==this.indexOf(y,C,H)},ha.prototype.indexOf=function(y,C,H){return kc(this,y,C,H,!0)},ha.prototype.lastIndexOf=function(y,C,H){return kc(this,y,C,H,!1)},ha.prototype.write=function(y,C,H,X){if(void 0===C)X="utf8",H=this.length,C=0;else if(void 0===H&&"string"==typeof C)X=C,H=this.length,C=0;else{if(!isFinite(C))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");C|=0,isFinite(H)?(H|=0,void 0===X&&(X="utf8")):(X=H,H=void 0)}var W=this.length-C;if((void 0===H||H>W)&&(H=W),y.length>0&&(H<0||C<0)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");X||(X="utf8");for(var T=!1;;)switch(X){case"hex":return Xe(this,y,C,H);case"utf8":case"utf-8":return vg(this,y,C,H);case"ascii":return ae(this,y,C,H);case"latin1":case"binary":return me(this,y,C,H);case"base64":return Zf(this,y,C,H);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wg(this,y,C,H);default:if(T)throw new TypeError("Unknown encoding: "+X);X=(""+X).toLowerCase(),T=!0}},ha.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function yi(y,C,H){var X="";H=Math.min(y.length,H);for(var W=C;W<H;++W)X+=String.fromCharCode(127&y[W]);return X}function _f(y,C,H){var X="";H=Math.min(y.length,H);for(var W=C;W<H;++W)X+=String.fromCharCode(y[W]);return X}function xg(y,C,H){var X=y.length;(!C||C<0)&&(C=0),(!H||H<0||H>X)&&(H=X);for(var W="",T=C;T<H;++T)W+=Df(y[T]);return W}function yg(y,C,H){for(var X=y.slice(C,H),W="",T=0;T<X.length;T+=2)W+=String.fromCharCode(X[T]+256*X[T+1]);return W}function Gb(y,C,H){if(y%1!=0||y<0)throw new RangeError("offset is not uint");if(y+C>H)throw new RangeError("Trying to access beyond buffer length")}function cb(y,C,H,X,W,T){if(!ha.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>W||C<T)throw new RangeError('"value" argument is out of bounds');if(H+X>y.length)throw new RangeError("Index out of range")}function Be(y,C,H,X){C<0&&(C=65535+C+1);for(var W=0,T=Math.min(y.length-H,2);W<T;++W)y[H+W]=(C&255<<8*(X?W:1-W))>>>8*(X?W:1-W)}function rf(y,C,H,X){C<0&&(C=4294967295+C+1);for(var W=0,T=Math.min(y.length-H,4);W<T;++W)y[H+W]=C>>>8*(X?W:3-W)&255}function uc(y,C,H,X,W,T){if(H+X>y.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("Index out of range")}function Cf(y,C,H,X,W){return W||uc(y,0,H,4),Fa.write(y,C,H,X,23,4),H+4}function ne(y,C,H,X,W){return W||uc(y,0,H,8),Fa.write(y,C,H,X,52,8),H+8}ha.prototype.slice=function(y,C){var H,X=this.length;if((y=~~y)<0?(y+=X)<0&&(y=0):y>X&&(y=X),(C=void 0===C?X:~~C)<0?(C+=X)<0&&(C=0):C>X&&(C=X),C<y&&(C=y),ha.TYPED_ARRAY_SUPPORT)(H=this.subarray(y,C)).__proto__=ha.prototype;else{var W=C-y;H=new ha(W,void 0);for(var T=0;T<W;++T)H[T]=this[T+y]}return H},ha.prototype.readUIntLE=function(y,C,H){y|=0,C|=0,H||Gb(y,C,this.length);for(var X=this[y],W=1,T=0;++T<C&&(W*=256);)X+=this[y+T]*W;return X},ha.prototype.readUIntBE=function(y,C,H){y|=0,C|=0,H||Gb(y,C,this.length);for(var X=this[y+--C],W=1;C>0&&(W*=256);)X+=this[y+--C]*W;return X},ha.prototype.readUInt8=function(y,C){return C||Gb(y,1,this.length),this[y]},ha.prototype.readUInt16LE=function(y,C){return C||Gb(y,2,this.length),this[y]|this[y+1]<<8},ha.prototype.readUInt16BE=function(y,C){return C||Gb(y,2,this.length),this[y]<<8|this[y+1]},ha.prototype.readUInt32LE=function(y,C){return C||Gb(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+16777216*this[y+3]},ha.prototype.readUInt32BE=function(y,C){return C||Gb(y,4,this.length),16777216*this[y]+(this[y+1]<<16|this[y+2]<<8|this[y+3])},ha.prototype.readIntLE=function(y,C,H){y|=0,C|=0,H||Gb(y,C,this.length);for(var X=this[y],W=1,T=0;++T<C&&(W*=256);)X+=this[y+T]*W;return X>=(W*=128)&&(X-=Math.pow(2,8*C)),X},ha.prototype.readIntBE=function(y,C,H){y|=0,C|=0,H||Gb(y,C,this.length);for(var X=C,W=1,T=this[y+--X];X>0&&(W*=256);)T+=this[y+--X]*W;return T>=(W*=128)&&(T-=Math.pow(2,8*C)),T},ha.prototype.readInt8=function(y,C){return C||Gb(y,1,this.length),128&this[y]?-1*(255-this[y]+1):this[y]},ha.prototype.readInt16LE=function(y,C){C||Gb(y,2,this.length);var H=this[y]|this[y+1]<<8;return 32768&H?4294901760|H:H},ha.prototype.readInt16BE=function(y,C){C||Gb(y,2,this.length);var H=this[y+1]|this[y]<<8;return 32768&H?4294901760|H:H},ha.prototype.readInt32LE=function(y,C){return C||Gb(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},ha.prototype.readInt32BE=function(y,C){return C||Gb(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},ha.prototype.readFloatLE=function(y,C){return C||Gb(y,4,this.length),Fa.read(this,y,!0,23,4)},ha.prototype.readFloatBE=function(y,C){return C||Gb(y,4,this.length),Fa.read(this,y,!1,23,4)},ha.prototype.readDoubleLE=function(y,C){return C||Gb(y,8,this.length),Fa.read(this,y,!0,52,8)},ha.prototype.readDoubleBE=function(y,C){return C||Gb(y,8,this.length),Fa.read(this,y,!1,52,8)},ha.prototype.writeUIntLE=function(y,C,H,X){(y=+y,C|=0,H|=0,X)||cb(this,y,C,H,Math.pow(2,8*H)-1,0);var W=1,T=0;for(this[C]=255&y;++T<H&&(W*=256);)this[C+T]=y/W&255;return C+H},ha.prototype.writeUIntBE=function(y,C,H,X){(y=+y,C|=0,H|=0,X)||cb(this,y,C,H,Math.pow(2,8*H)-1,0);var W=H-1,T=1;for(this[C+W]=255&y;--W>=0&&(T*=256);)this[C+W]=y/T&255;return C+H},ha.prototype.writeUInt8=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,1,255,0),ha.TYPED_ARRAY_SUPPORT||(y=Math.floor(y)),this[C]=255&y,C+1},ha.prototype.writeUInt16LE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,2,65535,0),ha.TYPED_ARRAY_SUPPORT?(this[C]=255&y,this[C+1]=y>>>8):Be(this,y,C,!0),C+2},ha.prototype.writeUInt16BE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,2,65535,0),ha.TYPED_ARRAY_SUPPORT?(this[C]=y>>>8,this[C+1]=255&y):Be(this,y,C,!1),C+2},ha.prototype.writeUInt32LE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,4,4294967295,0),ha.TYPED_ARRAY_SUPPORT?(this[C+3]=y>>>24,this[C+2]=y>>>16,this[C+1]=y>>>8,this[C]=255&y):rf(this,y,C,!0),C+4},ha.prototype.writeUInt32BE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,4,4294967295,0),ha.TYPED_ARRAY_SUPPORT?(this[C]=y>>>24,this[C+1]=y>>>16,this[C+2]=y>>>8,this[C+3]=255&y):rf(this,y,C,!1),C+4},ha.prototype.writeIntLE=function(y,C,H,X){if(y=+y,C|=0,!X){var W=Math.pow(2,8*H-1);cb(this,y,C,H,W-1,-W)}var T=0,Sa=1,rb=0;for(this[C]=255&y;++T<H&&(Sa*=256);)y<0&&0===rb&&0!==this[C+T-1]&&(rb=1),this[C+T]=(y/Sa>>0)-rb&255;return C+H},ha.prototype.writeIntBE=function(y,C,H,X){if(y=+y,C|=0,!X){var W=Math.pow(2,8*H-1);cb(this,y,C,H,W-1,-W)}var T=H-1,Sa=1,rb=0;for(this[C+T]=255&y;--T>=0&&(Sa*=256);)y<0&&0===rb&&0!==this[C+T+1]&&(rb=1),this[C+T]=(y/Sa>>0)-rb&255;return C+H},ha.prototype.writeInt8=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,1,127,-128),ha.TYPED_ARRAY_SUPPORT||(y=Math.floor(y)),y<0&&(y=255+y+1),this[C]=255&y,C+1},ha.prototype.writeInt16LE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,2,32767,-32768),ha.TYPED_ARRAY_SUPPORT?(this[C]=255&y,this[C+1]=y>>>8):Be(this,y,C,!0),C+2},ha.prototype.writeInt16BE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,2,32767,-32768),ha.TYPED_ARRAY_SUPPORT?(this[C]=y>>>8,this[C+1]=255&y):Be(this,y,C,!1),C+2},ha.prototype.writeInt32LE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,4,2147483647,-2147483648),ha.TYPED_ARRAY_SUPPORT?(this[C]=255&y,this[C+1]=y>>>8,this[C+2]=y>>>16,this[C+3]=y>>>24):rf(this,y,C,!0),C+4},ha.prototype.writeInt32BE=function(y,C,H){return y=+y,C|=0,H||cb(this,y,C,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),ha.TYPED_ARRAY_SUPPORT?(this[C]=y>>>24,this[C+1]=y>>>16,this[C+2]=y>>>8,this[C+3]=255&y):rf(this,y,C,!1),C+4},ha.prototype.writeFloatLE=function(y,C,H){return Cf(this,y,C,!0,H)},ha.prototype.writeFloatBE=function(y,C,H){return Cf(this,y,C,!1,H)},ha.prototype.writeDoubleLE=function(y,C,H){return ne(this,y,C,!0,H)},ha.prototype.writeDoubleBE=function(y,C,H){return ne(this,y,C,!1,H)},ha.prototype.copy=function(y,C,H,X){if(H||(H=0),X||0===X||(X=this.length),C>=y.length&&(C=y.length),C||(C=0),X>0&&X<H&&(X=H),X===H)return 0;if(0===y.length||0===this.length)return 0;if(C<0)throw new RangeError("targetStart out of bounds");if(H<0||H>=this.length)throw new RangeError("sourceStart out of bounds");if(X<0)throw new RangeError("sourceEnd out of bounds");X>this.length&&(X=this.length),y.length-C<X-H&&(X=y.length-C+H);var W,T=X-H;if(this===y&&H<C&&C<X)for(W=T-1;W>=0;--W)y[W+C]=this[W+H];else if(T<1e3||!ha.TYPED_ARRAY_SUPPORT)for(W=0;W<T;++W)y[W+C]=this[W+H];else Uint8Array.prototype.set.call(y,this.subarray(H,H+T),C);return T},ha.prototype.fill=function(y,C,H,X){if("string"==typeof y){if("string"==typeof C?(X=C,C=0,H=this.length):"string"==typeof H&&(X=H,H=this.length),1===y.length){var W=y.charCodeAt(0);W<256&&(y=W)}if(void 0!==X&&"string"!=typeof X)throw new TypeError("encoding must be a string");if("string"==typeof X&&!ha.isEncoding(X))throw new TypeError("Unknown encoding: "+X)}else"number"==typeof y&&(y&=255);if(C<0||this.length<C||this.length<H)throw new RangeError("Out of range index");if(H<=C)return this;var T;if(C>>>=0,H=void 0===H?this.length:H>>>0,y||(y=0),"number"==typeof y)for(T=C;T<H;++T)this[T]=y;else{var Sa=ha.isBuffer(y)?y:Ze(new ha(y,X).toString()),rb=Sa.length;for(T=0;T<H-C;++T)this[T+C]=Sa[T%rb]}return this};var be=/[^+\/0-9A-Za-z-_]/g;function Df(y){return y<16?"0"+y.toString(16):y.toString(16)}function Ze(y,C){var H;C=C||1/0;for(var X=y.length,W=null,T=[],Sa=0;Sa<X;++Sa){if((H=y.charCodeAt(Sa))>55295&&H<57344){if(!W){if(H>56319){(C-=3)>-1&&T.push(239,191,189);continue}if(Sa+1===X){(C-=3)>-1&&T.push(239,191,189);continue}W=H;continue}if(H<56320){(C-=3)>-1&&T.push(239,191,189),W=H;continue}H=65536+(W-55296<<10|H-56320)}else W&&(C-=3)>-1&&T.push(239,191,189);if(W=null,H<128){if((C-=1)<0)break;T.push(H)}else if(H<2048){if((C-=2)<0)break;T.push(H>>6|192,63&H|128)}else if(H<65536){if((C-=3)<0)break;T.push(H>>12|224,H>>6&63|128,63&H|128)}else{if(!(H<1114112))throw new Error("Invalid code point");if((C-=4)<0)break;T.push(H>>18|240,H>>12&63|128,H>>6&63|128,63&H|128)}}return T}function $f(y){return v.toByteArray(function(C){if((C=function(H){return H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")}(C).replace(be,"")).length<2)return"";for(;C.length%4!=0;)C+="=";return C}(y))}function Ce(y,C,H,X){for(var W=0;W<X&&!(W+H>=C.length||W>=y.length);++W)C[W+H]=y[W];return W}}).call(this,ya(2))},function(le,_a,ya){"use strict";_a.byteLength=function(zb){var Ua=ha(zb),eb=Ua[0],Wb=Ua[1];return 3*(eb+Wb)/4-Wb},_a.toByteArray=function(zb){var Ua,eb,Wb=ha(zb),ic=Wb[0],$c=Wb[1],jc=new Fa(function(Xe,vg,ae){return 3*(vg+ae)/4-ae}(0,ic,$c)),kc=0,Yf=$c>0?ic-4:ic;for(eb=0;eb<Yf;eb+=4)Ua=v[zb.charCodeAt(eb)]<<18|v[zb.charCodeAt(eb+1)]<<12|v[zb.charCodeAt(eb+2)]<<6|v[zb.charCodeAt(eb+3)],jc[kc++]=Ua>>16&255,jc[kc++]=Ua>>8&255,jc[kc++]=255&Ua;return 2===$c&&(Ua=v[zb.charCodeAt(eb)]<<2|v[zb.charCodeAt(eb+1)]>>4,jc[kc++]=255&Ua),1===$c&&(Ua=v[zb.charCodeAt(eb)]<<10|v[zb.charCodeAt(eb+1)]<<4|v[zb.charCodeAt(eb+2)]>>2,jc[kc++]=Ua>>8&255,jc[kc++]=255&Ua),jc},_a.fromByteArray=function(zb){for(var Ua,eb=zb.length,Wb=eb%3,ic=[],$c=0,jc=eb-Wb;$c<jc;$c+=16383)ic.push(td(zb,$c,$c+16383>jc?jc:$c+16383));return 1===Wb?(Ua=zb[eb-1],ic.push(Ca[Ua>>2]+Ca[Ua<<4&63]+"==")):2===Wb&&(Ua=(zb[eb-2]<<8)+zb[eb-1],ic.push(Ca[Ua>>10]+Ca[Ua>>4&63]+Ca[Ua<<2&63]+"=")),ic.join("")};for(var Ca=[],v=[],Fa="undefined"!=typeof Uint8Array?Uint8Array:Array,bc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cc=0,qb=bc.length;cc<qb;++cc)Ca[cc]=bc[cc],v[bc.charCodeAt(cc)]=cc;function ha(zb){var Ua=zb.length;if(Ua%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var eb=zb.indexOf("=");return-1===eb&&(eb=Ua),[eb,eb===Ua?0:4-eb%4]}function td(zb,Ua,eb){for(var Wb,ic,$c=[],jc=Ua;jc<eb;jc+=3)Wb=(zb[jc]<<16&16711680)+(zb[jc+1]<<8&65280)+(255&zb[jc+2]),$c.push(Ca[(ic=Wb)>>18&63]+Ca[ic>>12&63]+Ca[ic>>6&63]+Ca[63&ic]);return $c.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63},function(le,_a){_a.read=function(ya,Ca,v,Fa,bc){var cc,qb,ha=8*bc-Fa-1,td=(1<<ha)-1,zb=td>>1,Ua=-7,eb=v?bc-1:0,Wb=v?-1:1,ic=ya[Ca+eb];for(eb+=Wb,cc=ic&(1<<-Ua)-1,ic>>=-Ua,Ua+=ha;Ua>0;cc=256*cc+ya[Ca+eb],eb+=Wb,Ua-=8);for(qb=cc&(1<<-Ua)-1,cc>>=-Ua,Ua+=Fa;Ua>0;qb=256*qb+ya[Ca+eb],eb+=Wb,Ua-=8);if(0===cc)cc=1-zb;else{if(cc===td)return qb?NaN:1/0*(ic?-1:1);qb+=Math.pow(2,Fa),cc-=zb}return(ic?-1:1)*qb*Math.pow(2,cc-Fa)},_a.write=function(ya,Ca,v,Fa,bc,cc){var qb,ha,td,zb=8*cc-bc-1,Ua=(1<<zb)-1,eb=Ua>>1,Wb=23===bc?Math.pow(2,-24)-Math.pow(2,-77):0,ic=Fa?0:cc-1,$c=Fa?1:-1,jc=Ca<0||0===Ca&&1/Ca<0?1:0;for(Ca=Math.abs(Ca),isNaN(Ca)||Ca===1/0?(ha=isNaN(Ca)?1:0,qb=Ua):(qb=Math.floor(Math.log(Ca)/Math.LN2),Ca*(td=Math.pow(2,-qb))<1&&(qb--,td*=2),(Ca+=qb+eb>=1?Wb/td:Wb*Math.pow(2,1-eb))*td>=2&&(qb++,td/=2),qb+eb>=Ua?(ha=0,qb=Ua):qb+eb>=1?(ha=(Ca*td-1)*Math.pow(2,bc),qb+=eb):(ha=Ca*Math.pow(2,eb-1)*Math.pow(2,bc),qb=0));bc>=8;ya[v+ic]=255&ha,ic+=$c,ha/=256,bc-=8);for(qb=qb<<bc|ha,zb+=bc;zb>0;ya[v+ic]=255&qb,ic+=$c,qb/=256,zb-=8);ya[v+ic-$c]|=128*jc}},function(le,_a){var ya={}.toString;le.exports=Array.isArray||function(Ca){return"[object Array]"==ya.call(Ca)}},function(le,_a,ya){"use strict";ya.r(_a);var Ca={MODE:"production",NODE_ENV:"production"},v=(ya(4),ya(0));function Fa(E,{delay:F=0,duration:N=400,easing:L=v.p}){const P=+getComputedStyle(E).opacity;return{delay:F,duration:N,easing:L,css:R=>"opacity: "+R*P}}var bc=ya(1),cc=Object(bc.a)(function(E,F){E.exports=function(){var N=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function L(aa){return aa.split("").reverse().join("")}function P(aa,ma){return aa.substring(0,ma.length)===ma}function R(aa,ma,Y){if((aa[ma]||aa[Y])&&aa[ma]===aa[Y])throw new Error(ma)}function S(aa){return"number"==typeof aa&&isFinite(aa)}function ga(aa,ma,Y,qa,ba,ea,ta,Ta,fb,Nb,Ib,Aa){var Ic,Ob,Jb,Db,Jc,md=Aa,Dc="",Ec="";return ea&&(Aa=ea(Aa)),!!S(Aa)&&(!1!==aa&&0===parseFloat(Aa.toFixed(aa))&&(Aa=0),Aa<0&&(Ic=!0,Aa=Math.abs(Aa)),!1!==aa&&(Jc=aa,Db=(Db=Aa).toString().split("e"),Aa=(+((Db=(Db=Math.round(+(Db[0]+"e"+(Db[1]?+Db[1]+Jc:Jc)))).toString().split("e"))[0]+"e"+(Db[1]?+Db[1]-Jc:-Jc))).toFixed(Jc)),-1!==(Aa=Aa.toString()).indexOf(".")?(Jb=(Ob=Aa.split("."))[0],Y&&(Dc=Y+Ob[1])):Jb=Aa,ma&&(Jb=L(Jb).match(/.{1,3}/g),Jb=L(Jb.join(L(ma)))),Ic&&Ta&&(Ec+=Ta),qa&&(Ec+=qa),Ic&&fb&&(Ec+=fb),Ec+=Jb,Ec+=Dc,ba&&(Ec+=ba),Nb&&(Ec=Nb(Ec,md)),Ec)}function _(aa,ma,Y,qa,ba,ea,ta,Ta,fb,Nb,Ib,Aa){var Ic,Ob="";return Ib&&(Aa=Ib(Aa)),!(!Aa||"string"!=typeof Aa)&&(Ta&&P(Aa,Ta)&&(Aa=Aa.replace(Ta,""),Ic=!0),qa&&P(Aa,qa)&&(Aa=Aa.replace(qa,"")),fb&&P(Aa,fb)&&(Aa=Aa.replace(fb,""),Ic=!0),ba&&function(Jb,Db){return Jb.slice(-1*Db.length)===Db}(Aa,ba)&&(Aa=Aa.slice(0,-1*ba.length)),ma&&(Aa=Aa.split(ma).join("")),Y&&(Aa=Aa.replace(Y,".")),Ic&&(Ob+="-"),""!==(Ob=(Ob+=Aa).replace(/[^0-9\.\-.]/g,""))&&(Ob=Number(Ob),ta&&(Ob=ta(Ob)),!!S(Ob)&&Ob))}function la(aa,ma,Y){var qa,ba=[];for(qa=0;qa<N.length;qa+=1)ba.push(aa[N[qa]]);return ba.push(Y),ma.apply("",ba)}return function aa(ma){if(!(this instanceof aa))return new aa(ma);"object"==typeof ma&&(ma=function(Y){var qa,ba,ea,ta={};for(void 0===Y.suffix&&(Y.suffix=Y.postfix),qa=0;qa<N.length;qa+=1)if(void 0===(ea=Y[ba=N[qa]]))"negative"!==ba||ta.negativeBefore?"mark"===ba&&"."!==ta.thousand?ta[ba]=".":ta[ba]=!1:ta[ba]="-";else if("decimals"===ba){if(!(ea>=0&&ea<8))throw new Error(ba);ta[ba]=ea}else if("encoder"===ba||"decoder"===ba||"edit"===ba||"undo"===ba){if("function"!=typeof ea)throw new Error(ba);ta[ba]=ea}else{if("string"!=typeof ea)throw new Error(ba);ta[ba]=ea}return R(ta,"mark","thousand"),R(ta,"prefix","negative"),R(ta,"prefix","negativeBefore"),ta}(ma),this.to=function(Y){return la(ma,ga,Y)},this.from=function(Y){return la(ma,_,Y)})}}()}),qb=(ya(5),Object(bc.a)(function(E,F){E.exports=function(){var N="14.5.0";function L(M){M.parentElement.removeChild(M)}function P(M){return null!=M}function R(M){M.preventDefault()}function S(M){return"number"==typeof M&&!isNaN(M)&&isFinite(M)}function ga(M,G,pa){pa>0&&(ma(M,G),setTimeout(function(){Y(M,G)},pa))}function _(M){return Math.max(Math.min(M,100),0)}function la(M){return Array.isArray(M)?M:[M]}function aa(M){var G=(M=String(M)).split(".");return G.length>1?G[1].length:0}function ma(M,G){M.classList&&!/\s/.test(G)?M.classList.add(G):M.className+=" "+G}function Y(M,G){M.classList&&!/\s/.test(G)?M.classList.remove(G):M.className=M.className.replace(new RegExp("(^|\\b)"+G.split(" ").join("|")+"(\\b|$)","gi")," ")}function qa(M){var G=void 0!==window.pageXOffset,pa="CSS1Compat"===(M.compatMode||"");return{x:G?window.pageXOffset:pa?M.documentElement.scrollLeft:M.body.scrollLeft,y:G?window.pageYOffset:pa?M.documentElement.scrollTop:M.body.scrollTop}}function ba(M,G){return 100/(G-M)}function ea(M,G,pa){return 100*G/(M[pa+1]-M[pa])}function ta(M,G){for(var pa=1;M>=G[pa];)pa+=1;return pa}function Ta(M,G,pa){if(pa>=M.slice(-1)[0])return 100;var za=ta(pa,M),va=M[za-1],pb=M[za],sb=G[za-1],bb=G[za];return sb+function($a,Qb){return ea($a,$a[0]<0?Qb+Math.abs($a[0]):Qb-$a[0],0)}([va,pb],pa)/ba(sb,bb)}function fb(M,G,pa,za){if(100===za)return za;var va=ta(za,M),pb=M[va-1],sb=M[va];return pa?za-pb>(sb-pb)/2?sb:pb:G[va-1]?M[va-1]+function(bb,$a){return Math.round(bb/$a)*$a}(za-M[va-1],G[va-1]):za}function Nb(M,G,pa){var za;if("number"==typeof G&&(G=[G]),!Array.isArray(G))throw new Error("noUiSlider (14.5.0): 'range' contains invalid value.");if(!S(za="min"===M?0:"max"===M?100:parseFloat(M))||!S(G[0]))throw new Error("noUiSlider (14.5.0): 'range' value isn't numeric.");pa.xPct.push(za),pa.xVal.push(G[0]),za?pa.xSteps.push(!isNaN(G[1])&&G[1]):isNaN(G[1])||(pa.xSteps[0]=G[1]),pa.xHighestCompleteStep.push(0)}function Ib(M,G,pa){if(G)if(pa.xVal[M]!==pa.xVal[M+1]){pa.xSteps[M]=ea([pa.xVal[M],pa.xVal[M+1]],G,0)/ba(pa.xPct[M],pa.xPct[M+1]);var za=(pa.xVal[M+1]-pa.xVal[M])/pa.xNumSteps[M],va=Math.ceil(Number(za.toFixed(3))-1),pb=pa.xVal[M]+pa.xNumSteps[M]*va;pa.xHighestCompleteStep[M]=pb}else pa.xSteps[M]=pa.xHighestCompleteStep[M]=pa.xVal[M]}function Aa(M,G,pa){var za;this.xPct=[],this.xVal=[],this.xSteps=[pa||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=G;var va=[];for(za in M)M.hasOwnProperty(za)&&va.push([M[za],za]);for(va.length&&"object"==typeof va[0][0]?va.sort(function(pb,sb){return pb[0][0]-sb[0][0]}):va.sort(function(pb,sb){return pb[0]-sb[0]}),za=0;za<va.length;za++)Nb(va[za][1],va[za][0],this);for(this.xNumSteps=this.xSteps.slice(0),za=0;za<this.xNumSteps.length;za++)Ib(za,this.xNumSteps[za],this)}Aa.prototype.getDistance=function(M){var G,pa=[];for(G=0;G<this.xNumSteps.length-1;G++){var za=this.xNumSteps[G];if(za&&M/za%1!=0)throw new Error("noUiSlider (14.5.0): 'limit', 'margin' and 'padding' of "+this.xPct[G]+"% range must be divisible by step.");pa[G]=ea(this.xVal,M,G)}return pa},Aa.prototype.getAbsoluteDistance=function(M,G,pa){var za,va=0;if(M<this.xPct[this.xPct.length-1])for(;M>this.xPct[va+1];)va++;else M===this.xPct[this.xPct.length-1]&&(va=this.xPct.length-2);pa||M!==this.xPct[va+1]||va++;var pb=1,sb=G[va],bb=0,$a=0,Qb=0,Xb=0;for(za=pa?(M-this.xPct[va])/(this.xPct[va+1]-this.xPct[va]):(this.xPct[va+1]-M)/(this.xPct[va+1]-this.xPct[va]);sb>0;)bb=this.xPct[va+1+Xb]-this.xPct[va+Xb],G[va+Xb]*pb+100-100*za>100?($a=bb*za,pb=(sb-100*za)/G[va+Xb],za=1):($a=G[va+Xb]*bb/100*pb,pb=0),pa?(Qb-=$a,this.xPct.length+Xb>=1&&Xb--):(Qb+=$a,this.xPct.length-Xb>=1&&Xb++),sb=G[va+Xb]*pb;return M+Qb},Aa.prototype.toStepping=function(M){return M=Ta(this.xVal,this.xPct,M)},Aa.prototype.fromStepping=function(M){return function(G,pa,za){if(za>=100)return G.slice(-1)[0];var va=ta(za,pa),pb=G[va-1],sb=G[va],bb=pa[va-1];return function($a,Qb){return Qb*($a[1]-$a[0])/100+$a[0]}([pb,sb],(za-bb)*ba(bb,pa[va]))}(this.xVal,this.xPct,M)},Aa.prototype.getStep=function(M){return M=fb(this.xPct,this.xSteps,this.snap,M)},Aa.prototype.getDefaultStep=function(M,G,pa){var za=ta(M,this.xPct);return(100===M||G&&M===this.xPct[za-1])&&(za=Math.max(za-1,1)),(this.xVal[za]-this.xVal[za-1])/pa},Aa.prototype.getNearbySteps=function(M){var G=ta(M,this.xPct);return{stepBefore:{startValue:this.xVal[G-2],step:this.xNumSteps[G-2],highestStep:this.xHighestCompleteStep[G-2]},thisStep:{startValue:this.xVal[G-1],step:this.xNumSteps[G-1],highestStep:this.xHighestCompleteStep[G-1]},stepAfter:{startValue:this.xVal[G],step:this.xNumSteps[G],highestStep:this.xHighestCompleteStep[G]}}},Aa.prototype.countStepDecimals=function(){var M=this.xNumSteps.map(aa);return Math.max.apply(null,M)},Aa.prototype.convert=function(M){return this.getStep(this.toStepping(M))};var Ic={to:function(M){return void 0!==M&&M.toFixed(2)},from:Number},Ob={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"};function Jb(M){if(function(G){return"object"==typeof G&&"function"==typeof G.to&&"function"==typeof G.from}(M))return!0;throw new Error("noUiSlider (14.5.0): 'format' requires 'to' and 'from' methods.")}function Db(M,G){if(!S(G))throw new Error("noUiSlider (14.5.0): 'step' is not numeric.");M.singleStep=G}function Jc(M,G){if("object"!=typeof G||Array.isArray(G))throw new Error("noUiSlider (14.5.0): 'range' is not an object.");if(void 0===G.min||void 0===G.max)throw new Error("noUiSlider (14.5.0): Missing 'min' or 'max' in 'range'.");if(G.min===G.max)throw new Error("noUiSlider (14.5.0): 'range' 'min' and 'max' cannot be equal.");M.spectrum=new Aa(G,M.snap,M.singleStep)}function md(M,G){if(G=la(G),!Array.isArray(G)||!G.length)throw new Error("noUiSlider (14.5.0): 'start' option is incorrect.");M.handles=G.length,M.start=G}function Dc(M,G){if(M.snap=G,"boolean"!=typeof G)throw new Error("noUiSlider (14.5.0): 'snap' option must be a boolean.")}function Ec(M,G){if(M.animate=G,"boolean"!=typeof G)throw new Error("noUiSlider (14.5.0): 'animate' option must be a boolean.")}function nd(M,G){if(M.animationDuration=G,"number"!=typeof G)throw new Error("noUiSlider (14.5.0): 'animationDuration' option must be a number.")}function lc(M,G){var pa,za=[!1];if("lower"===G?G=[!0,!1]:"upper"===G&&(G=[!1,!0]),!0===G||!1===G){for(pa=1;pa<M.handles;pa++)za.push(G);za.push(!1)}else{if(!Array.isArray(G)||!G.length||G.length!==M.handles+1)throw new Error("noUiSlider (14.5.0): 'connect' option doesn't match handle count.");za=G}M.connect=za}function Ab(M,G){switch(G){case"horizontal":M.ort=0;break;case"vertical":M.ort=1;break;default:throw new Error("noUiSlider (14.5.0): 'orientation' option is invalid.")}}function ub(M,G){if(!S(G))throw new Error("noUiSlider (14.5.0): 'margin' option must be numeric.");0!==G&&(M.margin=M.spectrum.getDistance(G))}function Kc(M,G){if(!S(G))throw new Error("noUiSlider (14.5.0): 'limit' option must be numeric.");if(M.limit=M.spectrum.getDistance(G),!M.limit||M.handles<2)throw new Error("noUiSlider (14.5.0): 'limit' option is only supported on linear sliders with 2 or more handles.")}function cd(M,G){var pa;if(!S(G)&&!Array.isArray(G))throw new Error("noUiSlider (14.5.0): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(G)&&2!==G.length&&!S(G[0])&&!S(G[1]))throw new Error("noUiSlider (14.5.0): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==G){for(Array.isArray(G)||(G=[G,G]),M.padding=[M.spectrum.getDistance(G[0]),M.spectrum.getDistance(G[1])],pa=0;pa<M.spectrum.xNumSteps.length-1;pa++)if(M.padding[0][pa]<0||M.padding[1][pa]<0)throw new Error("noUiSlider (14.5.0): 'padding' option must be a positive number(s).");var za=G[0]+G[1],va=M.spectrum.xVal[0];if(za/(M.spectrum.xVal[M.spectrum.xVal.length-1]-va)>1)throw new Error("noUiSlider (14.5.0): 'padding' option must not exceed 100% of the range.")}}function Ld(M,G){switch(G){case"ltr":M.dir=0;break;case"rtl":M.dir=1;break;default:throw new Error("noUiSlider (14.5.0): 'direction' option was not recognized.")}}function Ee(M,G){if("string"!=typeof G)throw new Error("noUiSlider (14.5.0): 'behaviour' must be a string containing options.");var pa=G.indexOf("tap")>=0,za=G.indexOf("drag")>=0,va=G.indexOf("fixed")>=0,pb=G.indexOf("snap")>=0,sb=G.indexOf("hover")>=0,bb=G.indexOf("unconstrained")>=0;if(va){if(2!==M.handles)throw new Error("noUiSlider (14.5.0): 'fixed' behaviour must be used with 2 handles");ub(M,M.start[1]-M.start[0])}if(bb&&(M.margin||M.limit))throw new Error("noUiSlider (14.5.0): 'unconstrained' behaviour cannot be used with margin or limit");M.events={tap:pa||pb,drag:za,fixed:va,snap:pb,hover:sb,unconstrained:bb}}function Md(M,G){if(!1!==G)if(!0===G){M.tooltips=[];for(var pa=0;pa<M.handles;pa++)M.tooltips.push(!0)}else{if(M.tooltips=la(G),M.tooltips.length!==M.handles)throw new Error("noUiSlider (14.5.0): must pass a formatter for all handles.");M.tooltips.forEach(function(za){if("boolean"!=typeof za&&("object"!=typeof za||"function"!=typeof za.to))throw new Error("noUiSlider (14.5.0): 'tooltips' must be passed a formatter or 'false'.")})}}function Fe(M,G){M.ariaFormat=G,Jb(G)}function sf(M,G){M.format=G,Jb(G)}function Pc(M,G){if(M.keyboardSupport=G,"boolean"!=typeof G)throw new Error("noUiSlider (14.5.0): 'keyboardSupport' option must be a boolean.")}function vd(M,G){M.documentElement=G}function ra(M,G){if("string"!=typeof G&&!1!==G)throw new Error("noUiSlider (14.5.0): 'cssPrefix' must be a string or `false`.");M.cssPrefix=G}function Ya(M,G){if("object"!=typeof G)throw new Error("noUiSlider (14.5.0): 'cssClasses' must be an object.");if("string"==typeof M.cssPrefix)for(var pa in(M.cssClasses={},G))G.hasOwnProperty(pa)&&(M.cssClasses[pa]=M.cssPrefix+G[pa]);else M.cssClasses=G}function Pb(M){var G={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:Ic,format:Ic},pa={step:{r:!1,t:Db},start:{r:!0,t:md},connect:{r:!0,t:lc},direction:{r:!0,t:Ld},snap:{r:!1,t:Dc},animate:{r:!1,t:Ec},animationDuration:{r:!1,t:nd},range:{r:!0,t:Jc},orientation:{r:!1,t:Ab},margin:{r:!1,t:ub},limit:{r:!1,t:Kc},padding:{r:!1,t:cd},behaviour:{r:!0,t:Ee},ariaFormat:{r:!1,t:Fe},format:{r:!1,t:sf},tooltips:{r:!1,t:Md},keyboardSupport:{r:!0,t:Pc},documentElement:{r:!1,t:vd},cssPrefix:{r:!0,t:ra},cssClasses:{r:!0,t:Ya}},za={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Ob};M.format&&!M.ariaFormat&&(M.ariaFormat=M.format),Object.keys(pa).forEach(function(bb){if(!P(M[bb])&&void 0===za[bb]){if(pa[bb].r)throw new Error("noUiSlider (14.5.0): '"+bb+"' is required.");return!0}pa[bb].t(G,P(M[bb])?M[bb]:za[bb])}),G.pips=M.pips;var va=document.createElement("div"),pb=void 0!==va.style.msTransform,sb=void 0!==va.style.transform;return G.transformRule=sb?"transform":pb?"msTransform":"webkitTransform",G.style=[["left","top"],["right","bottom"]][G.dir][G.ort],G}function ec(M,G,pa){var za,va,pb,sb,bb,$a,Qb,Xb,wd=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},Lc=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var Z=!1;try{var fa=Object.defineProperty({},"passive",{get:function(){Z=!0}});window.addEventListener("test",null,fa)}catch(sa){}return Z}(),qc=M,kb=G.spectrum,gc=[],Rb=[],mc=[],dd=0,Uc={},od=M.ownerDocument,vc=G.documentElement||od.documentElement,xd=od.body,Kb="rtl"===od.dir||1===G.ort?0:100;function Fc(Z,fa){var sa=od.createElement("div");return fa&&ma(sa,fa),Z.appendChild(sa),sa}function oe(Z,fa){var sa=Fc(Z,G.cssClasses.origin),U=Fc(sa,G.cssClasses.handle);return Fc(U,G.cssClasses.touchArea),U.setAttribute("data-handle",fa),G.keyboardSupport&&(U.setAttribute("tabindex","0"),U.addEventListener("keydown",function(ka){return function(Na,Wa){if(Oa()||da(Wa))return!1;var Lb=["Left","Right"],Tb=["Down","Up"],Ha=["PageDown","PageUp"],Eb=["Home","End"];G.dir&&!G.ort?Lb.reverse():G.ort&&!G.dir&&(Tb.reverse(),Ha.reverse());var qd,rc=Na.key.replace("Arrow",""),Id=rc===Ha[0],Bg=rc===Ha[1],qe=rc===Tb[0]||rc===Lb[0]||Id,Ge=rc===Tb[1]||rc===Lb[1]||Bg,re=rc===Eb[0],He=rc===Eb[1];if(!(qe||Ge||re||He))return!0;if(Na.preventDefault(),Ge||qe){var Ie=qe?0:1,Xc=de(Wa)[Ie];if(null===Xc)return!1;!1===Xc&&(Xc=kb.getDefaultStep(Rb[Wa],qe,10)),(Bg||Id)&&(Xc*=5),Xc=Math.max(Xc,1e-7),Xc*=qe?-1:1,qd=gc[Wa]+Xc}else qd=He?G.spectrum.xVal[G.spectrum.xVal.length-1]:G.spectrum.xVal[0];return Hd(Wa,kb.toStepping(qd),!0,!0),nc("slide",Wa),nc("update",Wa),nc("change",Wa),nc("set",Wa),!1}(ka,fa)})),U.setAttribute("role","slider"),U.setAttribute("aria-orientation",G.ort?"vertical":"horizontal"),0===fa?ma(U,G.cssClasses.handleLower):fa===G.handles-1&&ma(U,G.cssClasses.handleUpper),sa}function ob(Z,fa){return!!fa&&Fc(Z,G.cssClasses.connect)}function hc(Z,fa){return!!G.tooltips[fa]&&Fc(Z.firstChild,G.cssClasses.tooltip)}function Oa(){return qc.hasAttribute("disabled")}function da(Z){return va[Z].hasAttribute("disabled")}function lb(){bb&&(ed("update.tooltips"),bb.forEach(function(Z){Z&&L(Z)}),bb=null)}function ua(){lb(),bb=va.map(hc),gb("update.tooltips",function(Z,fa,sa){if(bb[fa]){var U=Z[fa];!0!==G.tooltips[fa]&&(U=G.tooltips[fa].to(sa[fa])),bb[fa].innerHTML=U}})}function zc(Z,fa,sa){var U=od.createElement("div"),ka=[];ka[0]=G.cssClasses.valueNormal,ka[1]=G.cssClasses.valueLarge,ka[2]=G.cssClasses.valueSub;var Na=[];Na[0]=G.cssClasses.markerNormal,Na[1]=G.cssClasses.markerLarge,Na[2]=G.cssClasses.markerSub;var Wa=[G.cssClasses.valueHorizontal,G.cssClasses.valueVertical],Lb=[G.cssClasses.markerHorizontal,G.cssClasses.markerVertical];function Tb(Ha,Eb){var qd=Eb===G.cssClasses.value,rc=qd?ka:Na;return Eb+" "+(qd?Wa:Lb)[G.ort]+" "+rc[Ha]}return ma(U,G.cssClasses.pips),ma(U,0===G.ort?G.cssClasses.pipsHorizontal:G.cssClasses.pipsVertical),Object.keys(Z).forEach(function(Ha){!function(Eb,qd,rc){if(-1!==(rc=fa?fa(qd,rc):rc)){var Id=Fc(U,!1);Id.className=Tb(rc,G.cssClasses.marker),Id.style[G.style]=Eb+"%",rc>0&&((Id=Fc(U,!1)).className=Tb(rc,G.cssClasses.value),Id.setAttribute("data-value",qd),Id.style[G.style]=Eb+"%",Id.innerHTML=sa.to(qd))}}(Ha,Z[Ha][0],Z[Ha][1])}),U}function vb(){sb&&(L(sb),sb=null)}function Vc(Z){vb();var fa=Z.mode,sa=Z.density||1,U=Z.filter||!1,ka=function(Lb,Tb,Ha){if("range"===Lb||"steps"===Lb)return kb.xVal;if("count"===Lb){if(Tb<2)throw new Error("noUiSlider (14.5.0): 'values' (>= 2) required for mode 'count'.");var Eb=Tb-1,qd=100/Eb;for(Tb=[];Eb--;)Tb[Eb]=Eb*qd;Tb.push(100),Lb="positions"}return"positions"===Lb?Tb.map(function(rc){return kb.fromStepping(Ha?kb.getStep(rc):rc)}):"values"===Lb?Ha?Tb.map(function(rc){return kb.fromStepping(kb.getStep(kb.toStepping(rc)))}):Tb:void 0}(fa,Z.values||!1,Z.stepped||!1),Na=function(Lb,Tb,Ha){var Eb,qd={},rc=kb.xVal[0],Id=kb.xVal[kb.xVal.length-1],Bg=!1,qe=!1,Ge=0;return Eb=Ha.slice().sort(function(re,He){return re-He}),(Ha=Eb.filter(function(re){return!this[re]&&(this[re]=!0)},{}))[0]!==rc&&(Ha.unshift(rc),Bg=!0),Ha[Ha.length-1]!==Id&&(Ha.push(Id),qe=!0),Ha.forEach(function(re,He){var Ie,Xc,Ai,Ra,Ub,Sk,Cj,Xm,Ym,Zm,Nd=re,Kh=Ha[He+1],Mb="steps"===Tb;if(Mb&&(Ie=kb.xNumSteps[He]),Ie||(Ie=Kh-Nd),!1!==Nd&&void 0!==Kh)for(Ie=Math.max(Ie,1e-7),Xc=Nd;Xc<=Kh;Xc=(Xc+Ie).toFixed(7)/1){for(Xm=(Ub=(Ra=kb.toStepping(Xc))-Ge)/Lb,Zm=Ub/(Ym=Math.round(Xm)),Ai=1;Ai<=Ym;Ai+=1)qd[(Sk=Ge+Ai*Zm).toFixed(5)]=[kb.fromStepping(Sk),0];Cj=Ha.indexOf(Xc)>-1?1:Mb?2:0,!He&&Bg&&Xc!==Kh&&(Cj=0),Xc===Kh&&qe||(qd[Ra.toFixed(5)]=[Xc,Cj]),Ge=Ra}}),qd}(sa,fa,ka),Wa=Z.format||{to:Math.round};return sb=qc.appendChild(zc(Na,U,Wa))}function Wc(){var Z=za.getBoundingClientRect(),fa="offset"+["Width","Height"][G.ort];return 0===G.ort?Z.width||za[fa]:Z.height||za[fa]}function Bb(Z,fa,sa,U){var ka=function(Wa){return!!(Wa=function(Ha,Eb,qd){var rc,Id,Bg=0===Ha.type.indexOf("touch"),qe=0===Ha.type.indexOf("mouse"),Ge=0===Ha.type.indexOf("pointer");if(0===Ha.type.indexOf("MSPointer")&&(Ge=!0),Bg){var re=function(Xc){return Xc.target===qd||qd.contains(Xc.target)||Xc.target.shadowRoot&&Xc.target.shadowRoot.contains(qd)};if("touchstart"===Ha.type){var He=Array.prototype.filter.call(Ha.touches,re);if(He.length>1)return!1;rc=He[0].pageX,Id=He[0].pageY}else{var Ie=Array.prototype.find.call(Ha.changedTouches,re);if(!Ie)return!1;rc=Ie.pageX,Id=Ie.pageY}}return Eb=Eb||qa(od),(qe||Ge)&&(rc=Ha.clientX+Eb.x,Id=Ha.clientY+Eb.y),Ha.pageOffset=Eb,Ha.points=[rc,Id],Ha.cursor=qe||Ge,Ha}(Wa,U.pageOffset,U.target||fa))&&!(Oa()&&!U.doNotReject)&&(Lb=qc,Tb=G.cssClasses.tap,!((Lb.classList?Lb.classList.contains(Tb):new RegExp("\\b"+Tb+"\\b").test(Lb.className))&&!U.doNotReject)&&!(Z===wd.start&&void 0!==Wa.buttons&&Wa.buttons>1)&&(!U.hover||!Wa.buttons)&&(Lc||Wa.preventDefault(),Wa.calcPoint=Wa.points[G.ort],void sa(Wa,U)));var Lb,Tb},Na=[];return Z.split(" ").forEach(function(Wa){fa.addEventListener(Wa,ka,!!Lc&&{passive:!0}),Na.push([Wa,ka])}),Na}function Mc(Z){var fa,sa,U,ka,Na,Wa,Lb=100*(Z-(fa=za,sa=G.ort,U=fa.getBoundingClientRect(),ka=fa.ownerDocument,Na=ka.documentElement,Wa=qa(ka),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(Wa.x=0),sa?U.top+Wa.y-Na.clientTop:U.left+Wa.x-Na.clientLeft))/Wc();return Lb=_(Lb),G.dir?100-Lb:Lb}function Sb(Z,fa){"mouseout"===Z.type&&"HTML"===Z.target.nodeName&&null===Z.relatedTarget&&ad(Z,fa)}function Dd(Z,fa){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===Z.buttons&&0!==fa.buttonsProperty)return ad(Z,fa);var sa=(G.dir?-1:1)*(Z.calcPoint-fa.startCalcPoint);ja(sa>0,100*sa/fa.baseSize,fa.locations,fa.handleNumbers)}function ad(Z,fa){fa.handle&&(Y(fa.handle,G.cssClasses.active),dd-=1),fa.listeners.forEach(function(sa){vc.removeEventListener(sa[0],sa[1])}),0===dd&&(Y(qc,G.cssClasses.drag),ce(),Z.cursor&&(xd.style.cursor="",xd.removeEventListener("selectstart",R))),fa.handleNumbers.forEach(function(sa){nc("change",sa),nc("set",sa),nc("end",sa)})}function Qc(Z,fa){if(fa.handleNumbers.some(da))return!1;var sa;1===fa.handleNumbers.length&&(sa=va[fa.handleNumbers[0]].children[0],dd+=1,ma(sa,G.cssClasses.active)),Z.stopPropagation();var U=[],ka=Bb(wd.move,vc,Dd,{target:Z.target,handle:sa,listeners:U,startCalcPoint:Z.calcPoint,baseSize:Wc(),pageOffset:Z.pageOffset,handleNumbers:fa.handleNumbers,buttonsProperty:Z.buttons,locations:Rb.slice()}),Na=Bb(wd.end,vc,ad,{target:Z.target,handle:sa,listeners:U,doNotReject:!0,handleNumbers:fa.handleNumbers}),Wa=Bb("mouseout",vc,Sb,{target:Z.target,handle:sa,listeners:U,doNotReject:!0,handleNumbers:fa.handleNumbers});U.push.apply(U,ka.concat(Na,Wa)),Z.cursor&&(xd.style.cursor=getComputedStyle(Z.target).cursor,va.length>1&&ma(qc,G.cssClasses.drag),xd.addEventListener("selectstart",R,!1)),fa.handleNumbers.forEach(function(Lb){nc("start",Lb)})}function pd(Z){Z.stopPropagation();var fa=Mc(Z.calcPoint),sa=function(U){var ka=100,Na=!1;return va.forEach(function(Wa,Lb){if(!da(Lb)){var Tb=Rb[Lb],Ha=Math.abs(Tb-U);(Ha<ka||Ha<=ka&&U>Tb||100===Ha&&100===ka)&&(Na=Lb,ka=Ha)}}),Na}(fa);if(!1===sa)return!1;G.events.snap||ga(qc,G.cssClasses.tap,G.animationDuration),Hd(sa,fa,!0,!0),ce(),nc("slide",sa,!0),nc("update",sa,!0),nc("change",sa,!0),nc("set",sa,!0),G.events.snap&&Qc(Z,{handleNumbers:[sa]})}function Zb(Z){var fa=Mc(Z.calcPoint),sa=kb.getStep(fa),U=kb.fromStepping(sa);Object.keys(Uc).forEach(function(ka){"hover"===ka.split(".")[0]&&Uc[ka].forEach(function(Na){Na.call($a,U)})})}function gb(Z,fa){Uc[Z]=Uc[Z]||[],Uc[Z].push(fa),"update"===Z.split(".")[0]&&va.forEach(function(sa,U){nc("update",U)})}function ed(Z){var fa=Z&&Z.split(".")[0],sa=fa&&Z.substring(fa.length);Object.keys(Uc).forEach(function(U){var ka=U.split(".")[0],Na=U.substring(ka.length);fa&&fa!==ka||sa&&sa!==Na||delete Uc[U]})}function nc(Z,fa,sa){Object.keys(Uc).forEach(function(U){var ka=U.split(".")[0];Z===ka&&Uc[U].forEach(function(Na){Na.call($a,gc.map(G.format.to),fa,gc.slice(),sa||!1,Rb.slice(),$a)})})}function Ih(Z,fa,sa,U,ka,Na){var Wa;return va.length>1&&!G.events.unconstrained&&(U&&fa>0&&(Wa=kb.getAbsoluteDistance(Z[fa-1],G.margin,0),sa=Math.max(sa,Wa)),ka&&fa<va.length-1&&(Wa=kb.getAbsoluteDistance(Z[fa+1],G.margin,1),sa=Math.min(sa,Wa))),va.length>1&&G.limit&&(U&&fa>0&&(Wa=kb.getAbsoluteDistance(Z[fa-1],G.limit,0),sa=Math.min(sa,Wa)),ka&&fa<va.length-1&&(Wa=kb.getAbsoluteDistance(Z[fa+1],G.limit,1),sa=Math.max(sa,Wa))),G.padding&&(0===fa&&(Wa=kb.getAbsoluteDistance(0,G.padding[0],0),sa=Math.max(sa,Wa)),fa===va.length-1&&(Wa=kb.getAbsoluteDistance(100,G.padding[1],1),sa=Math.min(sa,Wa))),!((sa=_(sa=kb.getStep(sa)))===Z[fa]&&!Na)&&sa}function Jh(Z,fa){var sa=G.ort;return(sa?fa:Z)+", "+(sa?Z:fa)}function ja(Z,fa,sa,U){var ka=sa.slice(),Na=[!Z,Z],Wa=[Z,!Z];U=U.slice(),Z&&U.reverse(),U.length>1?U.forEach(function(Tb,Ha){var Eb=Ih(ka,Tb,ka[Tb]+fa,Na[Ha],Wa[Ha],!1);!1===Eb?fa=0:(fa=Eb-ka[Tb],ka[Tb]=Eb)}):Na=Wa=[!0];var Lb=!1;U.forEach(function(Tb,Ha){Lb=Hd(Tb,sa[Tb]+fa,Na[Ha],Wa[Ha])||Lb}),Lb&&U.forEach(function(Tb){nc("update",Tb),nc("slide",Tb)})}function $e(Z,fa){return G.dir?100-Z-fa:Z}function ce(){mc.forEach(function(Z){var fa=Rb[Z]>50?-1:1,sa=3+(va.length+fa*Z);va[Z].style.zIndex=sa})}function Hd(Z,fa,sa,U){return!1!==(fa=Ih(Rb,Z,fa,sa,U,!1))&&(function(ka,Na){Rb[ka]=Na,gc[ka]=kb.fromStepping(Na);var Wa="translate("+Jh(10*($e(Na,0)-Kb)+"%","0")+")";va[ka].style[G.transformRule]=Wa,yb(ka),yb(ka+1)}(Z,fa),!0)}function yb(Z){if(pb[Z]){var fa=0,sa=100;0!==Z&&(fa=Rb[Z-1]),Z!==pb.length-1&&(sa=Rb[Z]);var U=sa-fa,ka="translate("+Jh($e(fa,U)+"%","0")+")",Na="scale("+Jh(U/100,"1")+")";pb[Z].style[G.transformRule]=ka+" "+Na}}function fc(Z,fa){return null===Z||!1===Z||void 0===Z?Rb[fa]:("number"==typeof Z&&(Z=String(Z)),Z=G.format.from(Z),!1===(Z=kb.toStepping(Z))||isNaN(Z)?Rb[fa]:Z)}function pe(Z,fa){var sa=la(Z),U=void 0===Rb[0];fa=void 0===fa||!!fa,G.animate&&!U&&ga(qc,G.cssClasses.tap,G.animationDuration),mc.forEach(function(Na){Hd(Na,fc(sa[Na],Na),!0,!1)});for(var ka=1===mc.length?0:1;ka<mc.length;++ka)mc.forEach(function(Na){Hd(Na,Rb[Na],!0,!0)});ce(),mc.forEach(function(Na){nc("update",Na),null!==sa[Na]&&fa&&nc("set",Na)})}function Ef(){var Z=gc.map(G.format.to);return 1===Z.length?Z[0]:Z}function de(Z){var fa=Rb[Z],sa=kb.getNearbySteps(fa),U=gc[Z],ka=sa.thisStep.step,Na=null;if(G.snap)return[U-sa.stepBefore.startValue||null,sa.stepAfter.startValue-U||null];!1!==ka&&U+ka>sa.stepAfter.startValue&&(ka=sa.stepAfter.startValue-U),Na=U>sa.thisStep.startValue?sa.thisStep.step:!1!==sa.stepBefore.step&&U-sa.stepBefore.highestStep,100===fa?ka=null:0===fa&&(Na=null);var Wa=kb.countStepDecimals();return null!==ka&&!1!==ka&&(ka=Number(ka.toFixed(Wa))),null!==Na&&!1!==Na&&(Na=Number(Na.toFixed(Wa))),[Na,ka]}return ma(Qb=qc,G.cssClasses.target),0===G.dir?ma(Qb,G.cssClasses.ltr):ma(Qb,G.cssClasses.rtl),0===G.ort?ma(Qb,G.cssClasses.horizontal):ma(Qb,G.cssClasses.vertical),ma(Qb,"rtl"===getComputedStyle(Qb).direction?G.cssClasses.textDirectionRtl:G.cssClasses.textDirectionLtr),za=Fc(Qb,G.cssClasses.base),function(Z,fa){var sa=Fc(fa,G.cssClasses.connects);va=[],(pb=[]).push(ob(sa,Z[0]));for(var U=0;U<G.handles;U++)va.push(oe(fa,U)),mc[U]=U,pb.push(ob(sa,Z[U+1]))}(G.connect,za),(Xb=G.events).fixed||va.forEach(function(Z,fa){Bb(wd.start,Z.children[0],Qc,{handleNumbers:[fa]})}),Xb.tap&&Bb(wd.start,za,pd,{}),Xb.hover&&Bb(wd.move,za,Zb,{hover:!0}),Xb.drag&&pb.forEach(function(Z,fa){if(!1!==Z&&0!==fa&&fa!==pb.length-1){var sa=va[fa-1],U=va[fa],ka=[Z];ma(Z,G.cssClasses.draggable),Xb.fixed&&(ka.push(sa.children[0]),ka.push(U.children[0])),ka.forEach(function(Na){Bb(wd.start,Na,Qc,{handles:[sa,U],handleNumbers:[fa-1,fa]})})}}),pe(G.start),G.pips&&Vc(G.pips),G.tooltips&&ua(),gb("update",function(Z,fa,sa,U,ka){mc.forEach(function(Na){var Wa=va[Na],Lb=Ih(Rb,Na,0,!0,!0,!0),Tb=Ih(Rb,Na,100,!0,!0,!0),Ha=ka[Na],Eb=G.ariaFormat.to(sa[Na]);Lb=kb.fromStepping(Lb).toFixed(1),Tb=kb.fromStepping(Tb).toFixed(1),Ha=kb.fromStepping(Ha).toFixed(1),Wa.children[0].setAttribute("aria-valuemin",Lb),Wa.children[0].setAttribute("aria-valuemax",Tb),Wa.children[0].setAttribute("aria-valuenow",Ha),Wa.children[0].setAttribute("aria-valuetext",Eb)})}),$a={destroy:function(){for(var Z in G.cssClasses)G.cssClasses.hasOwnProperty(Z)&&Y(qc,G.cssClasses[Z]);for(;qc.firstChild;)qc.removeChild(qc.firstChild);delete qc.noUiSlider},steps:function(){return mc.map(de)},on:gb,off:ed,get:Ef,set:pe,setHandle:function(Z,fa,sa){if(!((Z=Number(Z))>=0&&Z<mc.length))throw new Error("noUiSlider (14.5.0): invalid handle number, got: "+Z);Hd(Z,fc(fa,Z),!0,!0),nc("update",Z),sa&&nc("set",Z)},reset:function(Z){pe(G.start,Z)},__moveHandles:function(Z,fa,sa){ja(Z,fa,Rb,sa)},options:pa,updateOptions:function(Z,fa){var sa=Ef(),U=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];U.forEach(function(Na){void 0!==Z[Na]&&(pa[Na]=Z[Na])});var ka=Pb(pa);U.forEach(function(Na){void 0!==Z[Na]&&(G[Na]=ka[Na])}),kb=ka.spectrum,G.margin=ka.margin,G.limit=ka.limit,G.padding=ka.padding,G.pips?Vc(G.pips):vb(),G.tooltips?ua():lb(),Rb=[],pe(Z.start||sa,fa)},target:qc,removePips:vb,removeTooltips:lb,getTooltips:function(){return bb},getOrigins:function(){return va},pips:Vc}}return{__spectrum:Aa,version:N,cssClasses:Ob,create:function(M,G){if(!M||!M.nodeName)throw new Error("noUiSlider (14.5.0): create requires a single element, got: "+M);if(M.noUiSlider)throw new Error("noUiSlider (14.5.0): Slider was already initialized.");var pa=ec(M,Pb(G),G);return M.noUiSlider=pa,pa}}}()}));function ha(E){let F;return{c(){F=Object(v.m)("div"),Object(v.e)(F,"class","rangeSlider")},m(N,L){Object(v.r)(N,F,L),E[11](F)},p:v.u,i:v.u,o:v.u,d(N){N&&Object(v.l)(F),E[11](null)}}}function td(E,F,N){let L,P,{tooltip:R=!1}=F,{min:S=0}=F,{max:ga=100}=F,{margin:_=0}=F,{values:la=[0]}=F,{step:aa=null}=F,{updateWhenSliding:ma=!1}=F,{disabled:Y=!1}=F;function qa(ba){N(1,la=ba.map(R.from))}return Object(v.w)(()=>{L=qb.create(P,{start:la,step:aa,margin:_,behaviour:"drag-tap",connect:la.length>1,range:{min:S,max:ga},tooltips:1===la.length?[R]:[R,R]}),Y&&P.setAttribute("disabled",!0),L.on("set",qa),L.on("slide",ba=>{ma&&qa(ba)})}),Object(v.v)(()=>{L&&L.off()}),E.$set=ba=>{"tooltip"in ba&&N(2,R=ba.tooltip),"min"in ba&&N(3,S=ba.min),"max"in ba&&N(4,ga=ba.max),"margin"in ba&&N(5,_=ba.margin),"values"in ba&&N(1,la=ba.values),"step"in ba&&N(6,aa=ba.step),"updateWhenSliding"in ba&&N(7,ma=ba.updateWhenSliding),"disabled"in ba&&N(8,Y=ba.disabled)},E.$$.update=()=>{257&E.$$.dirty&&P&&(Y?P.setAttribute("disabled",!0):P.removeAttribute("disabled"))},[P,la,R,S,ga,_,aa,ma,Y,L,qa,function(ba){v.g[ba?"unshift":"push"](()=>{N(0,P=ba)})}]}class zb extends v.a{constructor(E){super(),Object(v.q)(this,E,td,ha,v.y,{tooltip:2,min:3,max:4,margin:5,values:1,step:6,updateWhenSliding:7,disabled:8})}}var Ua=zb;ya(6);var eb=ya(3),Wb=Object(bc.a)(function(E,F){var N;Object.defineProperty(F,"__esModule",{value:!0}),function(P){P[P.Converged=0]="Converged",P[P.MaxStepsExceeded=1]="MaxStepsExceeded",P[P.EarlyReturn=2]="EarlyReturn"}(N=F.Outcome||(F.Outcome={}));var L=function(){function P(R){this.n=R,this.uRound=23e-17,this.maxSteps=1e4,this.initialStepSize=1e-4,this.maxStepSize=0,this.maxExtrapolationColumns=9,this.stepSizeSequence=0,this.stabilityCheckCount=1,this.stabilityCheckTableLines=2,this.denseOutput=!1,this.denseOutputErrorEstimator=!0,this.denseComponents=void 0,this.interpolationFormulaDegree=4,this.stepSizeReductionFactor=.5,this.stepSizeFac1=.02,this.stepSizeFac2=4,this.stepSizeFac3=.8,this.stepSizeFac4=.9,this.stepSafetyFactor1=.65,this.stepSafetyFactor2=.94,this.relativeTolerance=1e-5,this.absoluteTolerance=1e-5,this.debug=!1}return P.prototype.grid=function(R,S){if(!this.denseOutput)throw new Error("Must set .denseOutput to true when using grid");var ga,_=this.denseComponents;if(!_){_=[];for(var la=0;la<this.n;++la)_.push(la)}return function(aa,ma,Y,qa,ba){if(1===aa){var ea=S(Y,qa);return ga=Y+R,ea}for(;ga<=Y;){for(var ta=[],Ta=0,fb=_;Ta<fb.length;Ta++){var Nb=fb[Ta];ta.push(ba(Nb,ga))}if(!1===(ea=S(ga,ta)))return!1;ga+=R}}},P.dim2=function(R,S){for(var ga=new Array(R+1),_=1;_<=R;++_)ga[_]=P.dim(S);return ga},P.stepSizeSequence=function(R,S){var ga=new Array(S+1);switch(ga[0]=0,R){case 1:for(var _=1;_<=S;++_)ga[_]=2*_;break;case 2:for(ga[1]=2,_=2;_<=S;++_)ga[_]=4*_-4;break;case 3:for(ga[1]=2,ga[2]=4,ga[3]=6,_=4;_<=S;++_)ga[_]=2*ga[_-2];break;case 4:for(_=1;_<=S;++_)ga[_]=4*_-2;break;case 5:for(_=1;_<=S;++_)ga[_]=4*_;break;default:throw new Error("invalid stepSizeSequence selected")}return ga},P.prototype.solve=function(R,S,ga,_,la){var aa=this,ma=[0].concat(ga),Y=P.dim(this.n),qa=P.dim(this.n),ba=P.dim(this.n);if(this.maxSteps<=0)throw new Error("maxSteps must be positive");var ea=this.maxExtrapolationColumns;if(ea<=2)throw new Error("maxExtrapolationColumns must be > 2");var ta=this.stepSizeSequence||(this.denseOutput?4:1);if(ta<=3&&this.denseOutput)throw new Error("stepSizeSequence incompatible with denseOutput");if(this.denseOutput&&!la)throw new Error("denseOutput requires a solution observer function");if(this.interpolationFormulaDegree<=0||this.interpolationFormulaDegree>=7)throw new Error("bad interpolationFormulaDegree");var Ta=[0],fb=0;if(this.denseOutput)if(this.denseComponents)for(var Nb=0,Ib=this.denseComponents;Nb<Ib.length;Nb++){var Aa=Ib[Nb];if(Aa<0||Aa>this.n)throw new Error("bad dense component: "+Aa);Ta.push(Aa+1),++fb}else{for(var Ic=1;Ic<=this.n;++Ic)Ta.push(Ic);fb=this.n}if(this.uRound<=1e-35||this.uRound>1)throw new Error("suspicious value of uRound");var Ob=Math.abs(this.maxStepSize||_-S),Jb=2*ea*ea+ea;function Db(Fe,sf){var Pc=[0];if(Array.isArray(Fe))return Pc.concat(Fe);for(var vd=0;vd<sf;++vd)Pc.push(Fe);return Pc}var Jc=Db(this.absoluteTolerance,this.n),md=Db(this.relativeTolerance,this.n),Dc=[0,0,0,0],Ec=Dc[0],nd=Dc[1],lc=Dc[2],Ab=Dc[3],ub=Math.max(1,fb),Kc=Math.max(1,(2*ea+5)*fb),cd=P.dim(Kc),Ld=P.dim2(Jb,ub),Ee=function(Fe,sf,Pc){for(var vd=R(Fe,sf.slice(1)),ra=0;ra<vd.length;++ra)Pc[ra+1]=vd[ra]},Md=function(){var Fe,sf,Pc,vd=function(Oa){if(wd=S,S+=$a,aa.denseOutput){Pc=2*ob-aa.interpolationFormulaDegree+1;for(var da=1;da<=ub;++da)cd[da]=ma[Ta[da]];for(Fe=wd,sf=$a,da=1;da<=ub;++da)cd[ub+da]=$a*Y[Ta[da]];var lb=2*ub;for(da=1;da<=ub;++da)cd[lb+da]=G[1][Ta[da]];for(var ua=2;ua<=ob;++ua)for(var zc=pa[ua],vb=ua;vb>=2;--vb){var Vc=Math.pow(zc/pa[vb-1],2)-1;for(da=1;da<=ub;++da)ec[vb-1][da]=ec[vb][da]+(ec[vb][da]-ec[vb-1][da])/Vc}var Wc=4*ub;for(da=1;da<=ub;++da)cd[Wc+da]=ec[1][da];for(da=1;da<=Oa;++da)qa[da]=G[1][da];for(Ee(S,qa,ba),Wc=3*ub,da=1;da<=ub;++da)cd[Wc+da]=ba[Ta[da]]*$a;for(var Bb=1;Bb<=Pc;++Bb){for(var Mc=(Bb+1)/2|0,Sb=Mc;Sb<=ob;++Sb){var Dd=Math.pow(pa[Sb]/2,Bb-1);for(Lc=Qb[Sb+1]-2*Sb+Bb,da=1;da<=ub;++da)ec[Sb][da]=Ld[Lc][da]*Dd}for(ua=Mc+1;ua<=ob;++ua)for(zc=pa[ua],vb=ua;vb>=Mc+1;--vb)for(Vc=Math.pow(zc/pa[vb-1],2)-1,da=1;da<=ub;++da)ec[vb-1][da]=ec[vb][da]+(ec[vb][da]-ec[vb-1][da])/Vc;for(Wc=(Bb+4)*ub,da=1;da<=ub;++da)cd[Wc+da]=ec[Mc][da]*$a;if(Bb!==Pc){for(Sb=(Bb+2)/2|0;Sb<=ob;++Sb){var ad=Qb[Sb+1],Qc=Qb[Sb]+Bb+1;for(1===Bb&&4===ta&&(Qc+=2),vb=void 0,vb=ad;vb>=Qc;vb-=2)for(da=1;da<=ub;++da)Ld[vb][da]-=Ld[vb-2][da];if(1===Bb&&4===ta)for(vb=Qc-2,da=1;da<=ub;++da)Ld[vb][da]-=Y[Ta[da]]}for(Sb=(Bb+2)/2|0;Sb<=ob;++Sb)for(ad=Qb[Sb+1]-1,Qc=Qb[Sb]+Bb+2,vb=ad;vb>=Qc;vb-=2)for(da=1;da<=ub;++da)Ld[vb][da]-=Ld[vb-2][da]}}if(Ya(ub,cd,Pc),aa.denseOutputErrorEstimator&&Pc>=1){var pd=0;for(da=1;da<=ub;++da)pd+=Math.pow(cd[(Pc+4)*ub+da]/pb[Ta[da]],2);if(pd=Math.sqrt(pd/ub)*Xb[Pc],od=$a/Math.max(Math.pow(pd,1/(Pc+4)),.01),pd>10)return $a=od,S=wd,++Ab,Fc=!0,!0}for(da=1;da<=Oa;++da)Y[da]=ba[da]}for(da=1;da<=Oa;++da)ma[da]=G[1][da];return++lc,(!la||!1!==la(lc+1,wd,S,ma.slice(1),aa.denseOutput&&Pb(Fe,sf,Pc,cd,Ta)))&&(2===ob?(Zb=Math.min(3,ea-1),Fc&&(Zb=2)):ob<=bb?(Zb=ob,vc[ob-1]<vc[ob]*aa.stepSizeFac3&&(Zb=ob-1),vc[ob]<vc[ob-1]*aa.stepSizeFac4&&(Zb=Math.min(ob+1,ea-1))):(Zb=ob-1,ob>3&&vc[ob-2]<vc[ob-1]*aa.stepSizeFac3&&(Zb=ob-2),vc[ob]<vc[Zb]*aa.stepSizeFac4&&(Zb=Math.min(ob,ea-1))),Fc?(bb=Math.min(Zb,ob),$a=sb*Math.min(Math.abs($a),Math.abs(M[bb])),Fc=!1,!0):($a=Zb<=ob?M[Zb]:ob<bb&&vc[ob]<vc[ob-1]*aa.stepSizeFac4?M[ob]*za[Zb+1]/za[ob]:M[ob]*za[Zb]/za[ob],bb=Zb,$a=sb*Math.abs($a),!0));var Zb},ra=function(Oa){for(var da=P.dim(aa.n),lb=$a/pa[Oa],ua=1;ua<=aa.n;++ua)qa[ua]=ma[ua],ba[ua]=ma[ua]+lb*Y[ua];for(var zc=pa[Oa]-1,vb=pa[Oa]/2|0,Vc=1;Vc<=zc;++Vc){if(aa.denseOutput&&Vc===vb)for(ua=1;ua<=ub;++ua)ec[Oa][ua]=ba[Ta[ua]];if(Ee(S+lb*Vc,ba,da),aa.denseOutput&&Math.abs(Vc-vb)<=2*Oa-1)for(++Lc,ua=1;ua<=ub;++ua)Ld[Lc][ua]=da[Ta[ua]];for(ua=1;ua<=aa.n;++ua){var Wc=qa[ua];qa[ua]=ba[ua],ba[ua]=Wc+2*lb*da[ua]}if(Vc<=aa.stabilityCheckCount&&Oa<=aa.stabilityCheckTableLines){var Bb=0;for(ua=1;ua<=aa.n;++ua)Bb+=Math.pow(Y[ua]/pb[ua],2);var Mc=0;for(ua=1;ua<=aa.n;++ua)Mc+=Math.pow((da[ua]-Y[ua])/pb[ua],2);if(Mc/Math.max(aa.uRound,Bb)>4)return++Ec,xd=!0,$a*=aa.stepSizeReductionFactor,void(Fc=!0)}}if(Ee(S+$a,ba,da),aa.denseOutput&&vb<=2*Oa-1)for(++Lc,ua=1;ua<=ub;++ua)Ld[Lc][ua]=da[Ta[ua]];for(ua=1;ua<=aa.n;++ua)G[Oa][ua]=(qa[ua]+ba[ua]+lb*da[ua])/2;if(Ec+=pa[Oa],1!==Oa){for(var Sb,Dd=pa[Oa],ad=Oa;ad>1;--ad)for(Sb=Math.pow(Dd/pa[ad-1],2)-1,ua=1;ua<=aa.n;++ua)G[ad-1][ua]=G[ad][ua]+(G[ad][ua]-G[ad-1][ua])/Sb;for(dd=0,ua=1;ua<=aa.n;++ua){var Qc=Math.max(Math.abs(ma[ua]),Math.abs(G[1][ua]));pb[ua]=Jc[ua]+md[ua]*Qc,dd+=Math.pow((G[1][ua]-G[2][ua])/pb[ua],2)}if((dd=Math.sqrt(dd/aa.n))*aa.uRound>=1||Oa>2&&dd>=Uc)return xd=!0,$a*=aa.stepSizeReductionFactor,void(Fc=!0);Uc=Math.max(4*dd,1);var pd=1/(2*Oa-1),Zb=Math.pow(aa.stepSizeFac1,pd);Sb=1/(Sb=Math.min(aa.stepSizeFac2/Zb,Math.max(Zb,Math.pow(dd/aa.stepSafetyFactor1,pd)/aa.stepSafetyFactor2))),M[Oa]=Math.min(Math.abs($a)*Sb,Ob),vc[Oa]=za[Oa]/M[Oa]}},Ya=function(Oa,da,lb){for(var ua=new Array(31),zc=1;zc<=Oa;++zc){var vb=da[zc],Vc=da[2*Oa+zc],Wc=da[Oa+zc],Bb=da[3*Oa+zc],Mc=Vc-vb,Sb=-Bb+Mc,Dd=Wc-Mc;if(da[Oa+zc]=Mc,da[2*Oa+zc]=Sb,da[3*Oa+zc]=Dd,!(lb<0)){var ad=.5*(vb+Vc)+.125*(Sb+Dd),Qc=Mc+.25*(Sb-Dd),pd=-(Wc-Bb),Zb=6*(Dd-Sb);if(lb>=1&&(ua[1]=16*(da[5*Oa+zc]-Qc),lb>=3&&(ua[3]=16*(da[7*Oa+zc]-Zb+3*ua[1]),lb>=5)))for(var gb=5;gb<=lb;gb+=2){var ed=(nc=gb*(gb-1)/2)*(gb-2)*(gb-3)*2;ua[gb]=16*(da[(gb+4)*Oa+zc]+nc*ua[gb-2]-ed*ua[gb-4])}if(ua[0]=16*(da[4*Oa+zc]-ad),lb>=2&&(ua[2]=16*(da[6*Oa+zc]-pd+ua[0]),lb>=4))for(gb=4;gb<=lb;gb+=2){var nc=gb*(gb-1)/2;ed=gb*(gb-1)*(gb-2)*(gb-3),ua[gb]=16*(da[Oa*(gb+4)+zc]+ua[gb-2]*nc-ua[gb-4]*ed)}for(gb=0;gb<=lb;++gb)da[Oa*(gb+4)+zc]=ua[gb]}}},Pb=function(Oa,da,lb,ua,zc){return function(vb,Vc){for(var Wc=0,Bb=1;Bb<=ub;++Bb)zc[Bb]===vb+1&&(Wc=Bb);if(0===Wc)throw new Error("no dense output available for component "+vb);var Mc=(Vc-Oa)/da,Sb=1-Mc,Dd=ua[Wc]+Mc*(ua[ub+Wc]+Sb*(ua[2*ub+Wc]*Mc+ua[3*ub+Wc]*Sb));if(lb<0)return Dd;for(var ad=Mc-.5,Qc=ua[ub*(lb+4)+Wc],pd=lb;pd>=1;--pd)Qc=ua[ub*(pd+3)+Wc]+Qc*ad/pd;return Dd+Math.pow(Mc*Sb,2)*Qc}},ec=P.dim2(ea,ub),M=P.dim(ea),G=P.dim2(ea,aa.n),pa=P.stepSizeSequence(ta,ea),za=P.dim(ea);za[1]=1+pa[1];for(var va=2;va<=ea;++va)za[va]=za[va-1]+pa[va];var pb=P.dim(aa.n);for(va=1;va<=aa.n;++va)pb[va]=Jc[va]+md[va]+Math.abs(ma[va]);var sb=_-S>=0?1:-1,bb=Math.max(2,Math.min(ea-1,Math.floor(.6*-P.log10(md[1]+1e-40)+1.5))),$a=Math.max(Math.abs(aa.initialStepSize),1e-4);$a=sb*Math.min($a,Ob,Math.abs(_-S)/2);var Qb=P.dim(ea+1),Xb=P.dim(2*ea),wd=S,Lc=0;if(la){if(aa.denseOutput){for(Qb[1]=0,va=1;va<=ea;++va){var qc=4*va-2;pa[va]>qc&&++qc,Qb[va+1]=Qb[va]+qc}for(var kb=1;kb<=2*ea;++kb){for(var gc=.5*Math.sqrt(kb/(kb+4)),Rb=Math.pow(1/(kb+4),2),mc=1;mc<=kb;++mc)Rb*=gc/mc;Xb[kb]=Rb}Lc=0}if(!1===la(lc+1,wd,S,ma.slice(1)))return N.EarlyReturn}var dd=0,Uc=1e10,od=sb*Ob,vc=P.dim(ea);vc[1]=0;var xd,Kb,Fc=!1,oe=!1,ob=0;!function(Oa){Oa[Oa.Start=0]="Start",Oa[Oa.BasicIntegrationStep=1]="BasicIntegrationStep",Oa[Oa.ConvergenceStep=2]="ConvergenceStep",Oa[Oa.HopeForConvergence=3]="HopeForConvergence",Oa[Oa.Accept=4]="Accept",Oa[Oa.Reject=5]="Reject"}(Kb||(Kb={}));var hc=Kb.Start;qf:for(;;)switch(aa.debug&&console.log("STATE",Kb[hc],nd,wd,S,$a,bb,ob,od),hc){case Kb.Start:if(xd=!1,.1*Math.abs(_-S)<=Math.abs(S)*aa.uRound)break qf;if($a=sb*Math.min(Math.abs($a),Math.abs(_-S),Ob,Math.abs(od)),(S+1.01*$a-_)*sb>0&&($a=_-S,oe=!0),0!==nd&&aa.denseOutput||(Ee(S,ma,Y),++Ec),0===nd||oe){for(Lc=0,++nd,mc=1;mc<=bb;++mc){if(ob=mc,ra(mc),xd)continue qf;if(mc>1&&dd<=1){hc=Kb.Accept;continue qf}}hc=Kb.HopeForConvergence;continue}hc=Kb.BasicIntegrationStep;continue;case Kb.BasicIntegrationStep:if(Lc=0,++nd>=aa.maxSteps)return N.MaxStepsExceeded;for(ob=bb-1,mc=1;mc<=ob;++mc)if(ra(mc),xd){hc=Kb.Start;continue qf}hc=2===bb||Fc?Kb.ConvergenceStep:dd<=1?Kb.Accept:dd>Math.pow(pa[bb+1]*pa[bb]/4,2)?Kb.Reject:Kb.ConvergenceStep;continue;case Kb.ConvergenceStep:if(ra(bb),xd){hc=Kb.Start;continue}if(ob=bb,dd<=1){hc=Kb.Accept;continue}hc=Kb.HopeForConvergence;continue;case Kb.HopeForConvergence:if(dd>Math.pow(pa[bb+1]/2,2)){hc=Kb.Reject;continue}ra(ob=bb+1),hc=xd?Kb.Start:dd>1?Kb.Reject:Kb.Accept;continue;case Kb.Accept:if(!vd(aa.n))return N.EarlyReturn;hc=Kb.Start;continue;case Kb.Reject:(bb=Math.min(bb,ob,ea-1))>2&&vc[bb-1]<vc[bb]*aa.stepSizeFac3&&(bb-=1),++Ab,$a=sb*M[bb],Fc=!0,hc=Kb.BasicIntegrationStep}return N.Converged}();return{y:ma.slice(1),outcome:Md,nStep:nd,xEnd:_,nAccept:lc,nReject:Ab,nEval:Ec}},P}();L.dim=function(P){return Array(P+1)},L.log10=function(P){return Math.log(P)/Math.LN10},F.Solver=L}),ic=function(E){for(var F=new Array(E),N=0;N<E;++N)F[N]=N;return F},$c=function(E){return null!=E&&(jc(E)||function(F){return"function"==typeof F.readFloatLE&&"function"==typeof F.slice&&jc(F.slice(0,0))}(E)||!!E._isBuffer)};function jc(E){return!!E.constructor&&"function"==typeof E.constructor.isBuffer&&E.constructor.isBuffer(E)}var kc="undefined"!=typeof Float64Array;function Yf(E,F){return E[0]-F[0]}function Xe(){var E,F=this.stride,N=new Array(F.length);for(E=0;E<N.length;++E)N[E]=[Math.abs(F[E]),E];N.sort(Yf);var L=new Array(N.length);for(E=0;E<L.length;++E)L[E]=N[E][1];return L}function vg(E,F){var N=["View",F,"d",E].join("");F<0&&(N="View_Nil"+E);var L="generic"===E;if(-1===F){var P="function "+N+"(a){this.data=a;};var proto="+N+".prototype;proto.dtype='"+E+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+N+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+N+"(a){return new "+N+"(a);}";return new Function(P)()}if(0===F)return P="function "+N+"(a,d) {this.data = a;this.offset = d};var proto="+N+".prototype;proto.dtype='"+E+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+N+"_copy() {return new "+N+"(this.data,this.offset)};proto.pick=function "+N+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+N+"_get(){return "+(L?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+N+"_set(v){return "+(L?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+N+"(a,b,c,d){return new "+N+"(a,d)}",new Function("TrivialArray",P)(ae[E][0]);P=["'use strict'"];var R=ic(F),S=R.map(function(ea){return"i"+ea}),ga="this.offset+"+R.map(function(ea){return"this.stride["+ea+"]*i"+ea}).join("+"),_=R.map(function(ea){return"b"+ea}).join(","),la=R.map(function(ea){return"c"+ea}).join(",");P.push("function "+N+"(a,"+_+","+la+",d){this.data=a","this.shape=["+_+"]","this.stride=["+la+"]","this.offset=d|0}","var proto="+N+".prototype","proto.dtype='"+E+"'","proto.dimension="+F),P.push("Object.defineProperty(proto,'size',{get:function "+N+"_size(){return "+R.map(function(ea){return"this.shape["+ea+"]"}).join("*"),"}})"),1===F?P.push("proto.order=[0]"):(P.push("Object.defineProperty(proto,'order',{get:"),F<4?(P.push("function "+N+"_order(){"),2===F?P.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===F&&P.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):P.push("ORDER})")),P.push("proto.set=function "+N+"_set("+S.join(",")+",v){"),L?P.push("return this.data.set("+ga+",v)}"):P.push("return this.data["+ga+"]=v}"),P.push("proto.get=function "+N+"_get("+S.join(",")+"){"),L?P.push("return this.data.get("+ga+")}"):P.push("return this.data["+ga+"]}"),P.push("proto.index=function "+N+"_index(",S.join(),"){return "+ga+"}"),P.push("proto.hi=function "+N+"_hi("+S.join(",")+"){return new "+N+"(this.data,"+R.map(function(ea){return["(typeof i",ea,"!=='number'||i",ea,"<0)?this.shape[",ea,"]:i",ea,"|0"].join("")}).join(",")+","+R.map(function(ea){return"this.stride["+ea+"]"}).join(",")+",this.offset)}");var aa=R.map(function(ea){return"a"+ea+"=this.shape["+ea+"]"}),ma=R.map(function(ea){return"c"+ea+"=this.stride["+ea+"]"});P.push("proto.lo=function "+N+"_lo("+S.join(",")+"){var b=this.offset,d=0,"+aa.join(",")+","+ma.join(","));for(var Y=0;Y<F;++Y)P.push("if(typeof i"+Y+"==='number'&&i"+Y+">=0){d=i"+Y+"|0;b+=c"+Y+"*d;a"+Y+"-=d}");for(P.push("return new "+N+"(this.data,"+R.map(function(ea){return"a"+ea}).join(",")+","+R.map(function(ea){return"c"+ea}).join(",")+",b)}"),P.push("proto.step=function "+N+"_step("+S.join(",")+"){var "+R.map(function(ea){return"a"+ea+"=this.shape["+ea+"]"}).join(",")+","+R.map(function(ea){return"b"+ea+"=this.stride["+ea+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),Y=0;Y<F;++Y)P.push("if(typeof i"+Y+"==='number'){d=i"+Y+"|0;if(d<0){c+=b"+Y+"*(a"+Y+"-1);a"+Y+"=ceil(-a"+Y+"/d)}else{a"+Y+"=ceil(a"+Y+"/d)}b"+Y+"*=d}");P.push("return new "+N+"(this.data,"+R.map(function(ea){return"a"+ea}).join(",")+","+R.map(function(ea){return"b"+ea}).join(",")+",c)}");var qa=new Array(F),ba=new Array(F);for(Y=0;Y<F;++Y)qa[Y]="a[i"+Y+"]",ba[Y]="b[i"+Y+"]";for(P.push("proto.transpose=function "+N+"_transpose("+S+"){"+S.map(function(ea,ta){return ea+"=("+ea+"===undefined?"+ta+":"+ea+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+N+"(this.data,"+qa.join(",")+","+ba.join(",")+",this.offset)}"),P.push("proto.pick=function "+N+"_pick("+S+"){var a=[],b=[],c=this.offset"),Y=0;Y<F;++Y)P.push("if(typeof i"+Y+"==='number'&&i"+Y+">=0){c=(c+this.stride["+Y+"]*i"+Y+")|0}else{a.push(this.shape["+Y+"]);b.push(this.stride["+Y+"])}");return P.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),P.push("return function construct_"+N+"(data,shape,stride,offset){return new "+N+"(data,"+R.map(function(ea){return"shape["+ea+"]"}).join(",")+","+R.map(function(ea){return"stride["+ea+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",P.join(`
`))(ae[E],Xe)}var ae={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]},me=function(E,F,N,L){if(void 0===E)return(0,ae.array[0])([]);"number"==typeof E&&(E=[E]),void 0===F&&(F=[E.length]);var P=F.length;if(void 0===N){N=new Array(P);for(var R=P-1,S=1;R>=0;--R)N[R]=S,S*=F[R]}if(void 0===L)for(L=0,R=0;R<P;++R)N[R]<0&&(L-=(F[R]-1)*N[R]);for(var ga=function(la){if($c(la))return"buffer";if(kc)switch(Object.prototype.toString.call(la)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(la)?"array":"generic"}(E),_=ae[ga];_.length<=P+1;)_.push(vg(ga,_.length-1));return(0,_[P+1])(E,F,N,L)},Zf=function(E,F){switch(void 0===F&&(F=0),typeof E){case"number":if(E>0)return function(N,L){var P,R;for(P=new Array(N),R=0;R<N;++R)P[R]=L;return P}(0|E,F);break;case"object":if("number"==typeof E.length)return function N(L,P,R){var S=0|L[R];if(S<=0)return[];var ga,_=new Array(S);if(R===L.length-1)for(ga=0;ga<S;++ga)_[ga]=P;else for(ga=0;ga<S;++ga)_[ga]=N(L,P,R+1);return _}(E,F,0)}return[]},wg=function(E,F,N){return 0===E.length?E:F?(N||E.sort(F),function(L,P){for(var R=1,S=L.length,ga=L[0],_=L[0],la=1;la<S;++la)if(_=ga,P(ga=L[la],_)){if(la===R){R++;continue}L[R++]=ga}return L.length=R,L}(E,F)):(N||E.sort(),function(L){for(var P=1,R=L.length,S=L[0],ga=L[0],_=1;_<R;++_,ga=S)if(ga=S,(S=L[_])!==ga){if(_===P){P++;continue}L[P++]=S}return L.length=P,L}(E))};function bh(E,F,N){var L,P,R=E.length,S=F.arrayArgs.length,ga=F.indexArgs.length>0,_=[],la=[],aa=0,ma=0;for(L=0;L<R;++L)la.push(["i",L,"=0"].join(""));for(P=0;P<S;++P)for(L=0;L<R;++L)ma=aa,aa=E[L],0===L?la.push(["d",P,"s",L,"=t",P,"p",aa].join("")):la.push(["d",P,"s",L,"=(t",P,"p",aa,"-s",ma,"*t",P,"p",ma,")"].join(""));for(la.length>0&&_.push("var "+la.join(",")),L=R-1;L>=0;--L)aa=E[L],_.push(["for(i",L,"=0;i",L,"<s",aa,";++i",L,"){"].join(""));for(_.push(N),L=0;L<R;++L){for(ma=aa,aa=E[L],P=0;P<S;++P)_.push(["p",P,"+=d",P,"s",L].join(""));ga&&(L>0&&_.push(["index[",ma,"]-=s",ma].join("")),_.push(["++index[",aa,"]"].join(""))),_.push("}")}return _.join(`
`)}function Ye(E,F,N){for(var L=E.body,P=[],R=[],S=0;S<E.args.length;++S){var ga=E.args[S];if(!(ga.count<=0)){var _=new RegExp(ga.name,"g"),la="",aa=F.arrayArgs.indexOf(S);switch(F.argTypes[S]){case"offset":var ma=F.offsetArgIndex.indexOf(S);aa=F.offsetArgs[ma].array,la="+q"+ma;case"array":la="p"+aa+la;var Y="l"+S,qa="a"+aa;if(0===F.arrayBlockIndices[aa])1===ga.count?"generic"===N[aa]?ga.lvalue?(P.push(["var ",Y,"=",qa,".get(",la,")"].join("")),L=L.replace(_,Y),R.push([qa,".set(",la,",",Y,")"].join(""))):L=L.replace(_,[qa,".get(",la,")"].join("")):L=L.replace(_,[qa,"[",la,"]"].join("")):"generic"===N[aa]?(P.push(["var ",Y,"=",qa,".get(",la,")"].join("")),L=L.replace(_,Y),ga.lvalue&&R.push([qa,".set(",la,",",Y,")"].join(""))):(P.push(["var ",Y,"=",qa,"[",la,"]"].join("")),L=L.replace(_,Y),ga.lvalue&&R.push([qa,"[",la,"]=",Y].join("")));else{for(var ba=[ga.name],ea=[la],ta=0;ta<Math.abs(F.arrayBlockIndices[aa]);ta++)ba.push("\\s*\\[([^\\]]+)\\]"),ea.push("$"+(ta+1)+"*t"+aa+"b"+ta);if(_=new RegExp(ba.join(""),"g"),la=ea.join("+"),"generic"===N[aa])throw new Error("cwise: Generic arrays not supported in combination with blocks!");L=L.replace(_,[qa,"[",la,"]"].join(""))}break;case"scalar":L=L.replace(_,"Y"+F.scalarArgs.indexOf(S));break;case"index":L=L.replace(_,"index");break;case"shape":L=L.replace(_,"shape")}}}return[P.join(`
`),L,R.join(`
`)].join(`
`).trim()}function yi(E){for(var F=new Array(E.length),N=!0,L=0;L<E.length;++L){var P=E[L],R=P.match(/\d+/);R=R?R[0]:"",0===P.charAt(0)?F[L]="u"+P.charAt(1)+R:F[L]=P.charAt(0)+R,L>0&&(N=N&&F[L]===F[L-1])}return N?F[0]:F.join("")}var _f=function(E,F){for(var N=F[1].length-Math.abs(E.arrayBlockIndices[0])|0,L=new Array(E.arrayArgs.length),P=new Array(E.arrayArgs.length),R=0;R<E.arrayArgs.length;++R)P[R]=F[2*R],L[R]=F[2*R+1];var S=[],ga=[],_=[],la=[],aa=[];for(R=0;R<E.arrayArgs.length;++R){E.arrayBlockIndices[R]<0?(_.push(0),la.push(N),S.push(N),ga.push(N+E.arrayBlockIndices[R])):(_.push(E.arrayBlockIndices[R]),la.push(E.arrayBlockIndices[R]+N),S.push(0),ga.push(E.arrayBlockIndices[R]));for(var ma=[],Y=0;Y<L[R].length;Y++)_[R]<=L[R][Y]&&L[R][Y]<la[R]&&ma.push(L[R][Y]-_[R]);aa.push(ma)}var qa=["SS"],ba=["'use strict'"],ea=[];for(Y=0;Y<N;++Y)ea.push(["s",Y,"=SS[",Y,"]"].join(""));for(R=0;R<E.arrayArgs.length;++R){for(qa.push("a"+R),qa.push("t"+R),qa.push("p"+R),Y=0;Y<N;++Y)ea.push(["t",R,"p",Y,"=t",R,"[",_[R]+Y,"]"].join(""));for(Y=0;Y<Math.abs(E.arrayBlockIndices[R]);++Y)ea.push(["t",R,"b",Y,"=t",R,"[",S[R]+Y,"]"].join(""))}for(R=0;R<E.scalarArgs.length;++R)qa.push("Y"+R);if(E.shapeArgs.length>0&&ea.push("shape=SS.slice(0)"),E.indexArgs.length>0){var ta=new Array(N);for(R=0;R<N;++R)ta[R]="0";ea.push(["index=[",ta.join(","),"]"].join(""))}for(R=0;R<E.offsetArgs.length;++R){var Ta=E.offsetArgs[R],fb=[];for(Y=0;Y<Ta.offset.length;++Y)0!==Ta.offset[Y]&&(1===Ta.offset[Y]?fb.push(["t",Ta.array,"p",Y].join("")):fb.push([Ta.offset[Y],"*t",Ta.array,"p",Y].join("")));0===fb.length?ea.push("q"+R+"=0"):ea.push(["q",R,"=",fb.join("+")].join(""))}var Nb=wg([].concat(E.pre.thisVars).concat(E.body.thisVars).concat(E.post.thisVars));for((ea=ea.concat(Nb)).length>0&&ba.push("var "+ea.join(",")),R=0;R<E.arrayArgs.length;++R)ba.push("p"+R+"|=0");E.pre.body.length>3&&ba.push(Ye(E.pre,E,P));var Ib=Ye(E.body,E,P),Aa=function(Ob){for(var Jb=0,Db=Ob[0].length;Jb<Db;){for(var Jc=1;Jc<Ob.length;++Jc)if(Ob[Jc][Jb]!==Ob[0][Jb])return Jb;++Jb}return Jb}(aa);Aa<N?ba.push(function(Ob,Jb,Db,Jc){for(var md=Jb.length,Dc=Db.arrayArgs.length,Ec=Db.blockSize,nd=Db.indexArgs.length>0,lc=[],Ab=0;Ab<Dc;++Ab)lc.push(["var offset",Ab,"=p",Ab].join(""));for(Ab=Ob;Ab<md;++Ab)lc.push(["for(var j"+Ab+"=SS[",Jb[Ab],"]|0;j",Ab,">0;){"].join("")),lc.push(["if(j",Ab,"<",Ec,"){"].join("")),lc.push(["s",Jb[Ab],"=j",Ab].join("")),lc.push(["j",Ab,"=0"].join("")),lc.push(["}else{s",Jb[Ab],"=",Ec].join("")),lc.push(["j",Ab,"-=",Ec,"}"].join("")),nd&&lc.push(["index[",Jb[Ab],"]=j",Ab].join(""));for(Ab=0;Ab<Dc;++Ab){for(var ub=["offset"+Ab],Kc=Ob;Kc<md;++Kc)ub.push(["j",Kc,"*t",Ab,"p",Jb[Kc]].join(""));lc.push(["p",Ab,"=(",ub.join("+"),")"].join(""))}for(lc.push(bh(Jb,Db,Jc)),Ab=Ob;Ab<md;++Ab)lc.push("}");return lc.join(`
`)}(Aa,aa[0],E,Ib)):ba.push(bh(aa[0],E,Ib)),E.post.body.length>3&&ba.push(Ye(E.post,E,P)),E.debug&&console.log("-----Generated cwise routine for ",F,`:
`+ba.join(`
`)+`
----------`);var Ic=[E.funcName||"unnamed","_cwise_loop_",L[0].join("s"),"m",Aa,yi(P)].join("");return new Function(["function ",Ic,"(",qa.join(","),"){",ba.join(`
`),"} return ",Ic].join(""))()},xg=function(E){var F=["'use strict'","var CACHED={}"],N=[],L=E.funcName+"_cwise_thunk";F.push(["return function ",L,"(",E.shimArgs.join(","),"){"].join(""));for(var P=[],R=[],S=[["array",E.arrayArgs[0],".shape.slice(",Math.max(0,E.arrayBlockIndices[0]),E.arrayBlockIndices[0]<0?","+E.arrayBlockIndices[0]+")":")"].join("")],ga=[],_=[],la=0;la<E.arrayArgs.length;++la){var aa=E.arrayArgs[la];N.push(["t",aa,"=array",aa,".dtype,","r",aa,"=array",aa,".order"].join("")),P.push("t"+aa),P.push("r"+aa),R.push("t"+aa),R.push("r"+aa+".join()"),S.push("array"+aa+".data"),S.push("array"+aa+".stride"),S.push("array"+aa+".offset|0"),la>0&&(ga.push("array"+E.arrayArgs[0]+".shape.length===array"+aa+".shape.length+"+(Math.abs(E.arrayBlockIndices[0])-Math.abs(E.arrayBlockIndices[la]))),_.push("array"+E.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,E.arrayBlockIndices[0])+"]===array"+aa+".shape[shapeIndex+"+Math.max(0,E.arrayBlockIndices[la])+"]"))}for(E.arrayArgs.length>1&&(F.push("if (!("+ga.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),F.push("for(var shapeIndex=array"+E.arrayArgs[0]+".shape.length-"+Math.abs(E.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),F.push("if (!("+_.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),F.push("}")),la=0;la<E.scalarArgs.length;++la)S.push("scalar"+E.scalarArgs[la]);return N.push(["type=[",R.join(","),"].join()"].join("")),N.push("proc=CACHED[type]"),F.push("var "+N.join(",")),F.push(["if(!proc){","CACHED[type]=proc=compile([",P.join(","),"])}","return proc(",S.join(","),")}"].join("")),E.debug&&console.log(`-----Generated thunk:
`+F.join(`
`)+`
----------`),new Function("compile",F.join(`
`))(_f.bind(void 0,E))};function yg(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var Gb=function(E){var F=new yg();F.pre=E.pre,F.body=E.body,F.post=E.post;var N=E.args.slice(0);F.argTypes=N;for(var L=0;L<N.length;++L){var P=N[L];if("array"===P||"object"==typeof P&&P.blockIndices){if(F.argTypes[L]="array",F.arrayArgs.push(L),F.arrayBlockIndices.push(P.blockIndices?P.blockIndices:0),F.shimArgs.push("array"+L),L<F.pre.args.length&&F.pre.args[L].count>0)throw new Error("cwise: pre() block may not reference array args");if(L<F.post.args.length&&F.post.args[L].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===P)F.scalarArgs.push(L),F.shimArgs.push("scalar"+L);else if("index"===P){if(F.indexArgs.push(L),L<F.pre.args.length&&F.pre.args[L].count>0)throw new Error("cwise: pre() block may not reference array index");if(L<F.body.args.length&&F.body.args[L].lvalue)throw new Error("cwise: body() block may not write to array index");if(L<F.post.args.length&&F.post.args[L].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===P){if(F.shapeArgs.push(L),L<F.pre.args.length&&F.pre.args[L].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(L<F.body.args.length&&F.body.args[L].lvalue)throw new Error("cwise: body() block may not write to array shape");if(L<F.post.args.length&&F.post.args[L].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof P||!P.offset)throw new Error("cwise: Unknown argument type "+N[L]);F.argTypes[L]="offset",F.offsetArgs.push({array:P.array,offset:P.offset}),F.offsetArgIndex.push(L)}}if(F.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(F.pre.args.length>N.length)throw new Error("cwise: Too many arguments in pre() block");if(F.body.args.length>N.length)throw new Error("cwise: Too many arguments in body() block");if(F.post.args.length>N.length)throw new Error("cwise: Too many arguments in post() block");return F.debug=!!E.printCode||!!E.debug,F.funcName=E.funcName||"cwise",F.blockSize=E.blockSize||64,xg(F)},cb={},Be={body:"",args:[],thisVars:[],localVars:[]};function rf(E){if(!E)return Be;for(var F=0;F<E.args.length;++F){var N=E.args[F];E.args[F]=0===F?{name:N,lvalue:!0,rvalue:!!E.rvalue,count:E.count||1}:{name:N,lvalue:!1,rvalue:!0,count:1}}return E.thisVars||(E.thisVars=[]),E.localVars||(E.localVars=[]),E}function uc(E){for(var F=[],N=0;N<E.args.length;++N)F.push("a"+N);return new Function("P",["return function ",E.funcName,"_ndarrayops(",F.join(","),") {P(",F.join(","),");return a0}"].join(""))(function(L){return Gb({args:L.args,pre:rf(L.pre),body:rf(L.body),post:rf(L.proc),funcName:L.funcName})}(E))}var Cf={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var E in Cf){var F=Cf[E];cb[E]=uc({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+F+"c"},funcName:E}),cb[E+"eq"]=uc({args:["array","array"],body:{args:["a","b"],body:"a"+F+"=b"},rvalue:!0,funcName:E+"eq"}),cb[E+"s"]=uc({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+F+"s"},funcName:E+"s"}),cb[E+"seq"]=uc({args:["array","scalar"],body:{args:["a","s"],body:"a"+F+"=s"},rvalue:!0,funcName:E+"seq"})}}();var ne={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var E in ne){var F=ne[E];cb[E]=uc({args:["array","array"],body:{args:["a","b"],body:"a="+F+"b"},funcName:E}),cb[E+"eq"]=uc({args:["array"],body:{args:["a"],body:"a="+F+"a"},rvalue:!0,count:2,funcName:E+"eq"})}}();var be={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var E in be){var F=be[E];cb[E]=uc({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+F+"c"},funcName:E}),cb[E+"s"]=uc({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+F+"s"},funcName:E+"s"}),cb[E+"eq"]=uc({args:["array","array"],body:{args:["a","b"],body:"a=a"+F+"b"},rvalue:!0,count:2,funcName:E+"eq"}),cb[E+"seq"]=uc({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+F+"s"},rvalue:!0,count:2,funcName:E+"seq"})}}();var Df=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var E=0;E<Df.length;++E){var F=Df[E];cb[F]=uc({args:["array","array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:F}),cb[F+"eq"]=uc({args:["array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:F+"eq"})}}();var Ze=["max","min","atan2","pow"];!function(){for(var E=0;E<Ze.length;++E){var F=Ze[E];cb[F]=uc({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:F}),cb[F+"s"]=uc({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:F+"s"}),cb[F+"eq"]=uc({args:["array","array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:F+"eq"}),cb[F+"seq"]=uc({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:F+"seq"})}}();var $f=["atan2","pow"];!function(){for(var E=0;E<$f.length;++E){var F=$f[E];cb[F+"op"]=uc({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:F+"op"}),cb[F+"ops"]=uc({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:F+"ops"}),cb[F+"opeq"]=uc({args:["array","array"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:F+"opeq"}),cb[F+"opseq"]=uc({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+F,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:F+"opseq"})}}(),cb.any=Gb({args:["array"],pre:Be,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),cb.all=Gb({args:["array"],pre:Be,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),cb.sum=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),cb.prod=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),cb.norm2squared=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),cb.norm2=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),cb.norminf=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),cb.norm1=Gb({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),cb.sup=Gb({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),cb.inf=Gb({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),cb.argmin=Gb({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),cb.argmax=Gb({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),cb.random=uc({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),cb.assign=uc({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),cb.assigns=uc({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),cb.equals=Gb({args:["array","array"],pre:Be,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"});var Ce=cb,y=Gb({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
var _inline_1_v=_inline_1_arg1_,_inline_1_i
for(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {
_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]
}
_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]
}`,args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64}),C=function(E,F){for(var N=[],L=E,P=1;Array.isArray(L);)N.push(L.length),P*=L.length,L=L[0];return 0===N.length?me():(F||(F=me(new Float64Array(P),N)),y(F,E),F)},H=Gb({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
    var _inline_4_v = _inline_4_arg1_, _inline_4_i;
    for (_inline_4_i = 0; _inline_4_i < _inline_4_arg2_.length - 1; ++_inline_4_i) {
      _inline_4_v = _inline_4_v[_inline_4_arg2_[_inline_4_i]];
    }
    _inline_4_v[_inline_4_arg2_[_inline_4_arg2_.length - 1]] = _inline_4_arg0_;
  }`,args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_4_i","_inline_4_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"unpackCwise",blockSize:64}),X=function(E){var F=Zf(E.shape);return H(E,F),F},W=function(E,F){F=F||"float64";for(var N=1,L=0;L<E.length;++L)N*=E[L];return me(new(function(P){switch(P){case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float":case"float32":return Float32Array;case"double":case"float64":return Float64Array;case"uint8_clamped":return Uint8ClampedArray;case"generic":case"buffer":case"data":case"dataview":return ArrayBuffer;case"array":return Array}}(F))(N),E)},T={array:me,dup:Zf,muleq:Ce.muleq,mulseq:Ce.mulseq,pack:C,sum:Ce.sum,unpack:X,zeros:W};let Sa=["Susceptible","Exposed","Infected","Severely Infected","Recovered","Dead"],rb=["0-19","20-59","60+"],xc=[1e-4,.0032,.0328],Yb={Africa:[.507,.438,.055],Americas:[.293,.541,.166],Asia:[.312,.558,.131],Europe:[.211,.532,.257]};Object.keys(Yb).forEach(E=>Yb[E]=T.array(Yb[E]));let Hb=T.pack([[7.86,5.22,.5],[2.37,7.69,1.06],[1.19,5.38,1.92]]),ud={};Object.keys(Yb).forEach(E=>ud[E]=function(F,N){let L=F,P=N,R=T.zeros([L.size,L.size]);return L.data.forEach((S,ga)=>{L.data.forEach((_,la)=>{let aa=(P.get(ga,la)*L.get(ga)+P.get(la,ga)*L.get(la))/(2*L.get(ga));R.set(ga,la,aa)})}),R}(Yb[E],Hb));let _e={"Cancel mass gatherings":{chi:.72},Quarantine:{chi:.63},"Quarantine and tracing":{chi:.48},"School closure":{cohort_chi:[[.25,.8,1.52],[.8,.74,1],[1.52,1,1]]},"Shelter in place":{chi:.34},"Shielding the elderly":{xi:.5,indices:[[0,-1],[1,-1],[-1,0],[-1,1],[-1,-1]]}};class Cc{constructor(E,F,N=5.1,L=.034,P=6.3,R=17.8,S=xc,ga=rb.length){if(F.length!==E.length)throw new Error("Each contact matrix requires an epoch end time.");this.contacts=E,this.epoch_end_times=F,this.alpha=1/N,this.beta=L,this.gamma=1/P,this.delta=1/R,this.kappa=S,this.N_cohorts=ga,this.compartments=Sa,this.N_compartments=6,this.s=0,this.e=1,this.i=2,this.m=3,this.r=4,this.d=5}}Cc.prototype._fetch_contact=function(E){for(let F=0;F<this.contacts.length;F++)if(E<=this.epoch_end_times[F])return this.contacts[F]},Cc.prototype.f=function(E,F){if(isNaN(E))throw new Error("t can't be NaN");if(F.data)throw new Error("y should be an array, not ndarray");if(F.find(isNaN))throw new Error("y can't contain NaN");F=T.array(F,[this.N_cohorts,this.N_compartments]);let N=T.zeros([this.N_cohorts,this.N_compartments]),L=this._fetch_contact(E);L||console.error("oh no: ",[E,T.unpack(this.contacts)]);let P=Array.from(Array(this.N_cohorts).keys());for(let S of P){let ga=P.map(_=>this.beta*L.get(S,_)*(F.get(_,this.i)+F.get(_,this.m))/T.sum(F.pick(_,null))).reduce((_,la)=>_+la);N.set(S,this.s,-F.get(S,this.s)*ga),N.set(S,this.e,F.get(S,this.s)*ga-this.alpha*F.get(S,this.e)),N.set(S,this.i,this.alpha*(1-this.kappa[S])*F.get(S,this.e)-this.gamma*F.get(S,this.i)),N.set(S,this.m,this.alpha*this.kappa[S]*F.get(S,this.e)-this.delta*F.get(S,this.m)),N.set(S,this.r,this.gamma*F.get(S,this.i)),N.set(S,this.d,this.delta*F.get(S,this.m))}let R=T.unpack(T.array(N.data));if(R.find(isNaN))throw new Error("it broke, there's NaN",R);return R},Cc.prototype.solve=function(E){let F=new Wb.Solver(18),N=this.epoch_end_times.slice(-1)[0],L=[],P=[];return F.denseOutput=!0,F.solve(this.f.bind(this),0,E,N,F.grid(1,(R,S)=>{L.push(R),P.push(S)})),[L,P.flat()]};const De=(E,...F)=>E.map((N,L)=>F.reduce((P,R)=>[...P,R[L]],[N]));Cc.model_input=function(E,F,N,L,P=_e){let R=function(ma,Y){return length=Y-ma,Array.from(Array(length),(qa,ba)=>ba+ma)},S=function(ma,Y){let qa=R(...ma),ba=R(...Y);return qa.filter(ea=>ba.includes(ea)).length>1},ga=function(ma,Y,qa){let ba=Y[ma]||{};if(ba.cohort_chi)return T.muleq(qa,T.pack(ba.cohort_chi)),qa;if(ba.chi)return T.mulseq(qa,ba.chi),qa;for(let[ea,ta]of ba.indices||[]){ea=ea<0?qa.shape[0]+ea:ea,ta=ta<0?qa.shape[1]+ta:ta;let Ta=qa.get(ea,ta);if(void 0===Ta)throw"impact could not be applied";qa.set(ea,ta,Ta*ba.xi)}return qa},_=function(ma,Y){let qa=ma.flat().concat(0,Y).sort((ea,ta)=>ea-ta);return(ba=Array.from(new Set(qa))).slice(0,-1).map((ea,ta)=>ba.slice(ta,ta+2));var ba}(F,L),la=[],aa=["Cancel mass gatherings","School closure","Shielding the elderly"];for(let ma of _){let Y=T.pack(T.unpack(E)),qa=F[N.indexOf("Shelter in place")];for(let[ba,ea]of De(F,N))aa.includes(ea)&&S(ma,qa)||S(ba,ma)&&(Y=ga(ea,P,Y));la.push(Y)}return[la,_.map(ma=>ma[1])]},Cc.generateData=function(E,F,N){let L=N,P=T.unpack(Yb[E]).map(ba=>1e6*ba).map(ba=>[.998*ba,.001*ba,.001*ba,0,0,0]),[R,S]=Cc.model_input(ud[E],Object.values(F),Object.keys(F),L-0),ga=new Cc(R,S),[_,la]=ga.solve(P.flat()),aa=T.array(la,[_.length,ga.N_cohorts,ga.N_compartments]),ma=function(ba){for(var ea=ba.length,ta=ba[0].length,Ta=[],fb=0;fb<ta;fb++){for(var Nb=[],Ib=0;Ib<ea;Ib++)Nb.push(ba[Ib][fb]);Ta.push(Nb)}return Ta}((Y=aa,T.unpack(Y).map(ba=>De(...ba).map(ea=>ea.reduce((ta,Ta)=>ta+Ta)))));var Y;let qa={};return Sa.forEach((ba,ea)=>qa[ba]=ma[ea]),qa["Combined Infected"]=qa.Infected.map((ba,ea)=>ba+qa["Severely Infected"][ea]),qa.cohortDeaths=T.unpack(aa.pick(L,null,5)),qa};var zg=Cc;function Nk(E){let F,N,L,P,R,S,ga,_,la,aa,ma,Y,qa,ba,ea,ta,Ta,fb,Nb,Ib,Aa,Ic,Ob,Jb,Db,Jc,md,Dc=E[1][0]+"",Ec=E[1][1]+"",nd=E[1][2]+"";return{c(){F=Object(v.m)("div"),N=Object(v.m)("div"),L=Object(v.A)(),P=Object(v.m)("section"),P.textContent="The simulation begins on day zero with 1,000 people infected, 1,000 people exposed, and 1 million people total.",R=Object(v.A)(),S=Object(v.m)("section"),ga=Object(v.m)("p"),ga.innerHTML='<span class="big svelte-1okghyu">Deaths</span> per million',_=Object(v.A)(),la=Object(v.m)("p"),aa=Object(v.B)("< 19 years old"),ma=Object(v.m)("span"),Y=Object(v.B)(Dc),qa=Object(v.A)(),ba=Object(v.m)("p"),ea=Object(v.B)("20 - 59 years old"),ta=Object(v.m)("span"),Ta=Object(v.B)(Ec),fb=Object(v.A)(),Nb=Object(v.m)("p"),Ib=Object(v.B)("60+ years old"),Aa=Object(v.m)("span"),Ic=Object(v.B)(nd),Ob=Object(v.A)(),Jb=Object(v.m)("p"),Db=Object(v.B)("Total "),Jc=Object(v.m)("span"),md=Object(v.B)(E[2]),Object(v.e)(N,"class","covid-graph-vega svelte-1okghyu"),Object(v.e)(P,"class","footnote svelte-1okghyu"),Object(v.e)(ga,"class","svelte-1okghyu"),Object(v.e)(ma,"class","big svelte-1okghyu"),Object(v.e)(la,"class","svelte-1okghyu"),Object(v.e)(ta,"class","big svelte-1okghyu"),Object(v.e)(ba,"class","svelte-1okghyu"),Object(v.e)(Aa,"class","big svelte-1okghyu"),Object(v.e)(Nb,"class","svelte-1okghyu"),Object(v.e)(Jc,"class","big svelte-1okghyu"),Object(v.e)(Jb,"class","total svelte-1okghyu"),Object(v.e)(S,"class","numbers svelte-1okghyu"),Object(v.e)(F,"class","covid-graph-container svelte-1okghyu")},m(lc,Ab){Object(v.r)(lc,F,Ab),Object(v.d)(F,N),E[14](N),Object(v.d)(F,L),Object(v.d)(F,P),Object(v.d)(F,R),Object(v.d)(F,S),Object(v.d)(S,ga),Object(v.d)(S,_),Object(v.d)(S,la),Object(v.d)(la,aa),Object(v.d)(la,ma),Object(v.d)(ma,Y),Object(v.d)(S,qa),Object(v.d)(S,ba),Object(v.d)(ba,ea),Object(v.d)(ba,ta),Object(v.d)(ta,Ta),Object(v.d)(S,fb),Object(v.d)(S,Nb),Object(v.d)(Nb,Ib),Object(v.d)(Nb,Aa),Object(v.d)(Aa,Ic),Object(v.d)(S,Ob),Object(v.d)(S,Jb),Object(v.d)(Jb,Db),Object(v.d)(Jb,Jc),Object(v.d)(Jc,md)},p(lc,[Ab]){2&Ab&&Dc!==(Dc=lc[1][0]+"")&&Object(v.z)(Y,Dc),2&Ab&&Ec!==(Ec=lc[1][1]+"")&&Object(v.z)(Ta,Ec),2&Ab&&nd!==(nd=lc[1][2]+"")&&Object(v.z)(Ic,nd),4&Ab&&Object(v.z)(md,lc[2])},i:v.u,o:v.u,d(lc){lc&&Object(v.l)(F),E[14](null)}}}function Ok(E,F,N){let L,P,R,{compartment:S}=F,{region:ga}=F,{interventions:_}=F,{days:la}=F,aa=[],ma={},Y=[],qa={},ba={};function ea(ta,Ta){let fb={Infected:"Currently infected per million",Dead:"Cumulative deaths per million"}[Ta],Nb=ta[Ta];return{config:{view:{continuousWidth:400,continuousHeight:300},axis:{titleFont:"Karla",titleFontSize:13,labelFont:"Karla",labelFontSize:13}},data:{name:"seriesData"},mark:{type:"line",clip:!0,strokeWidth:4,color:{x1:1,y1:1,x2:1,y2:0,gradient:"linear",stops:[{offset:0,color:"#F0883F"},{offset:1,color:"#D31408"}]}},encoding:{x:{type:"quantitative",axis:{title:"Day",titleFontSize:13,titleFontWeight:"normal",labelFlush:!1},field:"days",scale:{domain:[0,la]}},y:{type:"quantitative",axis:{title:fb,titleFontWeight:"normal",titleFontSize:13},field:"pop",scale:{domain:[0,Nb]}}},$schema:"https://vega.github.io/schema/vega-lite/v4.8.1.json",width:"container",height:300,autosize:{type:"fit",contains:"padding"},padding:{bottom:10},background:"#F7F7F8"}}return E.$set=ta=>{"compartment"in ta&&N(3,S=ta.compartment),"region"in ta&&N(4,ga=ta.region),"interventions"in ta&&N(5,_=ta.interventions),"days"in ta&&N(6,la=ta.days)},E.$$.update=()=>{if(112&E.$$.dirty&&N(7,ma=zg.generateData(ga,_,la)),8&E.$$.dirty&&N(8,P="Infected"===S?"Combined Infected":S),384&E.$$.dirty&&N(9,Y=ma[P].map((ta,Ta)=>({days:Ta,pop:Math.round(ta)}))),128&E.$$.dirty&&N(1,aa=ma.cohortDeaths.map(Math.round).map(ta=>ta.toLocaleString())),128&E.$$.dirty&&N(2,R=Math.round(ma.cohortDeaths.reduce((ta,Ta)=>ta+Ta)).toLocaleString()),80&E.$$.dirty){let ta=zg.generateData(ga,{},la);N(10,qa={});for(let Ta in ta)N(10,qa[Ta]=ta[Ta].reduce((fb,Nb)=>fb>Nb?fb:Nb),qa)}1096&E.$$.dirty&&N(11,ba=ea(qa,S)),2561&E.$$.dirty&&L&&ba&&Object(eb.a)(L,ba).then(ta=>ta.view.insert("seriesData",Y).run()).catch(console.error)},[L,aa,R,S,ga,_,la,ma,P,Y,qa,ba,void 0,ea,function(ta){v.g[ta?"unshift":"push"](()=>{N(0,L=ta)})}]}class Pk extends v.a{constructor(E){super(),Object(v.q)(this,E,Ok,Nk,v.y,{compartment:3,region:4,interventions:5,days:6})}}var Qk=Pk;function Bj(E){let F,N,L,P,R,S,ga,_,la,aa,ma=E[11].name+"",Y=E[11].body+"";return{c(){F=Object(v.m)("section"),N=Object(v.m)("div"),L=Object(v.A)(),P=Object(v.m)("div"),R=Object(v.A)(),S=Object(v.m)("button"),S.textContent="Back",Object(v.e)(N,"class","control-name svelte-jt39wy"),Object(v.e)(P,"class","control-explanation svelte-jt39wy"),Object(v.e)(S,"class","explain-back svelte-jt39wy"),Object(v.e)(F,"class","explain svelte-jt39wy")},m(qa,ba){Object(v.r)(qa,F,ba),Object(v.d)(F,N),N.innerHTML=ma,Object(v.d)(F,L),Object(v.d)(F,P),P.innerHTML=Y,Object(v.d)(F,R),Object(v.d)(F,S),_=!0,la||(aa=Object(v.s)(S,"click",E[14]),la=!0)},p(qa,ba){(!_||2048&ba[0])&&ma!==(ma=qa[11].name+"")&&(N.innerHTML=ma),(!_||2048&ba[0])&&Y!==(Y=qa[11].body+"")&&(P.innerHTML=Y)},i(qa){_||(Object(v.c)(()=>{ga||(ga=Object(v.i)(F,Fa,{},!0)),ga.run(1)}),_=!0)},o(qa){ga||(ga=Object(v.i)(F,Fa,{},!1)),ga.run(0),_=!1},d(qa){qa&&Object(v.l)(F),qa&&ga&&ga.end(),la=!1,aa()}}}function zi(E){let F;return{c(){F=Object(v.m)("span"),F.textContent="Day",Object(v.e)(F,"class","control-label svelte-jt39wy")},m(N,L){Object(v.r)(N,F,L)},d(N){N&&Object(v.l)(F)}}}function ch(E){let F,N,L,P,R,S,ga,_,la,aa,ma,Y,qa,ba,ea,ta,Ta,fb,Nb,Ib,Aa,Ic,Ob,Jb,Db,Jc,md,Dc,Ec,nd,lc,Ab;const ub=new Qk({props:{region:E[0],interventions:E[10],compartment:E[1],days:Ag}});let Kc=E[11]&&Bj(E),cd=E[13]&&function(ra){let Ya,Pb,ec,M,G,pa,za,va,pb,sb,bb,$a,Qb,Xb,wd,Lc,qc,kb,gc,Rb,mc,dd,Uc,od,vc,xd,Kb,Fc,oe;function ob(da){ra[24].call(null,da)}let hc={max:Ag,step:1,tooltip:ra[12],disabled:!ra[9].includes("Quarantine")};void 0!==ra[8]&&(hc.values=ra[8]);const Oa=new Ua({props:hc});return v.g.push(()=>Object(v.f)(Oa,"values",ob)),{c(){Ya=Object(v.m)("section"),Pb=Object(v.m)("div"),ec=Object(v.m)("label"),M=Object(v.m)("input"),pa=Object(v.B)(`
            Quarantine infected on days`),za=Object(v.A)(),va=Object(v.m)("div"),pb=Object(v.A)(),sb=Object(v.m)("div"),sb.innerHTML=`
          Control of COVID-19 requires the effective testing and isolation and quarantine of contacts. Users should determine whether a household quarantine strategy will be adopted (lower resource intensity; we assume 37% reduction in transmission) or an extended contact tracing strategy and quarantine of all extended contacts will be used (higher resource intensity; we assume 52% reduction in transmission. (<a href="https://cmmid.github.io/topics/covid19/reports/bbc_contact_tracing.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,bb=Object(v.A)(),$a=Object(v.m)("div"),Qb=Object(v.m)("label"),Xb=Object(v.m)("input"),Lc=Object(v.B)(`
            Quarantine household only`),qc=Object(v.A)(),kb=Object(v.m)("div"),gc=Object(v.m)("label"),Rb=Object(v.m)("input"),dd=Object(v.B)(`
            Quarantine all contacts`),Uc=Object(v.A)(),od=Object(v.m)("div"),vc=Object(v.m)("div"),Object(v.j)(Oa.$$.fragment),Object(v.e)(M,"type","checkbox"),M.__value=G="Quarantine",M.value=M.__value,Object(v.e)(M,"class","svelte-jt39wy"),ra[21][0].push(M),Object(v.e)(ec,"class","control-label svelte-jt39wy"),Object(v.e)(Pb,"class","control-name svelte-jt39wy"),Object(v.C)(Pb,"enabled",ra[9].includes("Quarantine")),Object(v.e)(va,"class","control-tooltip svelte-jt39wy"),Object(v.e)(sb,"class","control-explanation svelte-jt39wy"),Object(v.e)(Xb,"type","radio"),Xb.__value=wd=!1,Xb.value=Xb.__value,Object(v.e)(Xb,"class","svelte-jt39wy"),ra[21][1].push(Xb),Object(v.e)(Qb,"class","control-label svelte-jt39wy"),Object(v.C)(Qb,"tracing",!ra[2]),Object(v.e)($a,"class","control-group radio svelte-jt39wy"),Object(v.e)(Rb,"type","radio"),Rb.__value=mc=!0,Rb.value=Rb.__value,Object(v.e)(Rb,"class","svelte-jt39wy"),ra[21][1].push(Rb),Object(v.e)(gc,"class","control-label svelte-jt39wy"),Object(v.C)(gc,"tracing",ra[2]),Object(v.e)(kb,"class","control-group radio svelte-jt39wy"),Object(v.e)(vc,"class","slider-container svelte-jt39wy"),Object(v.e)(od,"class","control-group slider svelte-jt39wy"),Object(v.e)(Ya,"class","control control-radio svelte-jt39wy")},m(da,lb){Object(v.r)(da,Ya,lb),Object(v.d)(Ya,Pb),Object(v.d)(Pb,ec),Object(v.d)(ec,M),M.checked=~ra[9].indexOf(M.__value),Object(v.d)(ec,pa),Object(v.d)(Ya,za),Object(v.d)(Ya,va),Object(v.d)(Ya,pb),Object(v.d)(Ya,sb),Object(v.d)(Ya,bb),Object(v.d)(Ya,$a),Object(v.d)($a,Qb),Object(v.d)(Qb,Xb),Xb.checked=Xb.__value===ra[2],Object(v.d)(Qb,Lc),Object(v.d)(Ya,qc),Object(v.d)(Ya,kb),Object(v.d)(kb,gc),Object(v.d)(gc,Rb),Rb.checked=Rb.__value===ra[2],Object(v.d)(gc,dd),Object(v.d)(Ya,Uc),Object(v.d)(Ya,od),Object(v.d)(od,vc),Object(v.t)(Oa,vc,null),Kb=!0,Fc||(oe=[Object(v.s)(M,"change",ra[20]),Object(v.s)(va,"click",ra[14]),Object(v.s)(Xb,"change",ra[22]),Object(v.s)(Rb,"change",ra[23])],Fc=!0)},p(da,lb){512&lb[0]&&(M.checked=~da[9].indexOf(M.__value)),512&lb[0]&&Object(v.C)(Pb,"enabled",da[9].includes("Quarantine")),4&lb[0]&&(Xb.checked=Xb.__value===da[2]),4&lb[0]&&Object(v.C)(Qb,"tracing",!da[2]),4&lb[0]&&(Rb.checked=Rb.__value===da[2]),4&lb[0]&&Object(v.C)(gc,"tracing",da[2]);const ua={};512&lb[0]&&(ua.disabled=!da[9].includes("Quarantine")),!xd&&256&lb[0]&&(xd=!0,ua.values=da[8],Object(v.b)(()=>xd=!1)),Oa.$set(ua)},i(da){Kb||(Object(v.D)(Oa.$$.fragment,da),Kb=!0)},o(da){Object(v.E)(Oa.$$.fragment,da),Kb=!1},d(da){da&&Object(v.l)(Ya),ra[21][0].splice(ra[21][0].indexOf(M),1),ra[21][1].splice(ra[21][1].indexOf(Xb),1),ra[21][1].splice(ra[21][1].indexOf(Rb),1),Object(v.k)(Oa),Fc=!1,Object(v.x)(oe)}}}(E),Ld=E[13]&&function(ra){let Ya;return{c(){Ya=Object(v.B)("on days")},m(Pb,ec){Object(v.r)(Pb,Ya,ec)},d(Pb){Pb&&Object(v.l)(Ya)}}}(),Ee=E[13]&&function(ra){let Ya;return{c(){Ya=Object(v.m)("div"),Ya.textContent="Overrides interventions below",Object(v.e)(Ya,"class","control-note svelte-jt39wy")},m(Pb,ec){Object(v.r)(Pb,Ya,ec)},d(Pb){Pb&&Object(v.l)(Ya)}}}(),Md=E[3]&&zi();function Fe(ra){E[26].call(null,ra)}let sf={max:Ag,step:1,tooltip:E[12],disabled:!E[9].includes("Shelter in place")};void 0!==E[4]&&(sf.values=E[4]);const Pc=new Ua({props:sf});v.g.push(()=>Object(v.f)(Pc,"values",Fe));let vd=E[13]&&function(ra){let Ya,Pb,ec,M,G,pa,za,va,pb,sb,bb,$a,Qb,Xb,wd,Lc,qc,kb,gc,Rb,mc,dd,Uc,od,vc,xd,Kb,Fc,oe,ob,hc,Oa,da,lb,ua,zc,vb,Vc,Wc,Bb,Mc,Sb,Dd,ad,Qc,pd,Zb;function gb(yb){ra[28].call(null,yb)}let ed={max:Ag,step:1,tooltip:ra[12],disabled:!ra[9].includes("School closure")};void 0!==ra[6]&&(ed.values=ra[6]);const nc=new Ua({props:ed});function Ih(yb){ra[30].call(null,yb)}v.g.push(()=>Object(v.f)(nc,"values",gb));let Jh={max:Ag,step:1,tooltip:ra[12],disabled:!ra[9].includes("Cancel mass gatherings")};void 0!==ra[5]&&(Jh.values=ra[5]);const ja=new Ua({props:Jh});function $e(yb){ra[32].call(null,yb)}v.g.push(()=>Object(v.f)(ja,"values",Ih));let ce={max:Ag,step:1,tooltip:ra[12],disabled:!ra[9].includes("Shielding the elderly")};void 0!==ra[7]&&(ce.values=ra[7]);const Hd=new Ua({props:ce});return v.g.push(()=>Object(v.f)(Hd,"values",$e)),{c(){Ya=Object(v.m)("section"),Pb=Object(v.m)("div"),ec=Object(v.m)("label"),M=Object(v.m)("input"),pa=Object(v.B)(`
            Schools closed on days`),za=Object(v.A)(),va=Object(v.m)("div"),pb=Object(v.A)(),sb=Object(v.m)("div"),sb.innerHTML=`
          Community acceptance may be stronger if alternative services for childcare and student learning and provision of nutrition are established. We used reductions in contacts by age groups in our age-structured model to replicate the findings of Litinova et al. (2019) (<a href="https://www.thelancet.com/action/showPdf?pii=S2352-4642%2820%2930095-X" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,bb=Object(v.A)(),$a=Object(v.m)("div"),Qb=Object(v.m)("div"),Object(v.j)(nc.$$.fragment),wd=Object(v.A)(),Lc=Object(v.m)("section"),qc=Object(v.m)("div"),kb=Object(v.m)("label"),gc=Object(v.m)("input"),mc=Object(v.B)(`
            No mass gatherings on days`),dd=Object(v.A)(),Uc=Object(v.m)("div"),od=Object(v.A)(),vc=Object(v.m)("div"),vc.innerHTML=`
          Engage with community and religious leaders to articulate value-based decisions and encourage local adoption. Adaptation of existing events, including outdoor services or services in shifts, may be helpful in localities where cancellation of gatherings is not practical. We assumed a reduction in transmission by 28%. (<a href="https://www.pnas.org/content/104/18/7588" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,xd=Object(v.A)(),Kb=Object(v.m)("div"),Fc=Object(v.m)("div"),Object(v.j)(ja.$$.fragment),ob=Object(v.A)(),hc=Object(v.m)("section"),Oa=Object(v.m)("div"),da=Object(v.m)("label"),lb=Object(v.m)("input"),zc=Object(v.B)(`
            Shield the elderly on days`),vb=Object(v.A)(),Vc=Object(v.m)("div"),Wc=Object(v.A)(),Bb=Object(v.m)("div"),Bb.innerHTML=`
          While there is a limited evidence base for a shielding strategy, such an approach might be of benefit to certain at-risk groups for severe outcomes. We assumed a reduction in transmission among the elderly cohort and their contacts of 50%. (<a href="https://www.imperial.ac.uk/media/imperial-college/medicine/sph/ide/gida-fellowships/Imperial-College-COVID19-NPI-modelling-16-03-2020.pdf" target="_blank" class="svelte-jt39wy">Reference</a>)
        `,Mc=Object(v.A)(),Sb=Object(v.m)("div"),Dd=Object(v.m)("div"),Object(v.j)(Hd.$$.fragment),Object(v.e)(M,"type","checkbox"),M.__value=G="School closure",M.value=M.__value,Object(v.e)(M,"class","svelte-jt39wy"),ra[21][0].push(M),Object(v.e)(ec,"class","control-label svelte-jt39wy"),Object(v.e)(Pb,"class","control-name svelte-jt39wy"),Object(v.C)(Pb,"enabled",ra[9].includes("School closure")),Object(v.e)(va,"class","control-tooltip svelte-jt39wy"),Object(v.e)(sb,"class","control-explanation svelte-jt39wy"),Object(v.e)(Qb,"class","slider-container svelte-jt39wy"),Object(v.e)($a,"class","control-group slider svelte-jt39wy"),Object(v.e)(Ya,"class","control svelte-jt39wy"),Object(v.e)(gc,"type","checkbox"),gc.__value=Rb="Cancel mass gatherings",gc.value=gc.__value,Object(v.e)(gc,"class","svelte-jt39wy"),ra[21][0].push(gc),Object(v.e)(kb,"class","control-label svelte-jt39wy"),Object(v.e)(qc,"class","control-name svelte-jt39wy"),Object(v.C)(qc,"enabled",ra[9].includes("Cancel mass gatherings")),Object(v.e)(Uc,"class","control-tooltip svelte-jt39wy"),Object(v.e)(vc,"class","control-explanation svelte-jt39wy"),Object(v.e)(Fc,"class","slider-container svelte-jt39wy"),Object(v.e)(Kb,"class","control-group slider svelte-jt39wy"),Object(v.e)(Lc,"class","control svelte-jt39wy"),Object(v.e)(lb,"type","checkbox"),lb.__value=ua="Shielding the elderly",lb.value=lb.__value,Object(v.e)(lb,"class","svelte-jt39wy"),ra[21][0].push(lb),Object(v.e)(da,"class","control-label svelte-jt39wy"),Object(v.e)(Oa,"class","control-name svelte-jt39wy"),Object(v.C)(Oa,"enabled",ra[9].includes("Shielding the elderly")),Object(v.e)(Vc,"class","control-tooltip svelte-jt39wy"),Object(v.e)(Bb,"class","control-explanation svelte-jt39wy"),Object(v.e)(Dd,"class","slider-container svelte-jt39wy"),Object(v.e)(Sb,"class","control-group slider svelte-jt39wy"),Object(v.e)(hc,"class","control svelte-jt39wy")},m(yb,fc){Object(v.r)(yb,Ya,fc),Object(v.d)(Ya,Pb),Object(v.d)(Pb,ec),Object(v.d)(ec,M),M.checked=~ra[9].indexOf(M.__value),Object(v.d)(ec,pa),Object(v.d)(Ya,za),Object(v.d)(Ya,va),Object(v.d)(Ya,pb),Object(v.d)(Ya,sb),Object(v.d)(Ya,bb),Object(v.d)(Ya,$a),Object(v.d)($a,Qb),Object(v.t)(nc,Qb,null),Object(v.r)(yb,wd,fc),Object(v.r)(yb,Lc,fc),Object(v.d)(Lc,qc),Object(v.d)(qc,kb),Object(v.d)(kb,gc),gc.checked=~ra[9].indexOf(gc.__value),Object(v.d)(kb,mc),Object(v.d)(Lc,dd),Object(v.d)(Lc,Uc),Object(v.d)(Lc,od),Object(v.d)(Lc,vc),Object(v.d)(Lc,xd),Object(v.d)(Lc,Kb),Object(v.d)(Kb,Fc),Object(v.t)(ja,Fc,null),Object(v.r)(yb,ob,fc),Object(v.r)(yb,hc,fc),Object(v.d)(hc,Oa),Object(v.d)(Oa,da),Object(v.d)(da,lb),lb.checked=~ra[9].indexOf(lb.__value),Object(v.d)(da,zc),Object(v.d)(hc,vb),Object(v.d)(hc,Vc),Object(v.d)(hc,Wc),Object(v.d)(hc,Bb),Object(v.d)(hc,Mc),Object(v.d)(hc,Sb),Object(v.d)(Sb,Dd),Object(v.t)(Hd,Dd,null),Qc=!0,pd||(Zb=[Object(v.s)(M,"change",ra[27]),Object(v.s)(va,"click",ra[14]),Object(v.s)(gc,"change",ra[29]),Object(v.s)(Uc,"click",ra[14]),Object(v.s)(lb,"change",ra[31]),Object(v.s)(Vc,"click",ra[14])],pd=!0)},p(yb,fc){512&fc[0]&&(M.checked=~yb[9].indexOf(M.__value)),512&fc[0]&&Object(v.C)(Pb,"enabled",yb[9].includes("School closure"));const pe={};512&fc[0]&&(pe.disabled=!yb[9].includes("School closure")),!Xb&&64&fc[0]&&(Xb=!0,pe.values=yb[6],Object(v.b)(()=>Xb=!1)),nc.$set(pe),512&fc[0]&&(gc.checked=~yb[9].indexOf(gc.__value)),512&fc[0]&&Object(v.C)(qc,"enabled",yb[9].includes("Cancel mass gatherings"));const Ef={};512&fc[0]&&(Ef.disabled=!yb[9].includes("Cancel mass gatherings")),!oe&&32&fc[0]&&(oe=!0,Ef.values=yb[5],Object(v.b)(()=>oe=!1)),ja.$set(Ef),512&fc[0]&&(lb.checked=~yb[9].indexOf(lb.__value)),512&fc[0]&&Object(v.C)(Oa,"enabled",yb[9].includes("Shielding the elderly"));const de={};512&fc[0]&&(de.disabled=!yb[9].includes("Shielding the elderly")),!ad&&128&fc[0]&&(ad=!0,de.values=yb[7],Object(v.b)(()=>ad=!1)),Hd.$set(de)},i(yb){Qc||(Object(v.D)(nc.$$.fragment,yb),Object(v.D)(ja.$$.fragment,yb),Object(v.D)(Hd.$$.fragment,yb),Qc=!0)},o(yb){Object(v.E)(nc.$$.fragment,yb),Object(v.E)(ja.$$.fragment,yb),Object(v.E)(Hd.$$.fragment,yb),Qc=!1},d(yb){yb&&Object(v.l)(Ya),ra[21][0].splice(ra[21][0].indexOf(M),1),Object(v.k)(nc),yb&&Object(v.l)(wd),yb&&Object(v.l)(Lc),ra[21][0].splice(ra[21][0].indexOf(gc),1),Object(v.k)(ja),yb&&Object(v.l)(ob),yb&&Object(v.l)(hc),ra[21][0].splice(ra[21][0].indexOf(lb),1),Object(v.k)(Hd),pd=!1,Object(v.x)(Zb)}}}(E);return{c(){F=Object(v.m)("section"),N=Object(v.m)("section"),L=Object(v.m)("h1"),P=Object(v.B)(E[0]),R=Object(v.A)(),S=Object(v.m)("p"),S.textContent="per million population",ga=Object(v.A)(),_=Object(v.m)("nav"),la=Object(v.m)("button"),la.textContent="Infections",aa=Object(v.A)(),ma=Object(v.m)("button"),ma.textContent="Deaths",Y=Object(v.A)(),Object(v.j)(ub.$$.fragment),qa=Object(v.A)(),ba=Object(v.m)("section"),Kc&&Kc.c(),ea=Object(v.A)(),cd&&cd.c(),ta=Object(v.A)(),Ta=Object(v.m)("section"),fb=Object(v.m)("div"),Nb=Object(v.m)("label"),Ib=Object(v.m)("input"),Ic=Object(v.B)(`
          Shelter in place `),Ld&&Ld.c(),Ob=Object(v.A)(),Ee&&Ee.c(),Jb=Object(v.A)(),Db=Object(v.m)("div"),Md&&Md.c(),Jc=Object(v.A)(),md=Object(v.m)("div"),Object(v.j)(Pc.$$.fragment),Ec=Object(v.A)(),vd&&vd.c(),Object(v.e)(L,"class","title svelte-jt39wy"),Object(v.e)(S,"class","subtitle svelte-jt39wy"),Object(v.e)(la,"class","svelte-jt39wy"),Object(v.C)(la,"active","Infected"===E[1]),Object(v.e)(ma,"class","svelte-jt39wy"),Object(v.C)(ma,"active","Dead"===E[1]),Object(v.e)(_,"class","compartment-tabs svelte-jt39wy"),Object(v.e)(N,"class","compartments svelte-jt39wy"),Object(v.e)(Ib,"type","checkbox"),Ib.__value=Aa="Shelter in place",Ib.value=Ib.__value,Object(v.e)(Ib,"class","svelte-jt39wy"),E[21][0].push(Ib),Object(v.e)(Nb,"class","control-label svelte-jt39wy"),Object(v.e)(fb,"class","control-name svelte-jt39wy"),Object(v.C)(fb,"enabled",E[9].includes("Shelter in place")),Object(v.e)(md,"class","slider-container svelte-jt39wy"),Object(v.e)(Db,"class","control-group slider svelte-jt39wy"),Object(v.e)(Ta,"class","control svelte-jt39wy"),Object(v.e)(ba,"class","controls svelte-jt39wy"),Object(v.e)(F,"class","covid-simulator svelte-jt39wy"),Object(v.C)(F,"stacked",E[13]),Object(v.C)(F,"simple",E[3])},m(ra,Ya){Object(v.r)(ra,F,Ya),Object(v.d)(F,N),Object(v.d)(N,L),Object(v.d)(L,P),Object(v.d)(N,R),Object(v.d)(N,S),Object(v.d)(N,ga),Object(v.d)(N,_),Object(v.d)(_,la),Object(v.d)(_,aa),Object(v.d)(_,ma),Object(v.d)(N,Y),Object(v.t)(ub,N,null),Object(v.d)(F,qa),Object(v.d)(F,ba),Kc&&Kc.m(ba,null),Object(v.d)(ba,ea),cd&&cd.m(ba,null),Object(v.d)(ba,ta),Object(v.d)(ba,Ta),Object(v.d)(Ta,fb),Object(v.d)(fb,Nb),Object(v.d)(Nb,Ib),Ib.checked=~E[9].indexOf(Ib.__value),Object(v.d)(Nb,Ic),Ld&&Ld.m(Nb,null),Object(v.d)(Ta,Ob),Ee&&Ee.m(Ta,null),Object(v.d)(Ta,Jb),Object(v.d)(Ta,Db),Md&&Md.m(Db,null),Object(v.d)(Db,Jc),Object(v.d)(Db,md),Object(v.t)(Pc,md,null),Object(v.d)(ba,Ec),vd&&vd.m(ba,null),nd=!0,lc||(Ab=[Object(v.s)(la,"click",E[18]),Object(v.s)(ma,"click",E[19]),Object(v.s)(Ib,"change",E[25])],lc=!0)},p(ra,Ya){(!nd||1&Ya[0])&&Object(v.z)(P,ra[0]),2&Ya[0]&&Object(v.C)(la,"active","Infected"===ra[1]),2&Ya[0]&&Object(v.C)(ma,"active","Dead"===ra[1]);const Pb={};1&Ya[0]&&(Pb.region=ra[0]),1024&Ya[0]&&(Pb.interventions=ra[10]),2&Ya[0]&&(Pb.compartment=ra[1]),ub.$set(Pb),ra[11]?Kc?(Kc.p(ra,Ya),2048&Ya[0]&&Object(v.D)(Kc,1)):(Kc=Bj(ra),Kc.c(),Object(v.D)(Kc,1),Kc.m(ba,ea)):Kc&&(Object(v.o)(),Object(v.E)(Kc,1,1,()=>{Kc=null}),Object(v.h)()),ra[13]&&cd.p(ra,Ya),512&Ya[0]&&(Ib.checked=~ra[9].indexOf(Ib.__value)),512&Ya[0]&&Object(v.C)(fb,"enabled",ra[9].includes("Shelter in place")),ra[3]?Md||(Md=zi(),Md.c(),Md.m(Db,Jc)):Md&&(Md.d(1),Md=null);const ec={};512&Ya[0]&&(ec.disabled=!ra[9].includes("Shelter in place")),!Dc&&16&Ya[0]&&(Dc=!0,ec.values=ra[4],Object(v.b)(()=>Dc=!1)),Pc.$set(ec),ra[13]&&vd.p(ra,Ya),8192&Ya[0]&&Object(v.C)(F,"stacked",ra[13]),8&Ya[0]&&Object(v.C)(F,"simple",ra[3])},i(ra){nd||(Object(v.D)(ub.$$.fragment,ra),Object(v.D)(Kc),Object(v.D)(cd),Object(v.D)(Pc.$$.fragment,ra),Object(v.D)(vd),nd=!0)},o(ra){Object(v.E)(ub.$$.fragment,ra),Object(v.E)(Kc),Object(v.E)(cd),Object(v.E)(Pc.$$.fragment,ra),Object(v.E)(vd),nd=!1},d(ra){ra&&Object(v.l)(F),Object(v.k)(ub),Kc&&Kc.d(),cd&&cd.d(),E[21][0].splice(E[21][0].indexOf(Ib),1),Ld&&Ld.d(),Ee&&Ee.d(),Md&&Md.d(),Object(v.k)(Pc),vd&&vd.d(),lc=!1,Object(v.x)(Ab)}}}let Ag=180;function Rk(E,F,N){let L,P,R,S,ga,_,{region:la}=F,{preset:aa=null}=F,ma="Infected",Y=cc({decimals:0,thousand:","}),qa=!1;switch(aa){case"shelter-only":L=!1,_=[0,0],P=[0,60],S=[0,0],R=[0,0],ga=[0,0];break;case"shelter-plus":L=!1,_=[0,0],P=[0,60],S=[0,60],R=[0,60],ga=[0,60];break;case"none":L=!1,_=[0,0],P=[0,0],S=[0,0],R=[0,0],ga=[0,0];break;case"elderly":L=!1,_=[0,0],P=[0,0],S=[0,0],R=[0,0],ga=[0,180];break;case"schools":L=!1,_=[0,0],P=[0,0],S=[0,180],R=[0,0],ga=[0,0];break;case"1":L=!0,P=[21,90];break;case"3":L=!0,P=[21,60];break;case"2":case"4":case"5":default:L=!1,_=[90,180],P=[21,90],S=[21,120],R=[21,90],ga=[21,120]}let ba=!L,ea=["Shelter in place","Cancel mass gatherings","School closure","Shielding the elderly","Quarantine"],ta=ea.slice(),Ta="Quarantine",fb={},Nb=!1;const Ib=[[],[]];return E.$set=Aa=>{"region"in Aa&&N(0,la=Aa.region),"preset"in Aa&&N(15,aa=Aa.preset)},E.$$.update=()=>{if(1&E.$$.dirty[0]&&N(0,la=la[0].toUpperCase()+la.slice(1)),4&E.$$.dirty[0]&&N(16,Ta=qa?"Quarantine and tracing":"Quarantine"),66552&E.$$.dirty[0])if(L)N(10,fb={"Shelter in place":P});else{N(10,fb={});for(let Aa of ea)switch(Aa){case"Cancel mass gatherings":N(10,fb[Aa]=ta.includes(Aa)?R:[0,0],fb);break;case"School closure":N(10,fb[Aa]=ta.includes(Aa)?S:[0,0],fb);break;case"Shelter in place":N(10,fb[Aa]=ta.includes(Aa)?P:[0,0],fb);break;case"Shielding the elderly":N(10,fb[Aa]=ta.includes(Aa)?ga:[0,0],fb);break;case"Quarantine":N(10,fb[Ta]=ta.includes(Aa)?_:[0,0],fb)}}},[la,ma,qa,L,P,R,S,ga,_,ta,fb,Nb,Y,ba,Aa=>{if(Nb)return N(11,Nb=!1);let Ic=Aa.target.parentElement;N(11,Nb={name:Ic.querySelector(".control-name").innerText,body:Ic.querySelector(".control-explanation").innerHTML})},aa,Ta,ea,()=>N(1,ma="Infected"),()=>N(1,ma="Dead"),function(){ta=Object(v.n)(Ib[0]),N(9,ta)},Ib,function(){qa=this.__value,N(2,qa)},function(){qa=this.__value,N(2,qa)},function(Aa){_=Aa,N(8,_)},function(){ta=Object(v.n)(Ib[0]),N(9,ta)},function(Aa){P=Aa,N(4,P)},function(){ta=Object(v.n)(Ib[0]),N(9,ta)},function(Aa){S=Aa,N(6,S)},function(){ta=Object(v.n)(Ib[0]),N(9,ta)},function(Aa){R=Aa,N(5,R)},function(){ta=Object(v.n)(Ib[0]),N(9,ta)},function(Aa){ga=Aa,N(7,ga)}]}class ca extends v.a{constructor(E){super(),Object(v.q)(this,E,Rk,ch,v.y,{region:0,preset:15},[-1,-1])}}var Ja=ca;function Va(E){const F=ya.p;let N="";return(!F||F.indexOf("://")<0)&&(N+=window.location.protocol+"//"+window.location.host),N+=F||"/",N+E}({url:Va("_dist_/index.js"),env:Ca}).env=Ca;let dc=[],Cd=[];function yc(E){document.querySelectorAll("[data-covid-graph]").forEach(F=>{let N=new E({target:F,props:{region:F.dataset.region,preset:F.dataset.preset}});dc.push(N),new MutationObserver(function(L){return function(P,R){P.forEach(S=>{"attributes"===S.type&&L.$set({region:S.target.dataset.region,preset:S.target.dataset.preset})})}}(N)).observe(F,{attributes:!0})})}document.addEventListener("DOMContentLoaded",()=>yc(Ja)),_a.default=dc,{url:Va("_dist_/index.js"),env:Ca}.hot&&({url:Va("_dist_/index.js"),env:Ca}.hot.accept(({module:E})=>{yc(E)}),{url:Va("_dist_/index.js"),env:Ca}.hot.dispose(()=>{dc.forEach(E=>E.$destroy()),Cd.forEach(E=>E.disconnect())}))}]);
